<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A PT-based approach to construct efficient provenance graph for threat alert investigation</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Shiming</forename><surname>Men</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Nanjing University of Aeronautics and Astronautics</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Jian</forename><surname>Wang</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Nanjing University of Aeronautics and Astronautics</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Mai</forename><surname>Ye</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Nanjing University of Aeronautics and Astronautics</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A PT-based approach to construct efficient provenance graph for threat alert investigation</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1051/itmconf/20246000016</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-21T20:22+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The Provenance Graph, constructed based on audit logs, encapsulates a wealth of causal relationships. When existing threat detection software issues an Event of Alert (EOA), security analysts conduct threat alert investigations based on the provenance graph. However, a provenance graph comprising tens of thousands of nodes and edges can lead to substantial time overhead. Moreover, coarse-grained audit logs can cause a dependency explosion in the provenance graph, thereby generating false causal relationships and interfering with the accuracy of the results. Hardware-assisted Processor Tracing (PT) can address the problem of false causal relationships caused by dependency explosion, by extracting the execution trace of a process and restoring instruction-level data flow. Leveraging PT features, we propose an efficient scheme, termed as GETSUS, which can reduce the size of the provenance graph while fully preserving the event sequences leading to the EOA. Empirical evidence shows that GETSUS can shrink a large provenance graph (approximately 200,000 edges) to a small one (around 50 edges). Compared to other schemes, the partial provenance graph output by GETSUS can fully retain the semantics related to the EOA, while improving the reduction efficiency by about tenfold.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>In today's world, with the continuous development of information technology, an increasing number of entities, such as corporations and individuals, are becoming targets of cyber-attacks. To counter these attacks, many corporations deploy the Threat Detection Software (TDS). This software continuously monitors activities and generates an Event of Alert (EOA) when suspicious activities occur. Cybersecurity analysts are required to manually investigate these EOAs. However, due to the lack of contextual information surrounding the alerts, it is challenging for analysts to conduct accurate investigations.</p><p>Provenance Graphs, based on system logs, have been demonstrated to provide rich contextual information <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b1">2]</ref>. These graphs record the causal relationships among system entities (processes, files, and network sockets). Upon the generation of an Event of Alert (EOA), cybersecurity analysts can analyse the provenance graph <ref type="bibr" target="#b2">[3]</ref><ref type="bibr" target="#b3">[4]</ref><ref type="bibr" target="#b4">[5]</ref><ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b8">[9]</ref><ref type="bibr" target="#b9">[10]</ref>, identify the attack entry nodes leading to the EOA (backward trace), and comprehend the consequences of the attack (forward trace) <ref type="bibr" target="#b6">[7,</ref><ref type="bibr" target="#b7">8]</ref>.</p><p>Consequently, an increasing number of security analysts are opting to use provenance-based schemes for threat alert investigations. Through meticulous analysis of previous works <ref type="bibr" target="#b8">[9,</ref><ref type="bibr" target="#b9">10,</ref><ref type="bibr" target="#b10">11]</ref>, we have derived three key insights. First, within large provenance graphs containing an EOA, a small number of suspicious edges representing attack sequences are hidden among a vast number of normal edges. Compared to normal edges, * Corresponding author: mailto:menshiming@nuaa.edu.cn The author(s) declare(s) that there is no conflict of interest regarding the publication of this paper.</p><p>these suspicious edges differ in multiple attributes and are more correlated with the EOA. Second, coarsegrained information based on system calls is insufficient to describe the activities of a process. Third, the suspiciousness level of each event should be adjusted based on the suspiciousness level of adjacent events. Despite the appeal of provenance-based methods and key insights, existing schemes for conducting threat alert investigations based on the provenance graph have several key limitations:</p><p>Dependency Explosion Problem <ref type="bibr" target="#b11">[12,</ref><ref type="bibr" target="#b12">13]</ref>. Current provenance tracing techniques only utilize coarsegrained provenance information, assuming that the output of an event is causally dependent on all previous input events <ref type="bibr" target="#b11">[12]</ref>, ultimately leading to a dependency explosion. This explosion can result in false dependencies during causal analysis, affecting the accuracy of the final results. The DepImpact <ref type="bibr" target="#b13">[14]</ref> scheme, due to its exclusive use of coarse-grained information, fails to completely eliminate edges without real dependencies. Furthermore, dependency explosions can lead to the inclusion of more normal edges in the provenance graph, which exacerbates the difficulty of investigation.</p><p>Completeness Problem. Missing parts of the event sequence can render the final investigation results unreliable. NoDoze <ref type="bibr" target="#b3">[4]</ref> opts to use a single feature to distinguish between suspicious and normal edges which lacks sufficient causal information for differentiation. Furthermore, NoDoze merges fixed-length event sequences to obtain the final partial graph which can miss suspicious entry nodes and lose key event sequences.</p><p>To address these challenges, we propose the GETSUS scheme based on key insights. GETSUS supplements coarse-grained audit logs with fine-grained Process Trace (PT) features, enhancing the contextual information of process nodes prone to dependency explosions, eliminating false dependencies, and resolving the dependency explosion problem. When a TDS generates an EOA, GETSUS identifies suspicious entry nodes related to the EOA. By performing forward tracing from these suspicious entry nodes, GETSUS obtains a suspicious provenance graph containing all event sequences leading to the EOA, assisting security analysts in conducting threat alert investigations. This paper makes the following contributions:</p><p>We successfully prevent false dependencies, and resolve the dependency explosion problem by integrating PT features with coarse-grained audit log records.</p><p>To facilitate the completion of threat alert investigations, we introduce the concept of a suspicious provenance graph, which fully retains the event sequence leading to the EOA. Compared to the original provenance graph, the suspicious provenance graph is reduced by approximately 4000 times while ensuring semantic completeness.</p><p>We have refined the existing algorithms, which enhances the ability to distinguish between suspicious and normal entry nodes.</p><p>We conduct a detailed and comprehensive evaluation. The results demonstrate the high efficiency of GETSUS.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Scheme (GETSUS) for constructing effective provenance graph 2.1 Overview</head><p>Figure <ref type="figure" target="#fig_0">2</ref> illustrates the workflow of GETSUS. When the existing TDS issues an EOA, GETSUS utilizes PT features to construct a provenance graph free of dependency explosions. GETSUS then optimizes this provenance graph, eliminating irrelevant edges and nodes (such as temporary files and library files). Based on the optimized provenance graph, GETSUS calculates and propagates suspiciousness values to identify suspicious entry nodes. By performing forward tracing analysis from these suspicious entry nodes, GETSUS outputs the suspicious provenance graph.</p><p>To facilitate understanding of GETSUS's function, Figure <ref type="figure" target="#fig_1">1</ref> illustrates its role in a real-world case. Here, diamonds represent socket nodes, rectangles represent process nodes, and ellipses represent file nodes. The edges between nodes represent causal relationships between two system entities. Figure <ref type="figure" target="#fig_1">1</ref>(a) shows a partial provenance graph of a data leakage attack. Figure <ref type="figure" target="#fig_1">1(b)</ref> shows the suspicious provenance graph which identifies event sequence leading to the EOA. Compared to the graph in Figure <ref type="figure" target="#fig_1">1</ref>(a), the suspicious provenance graph directly reveals the attack sequences. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Scheme</head><p>In this section, we elaborate on some of the design details of GETSUS. In Section 2.2.1, we provide a detailed introduction to some of the key concepts. In Section 2.2.2, we discuss how GETSUS collects audit logs and uses PT features to create a provenance graph. In Section 2.2.3, we describe how GETSUS identifies suspicious entry nodes. In Section 2.2.4, we explain how GETSUS obtains the suspicious provenance graph.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">Basic concept</head><p>A Provenance Graph is composed of system entities and the causal relationships between them. System entities include processes, files, and sockets. Causal relationships, such as read, write, clone, etc., represent interactions between entities and are obtained by parsing system audit logs. GETSUS uses system calls to represent interactions between entities. An event ğœ€ is composed of a triplet {ğ‘†ğ‘…ğ¶, ğ·ğ‘†ğ‘‡, ğ‘…ğ¸ğ¿} , where ğ‘†ğ‘…ğ¶, ğ·ğ‘†ğ‘‡ âˆˆ {ğ‘ƒğ‘Ÿğ‘œğ‘ğ‘’ğ‘ ğ‘ , ğ¹ğ‘–ğ‘™ğ‘’, ğ‘†ğ‘œğ‘ğ‘˜ğ‘’ğ‘¡} , and ğ‘…ğ¸ğ¿ âˆˆ {ğ‘Ÿğ‘’ğ‘ğ‘‘, ğ‘¤ğ‘Ÿğ‘–ğ‘¡ğ‘’, â€¦ }. Table <ref type="table">1</ref> shows various attributes in entities.</p><p>Table <ref type="table">1</ref>. Part critical information of system entities.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Entity Attributes Shapes</head><p>Process pid, ppid, exe, args, ... Rectangle File path, fd, ... Ellipse Socket ip, port, ... Diamond</p><p>Edges in the provenance graph represent system events, indicating interactions between system entities. An event sequence is composed of multiple causally related, ordered events ğœ€. An event sequence of length ğ‘› can be represented as ğ‘ƒ = {ğœ€ 1 , ğœ€ 2 , ğœ€ 3 , â€¦ , ğœ€ ğ‘› | ğœ€ ğ‘– . ğ·ğ‘†ğ‘‡ = ğœ€ ğ‘–+1 . ğ‘†ğ‘…ğ¶} . An event ğœ€ can have multiple event sequences. Event sequences can reflect the causes leading to ğœ€ and reveal the consequences triggered by ğœ€. GETSUS uses 32 system calls to represent the interaction relationships. Some of them are displayed in Table <ref type="table" target="#tab_0">2</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.2">Provenance graph construction &amp; refinement</head><p>GETSUS utilizes Auditbeat to collect system logs. Most provenance analysises based on system call logs can only track coarse-grained information flows in the system, conservatively assuming that the output of a node depends on all its previous inputs. This leads provenance-based attack investigations into the predicament of dependency explosions. As shown in Figure <ref type="figure" target="#fig_2">3</ref>(a), the curl process accesses a large number of Socket nodes and downloads numerous files. In Figure <ref type="figure" target="#fig_2">3</ref>(a), the config or info files depend on all preceding socket nodes in chronological order, creating false dependencies. Inspired by Palantir <ref type="bibr" target="#b14">[15]</ref>, GETSUS uses PT as a feature to solve the dependency explosion problem. PT is a hardware feature enabled by modern Intel CPUs, which effectively records the execution trace of a process and recovers instruction-level data flows. PT provides fine-grained provenance information, and when combined with coarse-grained system audit log records, it can eliminate false causal relationships. As shown in Figure <ref type="figure" target="#fig_2">3</ref>(b), PT can annotate the real dependency of the curl process and eliminate irrelevant nodes and edges. GETSUS employs Palantir <ref type="bibr" target="#b14">[15]</ref> to extract PT features, encompassing three steps: static binary analysis, runtime monitoring, and provenance analysis. First, this approach statically analyses program binary files to obtain the Control Flow Graphs (CFGs) and Call Graphs (CGs), followed by taint summarization. Leveraging the taint summary, this approach conducts taint propagation, and ultimately associates the PT trace with the audit logs through the system call sequence, yielding audit logs enriched with fine-grained information. Given that the extraction of PT features involves static binary analysis of the process, to enhance efficiency, we only perform static binary analysis on processes that are susceptible to dependency explosions, such as apache, nginx, firefox, etc. GETSUS generates a provenance graph devoid of false dependencies by parsing the optimized audit logs.</p><p>The majority of audit records are not essential when conducting causal analysis. To eliminate the irrelevant edges and nodes, GETSUS draws upon recent studies <ref type="bibr" target="#b12">[13,</ref><ref type="bibr" target="#b15">16]</ref> to trim the provenance graph from two aspects without losing semantic integrity. 1). The provenance graph typically contains many parallel edges between two nodes, resulting from the system's tendency to complete data transmission by proportionally invoking the corresponding system calls multiple times. Therefore, GETSUS amalgamates parallel edges occurring within a brief time frame. 2). The provenance graph is replete with temporary files and other irrelevant files, such as configuration files and library files. These files do not embody any semantic relationships and offer no assistance to subsequent causal analysis, necessitating their removal.</p><p>Upon trimming the provenance graph, GETSUS obtains a preliminarily reduced version. As GETSUS is solely concerned with the parts related to the EOA, it initiates a backward trace from the EOA using depthfirst search, yielding a partial graph that encompasses all components dependent on the EOA.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.3">Suspicious entry node identification</head><p>Inspired by DepImpact <ref type="bibr" target="#b13">[14]</ref>, GETSUS initially extracts temporal similarity, data flow similarity, and importance features of the edges. Utilizing the AFK-MC2 algorithm <ref type="bibr" target="#b16">[17]</ref>, GETSUS clusters the edges, then assigns weight values to the edges via the RSLDA algorithm <ref type="bibr" target="#b17">[18]</ref>. Starting from the EOA, GETSUS propagates suspiciousness values, ultimately identifying suspicious entry nodes.</p><p>GETSUS employs timestamps to represent the timing of events. GETSUS posits that events closer in time to the EOA are more likely to be suspicious events, hence they possess a higher temporal similarity, ğ‘† ğ‘¡ (ğ‘’).</p><p>Here, ğ‘¡ ğ‘’ denotes the timestamp of event ğ‘’ , and ğ‘¡ ğ¸ğ‘‚ğ´ represents the timestamp of the EOA. The calculation formula for ğ‘† ğ‘¡ (ğ‘’) is as follows:</p><formula xml:id="formula_0">ğ‘† ğ‘¡ (ğ‘’) = ğ‘™ğ‘› ( 1 |ğ‘¡ ğ¸ğ‘‚ğ´ -ğ‘¡ ğ‘’ | + 1)<label>(1)</label></formula><p>Similarly, events with a data flow more akin to the EOA are more likely to be suspicious events. GETSUS assigns a higher data flow similarity, ğ‘† ğ‘‘ (ğ‘’), to such events. The specific formula is as follows, where ğ‘‘ ğ‘’ represents the data flow size of event ğ‘’.</p><formula xml:id="formula_1">ğ‘† ğ‘‘ (ğ‘’) = 1 |ğ‘‘ ğ¸ğ‘‚ğ´ -ğ‘‘ ğ‘’ |<label>(2)</label></formula><p>The importance feature, ğ‘† ğ‘– (ğ‘’) , of an edge is quantified by the in-degree and out-degree of the edge's destination node and its calculation formula is as follows:</p><formula xml:id="formula_2">ğ‘† ğ‘– (ğ‘’) = ğ‘‚ğ‘ˆğ‘‡(ğ‘£) ğ¼ğ‘›(ğ‘£)<label>(3)</label></formula><p>Where, ğ‘’ = {ğ‘¢, ğ‘£} is event ğ‘’ . ğ‘‚ğ‘ˆğ‘‡(ğ‘£) and ğ¼ğ‘(ğ‘£) represents the outgoing edges and incoming edges of the destination node ğ‘£ respectively. If the only incoming edge to node ğ‘£ is edge ğ‘’ , this implies in terms of dependency that edge ğ‘’ is indispensable to node ğ‘£ . Therefore, to denote the importance of edge ğ‘’, GETSUS assigns a higher importance value to this edge.</p><p>The suspiciousness value of an edge signifies its causal correlation with the EOA: the greater the suspiciousness value, the stronger its relevance to the EOA. The contributions of the three feature values to the suspiciousness value are nebulous, and an evenly distributed method could yield inaccurate results. GETSUS normalizes the three feature values. Subsequently, GETSUS opts for the AFK-MC2 clustering algorithm <ref type="bibr" target="#b16">[17]</ref> to cluster all edges into two groups and roughly categorizes one group of edges as suspicious and the other as normal. The AFK-MC2 algorithm introduces certain enhancements to the Kmeans algorithm, optimizing the clustering outcome.</p><p>After obtaining two groups of edges, GETSUS employs the Robust Sparse Linear Discriminant Analysis (RSLDA) method <ref type="bibr" target="#b17">[18]</ref>, projecting the feature vectors onto a plane. RSLDA is capable of extracting the most discriminative features for classification. Specifically, RSLDA primarily utilizes the ğ‘™ 2,1 norm, adaptively assigning larger projection weights to categories of significant features. This approach allows RSLDA to minimize information loss, retain more semantic information, and provide a more effective distinction between suspicious and normal edges. Through RSLDA, GETSUS obtains the optimal projection matrix, denoted as ğ– = (ğ‘¤ ğ‘¡ , ğ‘¤ ğ‘‘ , ğ‘¤ ğ‘– ) ğ‘‡ and the unnormalized weight value ğ‘Š ğ‘’ â€² of the edge ğ‘’ is as follows:</p><formula xml:id="formula_3">ğ‘Š ğ‘’ â€² = ğ‘¤ ğ‘¡ * ğ‘† ğ‘¡ (ğ‘’) + ğ‘¤ ğ‘‘ * ğ‘† ğ‘‘ (ğ‘’) + ğ‘¤ ğ‘– * ğ‘† ğ‘– (ğ‘’)<label>(4)</label></formula><p>GETSUS assigns a suspiciousness value of 1 to the EOA. To ensure that the suspiciousness value of any node doesn't exceed the maximum value of its child nodes and EOA, GETSUS normalizes the weight value of the edge ğ‘’ = {ğ‘¢, ğ‘£} as follows <ref type="bibr" target="#b13">[14]</ref>:</p><formula xml:id="formula_4">ğ‘Š ğ‘’ = ğ‘Š ğ‘’ â€² âˆ‘ ğ‘Š ğ‘’ ğ‘– â€² ğ‘’ ğ‘– âˆˆğ‘‚ğ‘¢ğ‘¡ğ¸ğ‘‘ğ‘”ğ‘’ğ‘ (ğ‘¢) (5)</formula><p>After normalizing the weights of all edges, GETSUS propagates the suspiciousness value (SV) of the EOA based on the weight values. Each node will have a corresponding suspiciousness value, which is ultimately propagated to various entry nodes through different paths. The specific calculation method for the node suspiciousness value is as follows:</p><formula xml:id="formula_5">ğ‘†ğ‘‰(ğ‘¢) = âˆ‘ ğ‘Š ğ‘’ ğ‘– * ğ‘†ğ‘‰(ğ‘’ ğ‘– . ğ·ğ‘†ğ‘‡) ğ‘’ ğ‘– âˆˆğ‘‚ğ‘¢ğ‘¡ğ¸ğ‘‘ğ‘”ğ‘’ğ‘ (ğ‘¢)<label>(6)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.4">Suspicious provenance graph</head><p>GETSUS ranks all entry nodes based on their suspiciousness values. We posit that entry nodes with higher suspiciousness values have a stronger causal relationship with the EOA. GETSUS categorizes suspicious entry nodes into: file entry nodes, process entry nodes, and socket entry nodes, selecting a few nodes with the highest suspiciousness values from each category as suspicious entry nodes. GETSUS initiates a forward causal analysis from these suspicious entry nodes to the EOA. During this forward causal analysis, GETSUS records a portion of the traversed provenance graph, designating this as the suspicious provenance graph. The suspicious provenance graph encapsulates all event sequences leading to the EOA, assisting security analysts in conducting threat alert investigations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Evaluation</head><p>We have constructed the GETSUS using C++ and Python. In this section, we conduct a comprehensive evaluation of GETSUS through four simulated attacks.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Experiment setup</head><p>To evaluate the effectiveness of GETSUS in real-world attacks, we simulate four types of attacks: data leakage, insider threats, phishing software, and watering hole attacks. The primary operating environment for GETSUS is the 64-bit distribution of Ubuntu Linux 16.04.07 LTS. This environment is equipped with a 12th Gen Intel(R) Core (TM) i9-12900H 2.50 GH, 16GB of memory. All experiments are conducted on a single computer. GETSUS uses Auditbeat to collect system logs and approximately 7,000 lines of C++ code to parse the system logs and generate the provenance graph. GETSUS stores the provenance graph data in a Neo4j database and provides visualization capabilities.</p><p>During the simulation of the four attacks, we have manually marked the EOA, as well as the suspicious edges and entry nodes in advance. Table <ref type="table" target="#tab_4">3</ref> summarizes the statistical data after parsing the four simulated attacks.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Effectiveness of GETSUS</head><p>An effective suspicious provenance graph should encompass as many event sequences leading to the EOA as possible, ensuring no loss of attack semantics, while simultaneously incorporating fewer normal edges to avoid an overly large provenance graph. Therefore, we quantify the effectiveness of GETSUS using the number of edges (#Edge) in the suspicious provenance graph and the false negatives (FN), where FN represents the number of unidentified suspicious edges. We compared GETSUS with NoDoze and DepImpact, and the results demonstrated that GETSUS has zero FN and fewer #Edges. This indicates that GETSUS can efficiently assist security analysts in threat alert investigations. Table <ref type="table" target="#tab_1">4</ref> displays the final results. The FN of GETSUS in all four attacks is zero, indicating that the suspicious provenance graph includes all event sequences leading to the EOA. The smallest #Edges data indicates that GETSUS includes the fewest normal edges, demonstrating the best reduction in the original graph. The data shows that the suspicious provenance graph obtained by GETSUS is approximately 31% smaller than the suboptimal DepImpact and about eight times smaller than NoDoze. Compared to the original graph, GETSUS reduces approximately 200,000 audit logs to about 50 edges, a reduction of approximately 4000 times.</p><p>The subpar performance of NoDoze and DepImpact is understandable. The implementation of NoDoze requires the support of an event frequency database. Therefore, the effectiveness of NoDoze depends on whether its event frequency database can encompass all normal events. NoDoze bases its anomaly determination on a single frequency feature and ultimately merges the most suspicious fixed-length paths. Hence, in most cases, NoDoze may miss suspicious events due to its reliance on a single feature and may also miss suspicious entry nodes due to its fixed-length path. Consequently, NoDoze has the highest FN and #Edge. DepImpact's performance is inferior to GETSUS. As DepImpact uses coarse-grained audit information, the results from DepImpact exists false dependency relationships, leading to a higher number of #Edge and FN.  represents the total number of suspicious edges. However, selecting more suspicious entry nodes can lead to the inclusion of more normal edges, increasing irrelevant semantics and complicating the task for security analysts. Figure <ref type="figure" target="#fig_3">4</ref> indicates that when the number of suspicious entry nodes ranges from 1 to 3, GETSUS encompasses all key edges. If there is a desire to further increase the number of suspicious entry nodes, it will inevitably increase the amounts of normal edges and nodes. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Conclusion</head><p>We have developed the GETSUS scheme, which retains all event sequences leading to the EOA, and reduces the provenance graph by approximately 4000 times, effectively assisting security analysts in threat alert investigations. Initially, GETSUS employs PT features to supplement the audit logs with causal relationships, addressing the dependency explosion problem. Subsequently, GETSUS generates and optimizes the provenance graph. GETSUS assigns an appropriate weight value to each edge, propagates suspiciousness values backward from the EOA, and identifies suspicious entry nodes. By conducting forward tracing from these suspicious entry nodes, GETSUS ultimately outputs a suspicious provenance graph. The efficiency of GETSUS has been empirically validated.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Overview of GETSUS.</figDesc><graphic coords="2,316.65,523.88,221.35,171.20" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Partial provenance graph of an attack.</figDesc><graphic coords="2,82.25,72.00,431.30,201.25" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. The function of PT features.</figDesc><graphic coords="3,315.65,176.75,222.20,86.70" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. FNR values using various amounts of suspicious entry.</figDesc><graphic coords="6,57.15,189.05,222.50,160.99" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 2 .</head><label>2</label><figDesc>Representative system call.</figDesc><table><row><cell>Process/Process</cell><cell>fork, clone, execve, kill, vfork</cell></row><row><cell>Process/File</cell><cell>open, pipe, dup, close, mkdir, unlink</cell></row><row><cell>Process/Socket</cell><cell>connect, recvfrom, sendto, sendmsg, recvmsg, getpeername</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 4 .</head><label>4</label><figDesc>Effectiveness of each approach.</figDesc><table><row><cell>Attack</cell><cell></cell><cell>NoDoze</cell><cell cols="2">DepImpact</cell><cell cols="2">GETSUS</cell></row><row><cell></cell><cell cols="6">FN #Edge FN #Edge FN #Edge</cell></row><row><cell>Data Leakage</cell><cell>3</cell><cell>320</cell><cell>1</cell><cell>63</cell><cell>0</cell><cell>45</cell></row><row><cell>Insider Threat</cell><cell>1</cell><cell>241</cell><cell>0</cell><cell>53</cell><cell>0</cell><cell>38</cell></row><row><cell>Phishing Email</cell><cell>0</cell><cell>165</cell><cell>0</cell><cell>37</cell><cell>0</cell><cell>22</cell></row><row><cell>Watering Hole</cell><cell>4</cell><cell>386</cell><cell>2</cell><cell>74</cell><cell>0</cell><cell>54</cell></row><row><cell cols="4">3.3 Runtime performance</cell><cell></cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 5 .</head><label>5</label><figDesc>Runtime of GETSUS.</figDesc><table><row><cell>Attack</cell><cell>Provenance graph Construct (s)</cell><cell>Suspicious provenance graph (s)</cell></row><row><cell>Data Leakage</cell><cell>8.148</cell><cell>4.531</cell></row><row><cell>Phishing Email</cell><cell>4.093</cell><cell>2.426</cell></row><row><cell>Watering Hole</cell><cell>3.884</cell><cell>3.271</cell></row><row><cell>Watering Hole</cell><cell>14.373</cell><cell>5.725</cell></row><row><cell cols="3">We measured the time overhead of GETSUS. As show</cell></row><row><cell cols="3">in Table 5, GETSUS spent an average of 7.62 seconds</cell></row><row><cell cols="3">constructing the provenance graph and an average of</cell></row><row><cell cols="3">3.988 seconds constructing the suspicious provenance</cell></row><row><cell cols="3">graph. The results demonstrate that the time overhead of</cell></row><row><cell cols="3">GETSUS is within a reasonable range.</cell></row><row><cell>3.4</cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Selection of suspicious entry nodes</head><label></label><figDesc></figDesc><table /><note><p>GETSUS propagates the suspiciousness values of EOA to entry nodes. Among the three types of entry nodes, GETSUS selects those with higher suspiciousness values as suspicious entry nodes respectively. More suspicious entry nodes enable GETSUS to encompass more suspicious edges, resulting in a lower False Negative Rate (FNR), ğ¹ğ‘ğ‘… = ğ¹ğ‘/ğ¸ ğ‘¡ , where ğ¸ ğ‘¡</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 3 .</head><label>3</label><figDesc>Statistical data of four simulated attacks.</figDesc><table><row><cell cols="2">ITM Web of Conferences 60, 00016 (2024)</cell><cell></cell><cell></cell><cell></cell><cell cols="2">https://doi.org/10.1051/itmconf/20246000016</cell></row><row><cell>AISS 2023</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>Attack Scenario</cell><cell>Process</cell><cell>#Node File</cell><cell>Socket</cell><cell>#Event</cell><cell>#Edge</cell><cell>#Suspicious Edge</cell></row><row><cell>Data Leakage</cell><cell>844</cell><cell>785</cell><cell>316</cell><cell>195512</cell><cell>4963</cell><cell>11</cell></row><row><cell>Insider Threat</cell><cell>616</cell><cell>934</cell><cell>139</cell><cell>86127</cell><cell>2496</cell><cell>8</cell></row><row><cell>Phishing Email</cell><cell>452</cell><cell>402</cell><cell>18</cell><cell>79848</cell><cell>1479</cell><cell>6</cell></row><row><cell>Watering Hole</cell><cell>856</cell><cell>1087</cell><cell>127</cell><cell>293464</cell><cell>3871</cell><cell>12</cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_0"><p>ITM Web of Conferences 60, 00016 (2024) https://doi.org/10.1051/itmconf/20246000016 AISS 2023</p></note>
		</body>
		<back>

			
			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We express our gratitude to the reviewers for their constructive comments on this paper.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Trustworthy Whole-System provenance for the linux kernel</title>
		<author>
			<persName><forename type="first">A</forename><surname>Bates</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">J</forename><surname>Tian</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">R</forename><surname>Butler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Moyer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">24th USENIX Security Symposium</title>
		<imprint>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">SLEUTH: Real-time attack scenario reconstruction from COTS audit data</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">N</forename><surname>Hossain</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Milajerdi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">26th USENIX Security Symposium</title>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">The taser intrusion recovery system</title>
		<author>
			<persName><forename type="first">A</forename><surname>Goel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Po</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Farhadi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>De</surname></persName>
		</author>
		<author>
			<persName><surname>Lara</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the twentieth ACM symposium on Operating systems principles</title>
		<meeting>the twentieth ACM symposium on Operating systems principles</meeting>
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">Nodoze: Combatting threat alert fatigue with automated provenance triage, in network and distributed systems security symposium</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">U</forename><surname>Hassan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Guo</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">MCI: Modeling-based causality inference in audit logging for attack investigation</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Kwon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Network and Distributed Systems Security (NDSS) Symposium</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Intrusion recovery using selective re-execution</title>
		<author>
			<persName><forename type="first">T</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Zeldovich</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">F</forename><surname>Kaashoek</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">th USENIX Symposium on Operating Systems Design and Implementation</title>
		<imprint>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Backtracking intrusions</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">T</forename><surname>King</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">M</forename><surname>Chen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the nineteenth ACM symposium on Operating systems principles</title>
		<meeting>the nineteenth ACM symposium on Operating systems principles</meeting>
		<imprint>
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Enriching Intrusion Alerts Through Multi-Host Causality</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">T</forename><surname>King</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><forename type="middle">M</forename><surname>Mao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Ndss</title>
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Towards a Timely Causality Analysis for Enterprise Security</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">NDSS</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Protracer: Towards practical provenance tracing by alternating between logging and tainting</title>
		<author>
			<persName><forename type="first">S</forename><surname>Ma</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Xu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">23rd Annual Network And Distributed System Security Symposium</title>
		<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">AIQL: Enabling efficient attack investigation from system monitoring data</title>
		<author>
			<persName><forename type="first">P</forename><surname>Gao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Xusheng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">R</forename><surname>Kulkarni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">2018 USENIX Annual Technical Conference</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">High Accuracy Attack Provenance via Binary-based Execution Partition</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">H</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Xu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">NDSS</title>
		<imprint>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">High fidelity data reduction for big data security dependency analyses</title>
		<author>
			<persName><forename type="first">Z</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Wu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2016 ACM SIGSAC conference on computer and communications security</title>
		<meeting>the 2016 ACM SIGSAC conference on computer and communications security</meeting>
		<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Back-Propagating System Dependency Impact for Attack Investigation</title>
		<author>
			<persName><forename type="first">P</forename><surname>Fang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Gao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">31st USENIX Security Symposium</title>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">PalanTÃ­ r: Optimizing Attack Provenance with Hardware-enhanced System Observability</title>
		<author>
			<persName><forename type="first">J</forename><surname>Zeng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Liang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2022 ACM SIGSAC Conference on Computer and Communications Security</title>
		<meeting>the 2022 ACM SIGSAC Conference on Computer and Communications Security</meeting>
		<imprint>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Loggc: garbage collecting audit log</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">H</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Xu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2013 ACM SIGSAC conference on Computer &amp; communications security</title>
		<meeting>the 2013 ACM SIGSAC conference on Computer &amp; communications security</meeting>
		<imprint>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">Fast and provably good seedings for k-means, advances in neural information processing systems</title>
		<author>
			<persName><forename type="first">O</forename><surname>Bachem</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Lucic</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2016">2016</date>
			<biblScope unit="page">29</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Robust sparse linear discriminant analysis</title>
		<author>
			<persName><forename type="first">J</forename><surname>Wen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Fang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Transactions on Circuits and Systems for Video Technology</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
