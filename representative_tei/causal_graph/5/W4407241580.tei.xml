<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Cyclic quantum causal modelling with a graph separation theorem</title>
				<funder>
					<orgName type="full">ETH Zurich Quantum Center</orgName>
				</funder>
				<funder ref="#_qdXQtMw">
					<orgName type="full">ETH</orgName>
				</funder>
				<funder>
					<orgName type="full">NCCR SwissMAP</orgName>
				</funder>
				<funder ref="#_V9XYvTG #_THtZTxs #_B979K7s">
					<orgName type="full">Swiss National Science Foundation</orgName>
				</funder>
				<funder>
					<orgName type="full">ETH Foundation</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability  status="unknown">
					<licence/>
				</availability>
				<date type="published" when="2025-02-07">7 Feb 2025</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Carla</forename><surname>Ferradini</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Institute for Theoretical Physics</orgName>
								<orgName type="institution">ETH Zurich</orgName>
								<address>
									<postCode>8093</postCode>
									<settlement>Zürich</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Victor</forename><surname>Gitton</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Institute for Theoretical Physics</orgName>
								<orgName type="institution">ETH Zurich</orgName>
								<address>
									<postCode>8093</postCode>
									<settlement>Zürich</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">V</forename><surname>Vilasini</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Institute for Theoretical Physics</orgName>
								<orgName type="institution">ETH Zurich</orgName>
								<address>
									<postCode>8093</postCode>
									<settlement>Zürich</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution">Université Grenoble Alpes</orgName>
								<address>
									<postCode>38000</postCode>
									<settlement>Inria Grenoble</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Cyclic quantum causal modelling with a graph separation theorem</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2025-02-07">7 Feb 2025</date>
						</imprint>
					</monogr>
					<idno type="arXiv">arXiv:2502.04168v2[quant-ph]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-14T18:29+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Causal modelling frameworks link observable correlations to causal explanations, which is a crucial aspect of science. These models represent causal relationships through directed graphs, with vertices and edges denoting systems and transformations within a theory. Most studies focus on acyclic causal graphs, where well-defined probability rules and powerful graph-theoretic properties like the d-separation theorem apply. However, understanding complex feedback processes and exotic fundamental scenarios with causal loops requires cyclic causal models, where such results do not generally hold. While progress has been made in classical cyclic causal models, challenges remain in uniquely fixing probability distributions and identifying graphseparation properties applicable in general cyclic models. In cyclic quantum scenarios, existing frameworks have focussed on a subset of possible cyclic causal scenarios, with graph-separation properties yet unexplored. This work proposes a framework applicable to all consistent quantum and classical cyclic causal models on finite-dimensional systems. We address these challenges by introducing a robust probability rule and a novel graph-separation property, p-separation, which we prove to be sound and complete for all such models. Our approach maps cyclic causal models to acyclic ones with post-selection, leveraging the post-selected quantum teleportation protocol. We characterize these protocols and their success probabilities along the way. We also establish connections between this formalism and other classical and quantum frameworks to inform a more unified perspective on causality. This provides a foundation for more general cyclic causal discovery algorithms and to systematically extend open problems and techniques from acyclic informational networks (e.g., certification of non-classicality) to cyclic causal structures and networks.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Bridging causal explanations with observable correlations lies at the heart of scientific inquiry. Causal models provide a rigorous framework for describing correlations arising from a causal structure and identifying which structures are compatible with observed data. Classical causal modelling <ref type="bibr" target="#b45">[Pea09,</ref><ref type="bibr" target="#b49">SGS93]</ref>, captures causal relationships among random variables and has been widely applied across fields such as machine learning, economics, and clinical trials [RCLH21, KH11, Pea09, Spi05, PL14, AHK20, LKK21]. However, as demonstrated by Bell's theorem <ref type="bibr" target="#b6">[Bel64]</ref>, this classical framework cannot account for quantum correlations without invoking fine-tuned mechanisms or modifications to the causal structure naturally associated with a Bell scenario <ref type="bibr" target="#b59">[WS15]</ref>. This limitation has spurred the development of non-classical causal modelling frameworks that encompass quantum and broader operational theories <ref type="bibr" target="#b31">[HLP14,</ref><ref type="bibr" target="#b8">BLO20]</ref>, enabling the causal explanation of quantum correlations without invoking fine-tuning or adjustments to the operational causal structure.</p><p>Causal models are typically represented as directed graphs, with vertices and edges being associated with systems and transformations within a theory that embody its causal mechanisms. The mechanisms themselves are theory-dependent: functional dependencies in classical models, and quantum channels in quantum models. Broadly, causal modelling is an umbrella term that spans different approaches, in particular (i) approaches which focus on observable correlations generated by causal mechanisms of a theory, which are often referred to as Bayesian/causal networks (e.g., <ref type="bibr" target="#b28">[GVP90,</ref><ref type="bibr" target="#b31">HLP14]</ref>) and (ii) approaches such as structural equation models (e.g., <ref type="bibr" target="#b22">[FM17,</ref><ref type="bibr" target="#b7">BFPM21]</ref>) or split-node quantum causal models (e.g., <ref type="bibr" target="#b8">[BLO20,</ref><ref type="bibr" target="#b9">BLO21]</ref>), which examine properties of the causal mechanisms directly, such as solvability of functions or causal influences between quantum systems in unitary channels. In this work, we use "causal models" to encompass both approaches, distinguishing them where necessary.</p><p>The classical and non-classical causal modelling literature have predominantly focused on acyclic graphs, where there exists a well-defined probability rule for deriving correlations from causal mechanisms <ref type="bibr" target="#b45">[Pea09,</ref><ref type="bibr" target="#b31">HLP14,</ref><ref type="bibr" target="#b8">BLO20]</ref>. Moreover, a foundational and powerful result in acyclic causal models (both classical and non-classical) is the d-separation theorem [VP90, GVP90, HLP14], proving the soundness and completeness of a central graph-theoretic notion, d-separation <ref type="bibr" target="#b45">[Pea09,</ref><ref type="bibr" target="#b50">Spi05]</ref>. This theorem enables to read off conditional independences in correlations purely from the structure of the graph (causal structure), and is central to how we explain correlations (conditional dependencies) in terms of causal connections. Moreover, the d-separation theorem plays an integral role in causal discovery algorithms and inference across data-driven disciplines (see <ref type="bibr" target="#b52">[SZ16]</ref>), in causal compatibility problems as well as certification of non-classical correlations in causal structures <ref type="bibr" target="#b59">[WS15,</ref><ref type="bibr" target="#b31">HLP14]</ref>.</p><p>Recent years have witnessed growing interest in causal modelling for cyclic graphs, which can represent physical processes with feedback <ref type="bibr" target="#b22">[FM17,</ref><ref type="bibr" target="#b7">BFPM21]</ref> as well as provide information-theoretic models for describing exotic and fundamental causal phenomena, such as solutions to general relativity admitting closed timelike curves [G 49, Sto38, MM67, Deu91, LMGP + 11a, LMGP + 11b]. However, cyclic models introduce challenges, including potential pathologies like the "grandfather paradox". Two significant open problems arise in this context. First, for general cyclic causal models both in the classical and quantum case 1 , no well-defined and robust method to compute observable probabilities from the causal mechanisms exists. Secondly, certain cyclic causal models, even in classical settings and where the probabilities are well-defined, violate the soundness of d-separation, i.e., there exist classical causal models on cyclic graphs leading to correlations between vertices that are d-separated in the graph <ref type="bibr" target="#b41">[Nea00]</ref>. This complicates causal reasoning, raising concerns whether observations can be causally explained in a systematic manner in scenarios with cyclic causal structures.</p><p>Existing frameworks for cyclic causal modelling often impose restrictions on causal mechanisms to ensure consistency and define probabilities. For instance, classical cyclic models require global consistency conditions (e.g., unique solvability of functional dependencies <ref type="bibr" target="#b22">[FM17,</ref><ref type="bibr" target="#b7">BFPM21]</ref>), while quantum models enforce conditions like factorization of unitary channels (corresponding to requiring valid process operators <ref type="bibr" target="#b9">[BLO21]</ref>). Although these approaches capture meaningful subclasses of cyclic causal models and provide valuable techniques for studying them, the soundness of d-separation already fails within such classes of models (in particular, even in uniquely solvable models as shown in <ref type="bibr" target="#b41">[Nea00]</ref>). Moreover, there exist more general types of consistent cyclic causal models which cannot be captured in these approaches and constructing robust probability rules for arbitrary cyclic causal models has remained unresolved.</p><p>A general framework for cyclic causal modelling, applicable to non-classical theories, was proposed in <ref type="bibr" target="#b53">[VC22a,</ref><ref type="bibr" target="#b54">VC22b]</ref>. This top-down approach accommodates any theory, causal mechanism, and probability rule on a given cyclic graph, provided that the resulting probability distribution adheres to the soundness of d-separation (i.e., d-separations in the graph imply corresponding conditional independence in the distribution). Specifically, <ref type="bibr" target="#b53">[VC22a]</ref> constructed examples of non-classical cyclic causal models respecting d-separation soundness and <ref type="bibr" target="#b54">[VC22b]</ref> introduced a new method for computing probabilities for a specific classical cyclic model that is not uniquely solvable. However, models violating the soundness of d-separation fall outside this framework, and the general applicability of the probability method, beyond the particular examples, was not explored.</p><p>Finding alternative graph-separation properties to d-separation that are sound and complete in the cyclic case is an active research area in classical causality community <ref type="bibr" target="#b7">[BFPM21]</ref>. Notably, the concept of σ-separation was proposed as a sound and complete criterion for a specific subclass of classical models admitting unique solutions <ref type="bibr" target="#b22">[FM17]</ref>. However, to our knowledge, no graph-separation property applicable to all models is known even in the classical case. The problem remains unexplored for quantum and non-classical cyclic models, to the best of our knowledge.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Contributions.</head><p>In this work, we present a general framework for cyclic causal modelling involving finite-dimensional quantum systems. This framework extends beyond existing approaches to include cyclic causal models which are not necessarily associated with valid quantum process operators <ref type="bibr" target="#b8">[BLO20,</ref><ref type="bibr" target="#b9">BLO21]</ref> and it embeds classical causal models, including not uniquely solvable ones. We define a robust probability rule for all models in this framework, recovering existing results under the relevant restrictions. A central contribution is the introduction of a novel graph-separation property, p-separation, which we prove to be sound and complete for all quantum cyclic causal models within our framework, and which reduces to d-separation for directed acyclic graphs.</p><p>Our causal modelling approach aligns more closely with Bayesian networks in terms of its primary focus on questions related to observable correlations and their relationships also <ref type="bibr" target="#b20">[FGV25]</ref> for details.</p><p>to underlying graph-separations. However, we also discuss connections to other causality frameworks, emphasizing the broader relevance of our results. Our methods are based on a general mapping of cyclic models to acyclic ones using a post-selected quantum teleportation protocol. This entails new results on quantum teleportation [BBC + 93], which might be of independent interest to the quantum information community. Thus, our framework equips post-selected closed timelike curves (P-CTCs) [LMGP + 11a, LMGP + 11b], which are a quantum informational model for causal loops motivated by exotic solutions of general relativity, with a causal modelling and graph-separation semantic.</p><p>Furthermore, in a companion paper <ref type="bibr" target="#b20">[FGV25]</ref>, we develop the framework and results for the classical causal modelling community by introducing the concept of classical postselected teleportation. This includes an alternative formulation of p-separation for classical functional causal models which we prove to be equivalent to the quantum version presented herer when restricted to classical scenarios. In <ref type="bibr" target="#b20">[FGV25]</ref>, we establish connections between unique solvability properties and post-selection success probabilities in classical models. This enables our results to be directly accessible and applicable within the classical causality community, without requiring familiarity with quantum formalism.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.1">Structure of the paper</head><p>In section 2, we provide a high-level overview of the framework, the new graph-separation property of p-separation and its soundness and completeness, offering intuition through illustrative examples, without delving into technical details or proofs.</p><p>• Framework and probability rule: In section 3, we introduce a general framework for cyclic quantum causal modelling, starting with the known probability rule for the acyclic case illustrated through examples. In section 4, we define a probability rule for general models on cyclic graphs, which is achieved by constructing a mapping from a given (possibly cyclic) causal model to a family of acyclic models with post-selection. A key ingredient, post-selected quantum teleportation protocols, is described in section 4.1. Using this, section 4.2 constructs the relevant family of acyclic models, and section 4.3 formalizes the probability rule for cyclic models. By establishing relevant results on post-selected quantum teleportation in appendix A, we prove the robustness of our probability rule, namely, that it is independent of the choice of teleportation protocol and of the particular acyclic model in the family. Finally, section 4.4 illustrates these methods with examples of cyclic causal models.</p><p>• Soundness and completeness of p-separation: In section 5, we discuss graph separation properties, beginning with a review of d-separation in section 5.1 and its failure for cyclic graphs in section 5.2. In section 5.3, we introduce p-separation, the new graph-separation property generalizing d-separation, proving its soundness and completeness for all causal models within our framework. Examples of p-separation are given in section 5.4, including a discussion on how p-separation reduces to dseparation in the acyclic case.</p><p>• Further results: In section 6, we generalize the concept of probabilistic Markovianity to cyclic graphs and derive conditions for this property in terms of post-selection success probabilities. In section 7 (and further in appendix B), we situate our work within broader causality frameworks (summarised in figure <ref type="figure" target="#fig_5">1</ref>) and discuss its connections with the causal modelling approaches of Barrett-Lorenz-Oreshkov (BLO) for cyclic models and Costa-Shrapnel (CS) for acyclic models, to the causal decomposition problem, as well as links to closed time-like curves and indefinite causal order quantum processes. In particular, in appendix B we show that a class of BLO causal models, which we call tensor-restricted BLO models, can be faithfully mapped into our formalism, which implies the same for all CS causal models. In appendix C, we focus on classical functional models, showing how to faithfully map them to our causal models and proving consistency with the classical formulation of the cyclic probability rule and p-separation given in <ref type="bibr" target="#b20">[FGV25]</ref>.</p><p>Finally, section 8 summarizes the main contributions and discusses directions for future research.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.2">Notation</head><p>We denote with H a finite-dimensional Hilbert space, i.e., a finite-dimensional complex vector space equipped with an inner product. We denote with L(H) the complex vector space of linear operators acting on H. The trace is denoted as Tr[•] : L(H) → C. The identity map on H is denoted 1 ∈ L(H).</p><p>We use the following acronyms: CP map stands for completely positive map, CPTP map stands for completely positive and trace preserving map, and POVM stands for positive operator valued measurement.</p><p>We associate to a finite set X a finite dimensional Hilbert space H(X ) such that dim(H(X )) = |X |. The Hilbert space H(X ) is equipped with a preferred basis, labelled {|x⟩} x∈X and referred to as the computational basis, so that H(X ) = span |x⟩ x ∈ X .</p><p>(1)</p><p>We denote with G = (V, E) a directed graph where each edge e = (v 1 , v 2 ) ∈ E is an ordered pair of two vertices v 1 , v 2 ∈ V . We shall always assume, for convenience, that the set of vertices V is equipped with a preferred order, such that we can write V = {v 1 , . . . , v n } where n = |V |. The incoming and outgoing edges to a vertex v ∈ V are denoted</p><formula xml:id="formula_0">In(v) = e ∈ E ∃v ′ ∈ V : e = (v ′ , v) , (<label>2a</label></formula><formula xml:id="formula_1">)</formula><formula xml:id="formula_2">Out(v) = e ∈ E ∃v ′ ∈ V : e = (v, v ′ ) , (<label>2b</label></formula><formula xml:id="formula_3">)</formula><p>while the parents and children of a vertex v ∈ V are denoted</p><formula xml:id="formula_4">Pa(v) = v ′ ∈ V (v ′ , v) ∈ E , (3a) Ch(v) = v ′ ∈ V (v, v ′ ) ∈ E . (<label>3b</label></formula><formula xml:id="formula_5">)</formula><p>Given a G = (V, E), we say that a vertex v ∈ V is exogenous if the set Pa(v) is empty, endogenous otherwise and we define the sets</p><formula xml:id="formula_6">V ex = {v ∈ V : Pa(v) = ∅} and V end = V \ V ex , (<label>4</label></formula><formula xml:id="formula_7">)</formula><p>of exogenous and endogenous vertices of a graph.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Overview of the framework and main results through examples</head><p>In this section, we present the results in an informal manner with the scope of providing an intuitive picture of their use. Complete definitions and proofs are provided in the following sections and referenced here.</p><p>Causal graphs and causal models. We present our framework using the following directed graph as example</p><formula xml:id="formula_8">G = v 3 v 4 v 2 v 1 . (<label>5</label></formula><formula xml:id="formula_9">)</formula><p>The notation allows to distinguish between observed and unobserved processes and classical or quantum systems. Directed graphs that are decorated as follows are called causal graphs (definition 1). Specifically, 1. quantum edges are represented as and carry a finite-dimensional Hilbert space H;</p><p>2. classical edges are represented as and carry a finite set X ;</p><p>3. unobserved vertices are represented as circles v and carry a CPTP map, E;</p><p>4. observed vertices are represented as a rectangles v and carry a finite-cardinality random variable taking values from a finite set X and a POVM,</p><formula xml:id="formula_10">E = {E x } x∈X .</formula><p>Observed vertices correspond to the operation of performing a measurement, described by the POVM, E, on the incoming edges. The outcome of the measurement, x ∈ X , is carried by the vertex itself and broadcast to its children vertices.</p><p>Given the causal graph of equation ( <ref type="formula" target="#formula_8">5</ref>), one can define a causal model (definition 2) by associating finite-dimensional Hilbert spaces, H (3,4) and H (4,3) respectively to the edges (v 3 , v 4 ) and (v 4 , v 3 ), and finite sets to the edges (v 3 , v 1 ) and (v 4 , v 2 ), respectively X (3,1) and X (4,2) . The finite sets are associated with finite dimensional Hilbert spaces as in equation (1), namely H X (3,1) = span{|x⟩} x∈X (3,1) and H X (4,2) = span{|x⟩} x∈X (4,2) (6)</p><p>Then, we associate CPTP maps, E 3 : L H (4,3) → L H (3,4) ⊗ H X (3,1) and E 4 : L H (3,4) → L H (4,3) ⊗ H X (4,2)</p><p>respectively to the vertices v 3 and v 4 . To the observed vertices, v 1 and v 2 we associate the finite sets X 1 and X 2 and POVMs</p><formula xml:id="formula_11">E (1) = E (1)</formula><p>x 1 ∈ L H X (3,1)</p><formula xml:id="formula_12">x 1 ∈X 1 and E (2) = E (2) x 2 ∈ L H X (4,2)</formula><p>x 2 ∈X 2 . (7)</p><p>In the special case where the causal graph is acyclic, the probability distribution over observed vertices is defined as is standard in the literature (definition 3) <ref type="bibr" target="#b31">[HLP14]</ref>. Concretely, one first takes the tensor product of the maps associated to each exogenous vertex with input the only trace-one and positive linear operator in the trivial input space C, i.e., 1. Then, one applies the composition of the CPTP or CP maps associated to each endogenous vertex with the composition order given by the directed edges of the graph G. Eventually, because the graph is finite and acyclic (where the childless vertices are associated with maps having a trivial output space), and because all maps are completely positive 2 , the output of this composition operation will be a real number between 0 and 1.</p><p>2 Complete positivity implies that the outcome that resulting from composing all these maps is still a positive operator. Since the outcome is a value in C, it implies such value is real and positive. In addition, one can easily see that the maps we associate are also trace non-increasing, thus the final output is smaller than 1.</p><p>Mapping cyclic causal models to acyclic with post-selection and the probability rule. Firstly, given a well-defined causal model on a causal graph, we aim to define a rule for computing a single, well-defined probability distribution over the observed vertices' random variables. We achieve this by constructing a mapping from cyclic causal models to acyclic ones with post-selection (section 4) using a post-selected teleportation protocol (from the general class of such protocols as per definitions 4 and 5) to replace directed edges. Specifically, since directed edges act as identity channels which connect the maps associated to the vertices of the causal model and the post-selected teleportation protocol allows us to simulate identity channels, the latter can be used to replace a directed edge. Let us clarify this statement with an example.</p><p>In a typical teleportation protocol [BBC + 93], Alice and Bob share a bipartite entangled state, whose preparation is represented by R and the two subsystems by the edges (R, Y ) and (R, T ). Alice performs a Bell-state measurement, represented by T , on her half of the entangled state, i.e., the edge (R, T ), and the state to be teleported, i.e., the edge (X, T ). If Alice's measurement results in a specific outcome, p = Φ + , Bob's system is automatically in the correct quantum state, and Bob does not need to perform any further operations. Thus, by post-selecting on the successful instances where Alice measures p = Φ + , such a protocol simulates an identity channel and it can be used to simulate a direct edge between X and Y , i.e.,</p><formula xml:id="formula_13">X Y R T (R, T ) (X, T ) (R, Y ) = X Y . (<label>8</label></formula><formula xml:id="formula_14">)</formula><p>With this in mind, a causal model on a cyclic causal graph G is mapped to an acyclic causal model with post-selection through the following steps:</p><p>1. Consider an acyclic subgraph, G ′ , of G obtained only by removing edges, e.g.,</p><formula xml:id="formula_15">G ′ = v 3 v 4 v 2 v 1 . (<label>9</label></formula><formula xml:id="formula_16">)</formula><p>2. Construct an acyclic graph, G tp , by replacing each edge in G that is missing in G ′ with the edges and vertices of the post-selected teleportation protocol (definitions 4 and 6), e.g., since</p><formula xml:id="formula_17">(v 4 , v 3 ) is missing in G ′ we get G tp = R v 1 v 3 v 4 v 2 T . (<label>10</label></formula><formula xml:id="formula_18">)</formula><p>3. Define a causal model on the acyclic graph G tp by keeping the same associations of the original causal model to all vertices and edges that are preserved from G in G tp and associating a post-selected teleportation protocol on the added vertices and edges (definition 8), e.g, to R associate the state ρ R = |Φ + ⟩⟨Φ + | and to T the binary variable t ∈ {✓, ✗} given by the measurement {|Φ + ⟩⟨Φ + |, 1 -|Φ + ⟩⟨Φ + |}.</p><p>4. Evaluate the probability of the casual model on the acyclic graph G tp using the known acyclic probability rule (e.g., <ref type="bibr" target="#b31">[HLP14]</ref>) and consider the conditioned probability where t = ✓, obtaining</p><formula xml:id="formula_19">Pr acyc (x 1 , x 2 , t = ✓) Gtp and Pr acyc (x 1 , x 2 |t = ✓) Gtp = Pr acyc (x 1 , x 2 , t = ✓) Gtp Pr acyc (t = ✓) Gtp .</formula><p>The conditional probability defines a valid probability distribution over the variables x 1 and x 2 associated with the observed vertices v 1 and v 2 , unless the probability of successful post-selection, Pr acyc (t = ✓) Gtp , vanishes.</p><p>5. If Pr acyc (t = ✓) Gtp &gt; 0, i.e., the post-selection succeeds with non-zero probability, define the probability distribution over observed vertices in the causal model on the cyclic graph G as the conditional probability distribution Pr acyc (x 1 , x 2 |t = ✓) Gtp , i.e., (definition 12)</p><formula xml:id="formula_20">Pr(x 1 , x 2 ) G := Pr acyc (x 1 , x 2 |t = ✓) Gtp</formula><p>If Pr acyc (t = ✓) Gtp = 0, we say that the model is inconsistent and the probabilities are undefined.</p><p>The construction defines a family of acyclic graphs (definition 6), G tp (G), that can be obtained from G by performing steps 1-2 starting from different choices of acyclic subgraphs G ′ of G. The probability rule obtained in the last step is independent of which graph in this family is used to define it (proposition 10). The choice of causal mechanisms on the preand post-selection vertices is also not constrained to the Bell teleportation protocol (corollary 16). Indeed, any pair of state and measurement that allows to simulate an identity channel can be used to define a causal model in step 3 and leads to the same probability rule (see also appendix A for more details on post-selected teleportation protocols).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cyclic graph separation property: p-separation.</head><p>A powerful tool in causal modelling is given by theorems relating graph properties, independent of the model's mechanisms, to conditional independencies of the observed probability that would arise for any choice of mechanisms in a class of theories.  <ref type="bibr" target="#b55">[VP90,</ref><ref type="bibr" target="#b28">GVP90]</ref> and in the non-classical case in <ref type="bibr" target="#b31">[HLP14]</ref>, both for acyclic graphs. One could hope that an analogous theorem holds for cyclic graphs with some definition for probability distributions compatible with that graph. However, this typically fails [Pea09, Nea00] (section 5.2). For example, consider the following graph:</p><formula xml:id="formula_21">v 3 v 4 v 1 v 2 . (<label>11</label></formula><formula xml:id="formula_22">)</formula><p>Here, v 1 and v 2 are d-separated, but there exist cyclic causal models on this graph where the two variables must be correlated (section 5.2). Hence, d-separation in the graph no longer implies (conditional) independence in the probabilities. Therefore, there has been interest in finding new graph separation properties and proving their soundness and completeness at least for a subclass of cyclic models. In the classical causal modelling literature, the notion of σ-separation is defined as a graph separation property <ref type="bibr" target="#b22">[FM17]</ref>. This was shown to be sound and complete for a subclass of uniquely solvable classical cyclic causal models called modular structural equation models <ref type="bibr" target="#b22">[FM17,</ref><ref type="bibr" target="#b23">FM18]</ref>. However, to our knowledge, no general sound and complete graph-separation property is known to hold even for all finite-cardinality classical functional models (including non-uniquely solvable ones).</p><p>We propose a new graph-separation property, p-separation (definition 21), based on the correspondence between cyclic causal models and acyclic ones with post-selection. We say that two vertices A and B are p-separated conditioned on a third C, if there exists an acyclic causal model in the family G tp (G) such that A and B are d-separated conditioned on C and on all the post-selection vertices. For the graph in equation (11), one can easily see that the following graph, G tp , is in G tp (G):</p><formula xml:id="formula_23">G tp = R v 1 v 3 v 4 v 2 T . (<label>12</label></formula><formula xml:id="formula_24">)</formula><p>In G tp , v 1 and v 2 are d-connected after post-selecting on T . One can show that in all graphs in G tp (G), v 1 and v 2 become d-connected through conditioning on post-selection vertices, thus v 1 and v 2 are p-connected in G.</p><p>Similarly to the d-separation theorem, we prove the p-separation theorem connecting p-separation, which is purely a graph property, to conditional independencies of any probability distribution arising from causal models on the graph. Specifically, given a graph G, possibly cyclic, and considering the probability rule Pr G , defined above (section 4.3), the following hold (theorem 22)</p><formula xml:id="formula_25">Soundness: If A ⊥ p B|C in G, then for all causal models A ⊥ ⊥ B|C in Pr G , Completeness: If A ̸ ⊥ p B|C in G, then there exists a causal model on G where A ̸ ⊥ ⊥ B|C in Pr G ,</formula><p>where we denoted p-separation relations with ⊥ p . The soundness part of the theorem states that if two vertices are p-separated conditioned on a third, then the probability distribution over the outcomes of these vertices also presents the same conditional independence in any (possibly cyclic) quantum or classical causal model involving finite dimensional systems. Completeness ensures that there cannot be a stronger graph-separation property, in the sense of one which entails strictly more graph-separations than p-separation, which is also sound. <ref type="foot" target="#foot_2">4</ref> In particular, this explains by means of a sound and complete graph-separation criterion why the variables associated with the vertices v 1 and v 2 can become correlated in certain causal models on the cyclic graph in our above example.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Causal modelling framework</head><p>In this section, we introduce our causal modelling framework which is based on a graphical representation of cause and effect relations though so-called causal graphs. We will then describe how to equip causal graphs with a causal model, and define a probability distribution over the observed variables in the special case of acyclic causal graphs (deferring the discussion of probabilities in the cyclic case to the next section). Finally, we provide examples of causal models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Causal models and acyclic probabilities</head><p>A causal graph is a decorated directed graph which is allowed to be cyclic. The graph specifies causation relations between systems or variables, and the decorations specify whether the variables are observed or unobserved, and whether systems are classical or quantum.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Definition 1 (Causal graph).</head><p>A causal graph is defined to be a graph G = (V, E) such that:</p><p>1. The set of vertices V can be partitioned into V = V o ∪ V u , where the vertices v ∈ V o are called the observed vertices, denoted as v , while the vertices v ∈ V u are called the unobserved vertices and are denoted as v .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">The set of edges can be partitioned into</head><formula xml:id="formula_26">E = E cl ∪ E q ,</formula><p>where the edges e ∈ E cl are called the classical edges, denoted as , while the edges e ∈ E q are called the quantum edges and are denoted as .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">The outgoing edges of an observed vertex</head><formula xml:id="formula_27">v ∈ V o are classical, i.e., Out(v) ⊆ E cl .</formula><p>Given a causal graph G, the incoming and outgoing classical or quantum edges to a vertex v ∈ V are denoted</p><formula xml:id="formula_28">In cl (v) = In(v) ∩ E cl , In q (v) = In(v) ∩ E q , (13a) Out cl (v) = Out(v) ∩ E cl , Out q (v) = Out(v) ∩ E q . (<label>13b</label></formula><formula xml:id="formula_29">)</formula><p>A causal model assigns to a causal graph specific causal mechanisms for each vertex. These causal mechanisms have to match the type of the vertex, e.g., if the vertex is observed, the causal mechanism has to specify how the observed outcome is obtained.</p><p>Definition 2 (Causal model on causal graph). A causal model on a causal graph G = (V, E), Cm G , is specified by the following items:</p><p>1. A finite-dimensional Hilbert space H e is associated to each edge e ∈ E. We will use the notation where if E ′ ⊆ E is a non-empty subset of edges,</p><formula xml:id="formula_30">H E ′ = e∈E ′ H e , (<label>14</label></formula><formula xml:id="formula_31">)</formula><p>and if</p><formula xml:id="formula_32">E ′ = ∅, then H E ′ = H ∅ = C. 2. A random variable X v taking values x v from a non-empty finite set X v is associated to each observed vertex v ∈ V o .</formula><p>3. A finite set X e is associated to each classical edge e ∈ E cl . The Hilbert space associated to a classical edge then has to take the form H e = H(X e ) with associated computational basis {|x⟩} x∈Xe (see equation ( <ref type="formula">1</ref>)). For consistency, we require that for all observed vertices v ∈ V o , for all outgoing edges e ∈ Out(v) thereof, the set of outcomes match:</p><formula xml:id="formula_33">X e = X v . 4. A CPTP map is associated to each unobserved vertex v ∈ V u : v → E v : L H In(v) → L H Out(v) , (<label>15</label></formula><formula xml:id="formula_34">)</formula><p>where H In(v) and H Out(v) refer to equation (14</p><formula xml:id="formula_35">). If Out cl (v) is non-empty, the CPTP map E v satisfies the decoherence condition E v = D v • E v , (<label>16</label></formula><formula xml:id="formula_36">)</formula><p>where the channel D v is defined as </p><formula xml:id="formula_37">D v = e∈Out cl (v) D e ,</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">A POVM is associated to each observed vertex</head><formula xml:id="formula_38">v ∈ V o : v → E v = {E v x ∈ L(H In(v) )} x∈Xv . (<label>17</label></formula><formula xml:id="formula_39">)</formula><p>We furthermore associate to v a set of CP maps</p><formula xml:id="formula_40">M v x : L H In(v) → L H Out(v) x∈Xv (<label>18</label></formula><formula xml:id="formula_41">)</formula><p>defined as follows: for all ρ ∈ L(H In(v) ),</p><formula xml:id="formula_42">M v x (ρ) = Tr[E v x ρ] e∈Out(v) |x⟩⟨x| He . (<label>19</label></formula><formula xml:id="formula_43">)</formula><p>By definition of POVM,</p><formula xml:id="formula_44">E v = {E v x } x∈Xv satisfies x∈Xv E v x = 1 H In(v) and the map x∈Xv M v</formula><p>x is CPTP. Few comments on the definition are in order:</p><p>• The decoherence condition required for CPTP maps associated to unobserved vertices ensures that the output of E v on systems defined over classical edges is classical, i.e., diagonal in the computational basis. The analogous condition for classical input edges e = (v ′ , v) ∈ E cl is already satisfied due to the decoherence condition of the map associated to v ′ .</p><p>• If a vertex v is exogenous, the set In(v) is empty. In this case, L(H</p><formula xml:id="formula_45">In(v) ) = L (H ∅ ) = L (C) ∼ = C</formula><p>whose only positive and trace-one element is 1 ∈ C ≃ L(C). Therefore, for exogenous unobserved vertices we will write</p><formula xml:id="formula_46">ρ v = E v (1) ∈ L H Out(v)</formula><p>, which can be shown to be a valid density operator. For exogenous observed vertices, we will also denote</p><formula xml:id="formula_47">p v x = Tr[E v x ]</formula><p>, which is a valid probability distribution over x ∈ X v , and σ v x = M v x (1). It can be checked that {σ v x } x∈Xv is a collection of sub-normalized density matrices that sum up to a normalized density matrix.</p><p>Our goal for the next section will be to define a probability distribution over the values of the observed vertices given a causal model on any causal graph. An important special case of causal graphs happens when the graph is acyclic. In that case, we can define a probability distribution over the observed vertices in the usual way (in particular, as given by the acyclic causal modelling formalism of Henson, Lal and Pusey for the quantum case <ref type="bibr" target="#b31">[HLP14]</ref>). This is equivalent to considering the quantum protocol specified by the acyclic causal model and applying the Born rule.</p><p>Definition 3 (Probabilities of acyclic causal graphs). Consider a causal model on an acylic causal graph G = (V, E) and a global observed event x := {x v ∈ X v } v∈Vo . The probability Pr acyc (x) G ∈ [0, 1] is obtained by composing all the channels according to the graph, and we denote this as follows:</p><formula xml:id="formula_48">Pr acyc (x) G = ⃝ v∈Vo M v xv ⃝ u∈Vu E u . (<label>20</label></formula><formula xml:id="formula_49">)</formula><p>Concretely, one first takes the tensor product of the states ρ u = E u (1) associated to each exogenous unobserved vertex u and of the subnormalized states M v xv (1) associated to each exogenous observed vertex v. Then, one applies the composition of the CPTP maps E u associated to each endogenous unobserved vertex u and the CP map M v xv associated to each endogenous observed vertex, with the composition rule<ref type="foot" target="#foot_3">foot_3</ref> being obtained from the connectivity of the graph G. Eventually, because the graph is finite and acyclic, the output of this composition operation will be in L(C ⊗ • • • ⊗ C), which we canonically identify with C. Thus the composition operation ⃝ entails both parallel and sequential composition (in an order unambiguously specified by the acyclic causal graph).</p><p>Notice that the maps associated to exogenous vertices in definition 2 are defined for all linear operators on L(C) ∼ = C but we choose 1 as input state in the probability rule of definition 3. By linearity, the choice of any other λ ∈ C in definition 3 would yield</p><formula xml:id="formula_50">Pr ′ acyc (x) G = λPr acyc (x) G . (<label>21</label></formula><formula xml:id="formula_51">)</formula><p>It is easy to verify that this defines a valid probability distribution only for λ = 1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Examples of acyclic causal graphs</head><p>In this section, we present few examples of causal models on acyclic graphs. These should clarify how to define causal models on causal graphs and evaluate the acyclic probability distribution over observed vertices given in definition 3.</p><p>Prepare-and-measure scenarios. Consider the following causal graphs:</p><formula xml:id="formula_52">G q = A L B and G c = A L B . (<label>22</label></formula><formula xml:id="formula_53">)</formula><p>Let us analyze a general causal model for G q . The vertex </p><formula xml:id="formula_54">σ A a = p A a |a⟩⟨a|,<label>(23)</label></formula><p>where {|a⟩} a∈X A is the computational basis of the Hilbert space H e = H(X A ) associated to the classical edge e = (A, L). Then, the unobserved vertex L (for "latent") has an associated CPTP map </p><formula xml:id="formula_55">E L : L(H e ) → L(H e ′ ),</formula><formula xml:id="formula_56">L(H e ′ ) → C} b∈X B that simply act as M B b (ρ) = Tr[E B b ρ].</formula><p>Since the causal graph is acyclic, we can use definition 3 to obtain the following probability distribution over the observed vertices:</p><formula xml:id="formula_57">Pr acyc (a, b) Gq = M B b • E L • M A a (1) (24a) = Tr[E B b E L (σ A a )] (24b) = p A a Tr[E B b E L (|a⟩⟨a|)]. (<label>24c</label></formula><formula xml:id="formula_58">)</formula><p>This probability can be interpreted as follows: the value a is first drawn with probability p A a , the state E L (|a⟩⟨a|) is then prepared (this can be any state: the value a merely encodes the classical label of a collection of states), and this state E L (|a⟩⟨a|) is then measured with the POVM {E B b } b∈X B . Let us now analyze the causal graph G c of equation ( <ref type="formula" target="#formula_52">22</ref>). Compared to the previous case of G q , the difference is that the edge e ′ = (L, B) is now classical. In any causal model, it is thus equipped with a set X e ′ . The channel E L associated to the vertex L has a classical outgoing edge e ′ : it has to satisfy the decoherence condition D • E L = E L . In particular, for the input state |a⟩⟨a| ∈ L(H e ) = L(H(A)), this implies that</p><formula xml:id="formula_59">E L (|a⟩⟨a|) = D • E L (|a⟩⟨a|)<label>(25)</label></formula><p>=</p><formula xml:id="formula_60">l∈X e ′ ⟨l|E L (|a⟩⟨a|)|l⟩|l⟩⟨l|<label>(26)</label></formula><p>=:</p><formula xml:id="formula_61">l∈X e ′ p L l|a |l⟩⟨l|,<label>(27)</label></formula><p>where it can be checked that p L l|a is a probability distribution on l ∈ X e ′ . The probability of equation (24) then reads:</p><formula xml:id="formula_62">Pr acyc (a, b) Gc = p A a l∈X e ′ p L l|a ⟨l|E B b |l⟩ =: p A a l∈X e ′ p L l|a p B b|l , (<label>28</label></formula><formula xml:id="formula_63">)</formula><p>where it can be checked again that p B b|l is a probability distribution on b. This probability can be interpreted as follows: a value a is generated with probability p A a , followed by a value l generated with probability p A l|a , and finally the result b is obtained with probability p B b|l .</p><p>Bell scenario. We now consider the following two causal graphs:</p><formula xml:id="formula_64">G q = X Y A B L and G c = X Y A B L . (<label>29</label></formula><formula xml:id="formula_65">)</formula><p>In both cases, we will label the Hilbert spaces as follows:</p><formula xml:id="formula_66">H (X,A) = H X , H (L,A) = H L 1 , H (L,B) = H L 2 , and H (Y,B) = H Y .</formula><p>We start with the quantum Bell scenario, described by the causal graph G q . The unobserved vertex L is associated a CPTP map</p><formula xml:id="formula_67">E L : C → L(H L 1 ⊗ H L 2 )</formula><p>, from which we obtain the state ρ L = E L (1). The treatment of the vertices X, Y is analogous to the vertices A and B in the previous prepare-and-measure scenario. Thus, the probability distribution p X x is associated to X and p Y y to Y . These vertices have one child, thus the associated CP maps are</p><formula xml:id="formula_68">M X x (1) = p X x |x⟩⟨x| X and M Y y (1) = p Y y |y⟩⟨y| Y . (<label>30</label></formula><formula xml:id="formula_69">)</formula><p>The vertices A and B are observed with two incoming edges each, thus they are associated respectively with POVMs</p><formula xml:id="formula_70">{E A a ∈ L(H X ⊗ H L 1 )} a∈X A and {E B b ∈ L(H L 2 ⊗ H Y )} b∈X B .</formula><p>Since these vertices have no children, the associated CP maps act on states of the form ρ</p><formula xml:id="formula_71">L 1 ⊗ |x⟩⟨x| X for all ρ L 1 ∈ L(H L 1 ) and ρ L 2 ⊗ |x⟩⟨x| Y for all ρ L 2 ∈ L(H L 2 ) as M A a (ρ L 1 ⊗ |x⟩⟨x| X ) = Tr L 1 X E A a ρ L 1 ⊗ |x⟩⟨x| X =: Tr L 1 E A a|x ρ L 1 (31) and M B b (ρ L 2 ⊗ |y⟩⟨y| Y ) = Tr L 2 Y E B b ρ L 2 ⊗ |y⟩⟨y| Y =: Tr L 2 E B b|y ρ L 2 (32)</formula><p>where we defined</p><formula xml:id="formula_72">E A a|x = Tr X [E A a |x⟩⟨x| X ] ∈ L(H L 1 ), and E B b|y = Tr Y [E B b |y⟩⟨y| Y ] ∈ L(H L 2 )</formula><p>The acyclic probability rule yields in this case:</p><formula xml:id="formula_73">Pr acyc (a, b, x, y) Gq = (M A a ) XL 1 ⊗ (M B b ) L 2 Y M X x (1) ⊗ E L (1) ⊗ M Y y (1) (33) = (M A a ) XL 1 ⊗ (M B b ) L 2 Y p X x |x⟩⟨x| X ⊗ ρ L L 1 L 2 ⊗ p Y y |y⟩⟨y| Y (34) = p X x p Y y Tr XL 1 L 2 Y (E A a ) XL 1 (E B b ) L 2 Y |x⟩⟨x| X ρ L L 1 L 2 |y⟩⟨y| Y (35) = p X x p Y y Tr L 1 L 2 (E A a|x ) L 1 (E B b|y ) L 2 ρ L L 1 L 2 . (<label>36</label></formula><formula xml:id="formula_74">)</formula><p>The expression in equation ( <ref type="formula" target="#formula_73">36</ref>) is what we expect in the quantum Bell scenario: Alice and Bob sample a setting x (y) with probability p X x (p Y y ), and then measure their shared state ρ L L 1 L 2 with their local POVMs {E A a|x } a ({E B b|y } b ). Let us now analyze the case of the classical Bell scenario, described by the causal graph G c in equation (29). The edges L 1 = (L, A) and L 2 = (L, B) are now assigned a finite set X L 1 and X L 2 , respectively. The channel E L satisfies the decoherence condition E L = D•E L , which implies that</p><formula xml:id="formula_75">ρ L = E L (1) = D • E L (1) = D(ρ L ) (37) = l 1 ∈X L 1 l 2 ∈X L 2 ⟨l 1 | L 1 ⊗ ⟨l 2 | L 2 (ρ L ) L 1 L 2 |l 1 ⟩ L 1 ⊗ |l 2 ⟩ L 2 |l 1 ⟩⟨l 1 | L 1 ⊗ |l 2 ⟩⟨l 2 | L 2<label>(38)</label></formula><p>=:</p><formula xml:id="formula_76">l 1 ∈X L 1 l 2 ∈X L 2 p L l 1 ,l 2 |l 1 ⟩⟨l 1 | L 1 ⊗ |l 2 ⟩⟨l 2 | L 2 , (<label>39</label></formula><formula xml:id="formula_77">)</formula><p>We then define the response functions of the parties as follows:</p><formula xml:id="formula_78">p A a|x,l 1 = Tr (E A a ) XL 1 |x⟩⟨x| X ⊗ |l 1 ⟩⟨l 1 | L 1 ) , (<label>40</label></formula><formula xml:id="formula_79">) p B b|y,l 2 = Tr (E B b ) Y L 2 |y⟩⟨y| Y ⊗ |l 2 ⟩⟨l 2 | L 2 ) . (<label>41</label></formula><formula xml:id="formula_80">)</formula><p>It can be checked that the acyclic probability rule simplifies in this case to </p><formula xml:id="formula_81">Pr acyc (a, b, x, y) Gc = p X x p Y y l 1 ∈X L 1 l 2 ∈X L 2 p L l 1 ,l 2 p A a|x,l 1 p B b|y,l 2 , (<label>42</label></formula><formula xml:id="formula_82">)</formula><formula xml:id="formula_83">which</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Post-selected teleportation</head><p>Teleportation is a protocol that proceeds on three systems A, B and C. The systems A and C are identified as the same type, so that it makes sense to say that A and C are in the same state. The teleportation protocol goes as follows: A is prepared in some initial state, and B and C are prepared in some correlated state. Then, a measurement is performed on the systems A and B. After this, a correction that depends on the measurement outcome is applied on the system C, so that the final state of C is the same as the initial state on A.</p><p>The final state on A is arbitrary. We may represent this teleportation protocol as follows:</p><formula xml:id="formula_84">= . (<label>43</label></formula><formula xml:id="formula_85">)</formula><p>A teleportation protocol may have the following feature: it can be that for a specific outcome of the AB measurement, there is no correction to apply on the system C. If that is the case, this allows for a post-selected teleportation protocol: upon conditioning on this specific outcome of the AB measurement (i.e., discarding all rounds where a different outcome occurred), the teleportation succeeds without corrections. We will represent this post-selected teleportation protocol as follows:</p><formula xml:id="formula_86">A C B = A C . (<label>44</label></formula><formula xml:id="formula_87">)</formula><p>We now restrict the discussion to quantum theory. </p><formula xml:id="formula_88">Tr AB [E AB ρ A φ BC ] = p tp ρ C , (<label>45</label></formula><formula xml:id="formula_89">)</formula><p>where p tp ∈ (0, 1] is the success probability of the post-selected teleportation protocol.</p><p>As we show in appendix A, equation (45) together with the linearity of quantum theory implies that p tp is independent of the state ρ A being teleported. However, it may depend on the pair (E AB , φ BC ). We also show that for any post-selected teleportation protocol p tp ≤ 1/ dim(H A ) 2 . Out of all possible choices of (E AB , φ BC ) that satisfy definition 4, we consider the following as canonical choice [BBC + 93], which defines a valid post-selected protocol with optimal success probability of p tp = 1/ dim(H A ) 2 . Definition 5 (Bell post-selected teleportation protocol). The canonical choice of quantum post-selected teleportation protocol consists of choosing H B = H A and</p><formula xml:id="formula_90">E AB = |Φ + ⟩⟨Φ + | AB , φ BC = |Φ + ⟩⟨Φ + | BC , (<label>46a</label></formula><formula xml:id="formula_91">)</formula><p>where</p><formula xml:id="formula_92">|Φ + ⟩ AB = 1 dim(H A ) dim(H A ) i=1 |i⟩ A |i⟩ B , (<label>46b</label></formula><formula xml:id="formula_93">)</formula><p>and where {|i⟩}</p><formula xml:id="formula_94">dim(H A ) i=1</formula><p>is an orthonormal basis. We refer to this choice as Bell post-selected teleportation protocol.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Family of acyclic causal models from a cyclic model</head><p>In this section, we construct a family of acyclic causal models from a given, possibly cyclic model. The construction involves replacing a subset of edges of the graph with postselected teleportation protocols. We first construct a family of acyclic causal graphs from a given causal graph.</p><p>Definition 6 (Family of acyclic causal graphs G tp (G)). Given a causal graph G = (V, E), we define an associated family G tp (G) of directed acyclic causal graphs, where each element G tp ∈ G tp (G) is obtained from the causal graph G as follows. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Choose any subgraph G</head><formula xml:id="formula_95">′ := (V ′ , E ′ ) of G = (V, E) with V ′ = V and E ′ ⊆ E, such that G ′ is</formula><formula xml:id="formula_96">(v i , v ′ i ) ∈ E s (G tp ), include in G tp , two vertices T i and R i and three edges (v i , T i ), (R i , T i ) and (R i , v ′ i ). 4. The vertex T i is observed and R i unobserved. Outgoing edges from R i , (R i , T i ) and (R i , v ′ i ), are quantum edges. The edge (v i , T i ) is of the same type of the edge (v i , v ′ i ) in the original causal graph G.</formula><p>G tp constructed in this manner is thus a causal graph. It will be useful to refer to T i and R i as pre and post-selection vertices respectively and depict them with distinct vertex styles T i and R i , as these will play a special role in our framework. This makes G tp identical to G up to replacing each split edge</p><formula xml:id="formula_97">(v i , v ′ i ) ∈ E s (G tp ) ⊆ E with the following structure: v i v ′ i R i T i (R i , T i ) (v i , T i ) (R i , v ′ i )<label>(47)</label></formula><p>We will refer to every G tp ∈ G tp (G) as a teleportation graph, as we will later associate teleportation protocols to such graphs. It will be useful to denote the set of all post-selection vertices and the set of all pre-selection vertices in G tp as V post := {T i } (v i ,v ′ i )∈Es(Gtp) and V pre := {R i } (v i ,v ′ i )∈Es(Gtp) . As an example, consider the cyclic causal graph</p><formula xml:id="formula_98">G = L M . (<label>48</label></formula><formula xml:id="formula_99">)</formula><p>Let us follow the steps of definition 6.</p><p>1. Choosing E ′ = {(L, M )}, we obtain the following acyclic subgraph G ′ :</p><formula xml:id="formula_100">G ′ = L M 2.</formula><p>The only edge e which is absent in G ′ compared to G is e = (L, L), therefore we have E s (G tp ) = {(L, L)}. We have to add the post-selection vertex T and pre-selection vertex R to the graph, as well as the appropriate quantum edges. We obtain the following teleportation graph:</p><formula xml:id="formula_101">G tp = L M T R</formula><p>Alternatively, we could remove all edges of the graph, corresponding to E ′ = ∅ and E s (G tp ) = {(L, L), (L, M )}, resulting in the following teleportation graph:</p><formula xml:id="formula_102">G tp = L M T 1 R 1 R 2 T 2</formula><p>The following lemma, which is proven in appendix D, confirms that the result of the above definition is indeed a family of acyclic graphs.</p><p>Lemma 7 (Acyclicity of teleportation graphs). Each directed graph G tp obtained from a directed graph G as described in definition 6 is acyclic.</p><p>We constructed a family G tp (G) of acyclic causal graphs for any given causal graph G. Given a causal model on G, we can construct a corresponding family of causal models on G tp (G), as in the following definition.</p><p>Definition 8 (Teleportation causal models on the graph family G tp (G)). Given a causal model, Cm G , associated with a causal graph G, we can define a corresponding family of causal models, by associating a causal model Cm Gtp to each teleportation graph G tp ∈ G tp (G), as follows:</p><p>1. For every edge, as well as every vertex present in both G and G tp , the assigned Hilbert spaces, outcome sets, CPTP maps and POVMs (according to definition 2) are the same in the two causal models Cm G and Cm Gtp .</p><p>2. Using the same notation as in definition 6, for the pre-selection vertex R i , postselection vertex T i and corresponding three edges</p><formula xml:id="formula_103">(v i , T i ), (R i , T i ) and (R i , v ′ i ) intro- duced in G tp for each edge (v i , v ′ i ) ∈ E s (G tp )</formula><p>that was removed from G, the causal model Cm Gtp has the following specifications:</p><p>(a) The Hilbert spaces associated to the edges are</p><formula xml:id="formula_104">H (v i ,T i ) = H (R i ,v ′ i ) in Cm Gtp = H (v i ,v ′ i ) in Cm G . (<label>49</label></formula><formula xml:id="formula_105">)</formula><p>(b) The outcome set associated to the post-selection vertex consists of X T i = {✓, ✗}, the outcome taking values in this set will be denoted as t i .</p><p>(c) The POVM element E T i ✓ of the post-selection vertex and the state ρ R i of the pre-selection vertex form a post-selected teleportation protocol (definition 4). <ref type="foot" target="#foot_5">7</ref>Furthermore, the labelling of the CPTP and CP maps of the causal models are such that the</p><formula xml:id="formula_106">H (v i ,T i ) output of a map in Cm Gtp is identified with the H (v i ,v ′ i ) output of the same map in Cm G . Similarly, the H (R i ,v ′ i ) input of a map in Cm Gtp is identified with the H (v i ,v ′ i )</formula><p>input of the same map in Cm G . We will refer to each such Cm Gtp as a teleportation causal model.</p><p>As every causal model constructed according to definition 8 is an acyclic causal model, we can readily compute probabilities within such models using the acyclic probability rule of definition 3. Specifically, note that all observed vertices V o ⊆ V of G are preserved in every G tp ∈ G tp (G). For a given teleportation graph G tp , denoting V post as the set of all post-selection vertices of the graph (which are by construction also observed), V o ∪ V post corresponds to the set of all observed vertices of G tp . Therefore, by applying the acyclic probability rule (definition 3) to any causal model Cm Gtp defined on G tp (definition 8), we can compute the probability distribution Pr acyc x, {t i = ✓} T i ∈Vpost Gtp on the observed vertices of G tp , where x := {x v } v∈Vo . We are interested in the event that the post-selections involved in all the teleportation protocols of the model succeed.</p><p>Definition 9 (Success probability in a teleportation causal model). Let Cm G be a causal model of a causal graph G and Cm Gtp be a corresponding teleportation causal model defined on G tp ∈ G tp (G). The post-selection success probability of Cm Gtp is defined as follows</p><formula xml:id="formula_107">p ✓ := Pr acyc {t i = ✓} T i ∈Vpost Gtp = x Pr acyc x, {t i = ✓} T i ∈Vpost Gtp , (<label>50</label></formula><formula xml:id="formula_108">)</formula><p>where the summation is over x := {x v } v∈Vo and V o is the set of all observed vertices of G.</p><p>This allows to obtain the probability associated with observed events in V o , conditioned on the success of the post-selections in the teleportation causal model, which will be the probability of interest in our framework,</p><formula xml:id="formula_109">Pr acyc x {t i = ✓} T i ∈Vpost Gtp = Pr acyc x, {t i = ✓} T i ∈Vpost Gtp p ✓ . (<label>51</label></formula><formula xml:id="formula_110">)</formula><p>In appendix D, we prove the following proposition which shows that this conditional probability is independent of the choice of teleportation graph G tp ∈ G tp (G).</p><p>Proposition 10 (Equivalent probabilities from different teleportation graphs). Let Cm G be a causal model on a causal graph G, and let V o ⊆ V be the set of all observed vertices of G. Consider any G tp,1 , G tp,2 ∈ G tp (G), and for i ∈ {1, 2}, let Cm Gtp ,i be a causal model on the teleportation graph G tp,i that is associated to Cm G (definition 8). Then, we have</p><formula xml:id="formula_111">Pr acyc x {t i = ✓} T i ∈V 1 post Gtp ,1 = Pr acyc x {t i = ✓} T i ∈V 2 post Gtp ,2 , (<label>52</label></formula><formula xml:id="formula_112">)</formula><p>where we denoted the set of all post-selection vertices of G tp,1 , G tp,2 as V 1 post and V 2 post respectively, and the joint observed event of V o in short as</p><formula xml:id="formula_113">x := {x v ∈ X v } v∈Vo .</formula><p>Thus, as long as we are only interested in the conditional probabilities of equation ( <ref type="formula" target="#formula_109">51</ref>), all teleportation graphs G tp ∈ G tp (G) are equivalent. We define the maximal teleportation graph as canonical choice.</p><p>Definition 11 (Maximal teleportation graph). Given a causal graph G = (V, E), consider the family of acyclic causal graphs G tp (G). The canonical choice of teleportation graph</p><formula xml:id="formula_114">G max tp ∈ G tp (G) consists in choosing E s (G max tp ) = E.</formula><p>We refer to this choice as maximal teleportation graph.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">General probability rule for cyclic quantum causal models</head><p>In the previous section, we have constructed a family of acyclic causal models associated with a given causal model (definition 8). We have proven that the acyclic distribution conditioned on successful post-selection is independent of which teleportation causal model we choose in this family. In this section, we use these results to define a probability rule for the cyclic causal model underlying the family. </p><formula xml:id="formula_115">:= {x v ∈ X v } v∈Vo in Cm G is defined as Pr (x) G := Pr acyc x {t i = ✓} T i ∈Vpost Gtp = Pr acyc x, {t i = ✓} T i ∈Vpost Gtp p ✓ . (<label>53</label></formula><formula xml:id="formula_116">)</formula><p>If p ✓ = 0, we say that the causal model Cm G is inconsistent and the probabilities Pr (x) G are undefined.</p><p>In the above definition of Pr (x) G , there are two choices involved. Firstly the choice G tp ∈ G tp (G) of the teleportation graph and secondly, once G tp is fixed, there is still freedom in the specific implementation of post-selected teleportation protocol one picks for each pair of pre-and post-selection vertices in G tp . Proposition 10 proves that definition 12 is independent of the first choice. In the following, we show that it is also independent of the second choice. In fact, we show a general formula that makes this fact explicit. This involves the following composition rule, which is a special case of loop composition introduced in [PMM + 17].</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Definition 13 (Self-cycle composition). Let H</head><formula xml:id="formula_117">A ∼ = H C with d = dim(H A ) = dim(H C ). Further, let {|k⟩ A } d k=1 and {|l⟩ A } d l=1 be any orthonormal bases of H A and {|k⟩ C } d k=1 and {|l⟩ C } d l=1 be the corresponding bases of H C i.e., |k⟩ A ∼ = |k⟩ C and |l⟩ A ∼ = |l⟩ C for all k, l = 1, . . . , d. Then for any linear map M A|C : L(H C ) → L(H A ), we define the self-cycle composition cycle(M A|C ) ∈ C as follows cycle(M A|C ) = d k,l=1 ⟨k| A M(|k⟩⟨l| C )|l⟩ A . (<label>54</label></formula><formula xml:id="formula_118">)</formula><p>It is easy to check that cycle(M A|C ) is indeed independent of the choice of orthonormal basis one makes in the above definition.</p><p>Proposition 14 (General probability rule in terms of self-cycle composition). Consider a causal model Cm G on any causal graph G, associated with the sets V o and V u of observed and unobserved vertices. Let G tp ∈ G tp (G) be a teleportation graph and Cm Gtp a corresponding teleportation causal model on G tp constructed from Cm G . By construction, pre and post-selection vertices in G tp come in pairs R i and T i , and are associated in particular with edges e i := (v i , T i ) and e ′ i := (R i , v ′ i ). Suppose that the cardinality of the split edges set E s (G tp ) is k, then we have the edges {e 1 , . . . , e k } and {e ′ 1 , . . . , e ′ k } defined as above. We let a joint observed event associated with V o be denoted as x := {x v ∈ X v } v∈Vo , and define the collection of CP maps</p><formula xml:id="formula_119">C x : L k i=1 H e ′ i → L k i=1 H e i x (<label>55</label></formula><formula xml:id="formula_120">)</formula><p>through</p><formula xml:id="formula_121">C x = ⃝ v∈Vo M v xv ⃝ u∈Vu E u , (<label>56</label></formula><formula xml:id="formula_122">)</formula><p>where M v xv and E u refer to the maps of the causal model Cm G (see definition 2), and where the composition rule is dictated by the acyclic subgraph G ′ of G which is used in definition 6 to construct G tp<ref type="foot" target="#foot_6">foot_6</ref> . It holds that the success probability p ✓ and the probabilities Pr(x) G of definition 12, defined if and only if p ✓ ̸ = 0, satisfy</p><formula xml:id="formula_123">p ✓ = k i=1 p (i) tp x cycle(C x ), Pr(x) G = cycle(C x ) x cycle(C x ) , (<label>57</label></formula><formula xml:id="formula_124">)</formula><p>where the cycle operation was introduced in definition 13 and p</p><formula xml:id="formula_125">(i)</formula><p>tp is the teleportation probability associated to the post-selected teleportation protocol implemented by the vertices R i and T i (definition 8).</p><p>The proof of the proposition above is given in appendix D. Notice that proposition 14 holds for any teleportation graph G tp ∈ G tp (G). In the special case of the maximal teleportation graph (definition 11), G max tp ∈ G tp (G), the collection of CP maps of equation (56) reduces to the tensor product of the maps of the causal model Cm G , i.e.,</p><formula xml:id="formula_126">C max x = v∈Vo M v xv u∈Vu E u . (<label>58</label></formula><formula xml:id="formula_127">)</formula><p>In addition, we can prove that cycle(C x ) is independent of the choice of teleportation graph G tp ∈ G tp (G) used in its construction. This follows from the proof of the above proposition (specifically lemma 28 used therein).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Corollary 15. For any causal model on an arbitrary directed graph G, the quantity cycle(C x ), defined with respect to the causal mechanisms {M v xv } v∈Vo and {E v } v∈Vu of the causal model as in proposition 14, is the same independently of the choice of teleportation graph</head><formula xml:id="formula_128">G tp ∈ G tp (G) used in its construction.</formula><p>Finally, we obtain the following corollary showing that definition 12 does not depend on the implementation of teleportation protocol (definition 4). This immediately follows from proposition 14 and corollary 15, and observing that, by definition, the success probability of a post-selected teleportation protocol is strictly greater than zero.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Corollary 16. Consider a causal model Cm G on a causal graph G and any causal model</head><p>Cm Gtp in the family of teleportation causal models derived from Cm G according to definition 8. It holds that whether or not the probabilities Pr(x) G of Cm G (equation (53)) are defined and the values they take (if they are defined) do not depend on the choice of implementation of post-selected teleportation protocol (definition 4) one makes in the construction of Cm Gtp from Cm G .</p><p>Thus, we have proven that definition 12 does not depend on which teleportation graph one picks in the family of definition 6 nor on the implementation of teleportation protocol definition 4.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Examples of cyclic causal graphs</head><p>In this section, we present few examples of causal models on cyclic graphs. These should clarify how to construct a family of acyclic teleportation graphs (definition 6), define a teleportation graph on elements of this family (definition 8) and evaluate the probability distribution over observed vertices (definition 12).</p><p>The self-cycle graph. We start by considering the causal graph G given below (which is the same as the example of equation ( <ref type="formula" target="#formula_98">48</ref>)), and we choose the following teleportation graph</p><formula xml:id="formula_129">G tp ∈ G tp (G): G = L M D A G tp = L M D T R A B C (<label>59</label></formula><formula xml:id="formula_130">)</formula><p>Consider a generic causal model on G, namely, a channel E L AD|A and a POVM {(E M m ) D } m∈X M . We want to compute the probability Pr(m) G as in definition 12. For that, we pick the above G tp , and we pick a causal model on G tp associated to the causal model of G, which simply means that L and M get the same causal mechanisms as in G, but we also associate a post-selected teleportation protocol (E AB , φ BC ) with teleportation probability p tp to the pre-and post-selection vertices R and T of G tp . Notice also that we set H A = H C , as prescribed by definition 8. The success probability of the causal model in G tp is given by</p><formula xml:id="formula_131">p ✓ = m∈X M Tr ABD E AB ⊗ (E M m ) D E L AD|C (φ BC ) . (<label>60</label></formula><formula xml:id="formula_132">)</formula><p>For concreteness, we choose the post-selected teleportation protocol to be implemented with Bell states as in definition 5, thus obtaining</p><formula xml:id="formula_133">p ✓ = 1 dim(H A ) 2 dim(H A ) i,j=1 dim(H D ) k=1 ⟨i| A ⊗ ⟨k| D E L AD|C (|i⟩⟨j| C )|j⟩ A ⊗ |k⟩ D (61) = cycle(Tr D E L AD|C ) dim(H A ) 2 (62)</formula><p>as expected from proposition 14, where we can see that</p><formula xml:id="formula_134">C m = Tr D [E M m E L AD|C ] : L(H C ) → L(H A ).</formula><p>If this success probability is nonzero, the causal model on G is non-paradoxical, and we then obtain the probabilities</p><formula xml:id="formula_135">Pr(m) G = cycle(Tr D [E M m E L AD|C ]) cycle(Tr D [E L AD|C ]) . (<label>63</label></formula><formula xml:id="formula_136">)</formula><p>A two-cycle with inputs. We now move on to a case that displays some quantumclassical interplay. We let</p><formula xml:id="formula_137">G = L 1 L 2 M N X Y A D E F G tp = L 1 L 2 M N X Y R T D E F A B C A causal model on G consists of distributions {p X x } x∈X X and {p Y y } y∈X Y for X and Y , of POVMs {(E M m ) E } m∈X M and {(E N n ) F } n∈X N for M and N ,</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>and collections of channels</head><formula xml:id="formula_138">{E L 1 ,x AE|D } x∈X X and {E L 2 ,y DF |A } y∈X Y for L 1 and L 2 .</formula><p>In section 3.2, we applied definition 2 to examples of acyclic graphs, a similar procedure applies here noting that G tp is also acyclic.</p><p>To define the causal model on G tp associated to the above causal model on G, we take H A = H C , and we let (E AB , φ BC ) be the post-selected teleportation protocol of R, T , with teleportation probability p tp . The success probability can then be written as</p><formula xml:id="formula_139">p ✓ = x∈X X y∈X Y m∈X M n∈X N p X x p Y y Tr ABEF [(E M m ) E ⊗ E AB ⊗ (E N n ) F (E L 1 ,x AE|D • E L 2 ,y DF |C )(φ BC )] (64) = x∈X X y∈X Y p X x p Y y Tr AB [E AB (E L 1 ,x A|D • E L 2 ,y D|C )(φ BC )] (65) = x∈X X y∈X Y p X x p Y y cycle E L 1 ,x A|D • E L 2 ,y D|C , (<label>66</label></formula><formula xml:id="formula_140">)</formula><p>where we defined</p><formula xml:id="formula_141">E L 1 ,x A|D = m∈X M Tr E (E M m ) E E L 1 ,x AE|D = Tr E E L 1 ,x AE|D , E L 2 ,y D|C = n∈X N Tr F (E N n ) F E L 2 ,y DF |C = Tr F E L 2 ,y DF |C , (<label>67</label></formula><formula xml:id="formula_142">)</formula><formula xml:id="formula_143">and used that m∈X M E M m = 1 and n∈X N E N n = 1 by the definition of POVMs.</formula><p>If the success probability is non-zero, the causal model is non-paradoxical, and we obtain the following probabilities:</p><formula xml:id="formula_144">Pr(m, n, x, y) G = p X x p Y y cycle Tr E [(E M m ) E E L 1 ,x AE|D ] • Tr F [(E N n ) F E L 2 ,y DF |C ] x∈X X y∈X Y p X x p Y y cycle E L 1 ,x A|D • E L 2 ,y D|C (68)</formula><p>In particular, observe that the marginal Pr(x) G is in general not equal to the distribution of the causal mechanism p X x . Furthermore, we have Pr(x, y) G ̸ = p X x p Y y , and in particular, Pr(x, y) G ̸ = Pr(x) G Pr(y) G . This means that the causal model yields a distribution that features correlations between X and Y . As we will see in the next section, these correlations are generated by requiring logical consistency of the model, which effectively post-selects over the variables in the loop which are not paradoxical. This feature is relevant in understanding the failure of the soundness of existing graph-separation criteria like d-separation as well as the intuition behind the new property, p-separation that we propose in the following section.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">A sound and complete graph-separation property for cyclic QCMs</head><p>A powerful feature of the causal modelling approach is that by providing a graph-theoretic framework for describing information-theoretic circuits and networks, it allows us to infer properties of observable data from the topology of the underlying causal graph. Specifically, d-separation is an important graph separation property, originally introduced in the classical causal modelling literature for acyclic graphs and subsequently generalised to quantum and post-quantum theories. It is useful as the associated d-separation theorem shows that we can use the property to "read off" conditional independences in the outcome probabilities of any causal model on an acyclic graph, through the connectivity of the graph [VP90, GVP90, Pea09, HLP14]. However, this theorem has been known to fail even in classical causal models on cyclic graphs, and a general graph separation property applicable to all finite dimensional (or with finite-cardinality variables in the classical case) causal models on cyclic graphs has been lacking.</p><p>In this section, we apply our cyclic causal modelling framework to propose such a graph separation property, which we call p-separation. We begin by discussing d-separation for acyclic graphs and examples indicating its failure in cyclic scenarios before introducing p-separation and discussing its applications.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Previous results for acyclic case: d-separation</head><p>We motivate the concept of d-separation and then provide the general definition. Consider the following three types of simple directed graphs. Although d-separation is a purely graph-theoretic property defined for any directed graph, for explaining the motivation behind this concept, it is useful to consider classical causal models and probabilities on the associated vertices. We therefore stylize all vertices as observed v and all edges as classical edges for now.</p><formula xml:id="formula_145">Chain: A C B (<label>69</label></formula><formula xml:id="formula_146">)</formula><formula xml:id="formula_147">Fork: A C B (<label>70</label></formula><formula xml:id="formula_148">)</formula><formula xml:id="formula_149">Collider: A C B (<label>71</label></formula><formula xml:id="formula_150">)</formula><p>Suppose that the classical vertices A, B and C are each associated with a random variable of the same name. For causal models on the chain and the fork, we would generally expect A and B to get correlated, through the (indirect) causal influence of A on B in the first case and through the common cause C in the second case. However, we would expect that A and B would become independent conditioned on C as C mediates the correlations between A and B in both cases. In the chain and fork, we would say</p><formula xml:id="formula_151">A is d-connected to B, denoted A ̸ ⊥ d B while A is d-separated from B given C, denoted A ⊥ d B|C.</formula><p>For the collider on the other hand, A and B have no prior causes and we would expect them to be uncorrelated and we would say A ⊥ d B. However, conditioning on their common child C amounts to post-selection and can correlate A and B, i.e., they become d-connected</p><formula xml:id="formula_152">conditioned on C, A ̸ ⊥ d B|C.</formula><p>In the case of the collider, if we further had C → D as shown below, then we would also expect A and B to get correlated given D (as it is in the future of both), and expect A ̸ ⊥ d B|D also for descendants D of a collider C.</p><p>Collider with descendant:</p><formula xml:id="formula_153">A C B D (72)</formula><p>This is the intuition behind the following definitions. Although the intuition comes from thinking of the correlations, the definition is purely graph-theoretic. A subsequent theorem links this definition to conditional independences between the classical outcomes in a quantum causal model, which recovers the above intuition for the simple classical examples.</p><p>Definition 17 (Blocked paths). Let G be a directed graph in which V 1 , V 2 and V 3 are disjoint sets of vertices with the former two being non-empty. A path (not necessarily directed) from V 1 to V 2 is said to be blocked by V 3 if it contains, for some vertices A and B in the path, either</p><formula xml:id="formula_154">A → W → B with W ∈ V 3 , A ← W → B with W ∈ V 3 or A → W ← B such that neither the vertex W nor any descendant of W belongs to V 3 . Definition 18 (d-separation). Let G be a directed graph in which V 1 , V 2 and V 3 are disjoint sets of vertices with V 1 and V 2 non-empty. V 1 and V 2 are d-separated by V 3 in G, denoted as (V 1 ⊥ d V 2 |V 3 ) G if for every pair of vertices in V 1 and V 2 there is no path between them, or if every path from a vertex in V 1 to a vertex in V 2 is blocked by V 3 . Otherwise, V 1 is said to be d-connected with V 2 given V 3 , denoted as (V 1 ̸ ⊥ d V 2 |V 3 ) G .</formula><p>Definition 19 (Conditional independence). Let V be a non-empty finite set, and let P(x) be a joint probability distribution over a set X = {X v } v∈V of finite-cardinality random variables, whose values are denoted x = {x v } v∈V . Let V 1 , V 2 and V 3 be three disjoint subsets of V , with V 1 and V 2 being non-empty. We denote the corresponding sets of random variables as X i = {X v } v∈V i and the corresponding values as</p><formula xml:id="formula_155">x i = {x v } v∈V i for i ∈ {1, 2, 3}. We say that X 1 is conditionally independent of X 2 given X 3 and denote it as (X 1 ⊥ ⊥ X 2 |X 3 ) P if, for all x 1 , x 2 , x 3 , it holds that P(x 1 , x 2 |x 3 ) = P(x 1 |x 3 )P(x 2 |x 3 ).</formula><p>Then the next theorem follows from the theory-independent d-separation theorem of <ref type="bibr" target="#b31">[HLP14]</ref>, when restricted to the case of quantum theory.</p><p>Theorem 20 (d-separation theorem for acyclic graphs). Consider a directed acyclic graph G and let V 1 , V 2 and V 3 be any three disjoint sets of the vertices of G with V 1 and V 2 being non-empty. Then, the following holds:</p><p>(Soundness) For any causal model Cm G on G where the sets V i are observed, we have that d-separation between the vertex sets V i implies conditional independence for the corresponding sets of random variables</p><formula xml:id="formula_156">X i := {X v } v∈V i where i ∈ {1, 2, 3}, i.e., (V 1 ⊥ d V 2 |V 3 ) G =⇒ (X 1 ⊥ ⊥ X 2 |X 3 ) Pr f,acycG . (<label>73</label></formula><formula xml:id="formula_157">) (Completeness) If the d-connection (V 1 ̸ ⊥ d V 2 |V 3 ) G holds in G, then there exists a causal model Cm G such that the sets V i are observed and (X 1 ̸ ⊥ ⊥ X 2 |X 3 ) Pracyc G ..</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The above conditional (in)dependence statements are relative to the marginal Pr</head><formula xml:id="formula_158">acyc (x 1 , x 2 , x 3 ) G on X 1 ∪ X 2 ∪ X 3 , where x i = {x v ∈ X v } v∈V i , of the observed distribution Pr acyc (x) G , where x = {x v } v∈V , in the causal model fCm G .</formula><p>Example: Bell scenario. We illustrate these concepts and the conventions of our framework, through their application to the familiar example of a Bell scenario (see also section 3.2). This is represented through the following graph</p><formula xml:id="formula_159">G = X Y A B L ,</formula><p>representing two parties, Alice and Bob, who perform measurements on sub-systems of a shared bipartite system L. The exogenous vertices X and Y model the classical settings of Alice and Bob and are associated with channels that prepare a prior distribution on the associated classical variables x and y (see section 3.2 for more details).</p><p>We have V o = {X, Y, A, B} and the outcome distribution is Pr acyc (x, y, a, b) G . We observe the following d-separations between observed vertices in G: (X ⊥ d B|Y ) G and (Y ⊥ d A|X) G due to the absence of collider-free unblocked paths between the setting of one party and the outcome of another. These imply corresponding conditional independences <ref type="figure">y,</ref><ref type="figure">a,</ref><ref type="figure">b</ref>), which are precisely the two bipartite non-signalling conditions of the Bell scenario, i.e.,</p><formula xml:id="formula_160">(X ⊥ ⊥ B|Y ) Pracyc G and (Y ⊥ ⊥ A|X) Pracyc G in the distribution Pr acyc (x,</formula><formula xml:id="formula_161">(X ⊥ d B|Y ) G ⇒ Pr acyc (a|x, y) G = Pr acyc (a|x) G , (Y ⊥ d A|X) G ⇒ Pr acyc (b|x, y) G = Pr acyc (b|y) G .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Failure of d-separation in cyclic graphs</head><p>Theorem 20 can fail already for classical causal models on cyclic graphs. We provide a simple example, based on what is already known in the classical causal modelling literature <ref type="bibr" target="#b45">[Pea09,</ref><ref type="bibr" target="#b41">Nea00]</ref>. As this is a classical example, we use a causal graph with observed vertices and classical edges. Consider the following cyclic causal graph:</p><formula xml:id="formula_162">G = v 1 v 2 v 3 v 4<label>(74)</label></formula><p>Clearly we have (v 3 ⊥ d v 4 ) G . However, it is possible to construct a simple classical causal model (more precisely, a functional model, see appendix C and section 2 of <ref type="bibr" target="#b20">[FGV25]</ref>) where the associated outcomes x 3 and x 4 are correlated in the resulting probability distribution.</p><p>A functional model (see appendix C) involves specifying a prior distribution for every exogenous vertex along with a function for each vertex that determines the value of the variable of the vertex given values of its parental variables. Here, consider binary outcome variables, x i associated to v i , for all four vertices and the following functional dependencies: the outcome associated to v 1 depends on its parents as x 1 = x 2 ⊕x 3 and x 2 , associated to v 2 , depends on its parents as x 2 = x 1 ⊕x 4 . Here ⊕ denotes modulo 2 addition. It is easy to see that x 3 = x 4 is the only consistent solution to this causal model, independently of the priors p v 3 (x 3 ) and p v 4 (x 4 ) specified on these vertices in the functional model. Indeed, computing the probability through our rule, it can be checked that we would obtain Pr(x 3 , x 4 ) G = 0 whenever x 3 ̸ = x 4 indicating the perfect correlation.</p><p>Notice that the probability for the variables associated to exogenous vertices (computed through definition 12) does not equal the prior distribution,</p><formula xml:id="formula_163">Pr(x 3 , x 4 ) G ̸ = p v 3 (x 3 )p v 4 (x 4 ).</formula><p>As a consequence of the d-separation theorem (theorem 20) the equality is always true in acyclic causal models. Hence, this non-equivalence demonstrates a violation of the dseparation theorem (specifically, the soundness of d-separation) in this cyclic causal model as x 3 and x 4 are correlated despite being d-separated.</p><p>Looking carefully, one can identify the reason for the failure of the d-separation property: The loop between v 1 and v 2 effectively acts as a collider for the exogenous vertices v 3 and v 4 . Recall that conditioning on a collider can d-connect previously d-separated vertices. Here, the collider is not explicitly conditioned upon in the original cyclic graph, however the consistency conditions of the model impose an effective post-selection on the values of the loop variables. This intuition is already incorporated in how probabilities are computed in our formalism (definition 12), which maps probability computations in cyclic graphs to corresponding computations in acyclic graphs with post-selection, namely teleportation graphs. In each of the acyclic teleportation graphs, v 3 and v 4 are in fact d-connected when additionally conditioning on the post-selection vertices. The correlation between x 3 and x 4 (without d-connection) in the cyclic graph here is due to the fact that in the corresponding acyclic model (on any of the associated teleportation graphs) the post-selection success probability p ✓ is zero whenever x 3 ̸ = x 4 . This forces x 3 = x 4 in the post-selected distribution, which defines the probability of our original causal model. We illustrate this point more explicitly in the following section where we introduce a new graph separation property, p-separation, that generalises d-separation. We note that the example provided here for the violation of the soundness of dseparation in cyclic causal models involves a scenario where the model is inconsistent (in the classical case here, the functional dependencies admit no solutions) for certain values of the exogenous variables v 3 and v 4 . Such functional causal models are called non-uniquely solvable. It is important to note that there exists an example <ref type="bibr" target="#b41">[Nea00]</ref> of a uniquely solvable functional models defined on finite, binary variables where the soundness of d-separation fails, in that case, the associated graph is more complex than the simple one considered here. As we will see in the next section, the soundness and completeness of our new graph-separation property p-separation, will apply to such examples as well.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Introducing p-separation: soundness and completeness</head><p>The example from the previous sub-section provides an intuition for why d-separation fails in cyclic graphs. It also suggests that the properties of correlations in cyclic graphs are more naturally captured if, rather than looking at d-separation in the original cyclic graph G, we consider d-separation in a corresponding acyclic graph G tp ∈ G tp (G) while also conditioning on the graph's post-selection vertices. This motivates the introduction of a new graph separation property, called p-separation, where p stands for post-selection. As with the case of d-separation, p-separation is also purely a property of a directed graph.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Definition 21 (p-separation).</head><p>Let G be a directed graph and V 1 , V 2 and V 3 denote any three disjoint subsets of the vertices of G with V 1 and V 2 being non-empty. Then, we say that </p><formula xml:id="formula_164">V 1 is p-separated from V 2 given V 3 in G, denoted (V 1 ⊥ p V 2 |V 3 ) G , if and only if there exists G tp ∈ G tp (G) (definition 6) such that (V 1 ⊥ d V 2 |V 3 ∪ V post ) Gtp ,</formula><formula xml:id="formula_165">G tp ∈ G tp (G). Otherwise, we say that V 1 is p-connected to V 2 given V 3 in G, and we denote it (V 1 ̸ ⊥ p V 2 |V 3 ) G . To summarize, p-separation: (V 1 ⊥ p V 2 |V 3 ) G ⇐⇒ ∃G tp ∈ G tp (G) : (V 1 ⊥ d V 2 |V 3 ∪ V post ) Gtp , p-connection: (V 1 ̸ ⊥ p V 2 |V 3 ) G ⇐⇒ ∀G tp ∈ G tp (G) : (V 1 ̸ ⊥ d V 2 |V 3 ∪ V post ) Gtp . (<label>75</label></formula><formula xml:id="formula_166">)</formula><p>Notice that p-separation is defined as a property of a graph, not necessarily decorated as a causal graph. The following theorem establishes that p-separation is a sound and complete graph separation property for cyclic quantum causal models within our framework.</p><p>Theorem 22 (p-separation theorem). Consider a directed graph G and let V 1 , V 2 and V 3 be any three disjoint sets of the vertices of G with V 1 and V 2 being non-empty. Then, the following holds:</p><p>(Soundness) For any causal model Cm G on G where the sets V i are observed, we have that p-separation between the vertex sets V i implies conditional independence for the corresponding sets of random variables</p><formula xml:id="formula_167">X i := {X v } v∈V i where i ∈ {1, 2, 3}, i.e., (V 1 ⊥ p V 2 |V 3 ) G =⇒ (X 1 ⊥ ⊥ X 2 |X 3 ) Pr G . (<label>76</label></formula><formula xml:id="formula_168">) (Completeness) If the p-connection (V 1 ̸ ⊥ p V 2 |V 3 ) G holds in G, then there exists a causal model Cm G such that the sets V i are observed and (X 1 ̸ ⊥ ⊥ X 2 |X 3 ) Pr G .</formula><p>The above conditional (in)dependence statements are relative to the marginal Pr(</p><formula xml:id="formula_169">x 1 , x 2 , x 3 ) G on X 1 ∪ X 2 ∪ X 3 , where x i = {x v ∈ X v } v∈V i of the observed distribution Pr(x) G , where x = {x v } v∈V , in the causal model Cm G .</formula><p>Soundness and completeness of p-separation are proven in appendix E.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.4">Examples: p-separation in acyclic and cyclic graphs</head><p>Recovering d-separation in acyclic graphs Notice that our definition of p-separation reduces to d-separation whenever the causal graph G is acyclic. This is because in this case the graph is a representative of its own acyclic family, G ∈ G tp (G) with an empty set of post-selection vertices V post = ∅. Thus we immediately have that</p><formula xml:id="formula_170">d-separation of V 1 from V 2 given V 3 implies p-separation of V 1 from V 2 given V 3 in G, according to definition 21.</formula><p>The other direction, namely that p-separation implies d-separation is also true from the contrapositive d-connection implies p-connection. Indeed, if V 1 and V 2 are d-connected conditioned on V 3 in a given graph, the same d-connection will hold in all its teleportation graphs once we additionally condition on the post-selection vertices. Thus, V 1 and V 2 are p-connected conditioned on V 3 . To further motivate the definition of p-separation (definition 21), we now consider some examples. These highlight why it is natural to define p-separation through the ∃ G tp ∈ G tp (G) rather than ∀ G tp ∈ G tp (G), specifically for recovering d-separation in the acyclic case. For this, consider the chain, fork and collider graphs of equations ( <ref type="formula" target="#formula_145">69</ref>) and (70) and equation ( <ref type="formula" target="#formula_149">71</ref>) respectively, and consider the graph G max tp ∈ G tp (G) obtained by adding pre and post-selection vertices to every edge (which leads to the maximal number of such vertices for the given graphs). Then, we obtain the following graphs:</p><formula xml:id="formula_171">G max tp for the chain: A T 1 R 1 C T 2 R 2 B (<label>77</label></formula><formula xml:id="formula_172">)</formula><formula xml:id="formula_173">G max tp for the fork: A R 1 T 1 C T 2 R 2 B (<label>78</label></formula><formula xml:id="formula_174">)</formula><p>G max tp for the collider:</p><formula xml:id="formula_175">A T 1 R 1 C R 2 T 2 B (<label>79</label></formula><formula xml:id="formula_176">)</formula><p>Recall that we had (A ̸ ⊥ d B) G and (A ⊥ d B|C) G in the original chain and fork. Denoting</p><formula xml:id="formula_177">V post := {T 1 , T 2 }, we see that we have (A ̸ ⊥ d B|V post ) G max tp and (A ⊥ d B|C, V post ) G max tp</formula><p>in the above graphs for the chain and fork. For the collider, recall that we had (A ⊥ d B) G and (A ̸ ⊥ d B|C) G , and we can see that we also have</p><formula xml:id="formula_178">(A ⊥ d B|V post ) G max tp and (A ̸ ⊥ d B|C, V post ) G max tp .</formula><p>That is, for the graphs of the chain, fork and collider without descendants, the d-separation in the original graph G matches d-separation with conditioning on the post-selection vertices in the representative graph G max tp . However, an interesting difference occurs when we consider colliders with descendants as in equation ( <ref type="formula">72</ref>). The graph G max tp for the collider with descendant is</p><formula xml:id="formula_179">A T 1 R 1 C R 2 T 2 B T 3 R 3 D . (<label>80</label></formula><formula xml:id="formula_180">)</formula><p>The d-separation (A ⊥ d B) G still holds in the collider with descendant, even though</p><formula xml:id="formula_181">(A ⊥ d B|V post ) G max tp</formula><p>no longer holds here for V post := {T 1 , T 2 , T 3 } since T 3 is now a descendant of the collider which we condition on. However, notice that In other words, our definition only implies a p-connection in G when that connection is reflected in all the graphs of the graph family G tp (G). Indeed, we have shown (see proposition 10 and definition 12) that the observed probabilities for the causal model are independent of the representative of G tp (G) chosen in computing them. It is easy to check that applying our probability rule, the outcomes a and b of the vertices A and B will be conditionally independent even when conditioned on the colliders V post := {T 1 , T 2 , T 3 } in equation ( <ref type="formula" target="#formula_179">80</ref>), this is because the post-selection on the unblocking collider T 3 is fine-tuned such that it simulates a directed edge from C to D through an identity channel (without post-selecting a particular outcome value on C or D). Thus our definition of p-separation serves to avoid such fine-tuning and enables us to construct a sound and complete graph separation property for general directed graphs that reduces to d-separation in the acyclic case.</p><formula xml:id="formula_182">G max tp is just one representative of G tp (G).</formula><p>Example of section 5.2 Let us now apply the results of this section to the cyclic graph of equation ( <ref type="formula" target="#formula_162">74</ref>), to see how p-separation captures the failure of d-separation discussed in the previous sub-section. We consider two representatives of G tp,1 , G tp,2 ∈ G tp (G) for G given by equation (74). These are given by introducing pre-and post-selection vertices in one or both edges in the cycle.</p><formula xml:id="formula_183">G tp,1 : v 1 T 1 v 2 R 1 v 3 v 4 (81) G tp,2 : v 1 T 1 v 2 R 1 T 2 R 2 v 3 v 4 . (<label>82</label></formula><formula xml:id="formula_184">)</formula><p>Notice that we have</p><formula xml:id="formula_185">(v 3 ̸ ⊥ d v 4 |T 1 ) Gtp ,1 and (v 3 ̸ ⊥ d v 4 |T 1 , T 2 ) Gtp ,2 .</formula><p>It is easy to see that this d-connection would hold in all other teleportation graphs in this case, as all of them would involve at least one of the post-selection vertices T 1 , T 2 . Thus we have the pconnection, (v 3 ⊥ p v 4 ) G , which justifies why we would expect the outcomes of v 3 and v 4 to get correlated when we have a causal model on the original graph equation (74), as was the case in the example of section 5.2. Indeed, probabilities of that model are nothing but conditional probabilities of a corresponding model on G tp,1 with conditioning on T 1 or equivalently of a model on G tp,2 with conditioning on {T 1 , T 2 }. Notice that the same graph of equation ( <ref type="formula" target="#formula_162">74</ref>) also has a non-trivial p-separation: <ref type="foot" target="#foot_7">9</ref> Further, the following is an example of another cyclic graph with a non-trivial p-separation:</p><formula xml:id="formula_186">(v 3 ⊥ p v 4 |v 1 , v 2 ) G .</formula><formula xml:id="formula_187">G = v 1 v 2 v 3 v v 4 . (<label>83</label></formula><formula xml:id="formula_188">)</formula><p>Here, we have the non-trivial p-separation (v 3 ⊥ p v 4 ) G . Here, the only (possibly undirected) path between v 3 and v 4 goes through v. However, v acts as an unconditioned collider on this path for any G tp ∈ G tp (G), even when we condition on the set of postselection vertices in G tp , i.e., (v</p><formula xml:id="formula_189">3 ⊥ p v 4 |V post ) Gtp holds for all G tp ∈ G tp (G) implying the p-separation (v 3 ⊥ p v 4 ) G by definition 21.</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Links between Markovianity, linearity and success of post-selection</head><p>Consider a classical causal model (functional model or classical Bayesian network, see also appendix C) defined on a directed acyclic graph G where all vertices are observed, i.e., V o = V . The joint distribution on the observed outcomes, which we denote with Pr acyc (see definition 33), respects the Markov property, which corresponds to the following factorisation of this distribution</p><formula xml:id="formula_190">Pr f,acyc ({x v } v∈V ) G = v∈V Pr f,acyc (x v |Pa(x v )) G , (<label>84</label></formula><formula xml:id="formula_191">)</formula><p>where Pa(x v ) denotes the outcome set of all parents of the vertex v. If some of the vertices are unobserved, one simply marginalises over the outcomes of V \ V o on both sides of the above equation, to define the Markov property for Pr f,acyc</p><formula xml:id="formula_192">({x v } v∈Vo ) G .</formula><p>In quantum causal models on directed acyclic graphs, we have the probability rule of equation ( <ref type="formula" target="#formula_48">20</ref>) which expresses the joint probability of observed outcomes as a composition of completely positive linear maps, one for each vertex. We can simplify this by combining the maps M v xv and E v associated with observed and unobserved vertices, to a single map T v xv associated with each vertex v with an empty outcome set x v = ∅ (and the associated map being CPTP) whenever the vertex is unobserved, v ∈ V u . Observed vertices, v ∈ V o , have non-trivial outcomes and the map associated to each outcome, T v xv , is CP but not necessarily trace preserving. Then, we have</p><formula xml:id="formula_193">Pr acyc ({x v } v∈Vo ) G = ⃝ v∈V T v xv . (<label>85</label></formula><formula xml:id="formula_194">)</formula><p>One can check that the above expression is identical to that given by the Markov property in quantum Bayesian networks <ref type="bibr" target="#b31">[HLP14]</ref>, where the observed distribution is given by a generalised product of "tests", one for each vertex v. Each test is a map from incoming quantum systems from unobserved parents to outgoing systems to its children, conditioned on the outcomes of its observed parents. When v is observed, the test is associated with a particular outcome on that vertex of which we compute the probability. <ref type="foot" target="#foot_8">10</ref>The expressions of equation (20) or equivalently equation (85), which can be applied to define the Markov property for Pr acyc (x) G in the acyclic case, are not defined for cyclic models. Indeed, in this case the composition operation ⃝ , which captures parallel and sequential composition, is not defined. To understand how we can extend Markovianity to the cyclic case, we relate equation (85) to the self-cycle composition of definition 13, which is a special case of loop composition introduced in [PMM + 17]. Recall that in proposition 14, we showed that the general probability rule for cyclic quantum causal models can be written in terms of self-cycle composition of a channel C x constructed for a given choice of teleportation graph G tp ∈ G tp (G) and the causal mechanisms of the original causal model. In addition, in proposition 10 we proved that the probability is independent of the choice of teleportation graph G tp ∈ G tp (G). It follows from the results of [PMM + 17, VR24a, VR24b], which express sequential composition in terms of loop composition 11 , that in acyclic causal models, the acyclic probability of equation (20) and equation ( <ref type="formula" target="#formula_193">85</ref>) is equivalent to</p><formula xml:id="formula_195">Pr acyc ({x v } v∈Vo ) G = cycle(C x ),<label>(86)</label></formula><p>where x in the self-cycle expression is short hand for {x v } v∈Vo , as we had in proposition 14. While equation (20) and equation ( <ref type="formula" target="#formula_193">85</ref>) are not defined in the cyclic case, the above equation is, since the cycle operation is defined generally. This expression is independent of the choice of teleportation graph used (corollary 15), thus, without loss of generality one can choose the teleportation graph obtained by splitting all edges, in which case</p><formula xml:id="formula_196">C x = v∈V T v xv = v∈Vo M v xv v∈Vu E v , (<label>87</label></formula><formula xml:id="formula_197">)</formula><p>and</p><formula xml:id="formula_198">Pr({x v } v∈Vo ) G = cycle v∈V T v xv = cycle   v∈Vo M v xv v∈Vu E v   . (<label>88</label></formula><formula xml:id="formula_199">)</formula><p>The above expression gives the observed probability in terms of a composition operation on all the maps of the causal model where cycle links a pair of isomorphic in and output systems for each edge of the causal graph of the model. This suggests the following definition of Markovianity for the general cyclic case.</p><p>Definition 23 (Markov property in cyclic quantum causal models). For a causal model defined on a directed graph G, the associated observed probability distribution Pr({x v } v∈Vo ) G is said to be Markov with respect to G if it can be expressed as in equation (88). If this is the case, we will say that the causal model satisfies the Markov property or is probabilistically Markovian.</p><p>Then the following corollary is implied by proposition 14.</p><p>Corollary 24. Given a causal model on a directed graph G, Cm G , the following statements are equivalent:</p><formula xml:id="formula_200">1. Cm G is probabilistically Markovian; 2. x cycle(C x ) = 1;</formula><p>3. For every choice of G tp ∈ G tp (G) used in the definition of C x and p ✓ , the postselection success probability is</p><formula xml:id="formula_201">p ✓ = k i=1 p (i) tp , (<label>89</label></formula><formula xml:id="formula_202">)</formula><p>where k is the cardinality of the split edges set of G tp , i.e., k = |E s (G tp )|, and p</p><formula xml:id="formula_203">(i) tp</formula><p>is the teleportation probability associated to the post-selected teleportation protocol implemented instead of the i-th split edge in E s (G tp ) (see proposition 14). Using this, it is easy to see that applying all the compositions of an acyclic graph, we will end up with a cycle composition once all maps are fully composed.</p><p>This corollary has an interesting interpretation. Recall that in general, we have</p><formula xml:id="formula_204">p ✓ = k i=1 p (i) tp x cycle(C x ). (<label>90</label></formula><formula xml:id="formula_205">)</formula><p>The term x cycle(C x ) depends on the causal mechanisms of the causal model and not on the choice of teleportation protocols used on the split edges, while the term</p><formula xml:id="formula_206">k i=1 p (i) tp</formula><p>is a product of the individual success probabilities of the teleportation protocols used on the split edges and does not depend on the causal mechanisms of the original causal model at all. When we use the maximally entangled post-selected teleportation protocol (involving an entangled state of two d-dimensional systems) on the i-th edge then p</p><formula xml:id="formula_207">(i) tp = 1 d 2 .</formula><p>This corollary tells us that Markovianity holds whenever the overall post-selection success probability of the causal model is entirely independent of its causal mechanisms.</p><p>Moreover, notice that p ✓ and hence the x cycle(C x ) term appears in the denominator of our general probability expression (proposition 14), this makes the probabilities generally non-linear in the causal mechanisms {M v xv } v∈Vo and {E v } v∈Vu of the causal model. Causal models leading to Markovian distributions are therefore linear in the causal mechanisms of the model. Note, however, that for linearity, it suffices that x cycle(C x ) equals a constant value c not necessarily equal to 1, while Markovianity requires c = 1.</p><p>Link to linear P-CTCs. The intuition behind the results of this section are similar in spirit to certain characterisation results known for process matrices or equivalently quantum supermaps <ref type="bibr" target="#b42">[OCB12,</ref><ref type="bibr" target="#b12">CDPV13]</ref>, which are formalisms for describing so-called indefinite causal order (ICO) quantum processes. These are known to be a linear subset <ref type="bibr" target="#b3">[AGB17]</ref> of the general (possibly non-linear) post-selected closed timelike curves (P-CTCs) [LMGP + 11a, LMGP + 11b]. In particular, P-CTCs are defined with respect to maximally entangled pre and post-selections and process matrices correspond to P-CTCs where the overall success probability equals the product of 1 d 2 for each maximally entangled state of two d-dimensional systems used in the construction. This is precisely what we would get for the success probability p ✓ here by choosing the maximally entangled pre and post-selections on each split edge. Thus, process matrices, when mapped to our framework as discussed in appendix B.2, would correspond to probabilistically Markov causal models. More generally, our framework can give a causal modelling semantic to general non-linear P-CTCs as well, which would not necessarily correspond to probabilistically Markov models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Overview of relationships to other causality frameworks</head><p>Figure <ref type="figure" target="#fig_5">1</ref> illustrates relationships between our framework and several other causality frameworks proposed within the classical statistics and quantum information communities. Below, we highlight the key features distinguishing these frameworks and briefly compare them to ours to discuss the generality of our formalism. For further details, see also appendices B and C. We note that this is not an exhaustive list of such frameworks, but refers to notable and commonly used ones from different types of approaches. The green boxes highlight the graph-separation property (annotated above the box) whose soundness and completeness is known to hold within that formalism. For further explanation of this diagram, see section 7.</p><p>the classical literature) and their restricted variants, such as on finite-cardinality variables or modular functional causal models (fCM finite , mfCM, mfCM finite ), are purely classical frameworks. The relationships among these frameworks are evident from their specified restrictions. Modular fCMs (mfCMs) <ref type="bibr" target="#b22">[FM17,</ref><ref type="bibr" target="#b23">FM18]</ref> correspond to cases where the functional dependencies or structural equations possess a particular solvability property, which is stricter than unique solvability <ref type="foot" target="#foot_10">12</ref> . In <ref type="bibr" target="#b22">[FM17]</ref>, a graph-separation property for cyclic fCMs, called σseparation was proposed and proven to be sound and complete for all modular fCMs (referred there as modular structural equation models) which cover finite and infinite cardinality, discrete and continuous variables. However, the soundness of σ-separation (and d-separation) can fail in non-modular fCMs even in the discrete and finite-cardinality case: this includes uniquely solvable models (such as <ref type="bibr" target="#b41">[Nea00]</ref>) as well non-uniquely solvable models (see section 4 of <ref type="bibr" target="#b20">[FGV25]</ref> for more details on σ-separation). Our framework, when restricted to the classical domain, can fully describe fCM finite (appendix C.2) and, by extension, its subset mfCM finite (see also the companion paper <ref type="bibr" target="#b20">[FGV25]</ref>). However, since we work with finite-dimensional Hilbert spaces, we cannot capture continuous-variable or infinite-cardinality fCMs.</p><p>(b) Non-classical: quantum vs post-quantum. The remaining frameworks in figure <ref type="figure" target="#fig_5">1</ref> are inherently quantum, except for the Henson-Lal-Pusey (HLP) framework <ref type="bibr" target="#b31">[HLP14]</ref> and the non-classical cyclic causal modelling framework of <ref type="bibr" target="#b53">[VC22a,</ref><ref type="bibr" target="#b54">VC22b]</ref>, which apply to general operational probabilistic theories. These theories can include non-quantum and post-quantum models not captured by other frameworks, with the latter accommodating cyclic and post-quantum scenarios. Our framework can describe many of the quantum frameworks, as shown in the diagram, but it does not generically capture post-quantum causal models.</p><p>2. Cyclic vs acyclic: satisfaction of d-separation property and correspondence with valid process operators. The four frameworks in the bottom-most row are defined on directed acyclic graphs, where d-separation is known to be sound and complete. The other frameworks, by contrast, do not assume acyclicity and allow for certain types of cycles. The framework of <ref type="bibr" target="#b53">[VC22a,</ref><ref type="bibr" target="#b54">VC22b]</ref> defines a class of cyclic causal models applicable in classical, quantum and post-quantum theories but restricted to those respecting the soundness of d-separation, while other formalisms, like [BLO20, BLO21], focus on cyclic models associated with valid process operators. Process operators/process matrices/ quantum supermaps <ref type="bibr" target="#b42">[OCB12,</ref><ref type="bibr" target="#b12">CDPV13]</ref> correspond to a linear subset of post-selected closed timeline curves (P-CTCs) [LMGP + 11a, LMGP + 11b]. Our framework allows for classical and quantum models that violate the soundness of d-separation (section 5.2) as well as those with cycles that do not necessarily correspond to valid process operators.</p><p>3. Unitary vs general quantum channels. The Barrett-Lorenz-Oreshkov (BLO) approach [BLO20, BLO21] focuses on causal influence within unitary quantum channels, while the quantum restriction of the HLP approach <ref type="bibr" target="#b31">[HLP14]</ref> (and our extension to the cyclic case) allows for general quantum channels. While there are scenarios that can be modelled in both approaches, there are notable differences in the defi-nition of causal influence conditions and the associated concept of causal structure between these two approaches (see also appendix B.1.2 for further discussion).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Existence/Non-existence of tensor factorization across multiple edges.</head><p>A related point to the above is whether or not a separate tensor factor is assigned to each quantum system for each edge. For instance, when A is a cause of both B and C, whether B and C receive distinct quantum systems in tensor product with each other. In the BLO formalism, non-factor constructions are allowed, meaning a single system that cannot be split into an n-fold tensor product can still be a common parent for n vertices. All BLO models that involve such tensor factorization can be faithfully reproduced within our framework as shown in appendix 6. Faithful vs unfaithful mappings and coarse-graining. The BLO QCM formalism <ref type="bibr" target="#b9">[BLO21]</ref> provides detailed causal semantics for several unitary process matrices including those with indefinite causal order, by decomposing the process operator into marginal channels. When mapping such processes back from the BLO framework to process matrices, the causal semantics given by the causal graph is not maintained and the process operator/matrix is treated as one (coarse-grained) entity that interacts through feedback loops with each local operation. As discussed in appendix B.2, such a mapping between formalisms that involves coarse-graining no longer faithfully reflects the causal connectivity, although the operational predictions can be recovered in both pictures. Figure <ref type="figure" target="#fig_5">1</ref> shows that although direct path from BLO-QCMs to our framework is an open question (blue arrow), there exists a directed path of black arrows from BLO-QCMs to our framework via process matrices. The former says that the existence of a faithful mapping (in the sense of definition 30) is open while the latter says that there exists an unfaithful mapping nevertheless, as shown in appendix B.2.</p><p>7. Choice of post-selected teleportation The Post-selected Closed Timelike Curves (P-CTCs) framework [LMGP + 11a, LMGP + 11b] defines cyclic causal structures through post-selected quantum teleportation. While P-CTCs are specifically associated with post-selected teleportation using maximally entangled states (definition 5), our work generalizes this by allowing for arbitrary post-selected teleportation protocols that do not necessarily involve maximally entangled pre-and post-selections (definition 4).</p><p>Notably, we have demonstrated in section 4.3 that the operationally accessible probabilities can always be computed via a cyclic composition operation, irrespective of the chosen teleportation protocol. This establishes a direct connection between our framework and prior works based on cyclic composition, such as [VR24a, VC22b To summarize, our formalism exhibits generality by encompassing both quantum and classical causal models. It allows for non-unitary quantum channels, cyclic models that potentially violate the soundness of d-separation, and models that are not necessarily associated with valid process operators (but may involve non-linear post-selected closed timelike curves). The graph separation property p-separation, introduced here, is sound and complete for all causal models within this formalism.</p><p>Two potential limitations in its generality arise from the assumption of finite-dimensional Hilbert spaces and the requirement of associating a separate tensor factor for each edge. The former restricts the classical limit of the formalism to discrete and finite-cardinality variables. While no quantum causal modelling frameworks for infinite-dimensional Hilbert spaces are known, continuous-variable and infinite-cardinality classical models are have been studied formally even in cyclic scenarios (see e.g., <ref type="bibr" target="#b7">[BFPM21]</ref>). Whether the restriction to requiring a separate subsystem (tensor factor) to each edge leads to any loss of generality is an open question, and we are not aware of any counter examples that relax this restriction and cannot be modelled faithfully within our framework.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">Discussion and outlook</head><p>The main contributions of our work are summarised in section 1. There are a number of interesting future directions for building on this framework and results, and open questions that remain to be explored. We discuss these below.</p><p>• Causal discovery and causal compatibility in cyclic causal structures. In the case of acyclic models, the soundness and completeness of d-separation plays a central role in causal discovery algorithms which infer underlying causal explanations in terms of directed acyclic graphs from observed data. Such algorithms exist in the classical and quantum literature for acyclic models (e.g., <ref type="bibr" target="#b52">[SZ16,</ref><ref type="bibr" target="#b25">GC18]</ref>). A natural question is whether p-separation can be applied to generalize such causal discovery algorithms in a useful way to cyclic classical and quantum causal models. Similarly, the d-separation criterion underpins causal compatibility questions and witnessing non-classical correlations, such as in Bell's inequalities and network non-locality, where one asks whether a given causal structure supports a certifiable gap between sets of correlations realizable via classical vs non-classical causal models (see e.g., <ref type="bibr" target="#b31">[HLP14]</ref>). Our results create possibilities for exploring analogous questions in cyclic graphs, such as whether meaningful separations between classical and non-classical correlations can be identified, or whether there exist novel cyclic quantum causal models that violate classical compatibility constraints in a genuinely cyclic graph. More conceptually, this may bear insights for the question of whether in a world with causal loops, quantum theory can still be more powerful than classical.</p><p>• Accounting for interventions. We have focussed our attention on observed correlations. However, data resulting from active interventions is also central for identifying causal influences. We have shown how objects from the Barrett-Lorenz-Oreshkov [BLO21], Costa-Shrapnel <ref type="bibr" target="#b16">[CS16]</ref> and process matrix/quantum supermaps [OCB12, CDPV13] frameworks can be described in our framework. These frameworks allow for arbitrary interventions, as their vertices correspond to empty "slots" where any quantum channel can be plugged in. For every such choice of intervention, one obtains a causal model in our framework. Explicitly modelling interventions in our framework and studying the causal inference implications of allowing different classes of interventions is a subject of an upcoming work based on the master's thesis <ref type="bibr" target="#b19">[Fer23]</ref>. Such problems have been considered in the acyclic quantum literature <ref type="bibr" target="#b21">[FK23]</ref>. Beyond this, there is scope to extend these works to systematically investigate causal inference (inferring the causal graph from available data) and causal identification (identifying the causal mechanisms, such as channels, from available data) in cyclic graphs using correlations and interventions.</p><p>• Infinite-dimensional, continuous case and σ-separation In this work, we have focused on causal models for finite-dimensional quantum systems, which embed classical functional models on finite-cardinality variables (including non-uniquely solvable models). A direction for future work would be to identify whether and to what extent our results can be generalised to the infinite-dimensional case. This would require considering generalisations of the post-selected teleportation protocol to the infinitedimensional case and a careful, measure-theoretic treatment of the associated success probabilities.</p><p>While cyclic quantum causal modelling frameworks for infinite-dimensional systems have not been considered to our knowledge, the classical literature has explored functional models or structural equation models (fCMs)<ref type="foot" target="#foot_12">foot_12</ref> with continuous variables, including cyclic graphs. In this context, a cyclic generalization of d-separation, known as σ-separation, was proposed in <ref type="bibr" target="#b22">[FM17]</ref> and shown to be sound and complete for a subclass called modular fCMs (mfCMs) that satisfy a unique solvability property. The relationship between p-separation (introduced here) and σ-separation is discussed in detail in our companion paper <ref type="bibr" target="#b20">[FGV25]</ref>, which focuses on classical causal models. Notably, we find that neither concept is strictly more general than the other, although both extend d-separation to cyclic settings Additionally, our results also indicate the possibility of correlation gaps between all finite-dimensional causal models (classical and quantum) and continuous variable classical models. This is because there exist scenarios (see <ref type="bibr" target="#b20">[FGV25]</ref>) where there is p-separation but σ-connection. The p-separation would imply corresponding conditional independence in all finite-dimensional causal models (by theorem 20), but there exist continuous variable models leading to conditional dependence as allowed by the σ-connection in this case <ref type="bibr" target="#b23">[FM18,</ref><ref type="bibr" target="#b22">FM17]</ref>. In the broader context of quantum foundations, this may bear insights on correlation gaps between measurement statistics from finite and infinite dimensional systems in the presence of consistent causal loops.</p><p>• Characterizing "indefinite causal order" processes from graph-separation.</p><p>While we have introduced a generally sound graph separation criterion, p-separation, for cyclic models, it remains a relevant question to understand which subclass of cyclic causal models, in both classical and quantum settings, respects the soundness of dseparation. In the classical case, d-separation soundness holds for a class of models called ancestrally uniquely solvable <ref type="bibr" target="#b22">[FM17]</ref>, though it is unknown whether these are the most general models respecting d-separation. On the other hand, indefinite causal order (ICO) processes, particularly those described by process matrix and quantum supermap formalisms <ref type="bibr" target="#b42">[OCB12,</ref><ref type="bibr" target="#b12">CDPV13]</ref>, are a specific subclass of cyclic causal structures that can be understood in the post-selected closed timelike curve framework <ref type="bibr" target="#b3">[AGB17]</ref>. Interesting subsets of such ICO processes, such as unitary, causal, causally non-separable processes have been studied [ABC + 15, OG16, AFNB17, WAB19]. It would be valuable to explore concrete relations between the subclass of cyclic quantum causal models respecting d-separation soundness and subclasses of models corresponding to valid process matrices, or a subset of these such as unitary, causal or causally non-separable processes. This would address open questions in classical causal modelling while providing an alternative characterization of quantum processes.</p><p>There is already some evidence for such connections between the two domains, but a clear characterization is lacking. For example, process matrix protocols satisfy the conditions for probabilistic Markovianity identified in our framework (section 6), and in acyclic causal models soundness of d-separation and Markov factorizations of probabilities share close links <ref type="bibr" target="#b35">[LDLL90,</ref><ref type="bibr" target="#b26">GP90]</ref>. Furthermore, d-separation is tied to unique solvability properties in the classical case <ref type="bibr" target="#b22">[FM17]</ref>, while valid classical process matrices are characterised via having unique fixed points under all choices of local interventions <ref type="bibr" target="#b10">[BW16a]</ref>. This motivates concrete future research at the intersection of cyclic causal models, graph separation, and indefinite causality. Further discussions on the link between our framework and ICO protocols, and related open questions can be found in appendix B.2.</p><p>• Understanding space-time structure from operational causality. Causal models define causation through information-theoretic mechanisms, whereas causality in relativistic physics is tied to space-time geometry. Understanding the general interface of information-theoretic and spatio-temporal causality notions houses a number of intriguing and unexplored problems. A set of recent works connect causal models to relativistic principles by embedding them in space-time and considering the compatibility between the two notions of causal order [VC22a, VC22b, VR24a, VR24b]. Conversely, one may ask whether certain properties of spatio-temporal causation can "emerge" from information-theoretic models of causation, and can we thus understand them from more basic operational principles. With this motivation, in a follow-up work based on the master's thesis <ref type="bibr" target="#b19">[Fer23]</ref>, we link the present causal modelling framework to tensor networks, which are used in the quantum information and relativistic physics communities for studying questions relating to the emergence of space-time from quantum correlations, to enable a transfer of techniques between the two research communities. From a fundamental perspective, it would be interesting to develop the initial insights of this and follow-up works towards the larger goal of understanding the emergence of acyclic causal structures and thus an operational arrow of time from information-theoretic principles, or analogues of space-time properties such as distance and curvature through graph-separation criteria.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A Post-selected teleportation</head><p>Throughout this section, we let (E AB , φ BC ) be an implementation of a postelected teleportation protocol according to definition 4. We start by confirming that the success probability of the teleportation protocol does not depend on the input state. This will be needed for the upcoming results.</p><p>Lemma 25. The teleportation success probability p tp of definition 4 cannot depend on the state ρ A to be teleported.</p><p>Proof. Suppose that p tp is allowed to depend on the input state, so that</p><formula xml:id="formula_208">Tr AB [E AB ρ A φ BC ] = p tp (ρ)ρ C . (<label>91</label></formula><formula xml:id="formula_209">)</formula><p>Suppose that p tp (ρ) was not constant, so that there exist ρ ̸ = ρ ′ with p tp (ρ) ̸ = p tp (ρ ′ ). Consider a mixture of ρ and ρ ′ to be teleported, for some λ ∈ [0, 1]:</p><formula xml:id="formula_210">Tr AB [E AB (λρ A + (1 -λ)ρ ′ A )φ BC ] = p tp λρ + (1 -λ)ρ ′ λρ C + (1 -λ)ρ ′ C . (<label>92</label></formula><formula xml:id="formula_211">)</formula><p>By linearity, we also have</p><formula xml:id="formula_212">Tr AB [E AB (λρ A + (1 -λ)ρ ′ A )φ BC ] = λTr AB [E AB ρ A φ BC ] + (1 -λ)Tr AB [E AB ρ ′ A φ BC ] = λp tp (ρ)ρ C + (1 -λ)p tp (ρ ′ )ρ ′ C . (<label>93</label></formula><formula xml:id="formula_213">)</formula><p>Equating equations ( <ref type="formula" target="#formula_210">92</ref>) and (93), we get</p><formula xml:id="formula_214">p tp λρ + (1 -λ)ρ ′ λρ C + (1 -λ)ρ ′ C = λp tp (ρ)ρ C + (1 -λ)p tp (ρ ′ )ρ ′ C . (<label>94</label></formula><formula xml:id="formula_215">)</formula><p>Taking the trace of this equation yields</p><formula xml:id="formula_216">p tp λρ + (1 -λ)ρ ′ = λp tp (ρ) + (1 -λ)p tp (ρ ′ ). (<label>95</label></formula><formula xml:id="formula_217">)</formula><p>Inserting this identity back in equation (94), we obtain a quadratic expression in λ:</p><formula xml:id="formula_218">(p tp (ρ) -p tp (ρ ′ ))(ρ C -ρ ′ C )λ 2 + (• • •)λ + (• • •) = 0. (<label>96</label></formula><formula xml:id="formula_219">)</formula><p>This equation needs to hold for all λ ∈ [0, 1], which implies in particular that the term proportional to λ 2 must vanish. This is a contradiction to our assumption that ρ ̸ = ρ ′ and p tp (ρ) ̸ = p tp (ρ ′ ).</p><p>We now prove a type of self-testing result: the pre-and post-selection implementing a post-selected teleportation protocol have to take a specific form.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Lemma 26 (Self-testing of post-selected teleportation implementations). Let d</head><formula xml:id="formula_220">A = dim(H A ) = dim(H C ) and d B = dim(H B ). It holds that (E AB , φ BC ) is a post-selected</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>teleportation protocol implementation as in definition 4, with p tp ∈ (0, 1] the teleportation probability, if and only if d B ≥ d A and there exist coefficients</head><formula xml:id="formula_221">{0 ̸ = φ k ∈ R} d A k=1 satisfying d A k=1 φ 2 k = 1, d A k=1 1 φ 2 k ≤ 1 p tp , (<label>97</label></formula><formula xml:id="formula_222">)</formula><p>and there exist an ancilla Hilbert space H B ′ , as well as orthonormal bases</p><formula xml:id="formula_223">{|k⟩ A } d A k=1 16 for H A , {|k⟩ BB ′ } d B d B ′ k=1 for H B ⊗ H B ′ such that φ BC = Tr B ′ [|φ⟩⟨φ| BB ′ C ], Π BB ′ E AB Π BB ′ = |E⟩⟨E| ABB ′ , (<label>98</label></formula><formula xml:id="formula_224">)</formula><p>where we defined the pure state |φ⟩ BB ′ C , the subnormalized state |E⟩ ABB ′ and the orthogonal projector Π BB ′ as follows:</p><formula xml:id="formula_225">|φ⟩ BB ′ C = d A k=1 φ k |k⟩ BB ′ ⊗ |k⟩ C , (<label>99</label></formula><formula xml:id="formula_226">)</formula><formula xml:id="formula_227">|E⟩ ABB ′ = √ p tp d A k=1 1 φ k |k⟩ A ⊗ |k⟩ BB ′ , Π BB ′ = d A k=1 |k⟩⟨k| BB ′ . (<label>100</label></formula><formula xml:id="formula_228">)</formula><p>Proof. The "if" direction is trivial. We now prove the "only if" direction: suppose that (E AB , φ BC ) implements a post-selected teleportation protocol. We first prove that d B ≥ d A . Since the teleportation probability is independent of the input state (as shown in lemma 25), by linearity, we must have that R • O = p tp I, where</p><formula xml:id="formula_229">I : L(H A ) → L(H C ) is the identity map, and O : L(H A ) → L(H B ), R : L(H B ) → L(H C ) are defined as O(ρ A ) = Tr A [E AB ρ A ], R(ρ B ) = Tr B [φ BC ρ B ]. (<label>101</label></formula><formula xml:id="formula_230">)</formula><p>Since the rank of the identity map I is equal to d 2 A (the dimension of L(H A ), the complex vector space of linear operators on H A )), we must have that the rank of R and O is at least equal to d 2 A . However, the rank of a linear map is at most the minimum of the input and output vector space dimension. In particular, the rank of R and O are at most the vector space dimension of L(H B ), which is equal to d 2 B . We thus obtain d B ≥ d A as a necessary condition. We now prove the bulk of the self-testing result. We let H B ′ be an ancilla Hilbert space so that there exists a pure state |φ⟩ BB ′ C that purifies φ BC , i.e.,</p><formula xml:id="formula_231">φ BC = Tr B ′ [|φ⟩⟨φ| BB ′ C ],<label>(102)</label></formula><p>This implies the equality of equation (97). We consider the Schmidt decomposition of the state |φ⟩ BB ′ C with respect to the BB ′ |C partition: this implies that there exists an orthornormal basis of</p><formula xml:id="formula_232">H B ⊗ H B ′ denoted {|k⟩ BB ′ } d B d B ′ k=1 , an orthonormal basis of H C denoted {|k⟩ C } d A k=1 , and coefficients {0 ̸ = φ k ∈ R} dφ k=1 , where d φ ≤ min(d B d B ′ , d A ), such that |φ⟩ BB ′ C = dφ k=1 φ k |k⟩ BB ′ ⊗ |k⟩ C . (<label>103</label></formula><formula xml:id="formula_233">)</formula><p>The teleportation condition can be rewritten as follows, tracing out over the ancilla: for all density matrix ρ A ∈ L(H A ),</p><formula xml:id="formula_234">Tr BB ′ [E AB ρ A φ BB ′ C ] = p tp ρ C . (<label>104</label></formula><formula xml:id="formula_235">)</formula><p>Now, we define the orthogonal projector</p><formula xml:id="formula_236">Π BB ′ := dφ k=1 |k⟩⟨k| BB ′ . (<label>105</label></formula><formula xml:id="formula_237">)</formula><p>This projector is such that Π BB ′ |φ⟩ BB ′ C = |φ⟩ BB ′ C . We then define</p><formula xml:id="formula_238">E ABB ′ := (1 A ⊗ Π BB ′ )(E AB ⊗ 1 B ′ )(1 A ⊗ Π BB ′ ),<label>(106)</label></formula><p>which can be checked to be a valid POVM element. Using the "partial cyclicity" of the partial trace, equation ( <ref type="formula" target="#formula_234">104</ref>) is equivalent to</p><formula xml:id="formula_239">Tr BB ′ [E ABB ′ ρ A φ BB ′ C ] = p tp ρ C . (<label>107</label></formula><formula xml:id="formula_240">)</formula><p>We let {|k⟩ A } d A k=1 be the orthonormal basis of H A that corresponds to the orthonormal basis {|k⟩ C } k of H C through the identity that the teleportation protocol assumes, namely, H A = H C . Since the teleportation probability p tp does not depend on ρ, we can use the linearity of equation ( <ref type="formula" target="#formula_239">107</ref>), together with the fact that the linear span of density matrices consists of all (possibly non-Hermitian) linear operators on the Hilbert space, to substitute |i⟩⟨j| A instead of ρ A . Then, we have for all i, j ∈ {1, . . . , d A },</p><formula xml:id="formula_241">Tr BB ′ [E ABB ′ |i⟩⟨j| A φ BB ′ C ] = p tp |i⟩⟨j| C . (<label>108</label></formula><formula xml:id="formula_242">)</formula><p>Introducing the Schmidt decomposition of equation ( <ref type="formula" target="#formula_232">103</ref>), we obtain</p><formula xml:id="formula_243">dφ k,l=1 φ k φ l ⟨j| A ⟨l| BB ′ E ABB ′ |i⟩ A |k⟩ BB ′ |k⟩⟨l| C = p tp |i⟩⟨j| C . (<label>109</label></formula><formula xml:id="formula_244">)</formula><p>This directly implies that d φ = d A , which in turn implies that d B d B ′ ≥ d A . Furthemore, we can solve equation ( <ref type="formula" target="#formula_243">109</ref>) for E ABB ′ : for all i, j ∈ {1, . . . , d A }, for all l, k ∈ {1, . . . , d A },</p><formula xml:id="formula_245">⟨j| A ⟨l| BB ′ E ABB ′ |i⟩ A |k⟩ BB ′ = p tp φ k φ l δ ik δ jl . (<label>110</label></formula><formula xml:id="formula_246">)</formula><p>This yields</p><formula xml:id="formula_247">E ABB ′ = Π BB ′ E ABB ′ Π BB ′ = p tp d A k,l=1 1 φ k φ l |k⟩⟨l| A ⊗ |k⟩⟨l| BB ′ =: |E⟩⟨E| ABB ′ , (<label>111</label></formula><formula xml:id="formula_248">)</formula><p>where we defined the following sub-normalized state:</p><formula xml:id="formula_249">|E⟩ ABB ′ = √ p tp d A k=1 1 φ k |k⟩ A |k⟩ BB ′ . (<label>112</label></formula><formula xml:id="formula_250">)</formula><p>Note that for E ABB ′ to be a valid POVM element, we need E ABB ′ ≤ 1 ABB ′ , which implies that the norm of the above state must be at most one, implying the inequality of equation (97).</p><p>We can now prove that the optimal teleportation probability is given by 1/d 2 A , which is achieved by the Bell state preparation and measurement of definition 5.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Lemma 27 (Maximal teleportation probability). Given H A = H C , the maximal teleportation probability p tp that can be achieved within definition 4 is 1/d 2</head><p>A .</p><p>Proof. First, we have seen that the teleportation probability p tp = 1/d 2 A is always achievable by the Bell state implementation of definition 5. Indeed, we can put this implementation in the form of lemma 26: we have</p><formula xml:id="formula_251">φ k = 1 √ d A</formula><p>, and the pure state |E⟩ BB ′ C = |Φ + ⟩ BB ′ C defining the POVM element of the implementation can be written as</p><formula xml:id="formula_252">|E⟩ BB ′ C = 1 d 2 A d A k=1 d A |k⟩ BB ′ ⊗ |k⟩ C , (<label>113</label></formula><formula xml:id="formula_253">)</formula><p>thus showing that for this protocol, p tp = 1/d 2 A . We now wish to show that any teleportation probability is upper-bounded by 1/d 2 A . For a vector ⃗ φ = (φ k ) k , we denote with ∥⃗ φ∥ 2 = k φ 2 k the Euclidean norm squared. First, we argue that the maximal teleportation probability is given by</p><formula xml:id="formula_254">max p tp ∃⃗ φ ∈ R d A : φ k ̸ = 0, ∥⃗ φ∥ 2 = 1 and d A k=1 1 φ 2 k ≤ 1 ptp (114) = max p tp ∃⃗ φ ∈ R d A : φ k ̸ = 0, ∥⃗ φ∥ 2 = 1 and d A k=1 1 φ 2 k = 1 ptp (115) ≤ max p tp ∃⃗ φ, ⃗ ψ ∈ R d A : ∥⃗ φ∥ 2 = 1 and ⃗ φ • ⃗ ψ = d A and ∥ ⃗ ψ∥ 2 = 1 ptp , (<label>116</label></formula><formula xml:id="formula_255">)</formula><p>where the last inequality follows from seeing that any p tp achievable for some ⃗ φ in equation (115) can be achieved by using the same ⃗ φ in equation ( <ref type="formula" target="#formula_254">116</ref>) together with setting ψ k = 1/φ k . To maximize p tp , we need to minimize the norm of ⃗ ψ. However, subject to the constraints ⃗ φ • ⃗ ψ = d A and ∥⃗ φ∥= 1, this means that we need to pick</p><formula xml:id="formula_256">⃗ ψ = d A ⃗ φ, so that ∥ ⃗ ψ∥ 2 = d 2</formula><p>A , and the maximum teleportation probability is indeed 1/d 2 A . We now prove the following lemma, which will allow us to prove that the probabilities associated to cyclic causal models according to our proposed probability rule do not depend on the choice of post-selected teleportation implementation.</p><p>Lemma 28 (Cyclic composition is independent of post-selected teleportation implementation). It holds that for all post-selected teleportation implementation (E AB , φ BC ) with associated teleportation probability p tp (see definition 4),</p><formula xml:id="formula_257">Tr AB [E AB M A|C (φ BC )] = p tp cycle(M A|C ), (<label>117</label></formula><formula xml:id="formula_258">)</formula><p>where cycle(M A|C ) is defined in definition 13.</p><p>Proof. Consider an arbitrary post-selected teleportation implementation (E AB , φ BC ) with associated teleportation probability p tp , and let</p><formula xml:id="formula_259">H B ′ , {|k⟩ A } d k=1 , {|k⟩ BB ′ } d k=1 , |φ⟩ BB ′ C</formula><p>and |E⟩ ABB ′ be as in lemma 26. We then have</p><formula xml:id="formula_260">Tr AB [E AB M A|C (φ BC )] = Tr ABB ′ [|E⟩⟨E| ABB ′ M A|C (|φ⟩⟨φ| BB ′ C )] = d k,l,m,n=1 Tr ABB ′ p tp φ m φ n |m⟩⟨n| A ⊗ |m⟩⟨n| BB ′ φ k φ l |k⟩⟨l| BB ′ ⊗ M A|C (|k⟩⟨l| C ) = p tp cycle(M A|C ).</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B Links to other quantum causality frameworks B.1 Barrett Lorenz Oreshkov cyclic causal models</head><p>In this section, we outline relationships and distinctions between our framework and the cyclic quantum causal modelling formalism of Barrett, Lorenz and Oreshkov (BLO) <ref type="bibr" target="#b9">[BLO21]</ref>. We show that whenever the output space of each party A i factorises into tensor factors, one for each child of the vertex A i , then such causal models in the BLO framework can be recovered faithfully within our framework. This tensor factor restriction of the BLO framework can be seen as a natural cyclic generalization of the acyclic causal modelling framework of Costa and Shrapnel <ref type="bibr" target="#b16">[CS16]</ref>, thus in particular, the latter is also recovered in our framework. We then discuss the prospects for faithfully mapping the more general case (without the tensor factor restriction) into our framework and its links to the causal decomposition problem.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.1.1 Review of the BLO formalism</head><p>We begin by outlining how cyclic causal models are defined in the BLO formalism, the main ingredients are the Choi-Jamiolkowski isomorphism <ref type="bibr" target="#b13">[Cho75,</ref><ref type="bibr" target="#b32">Jam72]</ref> and the concept of process operators.</p><p>Choi-Jamiolkowski isomorphism. With every linear completely positive (CP) map, E A →B : L(H A ) → L(H B ), we can associate a corresponding Choi-Jamiolkowski (CJ) operator,</p><formula xml:id="formula_261">ρ B|A = i,j E A →B (|i⟩⟨j| A ) ⊗ |i⟩⟨j| A * ∈ L(H B ) ⊗ L(H * A ), (<label>118</label></formula><formula xml:id="formula_262">)</formula><p>where {|i⟩ A } is an orthonormal basis of H A and {|i⟩ A * } is the corresponding dual basis (an orthonormal basis of the dual space H * A ). When the map is completely positive and trace preserving (CPTP), we have Tr B (ρ B|A ) = 1 A * . The inverse isomorphism is given as follows and allows us to compute the action of the channel E A →B on an input state ρ A :</p><formula xml:id="formula_263">E A →B (ρ A ) = Tr[τ id AA * ρ B|A ρ A ],</formula><p>where τ id AA * = i,j |i⟩⟨j| A ⊗ |i⟩⟨j| A * is known as the linking operator. This equation has a striking similarity to classical conditional probabilities (which describe the action of classical channels) P(Y ) = X P(Y |X)P(X) <ref type="bibr" target="#b39">[LS13]</ref>, where P denotes an arbitrary probability distribution over two random variables X and Y .</p><p>There are multiple versions of the CJ isomorphism (see for instance <ref type="bibr" target="#b18">[FC24]</ref>), the above version is chosen in the BLO formalism as it is basis independent and yields a positive CJ operator. In particular, the more commonly used version is</p><formula xml:id="formula_264">ρ (1) B|A = i,j E A →B (|i⟩⟨j| A ) ⊗ |i⟩⟨j| A ∈ L(H B ) ⊗ L(H A ),<label>(119)</label></formula><p>which is positive but basis dependent, and another version is given by ρ</p><p>(2)</p><formula xml:id="formula_265">B|A := i,j E A →B (|i⟩⟨j| A ) ⊗ |j⟩⟨i| A ∈ L(H B ) ⊗ L(H A ), (<label>120</label></formula><formula xml:id="formula_266">)</formula><p>which is basis-independent but not necessarily positive. The inverse isomorphisms in these cases are given as</p><formula xml:id="formula_267">E A →B (ρ A ) = Tr[ρ (1) B|A (1 B ⊗ ρ T A )] = Tr[ρ (2) B|A (1 B ⊗ ρ A )].</formula><p>Process operators and probabilities. The next ingredient is the concept of process operators, which was previously used in the process matrix <ref type="bibr" target="#b42">[OCB12]</ref> and higher-order quantum process <ref type="bibr" target="#b12">[CDPV13]</ref> frameworks. The idea is to consider multiple laboratories A 1 , ..., A N , each A i being associated with a pair of in and output spaces</p><formula xml:id="formula_268">A in i := L H A in i , A out i := L H A out i .</formula><p>An agent may perform a local quantum operation within each such lab, which corresponds to a quantum instrument, i.e., a set of CP maps</p><formula xml:id="formula_269">{M x i : A in i → A out i } x i such that M := x i M x i is CPTP.</formula><p>Generally, the local operations can be parametrised by a classical setting choice a i and we have a corresponding quantum instrument {M x i |a i } x i .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The process operator σ</head><formula xml:id="formula_270">A 1 ,...,A N ∈ L i H A in i i H * A out i</formula><p>describes the environment of these labs, and encodes information on how they are connected, for instance whether or not there is a channel connecting the output A out 1 of lab A 1 to the input A in 2 of the next lab A 2 . The outcome probabilities can be computed as follows</p><formula xml:id="formula_271">Pr BLO (x 1 , ..., x N |a 1 , ..., a N ) = Tr σ A 1 ,...,A N n i=1 ρ x i |a i A out i |A in i T , (<label>121</label></formula><formula xml:id="formula_272">)</formula><p>where ρ</p><formula xml:id="formula_273">x i |a i A out i |A in i denotes the CJ operator of the local operation M x i |a i .</formula><p>The conditions for σ A 1 ,...,A N being a valid process operator 17 ensure that the distribution defined above is a valid, normalised probability distribution. See [ABC + 15] and <ref type="bibr" target="#b43">[OG16]</ref> for further details on necessary and sufficient constraints on valid process operators. In the above, all output spaces appearing in the CJ operators ρ A out i |A in i and the process operator σ A 1 ,...,A N are the dual spaces H *</p><formula xml:id="formula_274">A out i .</formula><p>We could alternatively use the CJ operators according to the variant ρ (1)</p><formula xml:id="formula_275">A out i |A in i</formula><p>of the CJ isomorphism where the dual spaces do not feature, and define the process operator on the joint in and output spaces of all parties. One can show that the probability expression equation (121) will be identical. However, in the latter case, one must be careful to express all operators and take the transpose in the same basis. We are now ready to review the definition of causal models in this framework.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Definition 29 (BLO-QCM [BLO21]</head><p>). A BLO-QCM is given by 1. A causal structure which corresponds to a directed graph G with vertices A 1 , ..., A N</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">For each A i , a quantum channel (in CJ representation)</head><formula xml:id="formula_276">σ A i |Pa(A i ) ∈ L   H A in i ⊗   A k ∈Pa(A i ) H * A out k    </formula><p>where Pa(A i ) denotes the set of all parents of A i in G, such that</p><formula xml:id="formula_277">[σ A i |Pa(A i ) , σ A j |Pa(A j ) ] = 0</formula><p>for all i, j and σ A 1 ,...,A N = N i=1 σ A i |Pa(A i ) is a valid process operator.</p><p>Note that the original papers [BLO20, BLO21] use ρ A i |Pa(A i ) rather than σ A i |Pa(A i ) for the channels mentioned in the above definition. We employ the latter notation in order to make it clear that these are internal channels of the process operator as opposed to the channels ρ A out i |A in i corresponding to the external operations performed by the parties. The BLO framework focuses process operators σ A 1 ,...,A N which correspond to the CJ operator of a unitary channel from the outputs of all parties to their inputs. Generally, given a channel E, the dependence of an output O of a channel E on an input I is checked by whether a choice M I of local operation on I can lead to distinguishable states on O, i.e., we have signalling from</p><formula xml:id="formula_278">I to O through E when Tr \O • E • M I ̸ = Tr \O • E,</formula><p>where \O denotes all outputs of E except O (see <ref type="bibr" target="#b44">[OVB23]</ref> for equivalent definitions). If the channel is unitary, the signalling relations between in and outputs form a directed acyclic graph where the in and output systems are the vertices <ref type="bibr" target="#b8">[BLO20]</ref>. This is not the case for general CPTP maps, where we can have non-trivial signalling relations between subsets of systems without signalling between individual systems, e.g., an input I of a (non-unitary) CPTP map E can signal to outputs O 1 and O 2 jointly but not individually.</p><p>Therefore, for unitary channels one can construct the edges of the graph through signalling relations, i.e., the parents of every output system S, Pa(S), correspond to inputs 17 These include that σ A 1 ,...,A N &gt; 0 and Tr σ</p><formula xml:id="formula_279">A 1 ,...,A N n i=1 ρ A out i |A in i T = 1 when ρ A out i |A in i are CJ operators of CPTP maps.</formula><p>that signal to S through the unitary channel. If we apply such construction to the unitary channel of the process operator, the factorisation</p><formula xml:id="formula_280">σ A 1 ,...,A N = N i=1 σ A i |Pa(A i )</formula><p>can be derived as a theorem (Theorem 4.3 of <ref type="bibr" target="#b8">[BLO20]</ref>). The factors are marginals of the full channel and commute with each other as required by definition 29. This motivates using such signalling relations to define causal relations in the case of unitary channels as processes -which is the case in the BLO framework. For further details on causality in unitary channels, we refer the reader to [ABH + 17, BLO20, BLO21]. For details on the inequivalence between causation and signalling in non-unitary channels, we refer the reader to the above and to <ref type="bibr" target="#b56">[VR24a]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.1.2 Tensor restriction of the BLO formalism and mapping to our framework</head><p>At this point, we can observe an important distinction between causal models in ours and the BLO formalism. Consider a simple common cause graph where we have vertices A, B and C and directed edges (A, B) and (A, C). In our formalism, any causal model on this graph will have a channel E A which has two outgoing wires, one for each outgoing edge and no incoming wires as A is exogenous (i.e., a bipartite state preparation), while B and C will be associated with channels E B and E C acting on the sub-systems of the bipartite state sent along the respective edges, i.e.,</p><formula xml:id="formula_281">A B C . (<label>122</label></formula><formula xml:id="formula_282">)</formula><p>In the BLO formalism, a common cause structure emanating from A does not generally imply a channel at A with multiple outgoing wires (each associated with a separate system). More specifically, considering the three vertices as three labs and using trivial in/output spaces for exogenous or childless vertices, we notice that the BLO framework associates a single global channel from the output space A out of A to the inputs B in and C in whose CJ operator is σ BC|A ∈ L(H B in ⊗ H C in ⊗ H * A out ) (this would in fact be the process operator, if we ignore the trivial spaces), with commuting marginals [σ B|A , σ C|A ] = 0 (keeping factors of identity implicit), σ B|A = Tr C (σ BC|A ) and σ C|A = Tr B (σ BC|A ). Generally, A could be a qubit and need not factorise into independent tensor factors corresponding to two wires.</p><p>In the BLO formalism, a vertex A corresponds to (pairs of) systems, H A in and H A out and the edge structure specifies the channels σ A|Pa(A) that connect the in/output systems between vertices. By contrast, in our formalism vertices v are associated with channels E v while edges e are associated with systems H e . How should we compare and map between the frameworks in a faithful manner that preserves the relevant information?</p><p>Faithful mappings and tensor-restriction of BLO models. We now show that if we require a tensor factorisation of output spaces in the BLO framework in terms of the structure of outgoing edges, then there is a faithful mapping into out framework for every choice of local operations. More formally, we first define these concepts, starting with defining when a mapping between two quantum causality formalisms can be considered faithful. As different frameworks formalize causal models in distinct ways, we will use a more general terminology that captures the essential features of such models: a quantum causal description consists of a directed graph together with an assignment of causal mechanisms (quantum channels) to that graph, and a rule for computing observed correlations arising from those mechanisms.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Definition 30 (Faithful mapping between quantum causal descriptions). We say that a mapping from one quantum causal description to another is faithful if (a) all the vertices and associated causal mechanisms of the former are preserved in the</head><p>image of the mapping, (b) if there is no directed path from A i to A j in the former, then there will be no directed path from A i to A j in the latter, (c) the probability rules associated with both descriptions lead to the same observed correlations.</p><p>This usage of the term faithful is also consistent with its formal usage in causal modelling and inference parlance. There, a causal model is said to be faithful if whenever there is connectivity in the graph, there is a corresponding conditional dependence in the causal model. If we mapped a BLO-QCM to our framework in a way that reproduces the operational predictions but there are additional directed paths in the causal graph of the image than the original model specifies, then the final causal model will generally not be faithful to the graph as it will contain additional observable independences not reflected in the connectivity (see appendix B.2 for further details). Note that any reasonable graphseparation notion would regard A i and A j as connected when there is a directed path from one to the other, i.e., when one is a cause of the other (d, σ and p separation satisfy this).</p><p>Next, we define the tensor-restriction of BLO quantum causal models as follows.</p><p>Definition 31 (BLO-QCM ⊗ ). We define a tensor product restricted BLO-QCM, denoted BLO-QCM ⊗ as being specified by the following.</p><p>1. A causal structure which corresponds to directed graph G with vertices A 1 , ..., A N .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">For each A i , a tensor factorisation of its output space as</head><formula xml:id="formula_283">H A out i = A k ∈Ch(A i ) H A out ik</formula><p>where Ch(A i ) denotes the set of all children of A i in G and H A out ik are arbitrary finite dimensional Hilbert spaces.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">For each A i , a quantum channel</head><formula xml:id="formula_284">σ A i |Pa(A i ) ∈ L   H A in i ⊗   A k ∈Pa(A i ) H * A out ki     such that σ A 1 ,...,A N = N i=1 σ A i |Pa(A i ) is a valid process operator.</formula><p>Since each channel σ A i |Pa(A i ) acts on a distinct Hilbert space (distinct tensor factors of the parental Hilbert space), the commutation condition [σ A i |Pa(A i ) , σ A j |Pa(A j ) ] = 0 is satisfied for all i, j. Hence, every BLO-QCM ⊗ is indeed an instance of a general BLO-QCM.</p><p>Faithfully mapping a tensor restricted BLO-QCM to our formalism. We now show that any BLO-QCM ⊗ (definition 31) can be faithfully mapped (definition 30) into our framework. Given a BLO-QCM ⊗ together with a choice of quantum instrument</p><formula xml:id="formula_285">M a i := {M x i |a i : L(H A in i ) → L(H A out i )} x i ,</formula><p>one for each agent A i , we can obtain a causal model in our formalism (definition 2) through the mapping we describe below. Therefore, each BLO-QCM ⊗ maps to a family of QCMs in our framework, with each element in the family corresponding to a fixed choice of instruments for the N parties, labelled by the settings {a i } i . A previous causal modelling framework by Costa and Shrapnel <ref type="bibr" target="#b16">[CS16]</ref> can be seen as a further restriction of BLO-QCM ⊗ above to the case of directed acyclic graphs G. Hence, the mapping we give here shows that the Costa and Shrapnel formalism can also be faithfully recovered within ours. to every child A j of A i , we can assign this space to the edge (A i , σ j ) of G ′ . The edges (σ j , A j ) are incoming to the lab A j and will be associated with the input space H A in j . The edges (A j , X j ) model the influence of each party's action on their classical outcome, and will be associated a Hilbert space H(X j ) which encodes the outcome set of the j-th party X j := {x j } x j in a preferred basis.</p><p>• Quantum channels In this mapping, we will ignore the dual spaces of the BLO framework. This is not an issue, as discussed earlier, as long as we are consistent about taking transposes in the same basis in which the CJ operators are expressed. Each of the σ i vertices is assigned the quantum channel σi :</p><formula xml:id="formula_286">L(H A in i ) → L( A k ∈Pa(A i ) H A out ki</formula><p>) whose CJ operator is the operator σ A i |Pa(A i ) of the BLO framework<ref type="foot" target="#foot_15">foot_15</ref> . Each of the A i vertices is assigned the corresponding local quantum instrument, M a i with a slight modification to make explicit the outcome as a separate system. The modified instrument is associated with a CPTP map Ma</p><formula xml:id="formula_287">i : L(H A in i ) → L(H A out i ⊗ H(X i )</formula><p>) defined as follows (where each term in the sum below is a CP map Mx i |a i , the set of which defines the instrument)</p><formula xml:id="formula_288">Ma i (ρ A in i ) := x i M x i |a i (ρ A in i ) ⊗ |x i ⟩⟨x i |.<label>(123)</label></formula><p>Finally, the X i vertices are associated with a set of maps {E x i } x i specified by a POVM which has elements E x i := |x i ⟩⟨x i |, according to equation ( <ref type="formula" target="#formula_42">19</ref>) (we have used E for this map as opposed to M of the defining equation, in order to distinguish this from the maps assigned to the labs). Note that the in and output spaces of all channels in this step match with the state spaces assigned to the in/outgoing edges in the previous step.</p><p>• Probabilities The above fully specifies a causal model according to definition 2, for every BLO-QCM ⊗ and choice {a i } N i=1 of local instruments. We can now show that the probabilities Pr BLO (x 1 , ..., x N |a 1 , ..., a N ) as computed in the BLO formalism (equation ( <ref type="formula" target="#formula_271">121</ref>)) and using the probability rule of our formalism (section 4.3) would be the same.</p><p>For simplicity and for sake of illustration, we make the argument for a particular example. However, the argument readily generalises to all graphs that support BLO-QCM ⊗ . Consider the graph G in the BLO framework with 4 vertices A, B, C and D and edges (D, B), (A, B) and (A, C) i.e.,</p><formula xml:id="formula_289">G = D A B C . (<label>124</label></formula><formula xml:id="formula_290">)</formula><p>Let D and A have trivial input spaces. Then the corresponding causal graph G ′ in our formalism would be as follows (it has 10 vertices as N = 4, k = 2):</p><formula xml:id="formula_291">G ′ = D A σ B σ C B C X D X A X B X C . (<label>125</label></formula><formula xml:id="formula_292">)</formula><p>Notice that the absence of directed paths from D to C in G is also reflected in G ′ , in accordance with definition 30. We now explain why the observed probabilities are the same under this mapping. Consider a causal model on the causal graph G ′ obtained from a BLO-QCM ⊗ through the mapping that we have described above. We can construct an acyclic causal graph G ′ ∈ G tp (G ′ ) by replacing each of the edges (A i , σ j ) of G ′ (which arise from the edges (A i , A j ) of the BLO-QCM ⊗ ) with a post-selected teleportation protocol. Suppose there are k edges of the type A i σ j . We then have the pre and post-selection vertices {R 1 , . . . , R k } = V pre and {T 1 , . . . , T k } = V post , and each such edge is replaced with the following protocol for a pair (R l , T l ):</p><formula xml:id="formula_293">A i σ j R l T l (R l , T l )</formula><p>e l e ′ l Then we can define a family of causal models on the acyclic causal graph G ′ based on any given causal model on the original graph G ′ : for all the original edges and vertices, all the causal mechanisms are the same and we assign a post-selection teleportation protocol specified by pre and post-selection mechanisms (E l , φ l ) to each pair of pre and post-selection vertices (R l , T l ) and associated edges. This is a family since we have a choice over the pre and post-selection mechanisms (E l , φ l ) that result in a post-selected teleportation protocol (definition 4). Using the acyclic probability rule, the required probability Pr(x 1 , ..., x N |a 1 , .., a N ) G ′ of the original causal model on G ′ is then given as follows.</p><formula xml:id="formula_294">Pr(x 1 , ..., x N |a 1 , .., a N ) G ′ = k l=1 E l ⃝ N i=1 E x i ⃝ N i=1 Mx i |a i ⃝ N i=1 σi ( k l=1 φ l ) y 1 ,...,y N k l=1 E l ⃝ N i=1 E y i ⃝ N i=1 My i |a i ⃝ N i=1 σi ( k l=1 φ l ) . (<label>126</label></formula><formula xml:id="formula_295">)</formula><p>In the above, the composition rule is dictated by the acyclic graph G ′ (definition 3) and some factors of identity have been suppressed for brevity. The fraction form of the above expression is due to the usual conditional probability rule (Bayes rule). The numerator is the joint probability of obtaining the outcomes x i and the post-selections given by E l succeeding, while the denominator is just the probability of the latter. The fraction thus gives us the probability of the outcomes conditioned on post-selection success, which is what yields the required probabilities of the cyclic model (definition 12).</p><p>In proposition 14, it is shown that this expression can be equivalently written in terms of self-cycle composition, which is independent of the choice of E l and φ l . For this, define</p><formula xml:id="formula_296">C x 1 ,...,x N |a 1 ,...,a N := ⃝ N i=1 E x i ⃝ N i=1 Mx i |a i ⃝ N i=1 σi and notice that C x 1 ,..,x N : L( k l=1 H e ′ l ) → L( k l=1 H e l ).</formula><p>Then it follows that the probabilities can be written as follows where cycle links the space of each edge e l to that of e ′ l through a self-cycle composition (definition 13),</p><formula xml:id="formula_297">Pr(x 1 , ..., x N |a 1 , .., a N ) G ′ = cycle(C x 1 ,...,x N |a 1 ,...,a N ) x 1 ,...,x N cycle(C x 1 ,...,x N |a 1 ,...,a N ) . (<label>127</label></formula><formula xml:id="formula_298">)</formula><p>The composition operation cycle here is identical to loop composition as defined in [PMM + 17], which takes on the form given in <ref type="bibr" target="#b56">[VR24a]</ref> for finite dimensional Hilbert spaces. <ref type="foot" target="#foot_16">19</ref>It follows from the results of <ref type="bibr" target="#b56">[VR24a]</ref> (Lemma 2 of arXiv v4) that cycle(C x 1 ,...,x N |a 1 ,...,a N ) equals the right hand side of equation ( <ref type="formula" target="#formula_271">121</ref>), and it follows that the denominator above equals 1, by the normalisation condition for BLO probabilities. Although the particular example graph G considered here is acyclic, that the denominator equals 1 holds for BLO models on any (possibly cyclic) graph, as these models are associated with valid process operators or process matrices. The above-mentioned results of <ref type="bibr" target="#b56">[VR24a]</ref> apply generically to cyclic graphs as well, and one can similarly establish the equivalence of the probabilities computed in the BLO framework and ours, in any BLO-QCM ⊗ . Finally, notice that all probability computations in our framework directly use the quantum channels and do not refer to the CJ operator, in contrast to the probability rule of the BLO formalism, equation (121).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.2 General BLO causal models and indefinite causal order processes</head><p>General BLO-QCMs and the causal decomposition problem. Having discussed the mapping to our formalism for tensor restricted BLO causal models, let us consider the more general case. Consider the motivating example from the beginning of the section, where A is a common cause of B and C, i.e.,</p><formula xml:id="formula_299">A B C . (<label>128</label></formula><formula xml:id="formula_300">)</formula><p>The process operator corresponds to the CJ operator σ BC|A of a channel E A →BC from A out to B in and C in . The model specifies the commuting marginals σ B|A and σ C|A , which are CJ operators of channels E A →B and E A →C , which non-trivially overlap on A. Generally, A out is not a classical system (i.e., states on A can not be perfectly copied) and need not factorise into two factors, one for each of the marginal channels σ B|A and σ C|A . It is also not immediate how the overall channel E A →BC can be written as a composition of the marginal channels E A →B and E A →C .</p><p>In an earlier paper [ABH + 17], it is shown that whenever the overall channel factorises into a product of its (commuting) marginals σ BC|A = σ B|A σ C|A , then</p><formula xml:id="formula_301">H A out = i H A out,i L ⊗ H A out,i R and ρ BC|A = i σ B|A i L ⊗ σ C|A i R where the marginals σ B|A i L and σ C|A i R are CJ operators of channels E A i L →B : L(H A out,i L ) → L(H B in ) and E A i R →C : L(H A out,i R ) → L(H C in ).</formula><p>This gives E A →BC a circuit decomposition in terms of physical operations: measure A out through a von Neumann measurement M and depending on the outcome i, split A out into two subspaces A out,i L and A out,i R sending one to E A i L →B and the other to</p><formula xml:id="formula_302">E A i R →C .</formula><p>This can be mapped to our framework using three vertices A, B and C for the local operations of the three parties and 3 more vertices M , σ A and σ C for the internal decomposition of the process channel into the measurement M (that can possibly involve an additional ancilla) and the two marginal channels E A i L →B and E A i R →C . Further, if we add a fourth vertex D with directed edge (D, B) to the common cause graph above i.e.,</p><formula xml:id="formula_303">A B C D ,<label>(129)</label></formula><p>and apply a similar channel decomposition for the common cause edges from A to B and C, the total unitary channel from AD to BC given by the BLO formalism, would decompose into sub-channels such that the absence of a directed edge/path from D to C in the graph is reflected in the absence of a directed path of wires in the decomposition. This would allow a faithful mapping into our framework. It is shown in [ABH + 17] that such direct-sum decompositions of the Choi states exist also when A is a common cause of any number n of vertices, allowing this case also to be mapped faithfully to our framework by considering the corresponding decomposition at the level of the channels. Thus, it is in principle possible to construct faithful mappings to our framework for BLO causal models that do not belong to BLO-QCM ⊗ . An interesting open question is whether such faithful decompositions (where the connectivity of the wires in the circuit decomposition matches the connectivity of the causal graph) exist for all valid causal models in the BLO formalism. This question of causal decomposition is an important one in the quantum causal modelling literature, and the question can be refined by specifying the subset of channels with respect to which one seeks a decomposition of the original channel. In particular, causal decompositions of unitary channels in terms of smaller unitary channels has been studied and has led to interesting possibility and potential impossibility results in a range of directed acyclic graphs (defined relative to the signalling structure of the original unitary, as in the BLO framework) <ref type="bibr" target="#b34">[LB21]</ref>. For there to exist a faithful mapping of every BLO causal model to our formalism, it is sufficient if the overall unitary channel defined in the BLO formalism admits a faithful causal decomposition in terms of general (not necessarily restricted to unitary) quantum channels. This remains an open problem even in acyclic causal models, and we are not aware of any counter-examples to show that this is not possible.</p><p>We leave a further investigation of this for future work. We note that unfaithful mappings into our formalism still exist for all process matrices and therefore for BLO-QCMs (based on unitary process matrices), and discuss this in the next subsection.</p><p>Process matrix protocols within our framework. In usual quantum protocols, operations occur in a well-defined and acyclic order. Frameworks for modelling so-called indefinite causal order processes have been proposed (e.g., <ref type="bibr" target="#b29">[Har05,</ref><ref type="bibr" target="#b30">Har09,</ref><ref type="bibr" target="#b42">OCB12,</ref><ref type="bibr" target="#b12">CDPV13]</ref>), where the order in which quantum operations are applied can be subject to quantum uncertainty or may not be acyclic. This includes scenarios such as the quantum switch <ref type="bibr" target="#b12">[CDPV13]</ref>, which involves a quantum superposition of Alice acting before Bob and Bob acting before Alice on a target quantum system (possibly depending on the state of a control system), as well as purely classical scenarios where there is a cyclic dependence between the operations of the parties (such as the Baumeler-Wolf process <ref type="bibr" target="#b11">[BW16b]</ref>). One such prominent framework is that of process matrices <ref type="bibr" target="#b42">[OCB12]</ref>. Here one considers N parties associated with labs A 1 , ..., A N where just as in the BLO framework each lab is associated with a pair of in and output spaces</p><formula xml:id="formula_304">H A in i and H A out i . The process matrix σ ∈ L( i H A in i ) ⊗ L( i H A out i</formula><p>) models the environment of these labs and tells us how they can be connected. The process operator σ A 1 ,...,A N of the BLO formalism, when expressed in the basis-dependent convention for CJ operators (without the duals) is precisely the process matrix σ. Given such a process operator or process matrix together with a set of local quantum channels M x i |a i , and the same probability rule equation ( <ref type="formula" target="#formula_271">121</ref>) can be used to compute the joint probability Pr BLO (x 1 , ..., x N |a 1 , ..., a N ). Recall that the form of this rule is independent of whether we use the basis-independent version of the BLO framework (with the dual spaces) or the standard basis-dependent version of the CJ isomorphism.</p><p>In the BLO formalism, the process operator σ A 1 ,...,A N is associated with a unitary channel on the parties outputs to their inputs, and this is linked to the process operator having further internal structure as a factorisation in terms of the channels σ A i |Pa(A i ) . While the BLO formalism includes certain classes of indefinite causal order process such as the quantum switch, it cannot model more general non-unitary processes (for instance the causal inequality violating process proposed by Oreshkov, Costa and Brukner <ref type="bibr" target="#b42">[OCB12]</ref>).</p><p>In the earlier section, we discussed how to faithfully map tensor restricted BLO causal models to our framework. More generally, one can also formulate all process matrices within our formalism through a generic mapping, which is similar to mappings proposed from process matrices to other cyclic quantum causality frameworks [LMGP + 11a, LMGP + 11b] and [VR24a, VR24b] (we will discuss such frameworks shortly). While this gives alternative and equivalent ways to study processes matrices (and in particular the resulting probabilities), it will generally not be a faithful mapping. The mapping is rather simple, it involves including 2N + 1 vertices {A 1 ,...,A N } ∪ {X 1 ,...,X N } ∪ {σ} in the causal graph where all the A i vertices and σ are unobserved and all X i vertices are observed. The vertex σ associated with the channel whose CJ operator is the process matrix σ, while for the remaining vertices the channels associated with them are given by the chosen local operations in the lab through the same procedure as we used the previous section for BLO-QCM ⊗ s. The generic graph for all processes would be the one where we have a directed cycle (σ, A i ) and (A i , σ) for each A i , along with an edge (A i , X i ) for every agent (see figure <ref type="figure">2</ref> for an example).</p><p>The generic graph constructed above has a high connectivity, a process where neither A nor B causally influence the other would also be mapped to the same graph where the lack of causal influence between the parties cannot be discerned from the graphical representation alone. This implies that the model is unfaithful: the graph shows connectivity although we will observe independences in the joint probability distribution. There is scope to employ additional procedures to fine-grain the σ vertex of this graph into multiple vertices and thereby fine-grain the causal model (while preserving the overall behaviour of the channel σ) to discern more information on the causal structure. For instance such a notion of σ</p><formula xml:id="formula_305">A O B O A I B I M A x|a M B y|b σ M A a E x M B b E y B O A I B I A O σ M A a M B b E x E y A I A O B I B O Figure 2:</formula><p>On the top left is an example of bipartite process matrix <ref type="bibr" target="#b42">[OCB12,</ref><ref type="bibr" target="#b12">CDPV13]</ref>. Here, the joint probabilities of two agents obtaining outcomes x and y conditioned on inputs a and b is associated with the local operations M A x|a and M B y|b of the two agents. The process σ describes the global behaviour of the protocol and defines the information-flow between the local operations. On the top right, the process is equivalently viewed in terms of a network formed by the loop composition of the process map σ with the local operations of the agents as shown on the top right, where we have modelled the classical outcomes explicitly in terms of an additional system on which the corresponding POVM acts. The top two figures are adapted from Figure <ref type="figure">9</ref> of <ref type="bibr" target="#b56">[VR24a]</ref>. The bottom figure shows the causal graph corresponding to the cyclic causal model (definition 2) specified by the top right cyclic network). Here, the process and each local operation correspond to unobserved nodes with quantum in and output edges while the outcomes correspond to observed classical nodes.</p><p>fine-graining for causal networks has been formally developed in <ref type="bibr" target="#b56">[VR24a,</ref><ref type="bibr" target="#b57">VR24b]</ref>. Finegraining has the potential to transform cyclic into acyclic causal models <ref type="bibr" target="#b56">[VR24a,</ref><ref type="bibr" target="#b57">VR24b]</ref> as well as unfaithful into faithful causal models <ref type="bibr" target="#b27">[GV24]</ref> while preserving the overall action of the channels involved. We leave an exploration of fine-graining in the context of causal inference in cyclic quantum causal models for future work.</p><p>C Functional causal models and connection with <ref type="bibr" target="#b20">[FGV25]</ref> In a related work <ref type="bibr" target="#b20">[FGV25]</ref>, we define the probability rule for arbitrary cyclic functional causal models. There, we use the same ideas of mapping a functional models on a cyclic graph to a functional causal model on an acyclic graph with post-selection, making use of a classical analogue of post-selected teleportation. For further details on the classical framework see <ref type="bibr" target="#b20">[FGV25]</ref>. In this section, we show that classical functional models can be embedded in our quantum causal modelling framework and prove that the probability rule given in definition 12 of <ref type="bibr" target="#b20">[FGV25]</ref> is equivalent to definition 12 applied to the embedded casual model. First, we briefly review functional causal models. Then, we define a mapping from functional causal models to causal models (definition 2). Finally, we prove consistency between the results of <ref type="bibr" target="#b20">[FGV25]</ref> and the quantum formalism presented here.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.1 Review of functional models</head><p>Classical causal models <ref type="bibr" target="#b45">[Pea09]</ref>, also known as functional or structural causal models, describe how variables are related to each other through deterministic functions and are used for classical causal inference between classical random variables. The general definition of functional causal models allows for continuous variables. However, in what follows we restrict the discussion to finite random variables. Therefore, all functional causal models considered in this section belong to the subset fCM finite (see figure <ref type="figure" target="#fig_5">1</ref>). For brevity, we denote a finite functional causal model on a graph G as fCm G .</p><p>Definition 32 (Finite functional causal model). Given a directed graph G = (V, E), a finite functional model (fCm G ) is given by associating the following specifications to each vertex v ∈ V : 1. A random variable X v taking values x v from a non-empty finite set X v . We will use a notation where if V ′ ⊆ V is a non-empty subset of vertices,</p><formula xml:id="formula_306">X V ′ = v∈V ′ X v (<label>130</label></formula><formula xml:id="formula_307">)</formula><p>where here denotes the Cartesian product.</p><p>2. An error random variable U v taking values u v from a finite set U v , distributed as</p><formula xml:id="formula_308">p v : U v → [0, 1]. 3. A function f v : X Pa(v) × U v → X v .</formula><p>In literature, the probability is considered to be well-defined for all functional models on acyclic graphs <ref type="bibr" target="#b45">[Pea09]</ref> and for a restricted set of cyclic functional models <ref type="bibr" target="#b22">[FM17,</ref><ref type="bibr" target="#b7">BFPM21]</ref>. In definition 12 of <ref type="bibr" target="#b20">[FGV25]</ref>, we provided a probability rule over the vertices of any -except for a handful of pathological cases -cyclic functional models. In the special case of acyclic models, the probability is defined as follows in the literature (and recovered by the general rule of <ref type="bibr" target="#b20">[FGV25]</ref>).</p><p>Definition 33 (Probability distribution of an acyclic functional model). Consider a functional model fCm G on an acyclic graph G = (V, E) and a global observed event x := {x v ∈ X v } v∈V . The probability Pr f,acyc (x) G ∈ [0, 1] is defined as</p><formula xml:id="formula_309">Pr f,acyc (x) G = u v∈V p v (u v )δ xv,f v (x Pa(v) ,uv) , (<label>131</label></formula><formula xml:id="formula_310">)</formula><p>where the sum u runs over u = {u v ∈ U v } v∈V .</p><p>If a subset of vertices is unobserved, the distribution over the remaining observed vertices is obtained through marginalising definition 33 over the unobserved variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.2 Mapping a functional model to a causal model</head><p>Classical systems are naturally embedded into quantum mechanical systems. Indeed, they correspond to systems whose state belongs to a subset of density operators, namely states which are diagonal in a given fixed basis, the so-called computational basis. Classical causal modelling, involving classical states and functional causal mechanisms is also naturally embedded into quantum causal modelling. In this section, we define a map from functional causal models to causal models which preserves the acyclic probability definition 33 through definition 3.</p><p>Causal graph. Functional models are defined over graphs, not causal graphs. Hence, we first need to define causal graphs associated to functional models. Since these involve classical random variables, all edges of the causal graph are classical. Without loss of generality, we consider all vertices to be observed. If some vertices are unobserved, the probability distribution over the remaining ones is obtained though marginalising the joint distribution over the unobserved variables. Hence, it is not restrictive to consider all vertices as observed and eventually marginalise over unobserved ones.</p><p>Definition 34 (Causal graph of a functional model). Given a functional model on a directed graph G = (V, E), we define a causal graph by decorating G such that all vertices are observed, V = V o , and all edges are classical, E = E cl . Hence, all edges of the graph are represented as , and all vertices are represented as v .</p><p>Notice that the outgoing edges of an observed vertex are necessarily classical, since all edges are classical, which proves that definition 34 gives a well-defined causal graph.</p><p>Causal model. Mapping a functional causal model to a causal model as in definition 2, involves describing classical objects, such as random variables and functional dependencies, as quantum ones. Recall that, given a finite set X , we associate to it a finite dimensional Hilbert space, such that dim(H(X )) = |X | and label the elements of an orthonormal basis of H(X ) as |x⟩ for x ∈ X , i.e.,</p><formula xml:id="formula_311">H(X ) = span { |x⟩ | x ∈ X } .</formula><p>This allows us to describe classical random variables. In addition, functional dependencies can be described using quantum channels as follows.</p><p>Definition 35. Let us consider a function f : Y → X , where X and Y are finite sets. We define a POVM</p><formula xml:id="formula_312">E f = {E f x } x∈X ⊆ L (H(Y)) , as E f x = y∈Y δ x,f (y) |y⟩⟨y|. (<label>132</label></formula><formula xml:id="formula_313">)</formula><p>For all functions f : Y → X , we have </p><formula xml:id="formula_314">Tr E f x |y⟩⟨y| = δ x,f (y) . (<label>133</label></formula><formula xml:id="formula_315">σ v = uv∈Uv p v (u v )|u v ⟩⟨u v | H(Uv) ;<label>(135)</label></formula><p>3. To each vertex v ∈ V associate the finite set X v as outcome set; 4. To each vertex v ∈ V associate the set of CP maps</p><formula xml:id="formula_316">M v x : L H In(v) → L H Out(v) x∈Xv (<label>136</label></formula><formula xml:id="formula_317">)</formula><p>defined as follows: for all ρ ∈ L(H In(v) ),</p><formula xml:id="formula_318">M v x (ρ) = Tr E f v x (ρ ⊗ σ v ) e∈Out(v) |x⟩⟨x| He , (<label>137</label></formula><formula xml:id="formula_319">)</formula><p>where {E f v x } x∈Xv is the POVM obtained through applying definition 35 to the function</p><formula xml:id="formula_320">f v : X Pa(v) × U v → X v and σ v is defined in equation (135).</formula><p>The following lemma proves that given an acyclic functional causal model fCm G , the probability distribution evaluated using definition 33 equals the probability distribution of the image causal model (definition 36), Cm(fCm) G evaluated using definition 3.</p><p>Lemma 37 (Equivalence of ayclic probabilities under definition 36). Consider a functional model on a directed and acyclic graph G = (V, E), fCm G , and its image under the mapping of definition 36, Cm(fCm) G . Let x := {x v ∈ X v } v∈V be a joint observed event, then we have:</p><formula xml:id="formula_321">Pr f,acyc (x) G = Pr acyc (x) G , (<label>138</label></formula><formula xml:id="formula_322">)</formula><p>where Pr f,acycG is the acyclic probability distribution of fCm G , evaluated with definition 33, and Pr acycG the acyclic probability distribution of Cm(fCm) G , evaluated using definition 3.</p><p>Proof. For all v ∈ V , let us consider the action of M v xv on states of the form</p><formula xml:id="formula_323">|x Pa(v) ⟩⟨x Pa(v) | := v ′ ∈Pa(v) |x v ′ ⟩⟨x v ′ |,<label>(139)</label></formula><p>where x v ′ ∈ X v ′ for all v ′ ∈ Pa(v). Using equation ( <ref type="formula" target="#formula_314">133</ref>) and linearity of the trace, we have</p><formula xml:id="formula_324">M v xv |x Pa(v) ⟩⟨x Pa(v) | = uv∈Uv p v (u v )δ xv,f v (x Pa(v) ,uv) e∈Out(v) |x v ⟩⟨x v | He . (<label>140</label></formula><formula xml:id="formula_325">)</formula><p>The maps associated to vertices are composed according to the graph connectivity (see definition 3 for more details) taking as input 1 ∈ C. In addition, the output of any CP map M v x is always decohered in the basis specified by the values of x v (this is always the case for maps associated to observed vertices). Thus, the input of all maps is always of the form considered in equation ( <ref type="formula" target="#formula_324">140</ref>), up to a constant factor. Since the graph is finite and acyclic, the output of the maps composition will eventually be in C. By linearity and because of trace-preservation, such composition will equal the product of the proportionality factors mentioned above, i.e., uv p v (u v )δ xv,f v (x Pa(v) ,uv) for each v ∈ V .</p><p>Thus, applying definition 3 gives</p><formula xml:id="formula_326">Pr(x) G = ⃝ v∈V M v xv = v∈V uv∈Uv p v (u v )δ xv,f v (x Pa(v) ,uv) = u V v∈V p v (u v )δ xv,f v (x Pa(v) ,uv) = Pr f,acyc (x) G , (<label>141</label></formula><formula xml:id="formula_327">)</formula><p>where the sum u V runs over u V = {u v ∈ U v } v∈V and x = {x v } v∈V . Thus proving the equivalence of this definition and definition 33.</p><p>Remark. We described functional models within our framework as causal models on a causal graph having only observed vertices. In the functional modelling literature, if a vertex is unobserved the probability distribution over the remaining ones is obtained through marginalising the joint distribution. Within our framework, unobserved variables can be naturally represented as unobserved vertices of the causal graph. Consider a functional model as in definition 32, and assume that a subset of vertices are unobserved, V u ⊆ V . Then, we associate to this graph a causal graph where all edges are classical, E = E cl , the unobserved vertices are V u and the observed are</p><formula xml:id="formula_328">V o = V \ V u .</formula><p>We define a causal model on this causal graph by preserving the same associations of definition 36 to edges, observed vertices v ∈ V o and all error variables. However, to each unobserved vertex v ∈ V u , we associate the CPTP map such that, for all ρ ∈ L(H In(v) ),</p><formula xml:id="formula_329">E v (ρ) = x∈Xv M v x (ρ) = x∈Xv Tr E f v x (ρ ⊗ σ v ) e∈Out(v) |x⟩⟨x| He , (<label>142</label></formula><formula xml:id="formula_330">)</formula><p>where ρ v x and M v x are as in definition 36. The probability distribution of this causal model, evaluated through definition 3, gives for all</p><formula xml:id="formula_331">x = {x v ∈ X v } v∈V Pr acyc ({x v } v∈Vo ) G = ⃝ v∈Vo M v xv ⃝ v ′ ∈Vu E v ′ = {xv} v∈Vu ⃝ v∈V M v xv = {xv} v∈Vu Pr f,acyc (x) G = Pr f,acyc ({x v } v∈Vo ) G . (<label>143</label></formula><formula xml:id="formula_332">)</formula><p>where the sum runs over {x v ∈ X v } v∈Vu . Therefore, the distribution of the causal model which accounts for unobserved vertices in the causal graph is equal to the distribution obtained through marginalising definition 33 over variables associated to unobserved vertices.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.3 Equivalence of p-separation definitions</head><p>In a companion paper <ref type="bibr" target="#b20">[FGV25]</ref>, we provide a causal modelling framework for cyclic classical causal models. This follows the same ideas of this work in mapping a given cyclic functional model to a family of acyclic models with post-selections. However, the mapping in section 3 of <ref type="bibr" target="#b20">[FGV25]</ref> is constructed on a slightly different family of acyclic graphs which simplifies the mapping in the classical case without relying on the quantum notation and formalism used in this paper<ref type="foot" target="#foot_17">foot_17</ref> . The graph family of definition 6 plays a crucial role in defining p-separation (definition 21), while in <ref type="bibr" target="#b20">[FGV25]</ref>, p-separation defined with respect to this slightly modified family. Here, we show that the two definitions of p-separation, which only depend on the graph, are equivalent. Let us first comment on the two different graph families.</p><p>One graph, two acyclic families. Given a (causal) graph G, we constructed a family of acyclic causal graph as in definition 6. This is denoted as G tp (G), and defined above.</p><p>For completeness, let us repeat the definition of G tp (G).</p><p>Definition 6 (Family of acyclic causal graphs G tp (G)). Given a causal graph G = (V, E), we define an associated family G tp (G) of directed acyclic causal graphs, where each element G tp ∈ G tp (G) is obtained from the causal graph G as follows. G tp constructed in this manner is thus a causal graph. It will be useful to refer to T i and R i as pre and post-selection vertices respectively and depict them with distinct vertex styles T i and R i , as these will play a special role in our framework. This makes G tp identical to G up to replacing each split edge</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Choose any subgraph G</head><formula xml:id="formula_333">′ := (V ′ , E ′ ) of G = (V, E) with V ′ = V and E ′ ⊆ E, such that G ′ is acyclic. 2.</formula><formula xml:id="formula_334">(v i , v ′ i ) ∈ E s (G tp ) ⊆ E with the following structure: v i v ′ i R i T i (R i , T i ) (v i , T i ) (R i , v ′ i ) (<label>47</label></formula><formula xml:id="formula_335">)</formula><p>We will refer to every G tp ∈ G tp (G) as a teleportation graph, as we will later associate teleportation protocols to such graphs. It will be useful to denote the set of all post-selection vertices and the set of all pre-selection vertices in G tp as</p><formula xml:id="formula_336">V post := {T i } (v i ,v ′ i )∈Es(Gtp) and V pre := {R i } (v i ,v ′ i )∈Es(Gtp) .</formula><p>From the same underlying graph G, in definition 7 of <ref type="bibr" target="#b20">[FGV25]</ref> we introduce a different family of acyclic graphs. We provide the definition of this family, which is denoted as G c,tp (G), here.</p><p>Definition 38 (Family of acyclic classical teleportation graphs G c,tp (G)). Given a directed graph G = (V, E), we define an associated family G c,tp (G) of acyclic graphs, where each element G c,tp ∈ G c,tp (G) is obtained from the graph G as follows.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Choose any subset of vertices</head><formula xml:id="formula_337">V s (G c,tp ) ⊆ V , such that the subgraph G ′ = (V ′ , E ′ ) of G with V ′ = V and E ′ = E \ v∈Vs(Gc,tp) Out(v) is acyclic. We refer to V s (G c,tp ) as the split vertices of G c,tp . 2. The vertices V c,tp of G c,tp consist of the vertices V of the original graph G together with new vertices R v , T v for each split vertex v ∈ V s (G c,tp ), i.e., V c,tp = V ∪ {R v } v∈Vs(Gc,tp) ∪ {T v } v∈Vs(Gc,tp) . (<label>144</label></formula><formula xml:id="formula_338">)</formula><p>3. The edges E c,tp of G c,tp consist of the edges E ′ of the subgraph G ′ together with the following new edges:</p><formula xml:id="formula_339">E c,tp = E ′ ∪ {(v, T v )} v∈Vs(Gc,tp) ∪ {(R v , T v )} v∈Vs(Gc,tp) ∪ {(R v , v ′ )} v∈Vs(Gc,tp),v ′ ∈Ch(v) G , (<label>145</label></formula><formula xml:id="formula_340">)</formula><p>where Ch(v) G refers to the children vertices of v in the graph G.</p><p>For each v ∈ V s (G c,tp ), we refer to the vertices R v and T v as pre-and post-selection vertices respectively and depict them with distinct vertex styles T v and R v , as these will play a special role in our framework. This construction makes G c,tp identical to G up to replacing all vertices v ∈ V s (G c,tp ) with the following structure v ... ... Definition 6 is formulated in terms of causal graphs while definition 38 is not. However, we can equivalently consider a causal graph where all vertices are observed in definition 38 (consistently with the notation used in equation ( <ref type="formula" target="#formula_341">146</ref>))and compare the two definitions.</p><formula xml:id="formula_341">Pa(v) Ch(v) → v R v ... ... Pa(v) G Ch(v) G T v . (<label>146</label></formula><p>With this in mind, the family of acyclic graphs of definition 38 is constructed in a similar way to the family of acyclic teleportation graphs in definition 6. Specifically, both definitions involve considering an acyclic subgraph of G. The subgraphs that are used to construct definition 38 are a subset of those considered for definition 6. Indeed, in the latter, one can remove any subset of edges from G to make graph acyclic, while in definition 38 one removes all outgoing edges from a subset of vertices V s (G c,tp ). In addition, in the classical case all outgoing edges are jointly substituted with one pair of pre-and postselection vertices, while, in the teleportation graph family of definition 6, each split edge is associated to a pair of pre-and post-selection vertices.</p><p>To understand the difference between these two families, consider the cyclic graph, G eg , and its subgraphs, G ′ eg and G ′′ eg .</p><formula xml:id="formula_342">G eg = A B C , G ′ eg = A B C , G ′′ eg = A B C (<label>147</label></formula><formula xml:id="formula_343">)</formula><p>The acyclic sugraph G ′ eg is a valid acyclic subraph for both definitions 6 and 38, respectively with set of split edges E s (G ′ eg ) = {(A, B), (A, C)} and split vertices V s (G eg ) = {A}. While, the acyclic subgraph G ′′ eg , which has set of split edges E s (G ′′ eg ) = {(A, B), (C, A)}, is not valid for definition 38.</p><p>The member of the families in definitions 6 and 38 constructed from G ′ eg , are, respectively,</p><formula xml:id="formula_344">G tp = A B C R 1 R 2 T 1 T 2 and G c,tp = A B C R T (<label>148</label></formula><formula xml:id="formula_345">)</formula><p>which differ in the amount of pre-and post-selection vertices. Such difference reflects the fact that each vertex of a functional model broadcasts its value to all its children, thus allowing for simplification compared to the quantum definition.</p><p>Equivalence of p-separation definitions. Let us now show that p-separation can be equivalently defined using either of these graph families. This result is necessary to establish consistency of the present work with the results of <ref type="bibr" target="#b20">[FGV25]</ref>. First we recall the two definitions of p-separation by repeating the definition given in section 5 and in <ref type="bibr" target="#b20">[FGV25]</ref>.</p><p>Definition 21 (p-separation). Let G be a directed graph and V 1 , V 2 and V 3 denote any three disjoint subsets of the vertices of G with V 1 and V 2 being non-empty. Then, we say </p><formula xml:id="formula_346">that V 1 is p-separated from V 2 given V 3 in G, denoted (V 1 ⊥ p V 2 |V 3 ) G , if and only if there exists G tp ∈ G tp (G) (definition 6) such that (V 1 ⊥ d V 2 |V 3 ∪ V post ) Gtp ,</formula><formula xml:id="formula_347">G tp ∈ G tp (G). Otherwise, we say that V 1 is p-connected to V 2 given V 3 in G, and we denote it (V 1 ̸ ⊥ p V 2 |V 3 ) G . To summarize, p-separation: (V 1 ⊥ p V 2 |V 3 ) G ⇐⇒ ∃G tp ∈ G tp (G) : (V 1 ⊥ d V 2 |V 3 ∪ V post ) Gtp , p-connection: (V 1 ̸ ⊥ p V 2 |V 3 ) G ⇐⇒ ∀G tp ∈ G tp (G) : (V 1 ̸ ⊥ d V 2 |V 3 ∪ V post ) Gtp . (<label>75</label></formula><formula xml:id="formula_348">) (⊥ p =⇒ ⊥ p,c ): If (V 1 ⊥ p V 2 |V 3 ) G , then there exists G tp ∈ G tp (G) such that (V 1 ⊥ d V 2 |V 3 ∪ V post )</formula><p>Gtp where V post denotes the set of all post-selection vertices in G tp (definition 21).</p><p>Let E s (G tp ) be the set of split edges of G tp and define</p><formula xml:id="formula_349">V s (G c,tp ) := {v ∈ V s.t. ∃e = (v, v ′ ) ∈ E s (G tp )}. (152) Consider the graph G ′ tp ∈ G tp (G) such that E s (G ′ tp ) = v∈Vs(Gc,tp) Out(v). We want to prove that (V 1 ⊥ d V 2 |V 3 ∪ V ′ post ) G ′ tp , where V ′ post denotes the set of post-selection vertices in G ′ tp . Let us consider v 1 ∈ V 1 and v 2 ∈ V 2 , if these are d-separated conditioned on v 3 , V post in G tp ,</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>then one of the following conditions is satisfied:</head><p>• There is no path (even undirected) between v 1 and v 2 in G tp . G ′ tp can be obtained through substituting some edges of G tp with a pre-and post-selection edges and vertices. Such substitution does not create new paths, hence there is also no path between v 1 and v 2 in G ′ tp . • All paths between v 1 and v 2 are blocked by V 3 ∪ V post . Hence, for each path in G tp , one of the following holds:</p><p>• There exists W ∈ V 3 ∪ V post such that A ← W → B for some A and B in the path. Adding pre and post-selection edges and vertices does not change the path, hence, the difference between G tp and G ′ tp is that some edges of the path might be substituted with such vertices and edges. If this substitution does not involve the subgraph A ← W → B, then the same W blocks the path in</p><formula xml:id="formula_350">G ′ tp . If the edge A ← W is substituted, we have A ← Q → P ← W → B. Since, the path between v 1 and v 2 contains P ← W → B and W ∈ V 3 ∪ V ′ post , then the path is blocked in G ′</formula><p>tp . The same considerations hold if the edge W → B is substituted.</p><p>• There exists W ∈ V 3 ∪ V post such that A → W → B for some A and B in the path. Adding pre and post-selection edges and vertices does not change the path, hence, the difference between G tp and G ′ tp is that some edges of the path might be substituted with a teleportation subgraph. If this substitution does not involve the subgraph A → W → B, then the same vertex W blocks the path also in G ′ tp . If the edge A → W is substituted, we have</p><formula xml:id="formula_351">A → P ← Q → W → B. Since the path between v 1 and v 2 contains Q → W → B and W ∈ V 3 ∪ V ′ post , then the path is blocked in G ′</formula><p>tp . The same considerations hold if the edge W → B is substituted.</p><p>• There exists U such that A → U ← B for some A and B in the path and U nor any descendent of U are in V 3 ∪ V post . Assume first that the substitution of edges with pre and post-selection vertices and edges does not involve the subgraph A → U ← B, but that there is a descendent of U in the conditioning set, i.e., W ∈</p><formula xml:id="formula_352">V 3 ∪ V ′ post such that U A B . . . W . (<label>153</label></formula><formula xml:id="formula_353">)</formula><p>Since, U had no descendents in the set</p><formula xml:id="formula_354">W ∈ V 3 ∪ V post , W is a post-selection vertex that was not in G tp , i.e., W ∈ V ′ post \ V post . However, by construction of E s (G ′ tp ), this means that v ∈ In(W ) is also a split vertex, v ∈ V s (G c,tp ). Therefore, there exists e = (v, v ′ ) ∈ E s (G tp ). In G ′ tp we have U A B . . . . . . v W W ′ and in G tp U A B . . . . . . v . . . W ′ . (<label>154</label></formula><formula xml:id="formula_355">)</formula><p>Hence, W ′ ∈ V 3 ∪ V post and it is a descendent of U . This is not possible by hypothesis, meaning that even in G ′ tp , U has no descendents in the conditioning set. If the edge A → U is substituted, we have</p><formula xml:id="formula_356">A → P ← Q → U ← B. The path between v 1 and v 2 contains Q → U ← B, hence the path is blocked in G ′ tp . The same considerations hold if the edge U ← B is substituted. This proves that if (V 1 ⊥ d V 2 |V 3 ∪ V post ) Gtp , then (V 1 ⊥ d V 2 |V 3 ∪ V ′ post ) G ′ tp . Using equation (151) to relate G ′ tp and G c,tp , it holds that (V 1 ⊥ d V 2 |V 3 ∪ V ′ post ) G ′ tp implies (V 1 ⊥ d V 2 |V 3 ∪ V c post ) Gc,tp .</formula><p>Thus, p-separation relations of a given graph G can be equivalently deduced using definition 21 or definition 39.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.4 Equivalence of cyclic probabilities under the mapping in definition 36</head><p>In appendix C.2, we showed that applying definition 36 to map an acyclic functional model to an acyclic causal model preserves the probability distribution over observed events. In this section, we consider probabilities over cyclic functional models and show that the probability rule given in definition 12 of <ref type="bibr" target="#b20">[FGV25]</ref> is equivalent to applying the probability rule of definition 12 to the image causal models through definition 36.</p><p>Lemma 41. Consider a functional model on a directed graph G = (V, E), fCm G , and its image under the mapping of definition 36, Cm(fCm) G . Let x = {x v ∈ X v } v∈V be a joint observed event, then we have:</p><formula xml:id="formula_357">Pr f (x) G = Pr(x) G (155)</formula><p>where Pr f G is the probability distribution of fCm G evaluated with definition 12 of <ref type="bibr" target="#b20">[FGV25]</ref> and Pr G is the probability distribution given by definition 12 of Cm(fCm) G .</p><p>Proof. In the proof the following two results are used.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Lemma 42. Consider a functional model on a directed graph</head><formula xml:id="formula_358">G = (V, E) with functional dependencies f v : X Pa(v) × U v → X v , associated to each vertex v ∈ V . The maps M f v</formula><p>x obtained though definition 36, satisfy</p><formula xml:id="formula_359">D Eout • M f v x • D E in = M f v x (<label>156</label></formula><formula xml:id="formula_360">)</formula><p>for any subset of outgoing and ingoing edges to v, E out ⊆ Out(v) and Proof. Let us prove that</p><formula xml:id="formula_361">E in ⊆ In(v). The decohering channel D E ′ : L(H E ′ ) → L(H E ′ ) is defined for any subset of edges E ′ ⊆ E as D E ′ = e∈E D</formula><formula xml:id="formula_362">D e • M f v x = M f v x = M f v x • D e ′<label>(157)</label></formula><p>for any e ∈ Out(v) and e ′ ∈ In(v). Once this is proven the general results follows from iterative application of this equality. The first equality follows immediately from the form of M v x , since for all ρ ∈ L(H In(v) ), we have</p><formula xml:id="formula_363">M v x (ρ) = Tr E f v x (ρ ⊗ σ v ) e∈Out(v) |x⟩⟨x| He ,<label>(158)</label></formula><p>which is already coherence-free. The second follows from the form of E f v x and of the state σ v (see equation ( <ref type="formula" target="#formula_315">135</ref>)), indeed</p><formula xml:id="formula_364">Tr E f v x (D e ′ (ρ) ⊗ σ v ) = Tr E f v x D e ′ ∪Uv (ρ ⊗ σ v ) = Tr y δ x,f v (y) |y⟩⟨y|D ẽ( ρ) = y z δ x,f v (y) Tr (|y⟩⟨y||z⟩⟨z|ρ|z⟩⟨z|) = y δ x,f v (y) Tr (|y⟩⟨y|(ρ ⊗ σ v )) = Tr E f v x (ρ ⊗ σ v ) . (<label>159</label></formula><formula xml:id="formula_365">)</formula><p>where we denoted ẽ = e ′ ∪ U v and ρ = ρ ⊗ σ v for brevity, and the sums run over y</p><formula xml:id="formula_366">= {y v ′ ∈ X v ′ } v ′ ∈Pa(v) ∪ {u v ∈ U v } and z = {z v ′ ∈ X v ′ } v ′ ∈Pa(v) ∪ {u ′ v ∈ U v }. Lemma 43. Consider a Hilbert space H In(v) = e∈In(v) H e 22 . For any E x , ρ ∈ L H In(v)</formula><p>and E in ⊆ In(v), it holds</p><formula xml:id="formula_367">Tr [E x (D E in (ρ))] = Tr [(D E in (E x ))ρ] . (<label>160</label></formula><formula xml:id="formula_368">)</formula><p>Proof. The proof follows from the cyclicity of the trace</p><formula xml:id="formula_369">Tr [E x (D E in (ρ)] = y Tr [E x (|y⟩⟨y| E in ⊗ 1)ρ(|y⟩⟨y| E in ⊗ 1)] (161) = y Tr [(|y⟩⟨y| E in ⊗ 1)E x (|y⟩⟨y| E in ⊗ 1)ρ] = Tr [(D E in (E x ))ρ] . (<label>162</label></formula><formula xml:id="formula_370">)</formula><p>Given these two results, we can proceed with the proof.</p><p>Overview of the proof and relevant notation. The goal of this proof is to connect the probabilities of a functional causal model on a possibly cyclic graph G, namely fCm G , and those of its image causal model through the embedding definition 36, namely Cm(fCm G ) (which, for brevity, we will simply denote as Cm G in what follows). To achieve this, we define auxiliary functional models (definition 32) and causal models (definition 2). Although the idea behind the proof is straightforward, given our formalism, it involves relating a number of different causal graphs and causal models. We therefore first sketch the main steps and notation of the proof, before detailing it.</p><p>Step 0: We start considering a functional causal model on G: fCm G (definition 32).</p><p>The cyclic probability distribution for the observed event x relative to this functional model is Pr f (x) G (definition 12 in <ref type="bibr" target="#b20">[FGV25]</ref>).</p><p>Step 1: We define a classical teleportation causal model on a teleportation graph G c,tp induced by fCm G : fCm Gc,tp (definition 9 of <ref type="bibr" target="#b20">[FGV25]</ref>).</p><p>Let V post be the set of post-selection vertices in G c,tp , which is acyclic by construction, and V s (G c,tp ) the set of split vertices of G c,tp . The probability distribution of the event x and successful post-selections {t v = 1} Tv∈Vpost relative to this acyclic functional model is Pr f,acyc (x, {t v = 1} Tv∈Vpost ) Gc,tp (definition 33).</p><p>By definition, the probability distribution of the cyclic model fCm G equals the conditional distribution of the acyclic model fCm Gc,tp , i.e.,</p><formula xml:id="formula_371">Pr f (x) G = Pr f,acyc (x|{t v = 1} Tv∈Vpost ) Gc,tp<label>(163)</label></formula><p>for all observed events x := {x v ∈ X v } v∈V .</p><p>Step </p><formula xml:id="formula_372">(x|{t e v = 1} T e v ∈V ′ post ) G ′ c,tp = Pr f,acyc (x|{t v = 1} Tv∈Vpost ) Gc,tp .<label>(164)</label></formula><p>Step 3: We map the acyclic functional model fCm </p><formula xml:id="formula_373">v = 1} T e v ∈V ′ post ) G ′ c,tp = Pr acyc (x, {t e v = 1} T e v ∈V ′ post ) G ′ c,tp .<label>(165)</label></formula><p>Before proceeding, let us sketch the results of the first three steps. The following diagram summarises the (functional) causal models that we introduced so far and their conditional probabilities. Each step establishes equivalence between the (conditional) distributions of these causal models.</p><formula xml:id="formula_374">fCm G fCm Gc,tp fCm G ′ c,tp Cm G ′ c,tp Pr f (x) Pr f,acyc (x|t) Pr f,acyc (x|{t e } e ) Pr acyc (x|{t e } e )</formula><p>Step 1</p><p>Step 2</p><p>Step 3</p><formula xml:id="formula_375">:= = =<label>(166)</label></formula><p>Step 4: We map the initial functional model fCm G (from Step 0) to a causal model (definition 2): Cm G (as specified by the mapping in definition 36).</p><p>The cyclic probability distribution for the observed event x relative to this causal model is Pr(x) G (definition 12).</p><p>Step Step 4</p><p>Step 5 :=</p><p>Step 6: We prove that the conditional probability distribution of the causal models Cm Combining together all the equalities established concludes the proof. The following diagram combines those of equations ( <ref type="formula" target="#formula_375">166</ref>) and (168) through Step 6.</p><formula xml:id="formula_377">fCm G fCm Gc,tp fCm G ′ c,tp Cm G ′ c,tp Pr f (x) Pr f,acyc (x|t) Pr f,acyc (x|{t e } e ) Pr acyc (x|{t e } e )</formula><p>Step 1</p><p>Step 2</p><p>Step 3</p><formula xml:id="formula_378">:= = = Cm G Cm Gtp Pr(x) Pr acyc (x|t)</formula><p>Step 4</p><p>Step 5 :=</p><p>Step 6 = (170)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Details of the proof.</head><p>In what follows, we prove in detail the results of Steps 1-6.</p><p>Step </p><formula xml:id="formula_379">Pa(v) Ch(v) → v R v ... ... Pa(v) G Ch(v) G T v . (<label>171</label></formula><formula xml:id="formula_380">)</formula><p>Then, we define a classical teleportation functional model on G c,tp through definition 9 of <ref type="bibr" target="#b20">[FGV25]</ref>. In particular, this construction prescribes that the same finite sets, functions and probabilities of the original functional model are associated to vertices and edges that are preserved from G to G c,tp . To pre-and post-selection vertices we associate uniform prior classical teleportation protocols<ref type="foot" target="#foot_20">foot_20</ref> , i.e., for all v ∈ V s (G c,tp ) we associate to the corresponding pre-selection vertex R v the finite set X Rv = X v , a uniform distribution to its error variable p Rv (u) = |X v | -1 for all u ∈ X v and a function f Rv (u) = u. Notice that this amounts to having the variable associated to pre-selection vertices R v distributed as p Rv (for more details see the remark in section 2 of <ref type="bibr" target="#b20">[FGV25]</ref>), thus in what follows we will refer to R v and its distribution. We associate to the corresponding post-selection vertex T v the finite set X Tv = {0, 1} and a (deterministic) delta function f Tv (x, y) = δ x,y for all x, y ∈ X v .</p><p>By definition 12 of <ref type="bibr" target="#b20">[FGV25]</ref>, given an observed event x := {x v ∈ X v } v∈V , the probability of fCm G is defined as</p><formula xml:id="formula_381">Pr f (x) G = Pr f,acyc x|{t T = 1} T ∈Vpost Gc,tp ,<label>(172)</label></formula><p>where V post denotes the set of post-selection vertices of G c,tp .</p><p>Step 2: We define an intermediate functional causal model over a graph G ′ c,tp , fCm Gc,tp . The graph G ′ c,tp is constructed from G c,tp through performing the following substitution of edges and vertices for</p><formula xml:id="formula_382">v ∈ V s (G c,tp ) R v T v v . . . → . . . v R e v T e v R e ′ v T e ′ v . (<label>173</label></formula><formula xml:id="formula_383">)</formula><p>This substitution is motivated by equation 20 of <ref type="bibr" target="#b20">[FGV25]</ref> which proves that n copies of a classical teleportation protocol (on the right) are equivalent to one classical teleportation protocol which is broadcast to n parties (on the left). For each split vertex v ∈ V s (G c,tp ) and each outgoing edge e ∈ Out(v), let us denote with R e v and T e v the pre-and post-selection vertices in G ′ c,tp associated to the outgoing edge e of v (see equation ( <ref type="formula" target="#formula_382">173</ref>)). Let us denote with V ′ post the set of post-selection vertices of G ′ c,tp . We define a functional causal model over G ′ c,tp , fCm G ′ c,tp , as follows: 1. To each vertex present in both G c,tp and G ′ c,tp assign the same finite set, functional dependency (for endogenous vertices) or probability (for exogenous vertices), of the causal model fCm Gc,tp 24 .</p><p>2. For all v ∈ V s (G c,tp ) and e ∈ Out(v), associate to R e v the finite set X R e v = X v and a uniform distribution to its error variable p R e v (u) = |X v | -1 for all u ∈ X v and a function f R e v (u) = u. Notice that this amounts to having the variable associated to pre-selection vertices R e v uniformly distributed (for more details see the remark in section 2 of <ref type="bibr" target="#b20">[FGV25]</ref>).</p><p>3. For all v ∈ V s (G c,tp ) and e ∈ Out(v), associate to T e v the finite set X T e v = {0, 1} and a (deterministic) delta function f T e v (x, y) = δ x,y for all x, y ∈ X v .</p><p>Hence, each outgoing edge from a vertex v ∈ V s (G c,tp ) in G has been replaced with a uniform prior classical teleportation protocol (definition 6 in <ref type="bibr" target="#b20">[FGV25]</ref>).</p><p>Since this model is acyclic, we can use the acyclic probability rule (definition 33) to evaluate probabilities. The equivalence between broadcasting a classical teleportation protocol to n parties and n copies of the same classical teleportation protocol (established in equation 20 of <ref type="bibr" target="#b20">[FGV25]</ref>) implies that</p><formula xml:id="formula_384">Pr f,acyc (x|{t e v = 1} T e v ∈V ′ post ) G ′ c,tp = Pr f,acyc (x|{t v = 1} Tv∈Vpost ) Gc,tp ,<label>(174)</label></formula><p>i.e., probabilities in fCm Gc,tp and fCm G ′ c,tp , conditioned on all post-selections being successful, are equal. Notice that the variables associated to pre-selection vertices are considered unobserved.</p><p>Step 3: We map the acyclic functional causal model fCm G ′ c,tp to a causal model using definition 36, Cm G ′ c,tp . As prescribed by the mapping, G ′ c,tp is decorated to form a causal graph whose edges are all classical. In addition, we consider the pre-selection vertices V ′ pre to be unobserved 25 and the remaining ones, V ∪ V ′ post to be observed. The associations prescribed by the mapping in definition 36 together with the specific form of uniform prior teleportation protocols, give the following assignments: 1. To each vertex that is present in both G and G ′ c,tp , i.e., v ∈ V , we associate the set of CP maps acting on ρ ∈ L(H In(v) )</p><formula xml:id="formula_385">M v x (ρ) = Tr E f v x (ρ ⊗ σ v ) e∈Out(v)</formula><p>|x⟩⟨x| He (175)</p><p>where {E f v x } x∈Xv is the POVM obtained through applying definition 35 to the function f v associated to v in the original functional model fCm G and σ v is the state associated to the error variable (see equation (135)).</p><p>24 By construction, these are also the same association of the original causal model fCmG on G. 25 In definition 34, all vertices are considered observed. In what follows, pre-selection vertices are always marginalised, hence unobserved. In the remark of appendix C.2, we showed that in this case we can consider such vertices unobserved and modify the associated maps and states. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D Proofs of section 4</head><p>Lemma 7 (Acyclicity of teleportation graphs). Each directed graph G tp obtained from a directed graph G as described in definition 6 is acyclic.</p><p>Proof. In the first step of definition 6, the graph G ′ is acyclic. The second step introduces pre-and post-selection vertices, R i and T i , and associated edges according to equation (47). To show that this step preserves acyclicity, notice that a directed graph is acyclic if and only if it can be drawn on a page with all directed edges oriented from bottom to top of the page<ref type="foot" target="#foot_21">foot_21</ref> . Since G ′ is acyclic, we can represent it on a page through such a diagram. We now add the pre-and post-selection vertices to this diagram by drawing all the R i at the bottom of the page, below all other vertices, and all the T i at the top of the page, above all the other vertices. Since all pre-selection vertices R i only have outgoing edges and all post-selection vertices T i only have incoming arrows, both of which will be oriented from bottom to top in our diagram, it follows that G tp is acyclic.</p><p>Proposition 10 (Equivalent probabilities from different teleportation graphs). Let Cm G be a causal model on a causal graph G, and let V o ⊆ V be the set of all observed vertices of G. Consider any G tp,1 , G tp,2 ∈ G tp (G), and for i ∈ {1, 2}, let Cm Gtp ,i be a causal model on the teleportation graph G tp,i that is associated to Cm G (definition 8). Then, we have Proof. Proof in a special case. Consider the special case where G tp,1 and G tp,2 were constructed by choosing</p><formula xml:id="formula_386">E s (G tp,2 ) = E s (G tp,1 ) ∪ {e 0 },<label>(195)</label></formula><p>i.e., G tp,2 splits the same edges as G tp,1 plus the edge e 0 . Let V 1 post denote the set of postselection vertices of G tp,1 and t := {t i ∈ {✓, ✗}} T i ∈V 1 post . Then, taking t 0 to be the outcome of the post-selection vertex associated to the edge e 0 , we have t∪t 0 := {t i ∈ {✓, ✗}} T i ∈V 2 post . Consider the probability Pr(x, t) Gtp ,1 associated to the causal model Cm Gtp ,1 on the causal graph underlying the teleportation graph G tp,1 . As this is an acyclic causal model by construction (c.f., lemma 7), this probability is immediately given by applying the acyclic probability rule of definition 3 to this causal model. Here, x = {x v ∈ X v } v∈Vo denotes an observed event on G tp,1 (which is also an event on G tp,2 , since these graphs have the same observed vertices). We can write Pr(x, t) Gtp ,1 = Tr[F (x,t) ρ (x,t) ], <ref type="bibr">(196)</ref> where we defined the subnormalized density matrix and POVM element ρ (x,t) , F (x,t) ∈ L(H e 0 ) obtained from composing all the channels of the causal model Cm Gtp ,1 , but leaving the composition along the e 0 edge as the last step. <ref type="foot" target="#foot_22">27</ref> We then consider the post-selected teleportation protocol that the causal model Cm Gtp ,2 implements in place of the edge e 0 =: (v 0 , v ′ 0 ), with associated pre-and post-selection vertices R 0 and T 0 . The associated teleportation probability is denoted p tp ∈ (0, 1]. For convenience, we label as A, B and C the Hilbert spaces involve in this teleportation protocol:</p><formula xml:id="formula_387">H A = H (v 0 ,T 0 ) , H B = H (R 0 ,T 0 ) , H C = H (R 0 ,v ′ 0 ) . (<label>197</label></formula><formula xml:id="formula_388">)</formula><p>This allows us to denote the post-selected teleportation implementation as (E AB , φ BC ).</p><p>Visually, the situation is as follows:</p><p>G tp,1 :  <ref type="bibr">(198)</ref> where Pr(x, t, t 0 ) Gtp ,2 denotes the probabilities associated to the causal model Cm Gtp ,2 on the causal graph underlying the teleportation graph G tp,2 . In the last equation, we used that Cm Gtp ,1 and Cm Gtp ,2 can be chosen to have the same associated ρ (x,t) and F (x,t) (to see this, one may for simplicity restrict all the post-selected teleportation protocols to be implemented as in definition 5 -if we establish proposition 10 in this case, the general result follows from corollary 16). We can now relate the success probability p where the sum x runs over all x = {x v ∈ X v } v∈Vo , and where we denote with t = ✓ the event {t i = ✓} T i ∈V 1 post . We see that the two success probabilities differ by a multiplicative constant (the success probability p tp of the post-selected teleportation protocol defined by Cm Gtp ,2 for the split edge e 0 ), and hence, p  ) and e ′ i := (R i , v ′ i ). Suppose that the cardinality of the split edges set E s (G tp ) is k, then we have the edges {e 1 , . . . , e k } and {e ′ 1 , . . . , e ′ k } defined as above. We let a joint observed event associated with V o be denoted as x := {x v ∈ X v } v∈Vo , and define the collection of CP maps</p><formula xml:id="formula_389">ρ (x,</formula><formula xml:id="formula_390">C x : L k i=1 H e ′ i → L k i=1 H e i x (<label>55</label></formula><formula xml:id="formula_391">)</formula><p>through</p><formula xml:id="formula_392">C x = ⃝ v∈Vo M v xv ⃝ u∈Vu E u , (<label>56</label></formula><formula xml:id="formula_393">)</formula><p>where M v xv and E u refer to the maps of the causal model Cm G (see definition 2), and where the composition rule is dictated by the acyclic subgraph G ′ of G which is used in definition 6 to construct G tp <ref type="foot" target="#foot_23">28</ref> . It holds that the success probability p ✓ and the probabilities Pr(x) G of definition 12, defined if and only if p ✓ ̸ = 0, satisfy</p><formula xml:id="formula_394">p ✓ = k i=1 p (i) tp x cycle(C x ), Pr(x) G = cycle(C x ) x cycle(C x ) , (<label>57</label></formula><formula xml:id="formula_395">)</formula><p>where the cycle operation was introduced in definition 13 and p</p><formula xml:id="formula_396">(i)</formula><p>tp is the teleportation probability associated to the post-selected teleportation protocol implemented by the vertices R i and T i (definition 8).</p><p>Proof. We start by considering a teleportation graph G tp ∈ G tp (G) associated with our given graph G, and the causal model Cm Gtp on the teleportation graph G tp , associated with a set V post := {T i } k i=1 of post-selection vertices.</p><p>The associated probability distribution Pr(x, {t i = ✓} T i ∈Vpost ) Gtp is then given by definition 3 since Cm Gtp is an acyclic causal model by construction (as G tp is a directed acyclic graph, lemma 7).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Pr(x, {t</head><formula xml:id="formula_397">i = ✓} T i ∈Vpost ) Gtp = Tr k i=1 E (i) C x k i=1 φ (i) , (<label>203</label></formula><formula xml:id="formula_398">)</formula><p>where the state i φ (i) acts on i H (R i ,T i ) ⊗ H e ′ i , and consists of the tensor product of the pre-selection states of each post-selected teleportation protocol. The POVM element E (i) acts on i H (R i ,T i ) ⊗ H e i and consists of the tensor product of the post-selection POVM elements of each post-selected teleportation protocol. Recall that the map C x takes inputs in L( i H e ′ i ) and outputs in L( i H e i ). Let us define the following Hilbert spaces:</p><formula xml:id="formula_399">H A = k i=1 H e i , H B = k i=1 H (R i ,T i ) , H C = k i=1 H e ′ i . (<label>204</label></formula><formula xml:id="formula_400">)</formula><p>By construction (definition 8), we have that H e i = H e ′ i , so that we also have H A = H C . We denote E AB = k i=1 E (i) and φ BC = k i=1 φ (i) , and we denote the map C x as (C x ) A|C . The probabilities of equation ( <ref type="formula" target="#formula_397">203</ref>) can be rewritten as Pr(x,</p><formula xml:id="formula_401">{t i = ✓} T i ∈Vpost ) Gtp = Tr AB [E AB (C x ) A|C (φ BC )].<label>(205)</label></formula><p>It is easy to prove that (E AB , φ BC ) implements a post-selected teleportation protocol. Indeed, this follows from the linearity of the post-selected teleportation condition equation (45), which allows to successfully teleport part of a multipartite state (see also lemma 25), together with the fact that (E AB , φ BC ) corresponds to k parallel independent post-selected teleportation protocols. Furthermore, it is easy to see that the teleportation success probability of (E AB , φ BC ) is the product of the individual teleportation probabilities. Using lemma 28, we see that the probabilities of equation ( <ref type="formula" target="#formula_401">205</ref> </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E Proofs of section 5</head><p>Theorem 22 (p-separation theorem). Consider a directed graph G and let V 1 , V 2 and V 3 be any three disjoint sets of the vertices of G with V 1 and V 2 being non-empty. Then, the following holds:</p><p>(Soundness) For any causal model Cm G on G where the sets V i are observed, we have that p-separation between the vertex sets V i implies conditional independence for the corresponding sets of random variables X i := {X v } v∈V i where i ∈ {1, 2, 3}, i.e.,</p><formula xml:id="formula_402">(V 1 ⊥ p V 2 |V 3 ) G =⇒ (X 1 ⊥ ⊥ X 2 |X 3 ) Pr G . (<label>76)</label></formula></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><label></label><figDesc>and D e : L(H e ) → L(H e ) is a decohering channel acting as D e (ρ) = x∈Xe |x⟩⟨x|ρ|x⟩⟨x|.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>where e ′ = (L, B) is the edge going from L to B. Finally, the vertex B has an associated POVM {E B b ∈ L(H e ′ )} b∈X B , and an associated set of CP maps {M B b :</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>where ⊥ d denotes d-separation and V post denotes the set of all post-selection vertices in the teleportation graph</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><label></label><figDesc>If we consider a teleportation graph G tp ∈ G tp (G) where the edge C → D does not receive any post-selection vertices, then (A ⊥ d B|V post ) G max tp will still hold. Therefore, by definition 21, (A ⊥ p B) G holds in this case.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><label></label><figDesc>position for a map with inputs A and C, and outputs B and D allows part of the output (say C) to be connected to part of the input (say B) to result in a new a map from A to D. Then sequential composition of first applying M1 : L(HA) → L(HB) and then M2 : L(HC ) → L(HD) (with HB ∼ = HC ) is equivalent to loop composition of C to C in M1 ⊗ M2 : L(HA) ⊗ L(HC ) → L(HB) ⊗ L(HD).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>1.Figure 1 :</head><label>1</label><figDesc>Figure1: Relationships between different causality frameworks and ours. Each vertex represents a causality framework, a directed (black) arrow from vertex A to vertex B represents that all objects in framework A can be mapped to and studied within framework B in a manner that preserves the relevant causal information. A red arrow from A to B represents that not all scenarios in A can be captured within B, the annotation indicates the reason why. For instance, our framework can describe all classical functional causal models on discrete variables with finite cardinality (fCM finite ) but the converse is not true as our framework contains quantum causal models that are not captured in fCM finite . Whether the Barrett-Lorenz-Oreshkov formalism for cyclic quantum causal models can be faithfully mapped to ours is an open question (represented by a blue arrow) that relies on another prominent open question in field relating to causal decompositions of quantum channels (see appendix B.1.2 for further discussion). The green boxes highlight the graph-separation property (annotated above the box) whose soundness and completeness is known to hold within that formalism. For further explanation of this diagram, see section 7.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>)</head><label></label><figDesc>Each element of the family Gc,tp ∈ G c,tp (G) is called a classical teleportation graph.The set of all pre-and post-selection vertices in G c,tp are denoted as V pre = {R v } v∈Vs(Gc,tp) and V post = {T v } v∈Vs(Gc,tp) .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><label></label><figDesc>where ⊥ d denotes d-separation and V post denotes the set of all post-selection vertices in the teleportation graph</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><label></label><figDesc>e acting as D e (ρ) = x∈Xe |x⟩⟨x|ρ|x⟩⟨x| for any ρ ∈ L(H e ).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head></head><label></label><figDesc>G ′ c,tp to a causal model (definition 36): Cm G ′ c,tp . The acyclic probability distribution of the event x and successful post-selections {t e v = 1} T e v ∈V ′ post relative to this functional model is Pr acyc (x|{t e v = 1} T e v ∈V ′ post ) G ′ c,tp . As a consequence of lemma 37, the acyclic probability rule is preserved through the mapping, i.e., Pr f,acyc (x, {t e</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head></head><label></label><figDesc>Step 3) and Cm Gtp (from Step 5) are equal, i.e., Pr acyc x|{t e v = ✓} T e v ∈ Ṽpost Gtp = Pr acyc (x|{t e v = 1} T e v ∈V ′ post ) G ′ c,tp . (169)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>1 :</head><label>1</label><figDesc>We define a classical teleportation causal model on a teleportation graph G c,tp ∈ G c,tp (G) with split vertices V s (G c,tp ) ⊆ V (see definition 38), as prescribed in definition 9 of<ref type="bibr" target="#b20">[FGV25]</ref>. For completeness, let us briefly remind what this amounts to. The classical teleportation graph is obtained through performing the following substitution for all v ∈ V s (G c,tp ):</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>2.Step 4 :</head><label>4</label><figDesc>For all v ∈ V s (G c,tp ) and e ∈ Out(v), associate to T e v and outcome t e v = 1 the map acting on ρ ∈ L H In(T e v ) ∼ = L H (v,T e v ) ⊗ H (R e v ,T e v ) POVM element obtained through applying definition 35 to a delta function and outcome 1, i.e., f T e v (x, y) = δ x,y = 1. 3. For all v ∈ V s (G c,tp ) and e = (v, v ′ ) ∈ Out(v), associate to R e v , which is considered unobserved, the stateσ R e v = x∈Xv 1 |X v | e∈Out(R e v ) |x⟩⟨x| He = x∈Xv 1 |X v | |x⟩⟨x| H (R e v ,T e v ) ⊗ |x⟩⟨x| H (R e v ,v ′ ) . (177)Lemma 37 establishes that probabilities are preserved through mapping an acyclic functional model to an acyclic causal model through definition 36. Since G ′ c,tp is acyclic, this implies thatPr f,acyc (x, {t e v = 1} T e v ∈V ′ post ) G ′ c,tp = Pr acyc (x, {t e v = 1} T e v ∈V ′ post ) G ′ c,tp . (178)We map the original functional model fCm G to a causal model (definition 2), Cm G , using definition 36. As prescribed by the mapping, the graph G is decorated to form a causal graph such that all edges are classical and all vertices are observed. The causal model is then defined through the associations of definition 36. In particular, to each vertex v ∈ V we associate the set of CP maps acting on ρ ∈ L(HIn(v) ) Mv x (ρ) = Tr E f v x (ρ ⊗ σ v ) e∈Out(v)|x⟩⟨x| He (179)where {E f v x } x∈Xv is the POVM obtained through applying definition 35 to the function f v associated to v in the functional model fCm G .Step 5: We define a teleportation causal model induced by Cm G . Firstly, let us consider the graph G tp which is constructed using definition 6 and has split edgesE s (G tp ) = v∈Vs(Gc,tp) Out(v),(180)i.e., the split edges of G tp correspond to the outgoing edges of split vertices in G c,tp (see Step 2). As given by the definition, this amounts to adding pre and postselection vertices for each split edge. For v ∈ V s (G c,tp ) and e ∈ Out(v) let us denote the pre and post-selection vertices respectively as R e v and T e v . Thus, the graph G tp is obtained from G through performing the following substitution for all v ∈ V s (G c,tp ) v with Ṽpost the set of post-selection vertices of G tp .Then, we define a teleportation causal model on G tp through definition 8. In particular, this construction prescribes that the same maps and Hilbert spaces are associated to vertices and edges that are preserved from G to G tp . To pre-and post-selection vertices we associate (without loss of generality, corollary 16) Bell teleportation protocols (definition 5), i.e., for all v ∈ V s (G c,tp ) and e = (v, v ′ ) ∈ Out(v) we associate to the corresponding pre-selection vertex R e v the Bell stateσR e v = |Φ + ⟩⟨Φ + | Out(R e v ) = 1 |X v | x,y∈Xv |x⟩⟨y| (R e v ,T e v ) ⊗ |x⟩⟨y| (R e v ,v ′ ) (182)and to the corresponding post-selection vertex T e v and outcome t = ✓ the CP map acting on all ρ ∈ L HIn(T e v ) ∼ = L H (v,T e v ) ⊗ H (R e v ,T e v )asMT e v ✓ (ρ) = Tr |Φ + ⟩⟨Φ + | In(T e v ) ρ = 1 |X v | Tr   x∈Xv |x⟩⟨y| H (v,T e v ) ⊗ |x⟩⟨y| H (R e v , given an observed event x := {x v ∈ X v } v∈V , the probability of Cm G (see Step 4) is defined as Pr(x) G = Pr acyc x|{t e v = ✓} T e v ∈ Ṽpost Gtp , (184)where Ṽpost denotes the set of post-selection vertices of G tp .Step 6: Finally, we show that the causal models Cm G ′ c,tp (introduced in Step 3) and Cm Gtp (introduced in Step 5) are equivalent, in the sense that for all observed eventsx := {x v ∈ X v } v∈V it holds Pr acyc x|{t e v = ✓} T e v ∈ Ṽpost Gtp = Pr acyc (x|{t e v = 1} T e v ∈V ′ post ) G ′ c,tp .(185)Firstly, we notice that the construction of G ′ c,tp and G tp give the same causal graphs, indeed, the subsequent substitutions in equation (171) and equation (173) are equivalent to equation (181). Let us show that the maps associated to each vertex are equivalent in the two causal models, Cm G ′ c,tp and Cm Gtp . We have: 1. For all vertices which are preserved from G to G ′ c,tp (and G tp ), v ∈ V the maps associated in Cm Gtp and Cm G ′ c,tp are equal (see equations (175) and (179)), i.e., for all ρ ∈ L(HIn(v) ) it holds Mv x (ρ) = M v x (ρ)(186)where we recall that Mv x is the map associated to v in Cm Gtp and M v x is the map associated to v in Cm G ′ c,tp . 2. For all post-selection vertices, i.e., for all v ∈ V s (G c,tp ) and e ∈ Out(v), we have (by the decoherence condition for observed vertices in definition 2) MT e v ✓ • Mv x = MT e v ✓ • D (v,T e v ) • Mv x (187) where Pr f G is the probability in fCm G (Step 0), Pr f,acycGc,tp in fCm Gc,tp (Step 1), Pr f,acycG ′ c,tp in fCm G ′ c,tp (Step 2), Pr acycG ′ c,tp in Cm G ′ c,tp (Step 3), Pr G in Cm G (Step 4) and Pr acycG tp in Cm Gtp (Step 5).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13"><head>Pr</head><label></label><figDesc>acyc x {t i = ✓} T i ∈V 1 post Gtp ,1 = Pr acyc x {t i = ✓} T i ∈V 2 post Gtp ,2 , (52)where we denoted the set of all post-selection vertices of G tp,1 , G tp,2 as V 1 post and V 2 post respectively, and the joint observed event of V o in short as x := {x v ∈ X v } v∈Vo .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14"><head></head><label></label><figDesc>causal model Cm Gtp ,i on the teleportation graph G tp,i for i ∈ {1, 2}. By definition 9, we havep Pr(x, t = ✓, t 0 = ✓) Gtp ,2</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15"><head>(</head><label></label><figDesc></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16"><head></head><label></label><figDesc>) can be rewritten as Pr(x,{t i = ✓} T i ∈Vpost ) Gtp = k i=1 p (i) tp cycle(C x ).(206)Finally, by recalling definition 9 of the post-selection success probability p ✓ and definition 12 of the probability Pr(x) G of the observed outcomes of the original causal model Cm G in terms of the probability Pr(x, {t i = ✓} T i ∈Vpost ) Gtp of the teleportation causal model Cm Gtp (on the graph G tp ), we see that equation (206) immediately implies the required equation (57),</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head></head><label></label><figDesc>A is observed, thus, it has associated a POVM {E A a ∈ L(H In(A) )} a∈X A . Since the vertex A has no incoming edges, we have by definition that H In(A) = H ∅ = C, so that the POVM {E A a } a∈X A amounts to a probability distribution {p A a } a∈X A . A only has one outgoing edge: Out(A) = {e = (A, L)}. The corresponding set of CP maps, {M A a : C → L(H e )} a∈X A , can be substituted for a set of sub-normalized density matrices σ A</figDesc><table /><note><p>a = M A a (1). We have</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>satisfies Bell's local causality condition, and can be obtained in a local hidden variable model where Alice and Bob use classical response functions, and where the shared source distributes two systems described classically, i.e., by a probability distribution p L l 1 ,l 2 .</figDesc><table><row><cell>4 Mapping cyclic to acyclic causal models with post-selection</cell></row><row><cell>Our aim is to define a probability distribution over the values of the observed vertices</cell></row><row><cell>given a causal model on a causal graph. To this goal, we map a given causal model on a</cell></row><row><cell>(possibly cyclic) causal graph to a causal model with post-selection on an acyclic causal</cell></row><row><cell>graph. This allows us to define the probability rule of the original causal model using</cell></row><row><cell>the acyclic probability rule in definition 3. The mapping is constructed from post-selected</cell></row><row><cell>teleportation protocols, introduced in the next section, which are known to simulate closed</cell></row><row><cell>time-like curves [LMGP + 11b, LMGP + 11a].</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head></head><label></label><figDesc>Definition 12 (Probabilities in a general causal model). Consider a causal model Cm G on a causal graph G associated with a set V o of observed vertices. Let Cm Gtp be a teleportation causal model on G tp ∈ G tp (G) obtained from Cm G (definition 8) and p ✓ be the success probability of post-selection in Cm Gtp (definition 9). If p ✓ &gt; 0, the probability associated with the joint observed event x</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head></head><label></label><figDesc>B.1.2. Whether non-factor BLO models can be reproduced directly in our framework depends on solving the open problem of causal decompositions of unitary channels in terms of arbitrary quantum channels, as discussed in appendix B.1.2.</figDesc><table /><note><p>5. Modelling of open wires. Many causal modelling approaches, including ours, do not include open in/output wires; wires are fully contracted with a state preparation, channel, or POVM. Causality frameworks that are not strictly about causal modelling, such as process matrices/quantum supermaps [OCB12, CDPV13], cyclic quantum networks [VR24a, VR24b], and category-theoretic approaches based on string diagrams (e.g., [CK17, CK16]) allow for open in/output wires. These can still be modelled within our framework by introducing a "slot" for state preparation or POVM measurement on an open in/output wire. This slot can be filled with a variable preparation/measurement box, which, depending on an input variable, prepares an arbitrary state or measures an arbitrary POVM. Thus, there is no strict loss of generality in this case, though explicitly modelling open wires may be useful in certain scenarios.</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head></head><label></label><figDesc>, PMM + 17]. Additionally, similar ideas linking between cyclic composition and preand post-selection exist in category-theoretic approaches that employ string diagrams<ref type="bibr" target="#b15">[CK17,</ref><ref type="bibr" target="#b14">CK16]</ref>. In these approaches, special pairs of bipartite states and effects, called cups and caps, combine to simulate an identity channel used in cyclic compositions. Although maximally entangled states are frequently used as canonical examples in the literature, the string-diagrammatic framework accommodates the broader class of teleportation protocols in definition 4. While we have focused on a more concise representation of our causal models via causal graphs, which is suitable for studying open problems relating to graph-separation properties in cyclic models, one can equivalently represent our models through string diagrams defined in a category instantiated by quantum channels.13   </figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8"><head></head><label></label><figDesc>15 . Moreover, this motivates open questions regarding gaps between different graph separation properties, e.g., under what conditions (on the graph and causal model) can we have different conditional independence constraints imposed by the soundness of two graph separation properties (among d, σ and p separation), where a causal model violates one of the constraints and satisfies the other? The results and further examples of<ref type="bibr" target="#b20">[FGV25]</ref> present relevant insights and techniques for this question.</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9"><head>•</head><label></label><figDesc>Causal graph If G is the graph associated with the given BLO-QCM ⊗ , by construction it has N vertices {A 1 , ..., A N }. Without loss of generality, let {A 1 , ..., A k } denote the vertices associated with a trivial (1-dimensional) input Hilbert space.Define a new causal graph G ′ constructed from G as follows with 2N + k vertices: {A 1 , ..., A N } ∪ {σ 1 , ..., σ k } ∪ {X 1 , ..., X N }, where {X 1 , ..., X N } are observed while the rest are unobserved vertices. Whenever (A i , A j ) is a directed edge in G, A j cannot have a trivial input space, and we include a corresponding directed edge (A i , σ j ) in G ′ . Further, include directed edges (σ j , A j ) for every j ̸ ∈ {1, ..., k} and (A j , X j ) for all j ∈ {1, ..., N } in G ′ . This construction ensures that absence of directed paths in G implies the same in G ′ as required by definition 30.</figDesc><table /><note><p>• State spaces We now associate a state space to each edge on the causal graph G ′ as required by definition 2. Consider the edges (A i , σ j ) of G ′ , which correspond to edges (A i , A j ) of G. Since each BLO-QCM ⊗ assigns a tensor factor H A out ij of A i 's output space H A out i</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_10"><head></head><label></label><figDesc>) Definition 36 (Causal model associated to a functional model). Consider a functional model fCm G (definition 32) on a directed graph G = (V, E). Using the same notation of definition 32, we define a causal model Cm(fCm) G on the causal graph given by definition 34, through: 1. To each edge e ∈ E = (v, v ′ ) associate the finite dimensional Hilbert space H e = H(X v ), where H(X v ) is defined as in equation (1); 2. To each error variable U v of v ∈ V associate the finite dimensional Hilbert space H(U v ), where H(U v ) is defined as in equation (1), and the state</figDesc><table><row><cell cols="4">In addition, {E f x } x∈X is a POVM, since E f x are positive and it holds</cell><cell></cell></row><row><cell>E x f =</cell><cell>δ x,f (y) |y⟩⟨y| =</cell><cell>|y⟩⟨y| =</cell><cell>|y⟩⟨y| = 1.</cell><cell>(134)</cell></row><row><cell>x∈X</cell><cell>x∈X</cell><cell>y∈Y</cell><cell>y∈Y</cell><cell></cell></row><row><cell></cell><cell>y∈Y</cell><cell>∃x∈X :f (y)=x</cell><cell></cell><cell></cell></row><row><cell cols="5">With these results in mind, we proceed to describe functional models within our causal</cell></row><row><cell>modelling framework.</cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_11"><head></head><label></label><figDesc>Include in G tp all the vertices and edges of the subgraph G ′ associated with the same vertex types (observed or unobserved) and edge types (classical or quantum) as the original causal graph G.3. Denoting the set of so-called split edges Es (G tp ) := E\E ′ , for each edge (v i , v ′ i ) ∈ E s (G tp ), include in G tp , two vertices T i and R i and three edges (v i , T i ), (R i , T i ) and (R i , v ′ i ). 4. The vertex T i is observed and R i unobserved. Outgoing edges from R i , (R i , T i ) and(R i , v ′ i ), are quantum edges. The edge (v i , T i ) is of the same type of the edge (v i , v ′ i ) in the original causal graph G.</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_12"><head></head><label></label><figDesc>2: We define an intermediate functional model on a graph G ′ c,tp which is constructed from the classical teleportation graph G c,tp : fCm G ′ c,tp . The idea is to use the correspondence between a single broadcasted classical teleportation protocol and multiple copies of regular classical teleportation, in going from G c,tp to G ′ c,tp (equation (151)). Let V ′ post be the set of post-selection vertices in G ′ c,tp . The acyclic probability distribution of the event x and successful post-selections {t e v = 1} T e v ∈V ′ post relative to this functional model is Pr f,acyc (x, {t e v = 1} T e v ∈Vpost ) G ′ c,tp (definition 33). We prove that the conditional probabilities in fCm Gc,tp (from Step 1) and fCm G ′</figDesc><table><row><cell>are equal, i.e.,</cell><cell>c,tp</cell></row><row><cell>Pr f,acyc</cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_13"><head></head><label></label><figDesc>5: We define a teleportation causal model on a specific teleportation graph G tp induced by Cm G : Cm Gtp (definition 6 and definition 8). Specifically, we choose G tp with split edges correspond to the outgoing edges of split vertices of G c,tp (see Step 1), i.e., E s (G tp ) = ∪ v∈Vs(Gc,tp) Out(v). Let us denote the set of post-selection vertices of G tp as Ṽpost . The acyclic probability distribution of the event x and successful post-selections {t e v = ✓} T e v ∈ Ṽpost relative to this causal model is Pr acyc x, {t e v = ✓} T e Let us sketch what the previous two steps achieve. The diagram summarises the causal models introduced in Step 4-5 together with the original functional causal model introduced in Step 0, and their (conditional) probabilities. Step 5 established the equivalence between the two probabilities of the newly introduced causal models. The equivalence between Pr f (x) G and Pr(x) G is what we aim to prove.</figDesc><table><row><cell></cell><cell></cell><cell>v ∈ Ṽpost Gtp</cell><cell>(definition 3).</cell></row><row><cell cols="4">By definition, the cyclic probability of Cm G equals the acyclic conditional distribu-</cell></row><row><cell>tion of Cm Gtp , i.e.,</cell><cell></cell><cell></cell></row><row><cell cols="4">Pr(x) G = Pr acyc x|{t e v = ✓} T e v ∈ Ṽpost Gtp</cell><cell>.</cell><cell>(167)</cell></row><row><cell>fCm G</cell><cell>Cm G</cell><cell cols="2">Cm Gtp</cell></row><row><cell>Pr f (x)</cell><cell>Pr(x)</cell><cell cols="2">Pr acyc (x|t)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_14"><head></head><label></label><figDesc>Thanks to the Hilbert space identities of equation (49), we have H e 0 = H A = H C . We can thus rewrite equation (196) as Pr(x, t) Gtp ,1 = Tr A [F</figDesc><table><row><cell>F (x,t)</cell><cell></cell><cell></cell><cell></cell><cell cols="2">E AB</cell><cell>F (x,t)</cell></row><row><cell>e 0</cell><cell></cell><cell cols="2">G tp,2 :</cell><cell>A</cell><cell>B</cell><cell>C</cell></row><row><cell>t)</cell><cell></cell><cell></cell><cell>ρ (x,t)</cell><cell></cell><cell>φ AB</cell></row><row><cell></cell><cell></cell><cell>(x,t) A</cell><cell>ρ (x,t) A ]</cell><cell></cell></row><row><cell>=</cell><cell>1 p tp</cell><cell cols="3">Tr AB (E AB ⊗ F C (x,t)</cell><cell>)(ρ (x,t) A</cell><cell>⊗ φ BC )</cell></row><row><cell>=</cell><cell>1 p</cell><cell></cell><cell></cell><cell></cell></row></table><note><p>tp Pr(x, t, t 0 = ✓) Gtp ,2 ,</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_15"><head></head><label></label><figDesc>1)✓ is zero if and only if p ✓ is zero. Hence, the probabilities Pr Gtp ,1 are defined if and only if the probabilities Pr Gtp ,2 are defined. Furthermore, if they are defined, we can relate them as follows (again appealing to definition 9): Proof in the general case. Consider two general elements ofG tp (G), G tp,1 , G tp,2 ∈ G tp (G).We can prove the general statement by first noticing that the repeated application of the above argument can be used to prove that the probabilities of both G tp,1 and G tp,2 are equivalent to those of G tp,0 , where the latter corresponds to the graph where all the edges have been split (i.e., E s (G tp,0 ) = E, where G = (V, E)). The result follows by transitivity.Proposition 14 (General probability rule in terms of self-cycle composition). Consider a causal model Cm G on any causal graph G, associated with the sets V o and V u of observed and unobserved vertices. Let G tp ∈ G tp (G) be a teleportation graph and Cm Gtp a corresponding teleportation causal model on G tp constructed from Cm G . By construction, pre and post-selection vertices in G tp come in pairs R i and T i , and are associated in particular with edges e i := (v i , T i</figDesc><table><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>(2)</cell><cell></cell></row><row><cell>Pr(x) Gtp ,1 =</cell><cell>Pr(x, t = ✓) Gtp ,1 p (1) ✓</cell><cell>=</cell><cell>p tp p tp</cell><cell>Pr(x, t = ✓, t 0 = ✓) Gtp ,2 ✓ p (2)</cell><cell>= Pr(x) Gtp ,2 ,</cell><cell>(202)</cell></row><row><cell cols="4">which completes the proof in this case.</cell><cell></cell><cell></cell><cell></cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0"><p>For example, in the classical literature, the observed distribution is only considered uniquely defined by the causal mechanisms (functional dependencies) in models that admit unique solutions to the functional dependencies<ref type="bibr" target="#b22">[FM17,</ref><ref type="bibr" target="#b23">FM18]</ref>, but this is not the case for non-uniquely solvable classical causal models, see</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="3" xml:id="foot_1"><p>Here we write A ⊥ ⊥ B|C in PG to denote conditional independence (see definition 19) i.e., P(a, b|c)G = P(a|c)GP(b|c)G for all values a, b, c of the variables A, B, C, where P denotes an arbitrary probability distribution over the random variables A, B and C.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4" xml:id="foot_2"><p>If such a property existed, then there would be at least one p-connection A ̸ ⊥ p B|C where we would have separation relative to the new property, and if that property were sound, A ⊥ ⊥ B|C in all causal models. This is disallowed by completeness.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="5" xml:id="foot_3"><p>Meaning: the order in which to compose, and how to take the tensor product of each map with identity channels so that each map acts on the correct subsystems.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6" xml:id="foot_4"><p>In the teleportation protocol, there is a POVM describing the measurement. EAB here is the POVM element that corresponds to the outcome for which there is no correction to apply.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="7" xml:id="foot_5"><p>As shown in lemma 26, this implies that dim(H (R i ,T i ) ) ≥ dim(He i ) = dim(H e ′ i). The assigned Hilbert spaces in equation (49) satisfy this condition.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="8" xml:id="foot_6"><p>This is similar to how the composition works in definition 3, but here specified by the chosen graph G ′ .</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="9" xml:id="foot_7"><p>This is because conditioning on v1, v2 blocks all paths from the remaining two vertices to the postselection vertices within the loop which will ensure that v3 and v4 remain d-separated conditioned on v1, v2 in all teleportation graphs, even when additionally conditioning on the post-selection vertices.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="10" xml:id="foot_8"><p>Here, the composition operation instantiates the generalised product in the quantum case, the tests correspond to the quantum CP(TP) maps T v , and we do not have an explicit conditioning on outcomes of observed parents as these are encoded into a preferred basis of a quantum system and we do not need to differentiate incoming edges from observed vs unobserved parents, and can treat all of them as quantum inputs to our "tests".</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="11" xml:id="foot_9"><p>Self-cycle composition of definition 13 is a special case of loop composition [PMM + 17] for finitedimensional systems, where the result is a number (a map with no in or outputs). Generally, loop com-</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="12" xml:id="foot_10"><p>Unique solvability corresponds to having a unique solution of the functional dependences for every valuation of the exogenous vertices.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="13" xml:id="foot_11"><p>Generally, the diagrammatic and category-theoretic approach can be applied to non-classical and nonquantum theories as well.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="14" xml:id="foot_12"><p>In<ref type="bibr" target="#b22">[FM17]</ref>, these are denoted as SEMs instead of fCMs. The two acronyms refer to the same object for our present purposes.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="15" xml:id="foot_13"><p>This is perhaps to be expected as they consider different domains, σ-separation was constructed for uniquely solvable but possibly continuous variable classical fCMs while p-separation for possibly nonuniquely solvable finite cardinality/dimensional classical and quantum models.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="16" xml:id="foot_14"><p>This basis is also an orthonormal basis {|k⟩C } d A k=1 for HC = HA.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="18" xml:id="foot_15"><p>According to the basis-dependent CJ representation without the dual spaces (equation (119)). We referred to this with a superscript 1 before but drop this to avoid clutter, since the meaning is clear from context.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="19" xml:id="foot_16"><p>Here, we use cycle only for compositions relevant for probability computations where the result of the composition is a number (a map with no in or outputs).</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="20" xml:id="foot_17"><p>The simplification is possible as classical variables can be copied and broadcast to multiple parties, i.e., the children vertices of the variable.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="21" xml:id="foot_18"><p>In what follows we modify the notation of p-separation with respect to Gc,tp(G) compared to<ref type="bibr" target="#b20">[FGV25]</ref>, which is denoted there as (V1 ⊥ p V2|V3)G. Here, (V1 ⊥ p V2|V3)G denotes p-separation with respect to Gtp(G), while (V1 ⊥ p,c V2|V3)G is with respect to Gc,tp(G). This distinction is necessary to show equivalence of the two definitions. Once this is established the notation (V1 ⊥ p V2|V3)G will denote either definition.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="22" xml:id="foot_19"><p>The lemma holds for any Hilbert space with such partition. We call the space H In(v) since the lemma will be applied to subsystems in a causal model.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="23" xml:id="foot_20"><p>Any other choice of classical post-selected teleportation protocol would yield the same probability as this canonical choice, as shown in<ref type="bibr" target="#b20">[FGV25]</ref> paper.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="26" xml:id="foot_21"><p>This representation is equivalent to a Hasse diagram for partially ordered sets, recognising the fact that every directed acyclic graph induces a partial order and vice versa.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="27" xml:id="foot_22"><p>This decomposition is not unique for teleportation graphs with disconnected components, in which case we can pick any such decomposition.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="28" xml:id="foot_23"><p>This is similar to how the composition works in definition 3, but here specified by the chosen graph G ′ .</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="29" xml:id="foot_24"><p>We note that the notion of definition 39 is referred to as ⊥ p in<ref type="bibr" target="#b20">[FGV25]</ref>, but we use ⊥ p,c here to distinguish it from the definition 21 introduced here.</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgements</head><p>We are grateful to <rs type="person">Elie Wolfe</rs> for valuable feedback on our framework and its relation to results in classical cyclic causal models. We are thankful to <rs type="person">Yílé Yīng</rs> for suggesting the name p-separation for the new graph separation property that we propose here. VV also thanks <rs type="person">Tein van der Lugt</rs> for insightful discussions on the causal decomposition problem, which is related to the question regarding the link between our framework and the quantum causal modelling framework of <rs type="affiliation">Barrett, Lorenz and Oreshkov</rs>. VV's research has been supported by an <rs type="funder">ETH</rs> <rs type="grantName">Postdoctoral Fellowship</rs>. VV acknowledges support from <rs type="funder">ETH Zurich Quantum Center</rs>, the <rs type="funder">Swiss National Science Foundation</rs> via project No. <rs type="grantNumber">200021_188541</rs> and the <rs type="institution">QuantERA</rs> programme via project No. <rs type="grantNumber">20QT21_187724</rs>. VG and CF acknowledge support from <rs type="funder">NCCR SwissMAP</rs>, the <rs type="funder">ETH Zurich Quantum Center</rs> and the <rs type="funder">Swiss National Science Foundation</rs> via project No. <rs type="grantNumber">20QU-1_225171</rs>. CF acknowledges support from the <rs type="funder">ETH Foundation</rs>.</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_qdXQtMw">
					<orgName type="grant-name">Postdoctoral Fellowship</orgName>
				</org>
				<org type="funding" xml:id="_V9XYvTG">
					<idno type="grant-number">200021_188541</idno>
				</org>
				<org type="funding" xml:id="_THtZTxs">
					<idno type="grant-number">20QT21_187724</idno>
				</org>
				<org type="funding" xml:id="_B979K7s">
					<idno type="grant-number">20QU-1_225171</idno>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>In section 4 of <ref type="bibr" target="#b20">[FGV25]</ref>, p-separation was defined with respect to the graph family definition 38. 21 Definition 39 (p-separation in <ref type="bibr" target="#b20">[FGV25]</ref>). Let G be a directed graph and V 1 , V 2 and V 3 denote any three disjoint subsets of the vertices of G with V 1 and V 2 being non-empty. Then, we say that <ref type="bibr">tp</ref> , where ⊥ d denotes d-separation and V post denotes the set of all post-selection vertices in the teleportation graph G c,tp ∈ G c,tp (G). Otherwise, we say that V 1 is p-connected to V 2 given V 3 in G, and we denote it</p><p>The following lemma shows equivalence of the two definitions of p-separation.</p><p>Lemma 40 (Equivalence of p-separation in the two graph families). Let us consider a directed graph G and three disjoint subsets</p><p>where</p><p>, where V post is the set of all post-selection vertices in G c,tp . We now define a teleportation graph</p><p>Then the graphs G tp and G c,tp are equivalent up to the following replacement (see equation 20 in <ref type="bibr" target="#b20">[FGV25]</ref>)</p><p>The left hand side represents the structure of G tp and the right hand side, G c,tp , and where the red vertices correspond to the post-selection vertices in both cases. Then it is easy to see that (</p><p>where all maps M are in Cm Gtp and D (v,T e v ) is a decohering channel acting as D e (ρ) = x∈Xe |x⟩⟨x|ρ|x⟩⟨x| for any ρ ∈ L(H e ). In order to evaluate probabilities, the maps of Cm Gtp are composed as described in definition 3. In particular, the map MT e v ✓ is always composed with Mv x as in equation ( <ref type="formula">187</ref>), hence, it can be replaced with MT e v ✓ • D (v,T e v ) without affecting probabilities. Thus, we have for all ρ ∈ L(H</p><p>and</p><p>Thus we can compare this map, associated to the post-selection vertex T e v in Cm Gtp , to the map M</p><p>3. For all pre-selection vertices, i.e., for all v</p><p>where ˜denotes associations in Cm Gtp and D (R e v ,v ′ ) is a decohering channel. In order to evaluate probabilities, the maps of Cm Gtp are composed as described in definition 3. In particular, the state σR e v is always composed with the map Mv ′</p><p>x ′ as in eq. ( <ref type="formula">191</ref>), hence, the state σR e v can be replaced with D (R e v ,v ′ ) • σR e v without affecting probabilities. Thus, we can compare the decohered state</p><p>• σR e v , associated to the pre-selection vertex R e v in Cm Gtp , to the state σ R e v associated to the same pre-selection vertex in Cm G ′ c,tp (see eq. ( <ref type="formula">177</ref>)). It holds:</p><p>eq. ( <ref type="formula">189</ref>)</p><p>Using the probability rule in definition 3, we can easily see that the conditional probabilities in Cm Gtp and Cm G ′ c,tp satisfy</p><p>notice that the scaling factor between the two maps in equation ( <ref type="formula">190</ref>) drops out once we condition on successful post-selections.</p><p>Finally, we can combine the results of Steps 1-6 to complete the proof. Indeed, we have</p><p>The above conditional (in)dependence statements are relative to the marginal Pr</p><p>, where V post is the set of all post-selection vertices in the chosen teleportation graph G tp . From theorem 20, it then follows that the conditional independence (X 1 ⊥ ⊥ X 2 |X 3 ∪ V post ) Pracyc G tp holds since G tp is a directed acyclic graph (lemma 7). Finally, by definition 12, the probability distribution associated with a causal model on the possibly cyclic causal graph G is given by the corresponding probability computed in any representative teleportation graph G tp ∈ G tp (G) with an additional conditioning on the associated post-selection vertices V post . Recall from proposition 10 that this distribution is the same, independently of which representative G tp ∈ G tp (G) is chosen. Therefore, using definition 12, we know that (</p><p>by definition 21, which completes the proof.</p><p>(Completeness) Suppose we have a p-connection (V 1 ̸ ⊥ p V 2 |V 3 ) G in the given directed graph G according to definition 21. Then by lemma 40 this implies p-connection (V 1 ̸ ⊥ p,c V 2 |V 3 ) G according to the alternative definition, definition 39, of this notion introduced in <ref type="bibr" target="#b20">[FGV25]</ref>. By the completeness result for ⊥ p,c proven in <ref type="bibr" target="#b20">[FGV25]</ref> (Theorem 20) 29 , it follows that there exists a functional causal model (definition 32) fCm G on G where the conditional dependence (X 1 ̸ ⊥ ⊥ X 2 |X 3 ) Pr f G holds. By lemma 37, fCm G induces a causal model Cm(fCm) G on G with equivalent probabilities, and hence the same conditional dependence holds in this causal model of G, (X 1 ̸ ⊥ ⊥ X 2 |X 3 ) Pr G as required. This completes the proof.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Witnessing causal nonseparability</title>
		<author>
			<persName><forename type="first">M</forename><surname>Araújo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Branciard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Costa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Feix</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Giarmatzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Č</forename><surname>Brukner</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/17/10/102001</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page">102001</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Quantum common causes and quantum causal models</title>
		<author>
			<persName><forename type="first">J.-M</forename><forename type="middle">A</forename><surname>Allen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Barrett</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">C</forename><surname>Horsman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">M</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">W</forename><surname>Spekkens</surname></persName>
		</author>
		<idno type="DOI">10.1103/physrevx.7.031021</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review X</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">3</biblScope>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A purification postulate for quantum mechanics with indefinite causal order</title>
		<author>
			<persName><forename type="first">M</forename><surname>Araújo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Feix</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Navascués</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">C</forename><surname>Brukner</surname></persName>
		</author>
		<idno type="DOI">10.22331/q-2017-04-26-10</idno>
	</analytic>
	<monogr>
		<title level="j">Quantum</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page">10</biblScope>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Quantum computation with indefinite causal structures</title>
		<author>
			<persName><forename type="first">M</forename><surname>Araújo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">A</forename><surname>Gérin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Baumeler</surname></persName>
		</author>
		<idno type="DOI">10.1103/physreva.96.052315</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review A</title>
		<imprint>
			<biblScope unit="volume">96</biblScope>
			<biblScope unit="issue">5</biblScope>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Research trend of causal machine learning method: A literature review</title>
		<author>
			<persName><forename type="first">S</forename><surname>Arti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Hidayah</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">S</forename><surname>Kusumawardani</surname></persName>
		</author>
		<idno type="DOI">10.14421/ijid.2020.09208</idno>
	</analytic>
	<monogr>
		<title level="j">IJID (International Journal on Informatics for Development)</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="111" to="118" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
	<note>BBC + 93</note>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Teleporting an unknown quantum state via dual classical and Einstein-Podolsky-Rosen channels</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">H</forename><surname>Bennett</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Brassard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Crépeau</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Jozsa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Peres</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">K</forename><surname>Wootters</surname></persName>
		</author>
		<idno type="DOI">10.1103/PhysRevLett.70.1895</idno>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. Lett</title>
		<imprint>
			<biblScope unit="volume">70</biblScope>
			<biblScope unit="page" from="1895" to="1899" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">On the Einstein Podolsky Rosen paradox</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Bell</surname></persName>
		</author>
		<idno type="DOI">10.1103/PhysicsPhysiqueFizika.1.195</idno>
	</analytic>
	<monogr>
		<title level="j">Physics Physique Fizika</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="195" to="200" />
			<date type="published" when="1964">1964</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Foundations of structural causal models with cycles and latent variables</title>
		<author>
			<persName><forename type="first">S</forename><surname>Bongers</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Forré</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Peters</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Mooij</surname></persName>
		</author>
		<idno type="DOI">10.1214/21-AOS2064</idno>
	</analytic>
	<monogr>
		<title level="j">The Annals of Statistics</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="2885" to="2915" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Quantum causal models</title>
		<author>
			<persName><forename type="first">J</forename><surname>Barrett</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Lorenz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Oreshkov</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.1906.10726</idno>
		<idno type="arXiv">arXiv:1906.10726</idno>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
	<note>quant-ph</note>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Cyclic quantum causal models</title>
		<author>
			<persName><forename type="first">J</forename><surname>Barrett</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Lorenz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Oreshkov</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41467-020-20456-x</idno>
	</analytic>
	<monogr>
		<title level="j">Nature Communications</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">1</biblScope>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Device-independent test of causal order and relations to fixed-points</title>
		<author>
			<persName><forename type="first">A</forename><surname>Baumeler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Wolf</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/18/3/035014</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">35014</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">The space of logically consistent classical processes without causal order</title>
		<author>
			<persName><forename type="first">A</forename><surname>Baumeler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Wolf</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/18/1/013036</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">13036</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Quantum computations without definite causal structure</title>
		<author>
			<persName><forename type="first">G</forename><surname>Chiribella</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>D'ariano</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Perinotti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Valiron</surname></persName>
		</author>
		<idno type="DOI">10.1103/physreva.88.022318</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review A</title>
		<imprint>
			<biblScope unit="volume">88</biblScope>
			<biblScope unit="issue">2</biblScope>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Completely positive linear maps on complex matrices</title>
		<author>
			<persName><forename type="first">M.-D</forename><surname>Choi</surname></persName>
		</author>
		<idno type="DOI">10.1016/0024-3795(75)90075-0</idno>
	</analytic>
	<monogr>
		<title level="j">Linear Algebra Appl</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="285" to="290" />
			<date type="published" when="1975">1975</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title level="m" type="main">Categorical quantum mechanics i: Causal quantum processes</title>
		<author>
			<persName><forename type="first">B</forename><surname>Coecke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Kissinger</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.1510.05468</idno>
		<idno type="arXiv">arXiv:1510.05468</idno>
		<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
	<note>quant-ph</note>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
		<author>
			<persName><forename type="first">B</forename><surname>Coecke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Kissinger</surname></persName>
		</author>
		<idno type="DOI">10.1017/9781316219317</idno>
		<title level="m">Picturing Quantum Processes: A First Course in Quantum Theory and Diagrammatic Reasoning</title>
		<imprint>
			<publisher>Cambridge University Press</publisher>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Quantum causal modelling</title>
		<author>
			<persName><forename type="first">F</forename><surname>Costa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Shrapnel</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/18/6/063032</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page">63032</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Quantum mechanics near closed timelike lines</title>
		<author>
			<persName><forename type="first">D</forename><surname>Deutsch</surname></persName>
		</author>
		<idno type="DOI">10.1103/PhysRevD.44.3197</idno>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. D</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="3197" to="3217" />
			<date type="published" when="1991">1991</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Variations on the choi-jamiołkowski isomorphism</title>
		<author>
			<persName><forename type="first">M</forename><surname>Frembs</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">G</forename><surname>Cavalcanti</surname></persName>
		</author>
		<idno type="DOI">10.1088/1751-8121/ad5394</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Physics A: Mathematical and Theoretical</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="issue">26</biblScope>
			<biblScope unit="page">265301</biblScope>
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Connecting tensor networks to quantum causal models with applications to holography</title>
		<author>
			<persName><forename type="first">C</forename><surname>Ferradini</surname></persName>
		</author>
		<idno type="DOI">10.3929/ethz-b-000671952</idno>
		<imprint>
			<date type="published" when="2023">2023</date>
			<publisher>ETH Zurich</publisher>
			<pubPlace>Zurich</pubPlace>
		</imprint>
	</monogr>
	<note type="report_type">Master thesis</note>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Cyclic functional causal models beyond unique solvability with a graph separation theorem</title>
		<author>
			<persName><forename type="first">C</forename><surname>Ferradini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Gitton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Vilasini</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.2502.04171</idno>
		<idno type="arXiv">arXiv:2502.04171</idno>
		<imprint>
			<date type="published" when="2025">2025</date>
		</imprint>
	</monogr>
	<note>math.ST</note>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Identification of causal influences in quantum processes</title>
		<author>
			<persName><forename type="first">I</forename><surname>Friend</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Kissinger</surname></persName>
		</author>
		<idno type="DOI">10.4204/eptcs.394.7</idno>
	</analytic>
	<monogr>
		<title level="m">Electronic Proceedings in Theoretical Computer Science</title>
		<imprint>
			<biblScope unit="volume">394</biblScope>
			<biblScope unit="page">2023</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Markov properties for graphical models with cycles and latent variables</title>
		<author>
			<persName><forename type="first">P</forename><surname>Forré</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Mooij</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.1710.08775</idno>
		<idno type="arXiv">arXiv:1710.08775</idno>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
	<note>math.ST</note>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">Constraint-based causal discovery for nonlinear structural causal models with cycles and latent confounders</title>
		<author>
			<persName><forename type="first">P</forename><surname>Forré</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Mooij</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.1807.03024</idno>
		<idno type="arXiv">arXiv:1807.03024</idno>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
	<note>stat.ML</note>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">An example of a new type of cosmological solutions of Einstein&apos;s field equations of gravitation</title>
		<author>
			<persName><forename type="first">]</forename><forename type="middle">K</forename><surname>Gödel</surname></persName>
		</author>
		<idno type="DOI">10.1103/RevModPhys.21.447</idno>
	</analytic>
	<monogr>
		<title level="j">Rev. Mod. Phys</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="447" to="450" />
			<date type="published" when="1949">1949</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<monogr>
		<title level="m" type="main">A quantum causal discovery algorithm</title>
		<author>
			<persName><forename type="first">C</forename><surname>Giarmatzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Costa</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41534-018-0062-6</idno>
		<imprint>
			<date type="published" when="2018">2018</date>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page">17</biblScope>
		</imprint>
	</monogr>
	<note>npj Quantum Information</note>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">On the logic of causal models</title>
		<author>
			<persName><forename type="first">D</forename><surname>Geiger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<idno type="DOI">10.1016/B978-0-444-88650-7.50006-8</idno>
	</analytic>
	<monogr>
		<title level="j">Machine Intelligence and Pattern Recognition</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="3" to="14" />
			<date type="published" when="1990">1990</date>
			<pubPlace>North-Holland</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">Characterizing signalling: Connections between causal inference and space-time geometry</title>
		<author>
			<persName><forename type="first">M</forename><surname>Grothus</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Vilasini</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.2403.00916</idno>
		<idno type="arXiv">arXiv:2403.00916</idno>
		<imprint>
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
	<note>gr-qc</note>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Identifying independence in bayesian networks</title>
		<author>
			<persName><forename type="first">D</forename><surname>Geiger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Verma</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<idno type="DOI">10.1002/net.3230200504</idno>
	</analytic>
	<monogr>
		<title level="j">Networks</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="507" to="534" />
			<date type="published" when="1990">1990</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">Probability theories with dynamic causal structure: A new framework for quantum gravity</title>
		<author>
			<persName><forename type="first">L</forename><surname>Hardy</surname></persName>
		</author>
		<idno type="DOI">10.48550/arXiv.gr-qc/0509120</idno>
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
	<note>gr-qc</note>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<title level="m" type="main">Quantum Gravity Computers: On the Theory of Computation with Indefinite Causal Structure</title>
		<author>
			<persName><forename type="first">L</forename><surname>Hardy</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-1-4020-9107-0_21</idno>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>Springer</publisher>
			<biblScope unit="page" from="379" to="401" />
			<pubPlace>Netherlands</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Theory-independent limits on correlations from generalized bayesian networks</title>
		<author>
			<persName><forename type="first">J</forename><surname>Henson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Lal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">F</forename><surname>Pusey</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/16/11/113043</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page">113043</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Linear transformations which preserve trace and positive semidefiniteness of operators</title>
		<author>
			<persName><forename type="first">A</forename><surname>Jamiołkowski</surname></persName>
		</author>
		<idno type="DOI">10.1016/0034-4877(72)90011-0</idno>
	</analytic>
	<monogr>
		<title level="j">Reports on Mathematical Physics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="275" to="278" />
			<date type="published" when="1972">1972</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">A review of causal inference for biomedical informatics</title>
		<author>
			<persName><forename type="first">S</forename><surname>Kleinberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Hripcsak</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.jbi.2011.07.001</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of biomedical informatics</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="1102" to="1112" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Causal and compositional structure of unitary transformations</title>
		<author>
			<persName><forename type="first">R</forename><surname>Lorenz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Barrett</surname></persName>
		</author>
		<idno type="DOI">10.22331/q-2021-07-28-511</idno>
	</analytic>
	<monogr>
		<title level="j">Quantum</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">511</biblScope>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">Independence properties of directed markov fields</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">L</forename><surname>Lauritzen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">P</forename><surname>Dawid</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">N</forename><surname>Larsen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H.-G</forename><surname>Leimer</surname></persName>
		</author>
		<idno type="DOI">10.1002/net.3230200503</idno>
	</analytic>
	<monogr>
		<title level="j">Networks</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="491" to="505" />
			<date type="published" when="1990">1990</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Quantifying causality in data science with quasi-experiments</title>
		<author>
			<persName><forename type="first">T</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">V</forename><surname>Kulkarni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">P</forename><surname>Kording</surname></persName>
		</author>
		<idno type="DOI">10.1038/s43588-020-00005-8</idno>
	</analytic>
	<monogr>
		<title level="j">Nature Computational Science</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="24" to="32" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Closed timelike curves via postselection: Theory and experimental test of consistency</title>
		<author>
			<persName><forename type="first">]</forename><forename type="middle">S</forename><surname>Lmgp + 11a</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Lloyd</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Maccone</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Garcia-Patron</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Giovannetti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Shikano</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">A</forename><surname>Pirandola</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rozema</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Darabi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">K</forename><surname>Soudagar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">M</forename><surname>Shalm</surname></persName>
		</author>
		<author>
			<persName><surname>Steinberg</surname></persName>
		</author>
		<idno type="DOI">10.1103/physrevlett.106.040403</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review Letters</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="issue">4</biblScope>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Closed timelike curves via postselection: Theory and experimental test of consistency</title>
		<author>
			<persName><forename type="first">]</forename><forename type="middle">S</forename><surname>Lmgp + 11b</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Lloyd</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Maccone</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Garcia-Patron</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Giovannetti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Shikano</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">A</forename><surname>Pirandola</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rozema</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Darabi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">K</forename><surname>Soudagar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">M</forename><surname>Shalm</surname></persName>
		</author>
		<author>
			<persName><surname>Steinberg</surname></persName>
		</author>
		<idno type="DOI">10.1103/physrevlett.106.040403</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review Letters</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="issue">4</biblScope>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Towards a formulation of quantum theory as a causally neutral theory of bayesian inference</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S</forename><surname>Leifer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">W</forename><surname>Spekkens</surname></persName>
		</author>
		<idno type="DOI">10.1103/physreva.88.052130</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review A</title>
		<imprint>
			<biblScope unit="volume">88</biblScope>
			<biblScope unit="issue">5</biblScope>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">Gravitational field equations for sources with axial symmetry and angular momentum</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Matzner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">W</forename><surname>Misner</surname></persName>
		</author>
		<idno type="DOI">10.1103/PhysRev.154.1229</idno>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev</title>
		<imprint>
			<biblScope unit="volume">154</biblScope>
			<biblScope unit="page" from="1229" to="1232" />
			<date type="published" when="1967">1967</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">On deducing conditional independence from d-separation in causal graphs with feedback (research note)</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">M</forename><surname>Neal</surname></persName>
		</author>
		<idno type="DOI">10.1613/jair.689</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Artificial Intelligence Research</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="87" to="91" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">Quantum correlations with no causal order</title>
		<author>
			<persName><forename type="first">O</forename><surname>Oreshkov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Costa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Č</forename><surname>Brukner</surname></persName>
		</author>
		<idno type="DOI">10.1038/ncomms2076</idno>
	</analytic>
	<monogr>
		<title level="j">Nature Communications</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">1</biblScope>
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Causal and causally separable processes</title>
		<author>
			<persName><forename type="first">O</forename><surname>Oreshkov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Giarmatzi</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/18/9/093020</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page">93020</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title level="a" type="main">Causal structure in the presence of sectorial constraints, with application to the quantum switch</title>
		<author>
			<persName><forename type="first">N</forename><surname>Ormrod</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Vanrietvelde</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Barrett</surname></persName>
		</author>
		<idno type="DOI">10.22331/q-2023-06-01-1028</idno>
	</analytic>
	<monogr>
		<title level="j">Quantum</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">1028</biblScope>
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Causality</forename></persName>
		</author>
		<idno type="DOI">10.1017/CBO9780511803161</idno>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>Cambridge University Press</publisher>
		</imprint>
	</monogr>
	<note>2nd edition</note>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title level="a" type="main">Causal models and learning from data integrating causal modeling and statistical estimation</title>
		<author>
			<persName><forename type="first">M</forename><surname>Petersen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Laan</surname></persName>
		</author>
		<idno type="DOI">10.1097/EDE.0000000000000078</idno>
	</analytic>
	<monogr>
		<title level="j">Epidemiology</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="418" to="426" />
			<date type="published" when="2014">2014</date>
			<pubPlace>Cambridge, Mass</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<analytic>
		<title level="a" type="main">Causal boxes: Quantum information-processing systems closed under composition</title>
		<author>
			<persName><forename type="first">C</forename><surname>Portmann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Matt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">U</forename><surname>Maurer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Renner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Tackmann</surname></persName>
		</author>
		<idno type="DOI">10.1109/tit.2017.2676805</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Information Theory</title>
		<imprint>
			<biblScope unit="page" from="1" to="1" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b48">
	<analytic>
		<title level="a" type="main">Big data, data science, and causal inference: A primer for clinicians</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Raita</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">A</forename><surname>Camargo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Liang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Hasegawa</surname></persName>
		</author>
		<idno type="DOI">10.3389/fmed.2021.678047</idno>
	</analytic>
	<monogr>
		<title level="j">Frontiers in Medicine</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b49">
	<monogr>
		<author>
			<persName><forename type="first">P</forename><surname>Spirtes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Glymour</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Scheines</surname></persName>
		</author>
		<idno type="DOI">10.1007/978-1-4612-2748-9</idno>
		<title level="m">Causation, Prediction, and Search</title>
		<imprint>
			<date type="published" when="1993">1993</date>
			<biblScope unit="volume">81</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b50">
	<analytic>
		<title level="a" type="main">Graphical models, causal inference, and econometric models</title>
		<author>
			<persName><forename type="first">P</forename><surname>Spirtes</surname></persName>
		</author>
		<idno type="DOI">10.1080/1350178042000330887</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Economic Methodology</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="3" to="34" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b51">
	<analytic>
		<title level="a" type="main">IX.-the gravitational field of a distribution of particles rotating about an axis of symmetry</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">J</forename><surname>Van Stockum</surname></persName>
		</author>
		<idno type="DOI">10.1017/S0370164600013699</idno>
	</analytic>
	<monogr>
		<title level="j">Proceedings of the Royal Society of Edinburgh</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="page" from="135" to="154" />
			<date type="published" when="1938">1938</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b52">
	<analytic>
		<title level="a" type="main">Causal discovery and inference: concepts and recent methodological advances</title>
		<author>
			<persName><forename type="first">P</forename><surname>Spirtes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Zhang</surname></persName>
		</author>
		<idno type="DOI">10.1186/s40535-016-0018-x</idno>
	</analytic>
	<monogr>
		<title level="j">Applied Informatics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">3</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b53">
	<analytic>
		<title level="a" type="main">General framework for cyclic and fine-tuned causal models and their compatibility with space-time</title>
		<author>
			<persName><forename type="first">V</forename><surname>Vilasini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Colbeck</surname></persName>
		</author>
		<idno type="DOI">10.1103/physreva.106.032204</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review A</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="issue">3</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b54">
	<analytic>
		<title level="a" type="main">Impossibility of superluminal signaling in minkowski spacetime does not rule out causal loops</title>
		<author>
			<persName><forename type="first">V</forename><surname>Vilasini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Colbeck</surname></persName>
		</author>
		<idno type="DOI">10.1103/physrevlett.129.110401</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review Letters</title>
		<imprint>
			<biblScope unit="volume">129</biblScope>
			<biblScope unit="issue">11</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b55">
	<analytic>
		<title level="a" type="main">Causal networks: Semantics and expressiveness</title>
		<author>
			<persName><forename type="first">T</forename><surname>Verma</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<idno type="DOI">10.1016/B978-0-444-88650-7.50011-1</idno>
	</analytic>
	<monogr>
		<title level="m">Machine Intelligence and Pattern Recognition</title>
		<editor>
			<persName><forename type="first">R</forename><forename type="middle">D</forename><surname>Shachter</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">T</forename><forename type="middle">S</forename><surname>Levitt</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">L</forename><forename type="middle">N</forename><surname>Kanal</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">J</forename><forename type="middle">F</forename><surname>Lemmer</surname></persName>
		</editor>
		<meeting><address><addrLine>North-Holland</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1990">1990</date>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="69" to="76" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b56">
	<analytic>
		<title level="a" type="main">Embedding cyclic information-theoretic structures in acyclic space-times: No-go results for indefinite causality</title>
		<author>
			<persName><forename type="first">V</forename><surname>Vilasini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Renner</surname></persName>
		</author>
		<idno type="DOI">10.1103/physreva.110.022227</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review A</title>
		<imprint>
			<biblScope unit="volume">110</biblScope>
			<biblScope unit="issue">2</biblScope>
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b57">
	<analytic>
		<title level="a" type="main">Fundamental limits for realizing quantum processes in spacetime</title>
		<author>
			<persName><forename type="first">V</forename><surname>Vilasini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Renner</surname></persName>
		</author>
		<idno type="DOI">10.1103/physrevlett.133.080201</idno>
	</analytic>
	<monogr>
		<title level="j">Physical Review Letters</title>
		<imprint>
			<biblScope unit="volume">133</biblScope>
			<biblScope unit="issue">8</biblScope>
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b58">
	<analytic>
		<title level="a" type="main">On the definition and characterisation of multipartite causal (non)separability</title>
		<author>
			<persName><forename type="first">J</forename><surname>Wechs</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">A</forename><surname>Abbott</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Branciard</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/aaf352</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">13027</biblScope>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b59">
	<analytic>
		<title level="a" type="main">The lesson of causal discovery algorithms for quantum correlations: causal explanations of Bell-inequality violations require fine-tuning</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">J</forename><surname>Wood</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">W</forename><surname>Spekkens</surname></persName>
		</author>
		<idno type="DOI">10.1088/1367-2630/17/3/033002</idno>
	</analytic>
	<monogr>
		<title level="j">New Journal of Physics</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">33002</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
