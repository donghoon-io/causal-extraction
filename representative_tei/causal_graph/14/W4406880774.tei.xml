<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Optimal Transport on Categorical Data for Counterfactuals using Compositional Data and Dirichlet Transport</title>
				<funder ref="#_urppbwR">
					<orgName type="full">Agence Nationale de la Recherche</orgName>
					<orgName type="abbreviated">ANR</orgName>
				</funder>
				<funder ref="#_yJZzZja">
					<orgName type="full">French government</orgName>
				</funder>
				<funder ref="#_7PQc6rX">
					<orgName type="full">SCOR Foundation for Science and the National Sciences and Engineering Research Council</orgName>
					<orgName type="abbreviated">NSERC</orgName>
				</funder>
				<funder>
					<orgName type="full">Excellence Initiative of Aix-Marseille University</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability  status="unknown">
					<licence/>
				</availability>
				<date type="published" when="2025-05-20">20 May 2025</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">Agathe</forename><surname>Fernandes Machado</surname></persName>
							<email>fernandes_machado.agathe@courrier.uqam.ca</email>
							<affiliation key="aff0">
								<orgName type="department">Département de Mathématiques</orgName>
								<orgName type="institution">Université du Québec à Montréal</orgName>
								<address>
									<settlement>Montréal</settlement>
									<region>Québec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Arthur</forename><surname>Charpentier</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Département de Mathématiques</orgName>
								<orgName type="institution">Université du Québec à Montréal</orgName>
								<address>
									<settlement>Montréal</settlement>
									<region>Québec</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Ewen</forename><surname>Gallic</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution" key="instit1">CNRS</orgName>
								<orgName type="institution" key="instit2">Université de Montréal CRM -CNRS</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Aix Marseille Univ</orgName>
								<orgName type="institution" key="instit2">CNRS</orgName>
								<orgName type="institution" key="instit3">AMSE</orgName>
								<address>
									<settlement>Marseille</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Optimal Transport on Categorical Data for Counterfactuals using Compositional Data and Dirichlet Transport</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2025-05-20">20 May 2025</date>
						</imprint>
					</monogr>
					<idno type="arXiv">arXiv:2501.15549v2[cs.LG]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-21T20:23+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Recently, optimal transport-based approaches have gained attention for deriving counterfactuals, e.g., to quantify algorithmic discrimination. However, in the general multivariate setting, these methods are often opaque and difficult to interpret. To address this, alternative methodologies have been proposed, using causal graphs combined with iterative quantile regressions (Plečko and Meinshausen, 2020) or sequential transport <ref type="bibr" target="#b11">(Fernandes Machado et al., 2025)</ref> to examine fairness at the individual level, often referred to as "counterfactual fairness. " Despite these advancements, transporting categorical variables remains a significant challenge in practical applications with real datasets. In this paper, we propose a novel approach to address this issue. Our method involves (1) converting categorical variables into compositional data and (2) transporting these compositions within the probabilistic simplex of R d . We demonstrate the applicability and effectiveness of this approach through an illustration on real-world data, and discuss limitations.</p><p>Counterfactual analysis, the third level in Pearl (2009)'s causal hierarchy, is widely used in machine learning, policy evaluation, economics and causal inference. It involves reasoning about "what could have happened" under alternative scenarios, providing insights into causality and decision-making effectiveness. An example could be the concept of counterfactual fairness, as introduced by Kusner et al. (2017), that ensures fairness by evaluating how decisions would Agathe Fernandes Machado acknowledges that the project leading to this publication has received funding from OBVIA.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>1.1 Counterfactuals change under alternative, counterfactual conditions. Counterfactual fairness focuses on mitigating bias by ensuring that sensitive attributes, such as race, gender, or socioeconomic status, do not unfairly influence outcomes.</p><p>In the counterfactual problem, we consider data {(s i , x i ), i = 1, • • • , n}, where s denotes a binary "treatment" (taking values in {0, 1}). With generic notations, the counterfactual version of (0, x) can be constructed as (1, T ⋆ (x)), where T ⋆ is the optimal transport (OT) mapping from X|S = 0 to X|S = 1, as discussed in <ref type="bibr" target="#b3">Black et al. (2020)</ref>, <ref type="bibr" target="#b6">Charpentier et al. (2023)</ref> and De <ref type="bibr" target="#b9">Lara et al. (2024)</ref>. Unfortunately, this multivariate mapping is usually both complicated to estimate, and hard to interpret. If x is univariate, it is simply a quantile interpretation: if x is associated to rank probability u within group s = 0, then its counterfactual version should be associated with the same rank probability in group s = 1 (mathematically, T ⋆ = F -<ref type="foot" target="#foot_0">foot_0</ref> 1 • F 0 , where F j : R → [0, 1], j = {0, 1} denotes the cumulative distribution in group j, and F -1 j is the generalized inverse, i.e., the quantile function). In higher dimensions, one could consider multivariate quantiles, as in <ref type="bibr" target="#b12">Hallin et al. (2021)</ref> or <ref type="bibr" target="#b13">Hallin and Konen (2024)</ref>, but the heuristics is still hard to interpret. While OT-based counterfactual methods have been proposed to assess counterfactual fairness <ref type="bibr" target="#b3">Black et al. (2020);</ref><ref type="bibr" target="#b9">De Lara et al. (2024)</ref>, an alternative approach introduced by Plečko and Meinshausen (2020) is grounded in causal graphs (DAGs). In this framework, the outcome y depends on variables (s, x), where the sensitive attribute s "is a source" (a vertex without parents) and y is a "sink" (a vertex without outgoing edges). <ref type="bibr">Recently, Fernandes Machado et al. (2025)</ref> unified these approaches by introducing sequential transport aligned with the "topological ordering" of a DAG.</p><p>For example, to test whether a predictor m(x) is gender-neutral; let the sensitive attribute s be gender (binary genders for simplicity); compare its output on a woman's features x with that on her mutatis mutandis male counterpart. Unlike a ceteris paribus change, which flips s while holding all other features fixed, a mutatis mutandis intervention also adjusts any x j causally influenced by s. Thus, if x 1 is height, the counterfactual of a 5'4" woman would not be a 5'4" man but, say, a 5'10" man, via an OT map. While OT handles continuous attributes naturally, categorical features (e.g. occupation or neighbourhood) lack a canonical distance. As a result, generating counterfactuals (e.g. the male counterpart of a female nurse, or where a Black resident of X would live if they were White) becomes particularly challenging.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.2">The Case of Categorical Variables</head><p>For absolutely continuous variables, the approaches of <ref type="bibr" target="#b32">Plečko and Meinshausen (2020)</ref>; <ref type="bibr" target="#b33">Plečko et al. (2024)</ref>  If Plečko and Meinshausen (2020) considered quantile regressions for absolutely continuous variables, the case of ordered categorical variables is considered (at least with some sort of meaningful ordering) in the section related to "Practical aspects and extensions. " Discrete optimal transport between two marginal multinomial distributions is considered, but as discussed, it suffers multiple limitations. Here, we will consider an alternative approach, based on the idea of transforming categorical variables into continuous ones, coined "compositional variables" in <ref type="bibr" target="#b7">Chayes (1971)</ref>, and then, using "Dirichlet optimal transport, " on those compositions.</p><p>While motivated by counterfactual fairness, the primary aim of this study is to present the core of a method for deriving counterfactuals for categorical data, applicable to any context requiring counterfactual analysis. Here, for simplicity, we have set aside considerations related to the assumption of a known Structural Causal Model (SCM). 1</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.3">Agenda</head><p>After recalling notations on OT in Section 2, we discuss how to transform categorical variables with d categories into variables taking values in the simplex S d in R d , i.e., compositional variables, in Section 3. In Section 4, we review the topological and geometrical properties of the probability simplex S d ⊂ R d . In Section 5, we introduce the first methodology, which transports distributions within S d via Gaussian OT. This approach relies on an alternative representation of probability vectors in the Euclidean space R d-1 and assumes approximate normality in the transformed space. In Section 6, we present a second methodology, which operates directly on S d using a tailored cost function instead of the standard quadratic cost. Theoretical aspects of this "Dirichlet transport" framework are discussed in Section 6.1, while empirical strategies for matching categorical observations are developed in Section 6.2. Section 7 provides two empirical illustrations using the German Credit and Adult datasets.</p><p>Our main contributions can be summarized as follows:</p><p>• We propose a novel method to handle categorical variables in counterfactual modeling by using optimal transport directly on the simplex. This approach transforms categorical variables into compositional data, enabling the use of probabilistic representations that preserve the geometric structure of the simplex.</p><p>• By integrating optimal transport techniques on this domain, the method ensures consistency with the properties of compositional data and offers a robust framework for counterfactual analysis in real-world scenarios.</p><p>• Our approach does not require imposing an arbitrary order on the labels of categorical variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Optimal Transport</head><p>Given two metric spaces X 0 and X 1 , consider a measurable map T : X 0 → X 1 and a measure µ 0 on X 0 . The push-forward of µ 0 by T is the measure µ 1 = T # µ 0 on X 1 defined by T # µ 0 (B) = µ 0 T -1 (B) , ∀B ⊂ X 1 . For all measurable and bounded φ : X 1 → R,</p><formula xml:id="formula_0">X 1 φ(x 1 )T # µ 0 (dx 1 ) = X 0 φ T (x 0 ) µ 0 (dx 0 ).</formula><p>For our applications, if we consider measures X 0 = X 1 as a compact subset of R d , then there exists T such that µ 1 = T # µ 0 , when µ 0 and µ 1 are two measures, and µ 0 is atomless, as shown in <ref type="bibr" target="#b35">Villani (2003)</ref> and <ref type="bibr" target="#b34">Santambrogio (2015)</ref>. Out of those mappings from µ 0 to µ 1 , we can be interested in "optimal" mappings, satisfying Monge problem, from Monge (1781), i.e., solutions of inf</p><formula xml:id="formula_1">T # µ 0 =µ 1 X 0 c x 0 , T (x 0 ) µ 0 (dx 0 ),<label>(1)</label></formula><p>for some positive ground cost function c : X 0 × X 1 → R + . In general settings, however, such a deterministic mapping T between probability distributions may not exist (in particular if µ 0 and µ 1 are not absolutely continuous, with respect to Lebesgue measure). This limitation motivates the Kantorovich relaxation of Monge's problem, as considered in <ref type="bibr" target="#b17">Kantorovich (1942)</ref>,</p><formula xml:id="formula_2">inf π∈Π(µ 0 ,µ 1 ) X 0 ×X 1 c(x 0 , x 1 )π(dx 0 , dx 1 ),<label>(2)</label></formula><p>with our cost function c, where Π(µ 0 , µ 1 ) is the set of all couplings of µ 0 and µ 1 . This problem focuses on couplings rather than deterministic mappings It always admits solutions referred to </p><formula xml:id="formula_3">, • • • , β d j xj ← C(1, e x ⊤ j β 2 , • • • , e x ⊤ j β d ) else xj ← x j end if end for</formula><p>as OT plans. Observe that T ⋆ is an "increasing mapping, " in the sense of being the gradient of a convex function, from <ref type="bibr" target="#b4">Brenier (1991)</ref>). Finally, one should have in mind the the cost function c is related to the geometry of sets X .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">From Categorical to Compositional Data</head><p>Using the notations of the introduction, consider a dataset {s, x} where features x are either numerical (assumed to be "continuous"), or categorical. In the latter case, suppose that</p><formula xml:id="formula_4">x j takes values in {x j,1 , • • • , x j,d j }, or more conveniently, [[d j ]] = {1, • • • , d j },</formula><p>corresponding to the d j categories (as in the standard "One Hot" encoding).</p><p>The aim is to transform a categorical variable x, which takes values in <ref type="bibr">[[d]]</ref>, into a numerical one in the simplex S d . To achieve this, we suggest using a probabilistic classifier. This classifier is based on the other features in x, denoted by X -x . Mathematically, we consider a mapping from X -x to S d (and not to <ref type="bibr">[[d]</ref>] as in a standard multiclass classifier). The most natural model for this transformation is the Multinomial Logistic Regression (MLR), which is based on the "softmax" loss function. To normalize the output of the classifier into the simplex, we define the closure operator C : R d + → S d as</p><formula xml:id="formula_5">C[x 1 , x 2 , . . . , x d ] = x 1 d i=1 x i , x 2 d i=1 x i , • • • , x d d i=1 x i , or<label>shortly</label></formula><formula xml:id="formula_6">C(x) = x x ⊤ 1 ,</formula><p>where 1 is a vector of ones in R d . Then, in the MLR model, the transformation T : X -x → S d is given by</p><formula xml:id="formula_7">T (x) = C(1, e x ⊤ β 2 , • • • , e x ⊤ β d ) ∈ S d ,</formula><p>where β 2 , . . . , β d are the estimated coefficients for each category, and the first category is taken as the reference. This procedure is described in Algorithm 1.</p><p>As an illustration, consider the purpose variable from the German dataset. For simplicity, this variable has been reduced to three categories: C, E, O (representing cars, equipment, and other, respectively). More details on the dataset are provided in Section 7.1. The purpose variable is converted into a continuous variable using four models: (i) a GAM-MLR with splines Table <ref type="table">1</ref>: Mappings from the purpose categorical variable x to the compositional one x, (in the german credit dataset), for the first four individuals of the dataset. The first two models are GAM-MLR (multinomial model with splines for continuous variables), then, a random forest, and a boosting algorithm.</p><p>for three continuous variables, (ii) a GAM-MLR incorporating these variables and seven categorical ones, (iii) a random forest, and (iv) a gradient boosting model. Table <ref type="table">1</ref> presents the observed values in the first column for each model, along with the estimated scores for each category in the three remaining columns, corresponding to the transformed values T ⋆ (x).</p><p>Note that if we want to go back from compositions to categories, the standard approach is based on the majority (or argmax) rule.</p><p>In the rest of the paper, given a dataset {s, x}, all categorical variables are transformed into compositions, so that X is a product space of sets that are either R for numerical variables or S d (type) for compositions (d will change according to the number of categories).</p><p>In fact, for privacy issues, a classical strategy is to consider aggregated data on small groups (usually on a geographic level, per block, or per zip code), even if there is an ecological fallacy issue (that occurs when conclusions about individual behaviour or characteristics are incorrectly drawn based on aggregate data for a group, see <ref type="bibr" target="#b18">King et al. (2004)</ref>). Hence, using "compositional data" is quite natural in many cases, as unobserved categorical variables can often be represented as compositions predicted from observed variables serving as proxies. For example, in U.S. datasets, racial information about individuals may not always be available. However, the proportions of groups such as "White and European, " "Asian, " "Hispanic and Latino, " "Black or African American, " etc., within a neighbourhood may be observed instead (see, e.g., <ref type="bibr" target="#b8">Cheng et al. (2010)</ref>, <ref type="bibr" target="#b22">Naeini et al. (2015)</ref> and <ref type="bibr" target="#b35">Zadrozny and Elkan (2001)</ref> for more general discussions, or <ref type="bibr" target="#b16">Imai et al. (2022)</ref> about the use of predicted probabilities when categories are not observed).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Topology and Geometry of the Simplex</head><p>The standard simplex of R d is the regular polytope</p><formula xml:id="formula_8">S d = x ∈ R d + x ⊤ 1 = 1 , but for con- venience, consider the open version of that set, S d = x ∈ (0, 1) d x ⊤ 1 = 1 .</formula><p>Following <ref type="bibr" target="#b0">Aitchison (1982)</ref>, define the inner product</p><formula xml:id="formula_9">⟨x, y⟩ = 1 d i&lt;j log x i x j log y i y j ∀x, y ∈ S d ,<label>(3)</label></formula><p>and the simplex becomes a metric vector space if we consider the associated "Aitchison distance, " as coined in Pawlowsky-Glahn and <ref type="bibr" target="#b27">Egozcue (2001)</ref>. Figure <ref type="figure" target="#fig_1">1</ref> shows n = 61 points in S 3 . Each point x can be seen as a probability vector over {A, B, C}, drown either from a distribution P 0 for red points or P 1 for blue points.  If we define the binary operator ⋄ on S d ,</p><formula xml:id="formula_10">x ⋄ y = x 1 y 1 d i=1 x i y i , • • • , x d y d d i=1 x i y i , then (S d , ⋄</formula><p>) is a commutative group, with identity element d -1 1, and the inverse of x is</p><formula xml:id="formula_11">x -1 = 1/x 1 d i=1 1/x i , • • • , 1/x d d i=1 1/x i = C(1/x).</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Using an Alternative Representation of Simplex Data</head><p>A first strategy to define a transport mapping could be to use some isomorphism, h : S d → E and then define the inverse mapping h -1 : E → S d , where E is some Euclidean space, classically R d-1 , where the standard quadratic cost can be considered. This idea corresponds to the dual transport problem in <ref type="bibr" target="#b25">Pal and Wong (2018)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Classical Transformations</head><p>The additive log ratio (alr) transform is an isomorphism where alr :</p><formula xml:id="formula_12">S d → R d-1 , given by alr(x) = log x 1 x d , • • • , log x d-1 x d . Its inverse is, for any z ∈ R d-1 , alr -1 (z) = C(exp(z 1 ), • • • , exp(z d-1 ), 1) = C exp([z, 0]) .</formula><p>Such a map, from S d to R d-1 is related to the so-called "exponential coordinate system" of the unit simplex, in <ref type="bibr" target="#b23">Pal (2024)</ref>. The center log ratio (clr) transform is both an isomorphism and an isometry where clr :</p><formula xml:id="formula_13">S d → R d , clr(x) = log x 1 x g , • • • , log x D x g ,</formula><p>where x g denotes the geometric mean of x. Observe that the inverse of this function is the softmax function, i.e.,</p><formula xml:id="formula_14">clr -1 (z) = C(exp(z 1 ), • • • , exp(z d )) = C exp(z) , z ∈ R d .</formula><p>Finally, the isometric log ratio (ilr) transform, defined in <ref type="bibr" target="#b10">Egozcue et al. (2003)</ref>, is both an isomorphism and an isometry where ilr :</p><formula xml:id="formula_15">S d → R d-1 , ilr(x) = ⟨x, ⃗ e 1 ⟩, • • • , ⟨x, ⃗ e d-1 ⟩ for some orthonormal base {⃗ e 1 , • • • , ⃗ e d-1 , ⃗ e d } of R d . One can consider some matrix M, d × (d -1) such that MM ⊤ = I d-1 and M ⊤ M = I d + 1 d×d . Then ilr(x) = clr(x)M = log(x)M,<label>and</label></formula><formula xml:id="formula_16">ilr -1 (z) = C (exp(zM ⊤ ) , z ∈ R d-1 .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Gaussian Mapping in the Euclidean Representation</head><p>Given a random vector X in S d , we say that x follows a "normal distribution on the simplex" if, for some isomorphism h, the vector of orthonormal coordinates, Z = h(X) follows a multivariate normal distribution on R d-1 . If we suppose that both X 0 and X 1 , taking values in S d , follow "normal distributions on the simplex, " then we can use standard Gaussian optimal transport, between Z 0 and Z 1 . For convenience, suppose that the same isomorphism is used for both distributions (but that assumption can easily be relaxed). Hence, if Z 0 ∼ N (µ 0 , Σ 0 ) and Z 1 ∼ N (µ 1 , Σ 1 ), the optimal mapping is linear,</p><formula xml:id="formula_17">z 1 = T ⋆ (z 0 ) = µ 1 + A(z 0 -µ 0 ),<label>(4)</label></formula><p>where A is a symmetric positive matrix that satisfies AΣ 0 A = Σ 1 , which has a unique solution given by</p><formula xml:id="formula_18">A = Σ -1/2 0 Σ 1/2 0 Σ 1 Σ 1/2 0 1/2 Σ -1/2 0</formula><p>, where M 1/2 is the square root of the square (symmetric) positive matrix M based on the Schur decomposition (M 1/2 is a positive symmetric matrix), as described in <ref type="bibr" target="#b14">Higham (2008)</ref>. Interestingly, it is possible to derive McCann's displacement interpolation, from <ref type="bibr" target="#b20">McCann (1997)</ref>, to have some sort of continuous mapping T ⋆ t such that T ⋆ 1 = T ⋆ and T 0 = Id, and so that Z t = T ⋆ t (Z 0 ) has distribution N (µ t , Σ t ) where µ t = (1 -t)µ 0 + tµ 1 and Figure 2: Counterfactuals using the ilr transformation, and Gaussian optimal transports, µ 0 → µ 1 on the left, and µ 1 → µ 0 on the right. Below are the averages of x 0,i 's and x 1,i 's, and of the transported points. The lines are geodesics in the dual spaces, mapped in the simplex. Optimal transport in R 2 , on z 0,i 's and z 1,i 's, can be visualized at the bottom (with linear mapping since Gaussian assumptions are made).</p><formula xml:id="formula_19">Σ t = Σ -1/2 0 (1 -t)Σ 0 + t Σ 1/2 0 Σ 1 Σ 1/2 0 1/2 2 Σ -1/2 0 . A B C • (0)</formula><p>Empirically, this can be performed using Algorithm 2, and a simulation can be visualized in Figure <ref type="figure">2</ref>, where h = clr. On the left, we can visualize the mapping of red points to the blue distribution, and on the right, the "inverse mapping" of blue points to the red distribution. Transformed points z = h(x), that are plotted at the bottom, are supposed to be normally distributed, and a multivariate Gaussian Optimal Transport mapping is used. Hence, T ⋆ t is linear in R d-1 , as given by expression 4, as well as displacement interpolation, corresponding to red and blue segments. But, as we can see on top of Figure <ref type="figure">2</ref>, in the original space, t → x t := h -1 (z t ) will be nonlinear. Tables are average values of the three components of x's and Algorithm 2 Gaussian Based Transport of x 0 on S d Input:</p><formula xml:id="formula_20">x 0 (∈ S d ) Parameter: {x 0,1 , • • • , x 0,n 0 } and {x 1,1 , • • • , x 1,n 1 } in S d ; isomorphic transformation h : S d → R d-1 Output: x 1 for i ∈ {1, • • • , n 0 } do z 0,i ← h(x 0,i ) end for for i ∈ {1, • • • , n 1 } do z 1,i ← h(x 1,i ) end for m 0 ← average of {z 0,1 , • • • , z 0,n 0 } m 1 ← average of {z 1,1 , • • • , z 1,n 1 } S 0 ← empirical variance matrix of {z 0,1 , • • • , z 0,n 0 } S 1 ← empirical variance matrix of {z 1,1 , • • • , z 1,n 1 } A ← S -1/2 0 S 1/2 0 S 1 S 1/2 0 1/2 S -1/2 0 x 1 ← h -1 m 1 + A(h(x 0 ) -m 0 ) T ⋆ (x)'s.</formula><p>6 Optimal Transport for Measures on S d</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1">Theoretical Properties</head><p>A function ψ : S d → R is exponentially concave if exp[ψ] : S d → R + is concave. As a consequence, such a function ψ is differentiable almost everywhere. Let ∇ψ and ∇ ⃗ u ψ denote, respectively, its gradient, and its directional derivative. Following <ref type="bibr" target="#b24">Pal and Wong (2016</ref><ref type="bibr" target="#b25">, 2018</ref><ref type="bibr">, 2020)</ref>, define an allocation map generated by ψ, π ψ : S d → S d defined as</p><formula xml:id="formula_21">π ψ (x) = x 1 1 + ∇ ⃗ e 1 -x ψ(x) , • • • , x d 1 + ∇ ⃗ e d -x ψ(x) ,</formula><p>where {⃗ e 1 , • • • , ⃗ e d } is the standard orthonormal basis of R d . Consider the optimal transport problem with the following cost function, on S d × S d , i.e., the L-divergence corresponding to the cross-entropy,</p><formula xml:id="formula_22">c(x, y) = log 1 d d i=1 y i x i - 1 d d i=1 log y i x i ,<label>(5)</label></formula><p>called "Dirichlet transport" in <ref type="bibr" target="#b1">Baxendale and Wong (2022)</ref>. See <ref type="bibr" target="#b31">Pistone and Shoaib (2024)</ref> for a discussion about the connections with the distance induced by Aitchsion's inner product of Equation ( <ref type="formula" target="#formula_9">3</ref>). From Theorem 1 in <ref type="bibr" target="#b26">Pal and Wong (2020)</ref>, for this cost function, there exists an exponentially concave function ψ ⋆ : S d → R such that</p><formula xml:id="formula_23">T ⋆ (x) = x ⋄ π ψ ⋆ x -1</formula><p>defines a push-forward from P 0 to P 1 , and the coupling (x, T ⋆ (x)) is optimal for problem (1), and is unique if P 0 is absolutely continuous. Observe that if y = T ⋆ (x),</p><formula xml:id="formula_24">y = C π ψ ⋆ z 1 /z 1 , • • • , π ψ ⋆ z d /z d ,</formula><p>where z = x -1 .</p><p>One can also consider an interpolation,</p><formula xml:id="formula_25">T ⋆ t (x) = x ⋄ π t x -1</formula><p>where π t = (1 -t)d -1 1 + tπ ψ ⋆ (even if this approach differs from McCann's displacement interpolation).</p><p>Note that a classical distribution on S d is Dirichlet distribution, with density</p><formula xml:id="formula_26">f (x 1 , . . . , x d ; α) = 1 B(α) d i=1 x α i -1 i for some α = (α 1 , . . . , α d ) ∈ R d</formula><p>+ , and a normalizing constant denoted B(α). Level curves of the density of Dirichlet distributions fitted on our toy dataset can be visualized in Figure <ref type="figure" target="#fig_2">3</ref>. Unfortunately, unlike the multivariate Gaussian distribution, there is no explicit expression for the optimal mapping between Dirichlet distribution (regardless of the cost). Therefore, to remain within S d and avoid the R d-1 representation, numerical techniques should be considered. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">Matching</head><p>Consider two samples in the</p><formula xml:id="formula_27">S d simplex, {x 0,1 , • • • , x 0,n 0 } and {x 1,1 , • • • , x 1,n 1 }.</formula><p>The discrete version of the Kantorovich problem (corresponding to Equation <ref type="formula" target="#formula_2">2</ref>) is min</p><formula xml:id="formula_28">P∈U (n 0 ,n 1 )    n 0 i=1 n 1 j=1 P i,j C i,j    (6)</formula><p>where, as in <ref type="bibr" target="#b5">Brualdi (2006)</ref>, U (n 0 , n 1 ) is the set of n 0 ×n 1 matrices corresponding to the convex transportation polytope</p><formula xml:id="formula_29">U (n 0 , n 1 ) = P : P1 n 1 = 1 n 0 and P ⊤ 1 n 0 = n 0 n 1 1 n 1 , Algorithm 3 Coupling samples on S d Input: {x 0,1 , • • • , x 0,n 0 } and {x 1,1 , • • • , x 1,n 1 } in S d ;</formula><p>Output: weight matching matrix n 0 × n 1 P * C ← matrix n 0 × n 1 , C i,j = c(x i , x j ) using ( <ref type="formula" target="#formula_22">5</ref>) P ⋆ ← solution of Equation ( <ref type="formula">6</ref>), using LP libraries and where C denotes the n 0 × n 1 cost matrix, C i,j = c(x i , x j ), associated with cost from Equation ( <ref type="formula" target="#formula_22">5</ref>).</p><p>In Algorithm 3, we recall how this procedure works, which is the one explained in Peyré et al. ( <ref type="formula">2019</ref>), with a specific cost function (from Equation ( <ref type="formula" target="#formula_22">5</ref>)). In the toy dataset, this can be visualized for two specific observations x 0,i . If n 0 ̸ = n 1 , it is not a one-to-one coupling, and "the counterfactual" is actually a weighted average of x 1,j 's, where weights are given in row</p><formula xml:id="formula_30">P ⋆ i = [P ⋆ i,1 , • • • , P ⋆ i,n 1 ] ∈ S n 1 .</formula><p>Figure <ref type="figure">4</ref>: Getting empirical counterfactuals using matching techniques, with x 0,i in red (on the topleft hand-side), and counterfactuals x 1,j 's in blue (bottom-right hand-side), with size proportional to</p><formula xml:id="formula_31">P ⋆ i = [P ⋆ i,1 , • • • , P ⋆ i,n 1 ] ∈ S n 1 .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Application on Sequential Transport for Counterfactuals</head><p>Variables x j in tabular data are either continuous or categorical. If x j is continuous, since x j ∈ R, transporting from observed x j |s = 0 to counterfactual x j |s = 1 is performed using standard (conditional) monotonic mapping, as discussed in Fernandes Machado et al. ( <ref type="formula">2025</ref>), using classical F -1 1 • F 0 . If x j is categorical, with d categories, consider some fitted model m(x j |x -j ), using some multinomial loss, and let x j = m(x j |x -j ) denote the predicted scores, so that x j ∈ S d . Then use Algorithm 2, with a Gaussian mapping in an Euclidean representation space, to transport from observed x j |s = 0 to counterfactual x j |s = 1, in S d .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.1">German Credit: Purpose</head><p>In the popular German Credit dataset, from <ref type="bibr" target="#b15">Hofmann (1994)</ref>, the variable Purpose described the reason an individual took out a loan. This variable is an important predictor for explaining potential defaults. The original variable is based on ten categories, that are merged here into three main classes, cars, equipment and other, in order to visualize the transport in a ternary plot -or Gibbs triangle. The sensitive variable s is here Sex.</p><p>We aim to construct a counterfactual value for the loan purpose, assuming the individuals were of a different sex. To achieve this, we apply our suggested procedure from to represent the purpose categorical variable as a compositional variable, using the same four models outlined in Section 3 and then apply Gaussian mapping from Section 5.2. The results provided by all of the models, shown in Figure <ref type="figure" target="#fig_3">5</ref>, suggest that, had the individuals been of a different sex, the purpose of the loan would have changed. Specifically, if the average scores in each group (cars, equipment, and other) were approximately [35%, 45%, 20%] in the female population, after transporting to obtain the counterfactuals, the average scores become [31%, 52%, 18%], which closely resemble the actual frequencies of each category in the original male population.</p><p>One can also consider our second approach, using matching in S 3 . Consider individual i among women, e.g., the left of Figure <ref type="figure" target="#fig_4">6</ref>, x 0,i = "equipment. " Using a MLR model, we obtain composition x 0,i , here [11.38%, 79.30%, 9.32]. Using Algorithm 3, three points x 1,j 's are matched, respectively with weights [0.453, 0.094, 0.453]. The first and the third individuals are such that x 1,j = "equipment" too, the second one "other. " So it would make sense to suppose that the counterfactual version of woman i with an "equipment" credit is a man with the same purpose. Actually, using Gaussian transport, T ⋆ (x 0,i ) = [15.78%, 69.54%, 14.68%].</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.2">Adult: Marital Status</head><p>Following the numerical applications in <ref type="bibr" target="#b33">Plečko et al. (2024) and</ref><ref type="bibr" target="#b11">Fernandes Machado et al. (2025)</ref>, we consider here the Adult dataset, from <ref type="bibr" target="#b2">Becker and Kohavi (1996)</ref>. We regrouped categories of the Marital Status variable to create three generic ones (that can be visualized in a ternary plot, as in Figure <ref type="figure">7</ref>), namely Married, Never-married and Separated. This example is interesting because if we compare status with respect to the Sex variable, proportions are quite different. In the dataset, proportions for married, never married, and separated are (roughly) [62%, 27%, 12%] for men, [14%, 44%, 41%] for women (more precise values are at the top of the table in Figure <ref type="figure">7</ref>). Thus, the counterfactual of a "separated" woman is more likely to be a "married" man than a "separated" man. Four models are used to convert the categorical variable Marital Status into a composition, as previously. The first MLR is based on three variables: a categorical variable, occupation, and two continuous ones, age, and hours_per_week, modeled nonlinearly using b-splines (hence, it is referred to as a logistic GAM). This model is clearly underfitted. Therefore, observations x 0,i 's for women and x 1,i 's for men clearly are in the interior of S d . In contrast, the more complex MLR (which uses additional features), as well as the random forest and boosting models, can produce predictions near the simplex boundary, ∂S d .</p><p>For the underfitted model (top left), transported scores have a distribution very close to the ones in the population of men. For the more accurate MLR model (top right), proportions are very close to the actual proportions (which is not surprising since GLMs are usually well calibrated), but the transported scores are slightly different than the proportions of categories (proportions were [62%, 27%, 12%] while average transported scores are [67%, 25%, 8%]). At least, we are different from the original ones, but the mapping is not as accurate as it should be. This might come from the fact that when the points x i are close to the border ∂S d , it is quite unlikely that the sample z i is Gaussian.   </p><formula xml:id="formula_32">categorical • (M) categorical • (F) composition • (M) composition • (F) T (•)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">Conclusion</head><p>In this article, we introduce a novel approach for constructing counterfactuals for categorical data by transforming them into compositional data using a probabilistic classifier. Our approach avoids imposing arbitrary assumptions about label ordering. However, our methodology is not without limitations. OT computations, particularly on the simplex, can be computationally intensive for large-scale datasets, posing challenges in high-dimensional settings.</p><p>Additionally, the reliance on a probabilistic classifier in the initial step introduces potential vulnerabilities. Biases may arise from a poorly calibrated or inaccurate classifier, impacting the quality of the subsequent analysis-especially with scarce categories that may need grouping to apply the proposed method.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A Complexity of the Main Algorithms</head><p>The complexity of Algorithm 2 is O(d 3 +(n 0 +n 1 )d 2 ) primarily arising from the computation of the class-wise covariance matrices S 0 , S 1 , and the transformation matrix A. When the number of classes d becomes large, this cost becomes prohibitive; in such scenarios, alternative OT formulations (beyond the Gaussian OT mapping) are advisable. Alternatively, Algorithm 3 provides a more scalable approach in high-dimensional settings. Here, d only affects the cost matrix computation with complexity O(n 0 n 1 d), while the dominant computational burden lies in solving the OT problem, which scales as O((n 0 n 1 ) 3/2 ) when using the Operator Splitting Quadratic Program (OSQP) solver.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B Choice of the Cost Function in Algorithm 3</head><p>Section 6 introduces an approach to transporting probability measures directly on the simplex S d . More precisely, Section 6.1 defines the existence of an OT map T ⋆ from a source measure P 0 on S d to a target measure P 1 on S d , using the cross-entropy as the cost function, which is referred to as "Dirichlet transport" <ref type="bibr" target="#b1">(Baxendale and Wong, 2022)</ref>. While this cost function guarantees the theoretical existence of an optimal map, no closed-form expression for T ⋆ is available in practice. Instead, numerical optimization is performed via the Kantorovich formulation of the OT problem to match individuals from P 0 to P 1 on S d , as described in Section 6.2. Although Euclidean costs, such as the Wasserstein-1 or Wasserstein-2 distances, could be considered, they violate the geometry of the simplex by relying on absolute differences, unlike the cross-entropy, which accounts for relative proportions.</p><p>C Integration of the methodology into a SCM for counterfactual fairness assessment</p><p>In Section 3, to transform a categorical variable x into a numerical one, we suggest using a probabilistic classifier based on the features X -x , i.e., all features except the categorical variable. In this appendix, we consider a more global approach, within an SCM, which requires positing a structural causal model in advance. Consider the DAG shown in Figure <ref type="figure" target="#fig_5">8</ref>, whose topological order is</p><formula xml:id="formula_33">S → X 1 → X 2 → X 3 → Y,</formula><p>where S ∈ {0, 1} is the sensitive treatment (for example, binary gender), X 1 ∈ R is a numeric feature, X 2 ∈ [[d 2 ]] and X 3 ∈ [[d 3 ]] are categorical features with d 2 and d 3 categories, respectively, and Y is the outcome sink. To generate a counterfactual for an individual with S = 0, we first flip the treatment by setting S = 1. We then obtain the numeric counterfactual X ⋆ 1 using a chosen mapping mechanism (e.g., using optimal transport). Subsequently, we construct each categorical counterfactual in sequence. For X 2 , we fit a classifier on its parents (S, X 1 ) to estimate the conditional distribution P (X 2 | S, X 1 ). This yields probability vectors in the simplex S d 2 for both the factual group (S = 0) and the counterfactual group (S = 1), which needs to be converted to a single label X ⋆ 2 in {1, . . . , d 2 }. We suggest either sampling according to the probabilities or selecting the highest-probability category (top-label). We repeat the same process for X 3 , estimating P (X 3 | S, X 2 ) and mapping its output into {1, . . . , d 3 }. Finally, we predict the counterfactual outcome Y ⋆ with a model conditioned on (S, X ⋆ 1 , X ⋆ 2 , X ⋆ 3 ). This sequential, topologically ordered procedure embeds each probabilistic result into its required discrete space, ensuring consistency with the a priori SCM. Matching individuals using their probability vectors on S d allows to uniquely determine them as it involves continuous distributions on [0, 1] for each category. In contrast, if counterfactuals were computed directly from categorical data, one would need to rely on the nondeterministic counterfactual framework described in <ref type="bibr">(Pearl et al., 2016, Chap. 4</ref>).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><label></label><figDesc>on the one hand (based on quantile regressions) and Black et al. (2020); Charpentier et al. (2023); De Lara et al. (2024); Fernandes Machado et al. (2025) (based on OT) are quite similar.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: n = 61 points in S 3 , with a toy dataset.</figDesc><graphic coords="6,193.47,151.18,208.35,207.50" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3 :</head><label>3</label><figDesc>Figure 3: Densities of Dirchlet distributions in S 3 fitted on observations of the toy dataset of Figure 1.</figDesc><graphic coords="10,89.29,311.20,208.35,207.50" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Optimal transport using the clr transformation, and Gaussian optimal transports, on the purpose scores in the German Credit database, with two logistic GAM models to predict scores, on top, and below a random forest (left) and a boosting model (right). Points in red are compositions for women, while points in blue are for men. Lines indicate the displacement interpolation when generating counterfactuals.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 6 :</head><label>6</label><figDesc>Figure 6: Empirical matching of two women, in red, from the German Credit dataset, with 2 or 3 men, in blue. Size of blue dots are proportional to the weights P ⋆ i .</figDesc><graphic coords="14,89.29,85.04,208.34,208.34" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 8 :</head><label>8</label><figDesc>Figure 8: Example of a Structural Causal Model with a sensitive attribute S, a numeric variable X 1 , two categorical variables X 2 and X 3 , and an output variable Y .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>Algorithm 1 From categorical variables into compositions. Input: training dataset D = {(s i , x i )} Input: new observation (s, x), with x j 's either in R or [[d j ]] Output: (s, x), with xj 's either in R or S d j</figDesc><table><row><cell>for j ∈ {1, • • • , k} do</cell></row><row><cell>if x j ∈ [[d j ]] then</cell></row><row><cell>estimate a MLR to predict categorical x j using D</cell></row><row><cell>get estimates β 2</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head></head><label></label><figDesc>43.713% 18.572% 37.715% • (1) 29.831% 48.605% 21.564% T (•) 29.553% 48.517% 21.930%</figDesc><table><row><cell>A</cell><cell>B</cell><cell>C</cell></row><row><cell cols="3">• (0) 43.713% 18.572% 37.715%</cell></row><row><cell cols="3">• (1) 29.831% 48.605% 21.564%</cell></row><row><cell cols="3">T (•) 43.728% 18.553% 37.719%</cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0"><p>Details on how the method can be integrated within an SCM are discussed in Appendix C.</p></note>
		</body>
		<back>

			<div type="funding">
<div><p><rs type="person">Arthur Charpentier</rs> acknowledges funding from the <rs type="funder">SCOR Foundation for Science and the National Sciences and Engineering Research Council (NSERC)</rs> for funding (<rs type="grantNumber">RGPIN-2019-07077</rs>). <rs type="person">Ewen Gallic</rs> acknowledges funding from the <rs type="funder">French government</rs> under the "<rs type="programName">France 2030</rs>" investment plan managed by the <rs type="funder">French National Research Agency</rs> (reference: <rs type="grantNumber">ANR-17-EURE-0020</rs>) and from <rs type="funder">Excellence Initiative of Aix-Marseille University</rs> -A*MIDEX. Replication codes and companion e-book: <ref type="url" target="https://github.com/fer-agathe/transport-simplex">https://github.com/fer-agathe/transport-simplex</ref> </p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_7PQc6rX">
					<idno type="grant-number">RGPIN-2019-07077</idno>
				</org>
				<org type="funding" xml:id="_yJZzZja">
					<orgName type="program" subtype="full">France 2030</orgName>
				</org>
				<org type="funding" xml:id="_urppbwR">
					<idno type="grant-number">ANR-17-EURE-0020</idno>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0" />			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">The statistical analysis of compositional data</title>
		<author>
			<persName><forename type="first">J</forename><surname>Aitchison</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society: Series B (Methodological)</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="139" to="160" />
			<date type="published" when="1982">1982</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Random concave functions</title>
		<author>
			<persName><forename type="first">P</forename><surname>Baxendale</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T.-K</forename><forename type="middle">L</forename><surname>Wong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of Applied Probability</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="812" to="852" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<author>
			<persName><forename type="first">B</forename><surname>Becker</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Kohavi</surname></persName>
		</author>
		<idno type="DOI">10.24432/C5XW20</idno>
		<title level="m">Adult. UCI Machine Learning Repository</title>
		<imprint>
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Fliptest: fairness testing via optimal transport</title>
		<author>
			<persName><forename type="first">E</forename><surname>Black</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Yeom</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Fredrikson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 2020 Conference on Fairness, Accountability, and Transparency</title>
		<meeting>the 2020 Conference on Fairness, Accountability, and Transparency</meeting>
		<imprint>
			<date type="published" when="2020">2020</date>
			<biblScope unit="page" from="111" to="121" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Polar factorization and monotone rearrangement of vector-valued functions</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Brenier</surname></persName>
		</author>
		<idno type="DOI">10.1002/cpa.3160440402</idno>
	</analytic>
	<monogr>
		<title level="j">Communications on pure and applied mathematics</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="375" to="417" />
			<date type="published" when="1991">1991</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Combinatorial matrix classes</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Brualdi</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2006">2006</date>
			<publisher>Cambridge University Press</publisher>
			<biblScope unit="volume">13</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Optimal transport for counterfactual estimation: A method for causal inference</title>
		<author>
			<persName><forename type="first">A</forename><surname>Charpentier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Flachaire</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Gallic</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Optimal Transport Statistics for Economics and Related Topics</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2023">2023</date>
			<biblScope unit="page" from="45" to="89" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">F</forename><surname>Chayes</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1971">1971</date>
			<publisher>University of Chicago Press</publisher>
		</imprint>
	</monogr>
	<note>Ratio correlation</note>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Bayes optimal multilabel classification via probabilistic classifier chains</title>
		<author>
			<persName><forename type="first">W</forename><surname>Cheng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Hüllermeier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">J</forename><surname>Dembczynski</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 27th international conference on machine learning</title>
		<meeting>the 27th international conference on machine learning</meeting>
		<imprint>
			<date type="published" when="2010">2010</date>
			<biblScope unit="page" from="279" to="286" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Transport-based counterfactual models</title>
		<author>
			<persName><forename type="first">L</forename><surname>De Lara</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>González-Sanz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Asher</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Risser</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-M</forename><surname>Loubes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="1" to="59" />
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Isometric logratio transformations for compositional data analysis</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">J</forename><surname>Egozcue</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Pawlowsky-Glahn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Mateu-Figueras</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Barcelo-Vidal</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mathematical geology</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="page" from="279" to="300" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Sequential conditional transport on probabilistic graphs for interpretable counterfactual fairness</title>
		<author>
			<persName><forename type="first">A</forename><surname>Fernandes Machado</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Charpentier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Gallic</surname></persName>
		</author>
		<idno type="DOI">10.1609/aaai.v39i18.34131</idno>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the AAAI Conference on Artificial Intelligence</title>
		<meeting>the AAAI Conference on Artificial Intelligence</meeting>
		<imprint>
			<date type="published" when="2025">2025</date>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="19358" to="19366" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Distribution and quantile functions, ranks and signs in dimension d: A measure transportation approach</title>
		<author>
			<persName><forename type="first">M</forename><surname>Hallin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Del Barrio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Cuesta-Albertos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Matrán</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of Statistics</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="page" from="1139" to="1165" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Multivariate quantiles: Geometric and measuretransportation-based contours</title>
		<author>
			<persName><forename type="first">M</forename><surname>Hallin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Konen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Applications of Optimal Transport to Economics and Related Topics</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2024">2024</date>
			<biblScope unit="page" from="61" to="78" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">J</forename><surname>Higham</surname></persName>
		</author>
		<title level="m">Functions of matrices: theory and computation</title>
		<imprint>
			<publisher>SIAM</publisher>
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">German Credit Data</title>
		<author>
			<persName><forename type="first">H</forename><surname>Hofmann</surname></persName>
		</author>
		<idno type="DOI">10.24432/C5NC77</idno>
	</analytic>
	<monogr>
		<title level="j">UCI Machine Learning Repository</title>
		<imprint>
			<date type="published" when="1994">1994</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Addressing census data problems in race imputation via fully bayesian improved surname geocoding and name supplements</title>
		<author>
			<persName><forename type="first">K</forename><surname>Imai</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Olivella</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">T</forename><surname>Rosenman</surname></persName>
		</author>
		<idno type="DOI">10.1126/sciadv.adc9824</idno>
	</analytic>
	<monogr>
		<title level="j">Science Advances</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">9824</biblScope>
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">On the translocation of masses</title>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">V</forename><surname>Kantorovich</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Doklady Akademii Nauk USSR</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="199" to="201" />
			<date type="published" when="1942">1942</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<author>
			<persName><forename type="first">G</forename><surname>King</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Tanner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Rosen</surname></persName>
		</author>
		<title level="m">Ecological inference: New methodological strategies</title>
		<imprint>
			<publisher>Cambridge University Press</publisher>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Counterfactual fairness</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Kusner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Loftus</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Russell</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Silva</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in Neural Information Processing Systems 30. NIPS</title>
		<editor>
			<persName><forename type="first">I</forename><surname>Guyon</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">U</forename><forename type="middle">V</forename><surname>Luxburg</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">S</forename><surname>Bengio</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">H</forename><surname>Wallach</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">R</forename><surname>Fergus</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">S</forename><surname>Vishwanathan</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">R</forename><surname>Garnett</surname></persName>
		</editor>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="4066" to="4076" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">A convexity principle for interacting gases</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in mathematics</title>
		<imprint>
			<biblScope unit="volume">128</biblScope>
			<biblScope unit="page" from="153" to="179" />
			<date type="published" when="1997">1997</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Mémoire sur la théorie des déblais et des remblais</title>
		<author>
			<persName><forename type="first">G</forename><surname>Monge</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Histoire de l&apos;Académie Royale des Sciences de</title>
		<imprint>
			<date type="published" when="1781">1781</date>
			<pubPlace>Paris</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Obtaining well calibrated probabilities using bayesian binning</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">P</forename><surname>Naeini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Cooper</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Hauskrecht</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the AAAI conference on artificial intelligence</title>
		<meeting>the AAAI conference on artificial intelligence</meeting>
		<imprint>
			<date type="published" when="2015">2015</date>
			<biblScope unit="page">29</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">On the difference between entropic cost and the optimal transport cost</title>
		<author>
			<persName><forename type="first">S</forename><surname>Pal</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of Applied Probability</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="1003" to="1028" />
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">The geometry of relative arbitrage</title>
		<author>
			<persName><forename type="first">S</forename><surname>Pal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T.-K</forename><forename type="middle">L</forename><surname>Wong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mathematics and Financial Economics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="263" to="293" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Exponentially concave functions and a new information geometry</title>
		<author>
			<persName><forename type="first">S</forename><surname>Pal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T.-K</forename><forename type="middle">L</forename><surname>Wong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of probability</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="page" from="1070" to="1113" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Multiplicative schrödinger problem and the dirichlet transport</title>
		<author>
			<persName><forename type="first">S</forename><surname>Pal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T.-K</forename><forename type="middle">L</forename><surname>Wong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Probability Theory and Related Fields</title>
		<imprint>
			<biblScope unit="volume">178</biblScope>
			<biblScope unit="page" from="613" to="654" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Geometric approach to statistical analysis on the simplex</title>
		<author>
			<persName><forename type="first">V</forename><surname>Pawlowsky-Glahn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">J</forename><surname>Egozcue</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stochastic Environmental Research and Risk Assessment</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="384" to="398" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<monogr>
		<title level="m" type="main">Causality</title>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>Cambridge university press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">Causal inference in statistics: A primer</title>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Glymour</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">P</forename><surname>Jewell</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2016">2016</date>
			<publisher>John Wiley Sons</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Computational optimal transport: With applications to data science</title>
		<author>
			<persName><forename type="first">G</forename><surname>Peyré</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Cuturi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Foundations and Trends in Machine Learning</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="355" to="607" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<monogr>
		<title level="m" type="main">A unified approach to aitchison&apos;s, dually affine, and transport geometries of the probability simplex</title>
		<author>
			<persName><forename type="first">G</forename><surname>Pistone</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Shoaib</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2024">2024</date>
			<biblScope unit="page">823</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Fair data adaptation with quantile preservation</title>
		<author>
			<persName><forename type="first">D</forename><surname>Plečko</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Meinshausen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="1" to="44" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">Fairadapt: Causal reasoning for fair data preprocessing</title>
		<author>
			<persName><forename type="first">D</forename><surname>Plečko</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Bennett</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Meinshausen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Software</title>
		<imprint>
			<biblScope unit="volume">110</biblScope>
			<biblScope unit="page" from="1" to="35" />
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<monogr>
		<author>
			<persName><forename type="first">F</forename><surname>Santambrogio</surname></persName>
		</author>
		<title level="m">Optimal transport for applied mathematicians</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">Obtaining calibrated probability estimates from decision trees and naive Bayesian classifiers</title>
		<author>
			<persName><forename type="first">C</forename><surname>Villani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Zadrozny</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Elkan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Eighteenth International Conference on Machine Learning, ICML &apos;01</title>
		<meeting>the Eighteenth International Conference on Machine Learning, ICML &apos;01<address><addrLine>San Francisco, CA, USA</addrLine></address></meeting>
		<imprint>
			<publisher>Morgan Kaufmann Publishers Inc</publisher>
			<date type="published" when="2001">2003. 2001</date>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="page" from="609" to="616" />
		</imprint>
	</monogr>
	<note>Topics in optimal transportation</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
