<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Functional structural equation modeling with latent variables</title>
				<funder>
					<orgName type="full">ERA-NET-NEURON</orgName>
				</funder>
				<funder ref="#_jWMQVpn">
					<orgName type="full">JTC 2020/Norwegian Research Council</orgName>
				</funder>
				<funder ref="#_2aFPuwB">
					<orgName type="full">South-Eastern Norway Regional Health Authority</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability  status="unknown">
					<licence/>
				</availability>
				<date type="published" when="2024-12-26">26 Dec 2024</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Fatemeh</forename><surname>Asgari</surname></persName>
							<email>fatemeh.asgari@medisin.uio.no</email>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Behavioural Medicine</orgName>
								<orgName type="department" key="dep2">Institute of Basic Medical Sciences</orgName>
								<orgName type="department" key="dep3">Faculty of Medicine</orgName>
								<orgName type="institution">University of Oslo</orgName>
								<address>
									<settlement>Oslo</settlement>
									<country key="NO">Norway</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Oslo Centre for Biostatistics and Epidemiology</orgName>
								<orgName type="department" key="dep2">Department of Biostatistics</orgName>
								<orgName type="department" key="dep3">Institute of Basic Medical Sciences</orgName>
								<orgName type="institution">University of Oslo</orgName>
								<address>
									<settlement>Oslo</settlement>
									<country key="NO">Norway</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Department of Endocrinology, Obesity and Nutrition</orgName>
								<orgName type="institution">Vestfold Hospital Trust</orgName>
								<address>
									<settlement>TÃ¸nsberg</settlement>
									<country key="NO">Norway</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Valeria</forename><surname>Vitelli</surname></persName>
							<email>valeria.vitelli@medisin.uio.no</email>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Oslo Centre for Biostatistics and Epidemiology</orgName>
								<orgName type="department" key="dep2">Department of Biostatistics</orgName>
								<orgName type="department" key="dep3">Institute of Basic Medical Sciences</orgName>
								<orgName type="institution">University of Oslo</orgName>
								<address>
									<settlement>Oslo</settlement>
									<country key="NO">Norway</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Uta</forename><surname>Sailer</surname></persName>
							<email>uta.sailer@medisin.uio.no</email>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Behavioural Medicine</orgName>
								<orgName type="department" key="dep2">Institute of Basic Medical Sciences</orgName>
								<orgName type="department" key="dep3">Faculty of Medicine</orgName>
								<orgName type="institution">University of Oslo</orgName>
								<address>
									<settlement>Oslo</settlement>
									<country key="NO">Norway</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Functional structural equation modeling with latent variables</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2024-12-26">26 Dec 2024</date>
						</imprint>
					</monogr>
					<idno type="arXiv">arXiv:2412.19242v1[stat.ME]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-21T20:12+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Latent variables</term>
					<term>Structural equation model</term>
					<term>Functional data</term>
					<term>Gaussian process</term>
					<term>Monte Carlo expectation-maximization algorithm</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Handling latent variables in Structural Equation Models (SEMs) in a case where both the latent variables and their corresponding indicators in the measurement error part of the model are random curves presents significant challenges, especially with sparse data. In this paper, we develop a novel family of Functional Structural Equation Models (FSEMs) that incorporate latent variables modeled as Gaussian Processes (GPs). The introduced FSEMs are built upon functional regression models having response variables modeled as underlying GPs. The model flexibly adapts to cases when the random curves' realizations are observed only over a sparse subset of the domain, and the inferential framework is based on a restricted maximum likelihood approach. The advantage of this framework lies in its ability and flexibility in handling various data scenarios, including regularly and irregularly spaced points and thus missing data. To extract smooth estimates for the functional parameters, we employ a penalized likelihood approach that selects the smoothing parameters using a cross-validation method. We evaluate the performance of the proposed model using simulation studies and a real data example, which suggests that our model performs well in practice. The uncertainty associated with the estimates of the functional coefficients is also assessed by constructing confidence regions for each estimate. The goodness of fit indices that are commonly used to evaluate the fit of SEMs are developed for the FSEMs introduced in this paper. Overall, the proposed method is a promising approach for modeling functional data in SEMs with functional latent variables.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Structural Equation Models (SEMs) have been successfully used in many fields of science to model how the different aspects of a phenomenon are thought to causally connect to one another. In SEMs including latent variables, both the observed and the latent variables might be curves over a domain. Several studies in recent years have addressed this kind of situation, for SEMs where all variables are observed, by adapting this setting to the functional data analysis (FDA) context <ref type="bibr" target="#b20">(Silverman &amp; Ramsay, 2002;</ref><ref type="bibr" target="#b18">Ramsay &amp; Silverman, 2005)</ref>. In a functional SEM (FSEM) setting, the directional relationships among the variables are estimated through functional regression models <ref type="bibr" target="#b18">(Ramsay &amp; Silverman, 2005;</ref><ref type="bibr" target="#b22">Wang et al., 2016)</ref>. Examples of this approach are <ref type="bibr" target="#b12">Lindquist (2012)</ref> and <ref type="bibr" target="#b25">Zhao et al. (2018)</ref>, who developed a class of functional mediation models, while <ref type="bibr" target="#b24">Zeng et al. (2021)</ref> and <ref type="bibr" target="#b3">Coffman et al. (2022)</ref> extended the functional mediation model to deal with sparse and irregular longitudinal data, and with binaryvalued outcomes, respectively. A functional mediation model for describing nonlinear relations among the observed variables was studied by <ref type="bibr">Lee &amp; Li (2022)</ref>.</p><p>In some modeling situations where FSEMs would be suited, the variables of interest cannot be directly measured, requiring their estimation through corresponding indicators in a measurement model. While the measurement model itself may be of interest, the primary focus typically lies in the structural component of the model. This structural part specifies the directional relationships among the factors, or between latent factors and observed variables. All aforementioned studies focusing on FSEMs primarily address the scenario where all random variables are observed. Despite the many potential applications for FSEMs incorporating latent functional variables, this topic, which explores latent functional variables within FSEMs, has received no attention in the literature so far.</p><p>In this work, we focus on FSEMs with latent variables and corresponding indicators sparsely observed over the domain. Handling latent variables in the context of FDA settings can be approached in several ways, and among methods focusing on this issue we find <ref type="bibr" target="#b7">Guo (2002)</ref>, <ref type="bibr" target="#b15">Morris &amp; Carroll (2006)</ref>, <ref type="bibr" target="#b14">Montagna et al. (2012)</ref>, <ref type="bibr" target="#b26">Zhu et al. (2011)</ref>, <ref type="bibr" target="#b17">Noh et al. (2020)</ref>. We tackle this problem by considering each indicator as a Gaussian random Process (GP) and provide a likelihood-based framework for developing and performing inference in a new class of FSEMs that incorporate latent factors.</p><p>The FSEMs developed in this paper are built upon the function-on-function and function-on-scalar regression models. The latent variables in our framework are represented as latent random GPs that are identified through one or more measurement models. Three types of effects for factor loadings are considered in this paper: fixed, concurrent, and historical <ref type="bibr" target="#b13">(Malfait &amp; Ramsay, 2003;</ref><ref type="bibr" target="#b22">Wang et al., 2016)</ref>. The fixed effect represents the association between the indicator and the latent factor using a scalar parameter. The concurrent effect describes the pointwise association between the indicator and the latent factor over time, modeled by a smooth function. Historical effects account for the influence of past values of the latent factor on the indicator at a specific point in time, represented by an integral. Our framework supports both scalar and functional covariates, encompassing four types of effects: concurrent, historical, linear, and smooth. Unlike the linear effect, the smooth effect captures the nonlinear influences of scalar covariates.</p><p>To estimate the kernel functions, we employ functional principal component analysis <ref type="bibr" target="#b18">(Ramsay &amp; Silverman, 2005;</ref><ref type="bibr" target="#b19">Rice &amp; Silverman, 1991;</ref><ref type="bibr" target="#b23">Yao et al., 2005)</ref>. Since we aim at obtaining smooth estimates for the functional regression coefficients, we employ a penalized likelihood approach in which all smoothing parameters are chosen using a cross-validation method.</p><p>To demonstrate the use of the proposed model, we analyse a dataset from the Health and Retirement Study (HRS) <ref type="bibr">(Health and Retirement Study, 2024)</ref>. The HRS is a nationally representative longitudinal survey conducted from the University of Michigan (US), including more than 12K adults aged 50 and over, and encompassing a comprehensive array of questions concerning health, psychological variables, and income. Initiated in 1992, the HRS is an ongoing study, with participants being interviewed biennially since the study started. This dataset has previously been investigated using longitudinal methods (see <ref type="bibr" target="#b16">Newsom, 2015)</ref>. In this work, the General Factor of Personality (GFP) is treated as a latent factor identified by the Big Five personality traits. GFP is discussed in the literature and is criticized by different researchers, while others suggest that it could reflect Social Effectiveness (SEff), influencing behaviors that are socially desirable and advantageous <ref type="bibr" target="#b21">(Van Der Linden et al., 2016)</ref>. We employ the proposed FSEM to investigate GFP as a latent factor, and to study the change of the factor loadings across time while estimating the relationship between GFP and different covariates (including 'sex' and 'having been diagnosed with any type of cancer') in a functional regression framework.</p><p>The rest of this paper is organized as follows. In Section 2, we introduce the measurement model and the structural model for the FSEM, and their finite-dimensional truncated models are given by means of basis expansions. Section 3 presents the inferential framework for both estimation and smoothing, which is based on the Expectation-Maximization (EM) algorithm. In Section 4, we address the uncertainty of the estimates for the regression coefficients. Section 5 provides extensions for the goodness of fit indices used for the conventional SEM. The performance of the developed model is assessed in Section 6 through simulation studies. The proposed model is fitted to real data from the HRS to demonstrate its usefulness in an application context in Section 7. Finally, the study conclusions and a discussion are provided in Section 8.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Functional structural equation model (FSEM)</head><p>The core idea of this paper is to handle the problem of functional structural equation modeling with latent variables, in the assumption that both the observed and latent variables take values in a separable Hilbert space ğ¿ 2 (ğœ), where ğœ is a compact set in R (e.g., a time interval). In this section, the FSEM will be detailed in full, starting with the necessary notation in section 2.1, followed by the measurement model and the structural part of the FSEM in section 2.2, and their truncated versions in section 2.3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.">Notation</head><p>Throughout the paper, all the univariate and functional random variables will be represented by regular lowercase letters (e.g., ğ‘§), while vectors are denoted by lowercase bold letters (e.g., z), and matrices are represented by uppercase bold letters (e.g., Z). The difference between the variables and their realizations shall be understood from the context.</p><p>We denote via {ğ‘’ ğ‘Ÿ } ğ‘Ÿ â‰¥1 a set of arbitrary basis functions for the space ğ¿ 2 (ğœ). The space ğ¿ 2 (ğœ) is equipped with the inner product âŸ¨â€¢, â€¢âŸ© and the corresponding norm âˆ¥ â€¢ âˆ¥. We indicate with âˆ¥ â€¢ âˆ¥ 2 the usual Euclidean â„“ 2 norm in R ğ‘› . Finally, 1 ğ‘ is a ğ‘-dimensional unit vector, while I ğ‘ is the ğ‘-dimensional identity matrix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.">The functional structural equation model (FSEM) in infinite dimensions</head><p>Suppose that the latent factors ğœ‚ 1 , ğœ‚ 2 , . . . , ğœ‚ ğ‘ âˆˆ ğ¿ 2 (ğœ) are measured through variables ğ‘¦ 1 , ğ‘¦ 2 , . . . , ğ‘¦ ğ‘ âˆˆ ğ¿ 2 (ğœ), which are in turn observed concatenated with time-dependent measurement errors ğœ– 1ğ‘¡ , ğœ– 2ğ‘¡ , . . . , ğœ– ğ‘ğ‘¡ , respectively. Assuming to observe ğ‘ i.i.d. subjects, the functional factor model (FM) for the ğ‘—-th variable in the ğ‘–-th subject ğ‘¦ ğ‘– ğ‘— , ğ‘– = 1, . . . , ğ‘ and ğ‘— = 1, . . . , ğ‘, coupled with the measurement error process ğœ– ğ‘—ğ‘¡ , can be written as</p><formula xml:id="formula_0">ğ‘¦ ğ‘– ğ‘— (ğ‘¡) = ğ›½ ğ‘— (ğ‘¡) + ğ‘ âˆ‘ï¸ ğ‘š=1 ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡)ğ‘ ğ‘—ğ‘š + ğœ€ ğ‘– ğ‘— (ğ‘¡),<label>(1)</label></formula><formula xml:id="formula_1">ğ‘§ ğ‘– ğ‘— (ğ‘¡) = ğ‘¦ ğ‘– ğ‘— (ğ‘¡) + ğœ– ğ‘– ğ‘—ğ‘¡ ,<label>(2)</label></formula><p>where ğ›½ ğ‘— âˆˆ ğ¿ 2 (ğœ) denote the functional intercepts, and ğœ€ ğ‘– ğ‘— âˆˆ ğ¿ 2 (ğœ) are the functional unique factors capturing the subject-level functional variation. The effect of the latent factor ğœ‚ ğ‘–ğ‘š on the response ğ‘¦ ğ‘– ğ‘— is flexibly modeled by the term ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡), which can take the form of fixed, concurrent or historical effect. The fixed effect is represented by the term ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) := ğœ† ğ‘—ğ‘š ğœ‚ ğ‘–ğ‘š (ğ‘¡), where the factor loading ğœ† ğ‘—ğ‘š is a scalar parameter. For the concurrent effect, we have ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) := ğœ† ğ‘—ğ‘š (ğ‘¡)ğœ‚ ğ‘–ğ‘š (ğ‘¡), while for the historical effect, this term takes the form ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) := âˆ« ğ‘ â‰¤ğ‘¡ ğœ† ğ‘—ğ‘š (ğ‘ , ğ‘¡)ğœ‚ ğ‘–ğ‘š (ğ‘ )ğ‘‘ğ‘ , where the factor loading ğœ† ğ‘—ğ‘š (â€¢) is instead functional. The term ğ‘ ğ‘—ğ‘š takes the value 1 if ğ‘¦ ğ‘– ğ‘— is regressed on ğœ‚ ğ‘–ğ‘š , otherwise is zero. Moreover, the measurement error terms ğœ– ğ‘– ğ‘—ğ‘¡ are assumed as i.i.d. âˆ¼ ğ‘ (0, ğœ 2 ğ‘— ). Finally, ğœ€ ğ‘– ğ‘— are GPs with 0 mean and covariance operator ğ‘‡ ğ‘— . We assume each indicator ğ‘§ ğ‘– ğ‘— is observed in a sparse or dense subset of the domain at time points ğ‘¡ ğ‘– ğ‘—1 , ğ‘¡ ğ‘– ğ‘—2 , . . . , ğ‘¡ ğ‘– ğ‘— ğ‘€ ğ‘– ğ‘— âˆˆ ğœ. Notice that the measurement error ğœ– ğ‘– ğ‘—ğ‘¡ is independent for each ğ‘–, ğ‘—, ğ‘¡ and is independent of ğœ€ ğ‘– ğ‘— (ğ‘¡), which implies identifiability of the model.</p><p>For the structural part, we consider the model</p><formula xml:id="formula_2">ğœ‚ ğ‘–ğ‘š (ğ‘¡) = ğ‘ âˆ‘ï¸ ğ‘›=1 ğ‘  ğœ‚ ğ‘šğ‘› (ğœ‚ ğ‘–ğ‘› , ğ‘¡)ğ‘ ğœ‚ ğ‘šğ‘› + ğ‘„ âˆ‘ï¸ ğ‘™=1 ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡)ğ‘ ğ‘¥ ğ‘šğ‘™ + ğœ ğ‘–ğ‘š (ğ‘¡),<label>(3)</label></formula><p>where ğ‘¥ 1 , ğ‘¥ Let ğ¾ ğœ ğ‘š (ğ‘ , ğ‘¡) be the kernel function of the operator ğ¶ ğ‘š and consider ğ‘¦ ğ‘– ğ‘— â€² (ğ‘¡), i.e., the first indicator corresponding to the functional factor ğœ‚ ğ‘–ğ‘š . Model (1) cannot be uniquely identified unless either we set the first factor loading corresponding to each factor equal to 1, i.e., ğ‘“ ğ‘— â€² ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = ğœ‚ ğ‘–ğ‘š (ğ‘¡), or we put the constraint ğ¾ ğœ ğ‘š (ğ‘¡, ğ‘¡) = 1 for all ğ‘¡ âˆˆ ğœ. In what follows, we set the first factor loading corresponding to each factor equal to 1. Furthermore, in the current framework, we suppose the models to be recursive, i.e., feedback effects are not allowed among the latent variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.">Truncated model specification</head><p>In the current section, by rewriting ğ‘¦ ğ‘– ğ‘— and ğœ‚ ğ‘–ğ‘š according to their corresponding basis expansions, truncated versions of the models (1) and (3) are provided.</p><p>For the measurement part of the model, let e = (ğ‘’ 1 , ğ‘’ 2 , . . . , ğ‘’ ğ½ ) be the vector including the first ğ½ basis functions of the space ğ¿ 2 (ğœ), and suppose that {ğœ™ ğ‘—ğ‘Ÿ } 1â‰¤ğ‘Ÿ â‰¤ ğ½ and {ğœˆ ğ‘—ğ‘Ÿ } 1â‰¤ğ‘Ÿ â‰¤ ğ½ are the truncated sets of eigen-functions and eigen-values of the covariance operator ğ‘‡ ğ‘— , respectively. Using the Karhunen-LoÃ¨ve expansion of ğœ€ ğ‘– ğ‘— (ğ‘¡), the truncated version of the model given in (1) can be written as (see Appendix A)</p><formula xml:id="formula_3">y ğ‘– ğ‘— = ğœ· ğ‘— + (EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘š=1 f â€² ğ‘– ğ‘—ğ‘š ğ‘ â€² ğ‘—ğ‘š + (EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘š=1 f ğ‘– ğ‘—ğ‘š ğ‘ ğ‘—ğ‘š + ğœº ğ‘– ğ‘— ,<label>(4)</label></formula><p>where ğ‘ â€² ğ‘—ğ‘š + ğ‘ ğ‘—ğ‘š takes either 0 or 1, and E = [e(ğ‘¡ 1 ), e(ğ‘¡ 2 ) . . . , e(ğ‘¡ ğ‘€ )] âˆˆ R ğ½ Ã— ğ‘€ denotes the evaluation matrix of the vector of functions e, where ğ‘¡ 1 , ğ‘¡ 2 , . . . , ğ‘¡ ğ‘€ and the number of time points ğ‘€ may differ for each indicator per sample. Moreover, y ğ‘– ğ‘— and ğœ· ğ‘— âˆˆ R ğ½ denote respectively the vectors of basis coefficients of ğ‘¦ ğ‘– ğ‘— and of the functional intercept ğ›½ ğ‘— , while</p><formula xml:id="formula_4">f ğ‘– ğ‘—ğ‘š = [ ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ ğ‘˜ )] 1â‰¤ ğ‘˜ â‰¤ ğ‘€ and f â€² ğ‘– ğ‘—ğ‘š = [ ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ ğ‘˜ )] 1â‰¤ ğ‘˜ â‰¤ ğ‘€ .</formula><p>Finally, ğœº ğ‘– ğ‘— is i.i.d. distributed as a zero mean multivariate Gaussian with variance-covariance matrix ğšº ğœ€ ğ‘— = ğš½ ğ‘— G ğ‘— ğš½ âŠ¤ ğ‘— , where G ğ‘— = diag ğœˆ ğ‘— (1) , . . . , ğœˆ ğ‘— ( ğ½ ) is the diagonal matrix including the eigen-values of ğ‘‡ ğ‘— sorted in descending order, and ğš½ ğ‘— is the matrix whose elements are the basis coefficients of the eigen-functions of ğ‘‡ ğ‘— in the same order as in G ğ‘— , i.e., ğš½ ğ‘— ğ‘Ÿ ğ‘˜ = âŸ¨ğœ™ ğ‘— (ğ‘˜ ) , ğ‘’ ğ‘Ÿ âŸ©, for ğ‘Ÿ, ğ‘˜ = 1, . . . , ğ½.</p><p>In Appendix B, the different forms for f â€² ğ‘– ğ‘—ğ‘š and f ğ‘– ğ‘—ğ‘š depending on the type of effect are provided. When the effect is fixed, we have f â€² ğ‘– ğ‘—ğ‘š = E âŠ¤ ğœ¼ ğ‘–ğ‘š and f ğ‘– ğ‘—ğ‘š = (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘š ) âŠ¤ ğğœ† ğ‘—ğ‘š . For the concurrent effect we have f â€² ğ‘– ğ‘—ğ‘š = E âŠ¤ ğœ¼ ğ‘–ğ‘š and f ğ‘– ğ‘—ğ‘š = (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘š ) âŠ¤ ğ›€ 1 ğ€ ğ‘—ğ‘š , and for the historical effect we can write f</p><formula xml:id="formula_5">â€² ğ‘– ğ‘—ğ‘š = ğš«ğœ¼ ğ‘–ğ‘š and f ğ‘– ğ‘—ğ‘š = (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘š ) âŠ¤ ğ›€ 2 ğ€ ğ‘—ğ‘š , where ğ = [e(ğ‘¡ ğ‘˜ )] 1â‰¤ ğ‘˜ â‰¤ ğ‘€ , ğ›€ 1 = e(ğ‘¡ ğ‘˜ )e âŠ¤ (ğ‘¡ ğ‘˜ ) 1â‰¤ ğ‘˜ â‰¤ ğ‘€ , ğ›€ 2 = âˆ« ğ‘ â‰¤ğ‘¡ ğ‘˜ e(ğ‘ ) (e âŠ¤ (ğ‘¡ ğ‘˜ ) âŠ— e âŠ¤ (ğ‘ ))ğ‘‘ğ‘  1â‰¤ ğ‘˜ â‰¤ ğ‘€ , ğš« = âˆ« ğ‘ â‰¤ğ‘¡ ğ‘˜ e âŠ¤ (ğ‘ )ğ‘‘ğ‘  1â‰¤ ğ‘˜ â‰¤ ğ‘€</formula><p>, and ğ€ ğ‘—ğ‘š is the vector of basis coefficients for the functional parameter ğœ† ğ‘—ğ‘š (ğ‘¡). Then, we can rewrite the equation (4) as</p><formula xml:id="formula_6">y ğ‘– ğ‘— =ğœ· ğ‘— + (EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘š=1 f â€² ğ‘– ğ‘—ğ‘š ğ‘ â€² ğ‘—ğ‘š + (EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘š=1 (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘š ) âŠ¤ ğ›€ * ğ‘ ğ‘—ğ‘š ğ€ ğ‘—ğ‘š + ğœº ğ‘– ğ‘— ,<label>(5)</label></formula><p>in which ğ›€ * equals ğ for the fixed effect, equals ğ›€ 1 if the effect is concurrent, and otherwise equals ğ›€ 2 if the effect is historical. Finally, by stacking ğœ· ğ‘— and ğ€ ğ‘—ğ‘š for all ğ‘š = 1, 2, . . . , ğ‘ into the vector ğ€ ğ‘— , model ( <ref type="formula" target="#formula_6">5</ref>) can be rewritten as</p><formula xml:id="formula_7">y ğ‘– ğ‘— = (EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘š=1 f â€² ğ‘– ğ‘—ğ‘š ğ‘ â€² ğ‘—ğ‘š + F ğ‘– A ğ‘— ğ€ ğ‘— + ğœº ğ‘– ğ‘— ,<label>(6)</label></formula><p>where the block matrix F ğ‘– is defined as</p><formula xml:id="formula_8">F ğ‘– = I ğ½ |(EE âŠ¤ ) -1 E(I ğ‘€ âŠ— ğœ¼ ğ‘–1 ) âŠ¤ ğ›€ * | â€¢ â€¢ â€¢ |(EE âŠ¤ ) -1 E(I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘ ) âŠ¤ ğ›€ * .</formula><p>Furthermore, A ğ‘— is defined as</p><formula xml:id="formula_9">A ğ‘— = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° I ğ½ 0 â€¢ â€¢ â€¢ 0 0 ğ‘ ğ‘—1 I col(ğ›€ * ) â€¢ â€¢ â€¢ 0 . . . . . . . . . . . . 0 0 â€¢ â€¢ â€¢ ğ‘ ğ‘—ğ‘ I col(ğ›€ * ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» .</formula><p>Finally, by stacking the variables ğ‘§ ğ‘– ğ‘— (ğ‘¡ 1 ), ğ‘§ ğ‘– ğ‘— (ğ‘¡ 2 ), . . . , ğ‘§ ğ‘– ğ‘— (ğ‘¡ ğ‘€ ) into the vector z ğ‘– ğ‘— and from (2), we can write</p><formula xml:id="formula_10">z ğ‘– ğ‘— = E âŠ¤ y ğ‘– ğ‘— + ğ ğ‘– ğ‘— ,<label>(7)</label></formula><p>where ğ ğ‘– ğ‘— has Gaussian distribution with mean vector zero and variance-covariance matrix ğœ 2 ğ‘— I ğ‘€ . For the structural part of the model, let {ğœ“ ğ‘šğ‘Ÿ } 1â‰¤ğ‘Ÿ â‰¤ ğ½ and {ğœ‡ ğ‘šğ‘Ÿ } 1â‰¤ğ‘Ÿ â‰¤ ğ½ be the truncated sets of eigenfunctions and eigen-values of the covariance operator ğ¶ ğ‘š . In a similar way to the FM, for the structural model (3) we can write is the diagonal matrix including the eigen-values of ğ¶ ğ‘š sorted in descending order, and ğš¿ ğ‘š is the matrix whose elements are the basis coefficients of the eigen-functions of ğ¶ ğ‘š in the same order as in H ğ‘š , i.e., {ğš¿ ğ‘š } ğ‘Ÿ ğ‘˜ = âŸ¨ğœ“ ğ‘š(ğ‘˜ ) , ğ‘’ ğ‘Ÿ âŸ©, for ğ‘Ÿ, ğ‘˜ = 1, . . . , ğ½.</p><formula xml:id="formula_11">ğœ¼ ğ‘–ğ‘š = (EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘›=1 s ğœ‚ ğ‘–ğ‘šğ‘› ğ‘ ğœ‚ ğ‘šğ‘› + ğ‘„ âˆ‘ï¸ ğ‘™=1 s ğ‘¥ ğ‘–ğ‘šğ‘™ ğ‘ ğ‘¥ ğ‘šğ‘™ + ğœ» ğ‘–ğ‘š ,<label>(8)</label></formula><p>Similarly to what we have seen for the measurement model, s ğœ‚ ğ‘–ğ‘šğ‘› and s ğ‘¥ ğ‘–ğ‘šğ‘™ can be written in several forms. In the case of concurrent effects, we can write s</p><formula xml:id="formula_12">ğœ‚ ğ‘–ğ‘šğ‘› = (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘› ) âŠ¤ ğ›€ 1 ğœ¸ ğœ‚ ğ‘šğ‘› and s ğ‘¥ ğ‘–ğ‘šğ‘™ = (I ğ‘€ âŠ— x ğ‘–ğ‘™ ) âŠ¤ ğ›€ 1 ğœ¸ ğ‘¥ ğ‘šğ‘™ .</formula><p>For the historical effects we have s</p><formula xml:id="formula_13">ğœ‚ ğ‘–ğ‘šğ‘› = (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘› ) âŠ¤ ğ›€ 2 ğœ¸ ğœ‚ ğ‘šğ‘› and s ğ‘¥ ğ‘–ğ‘šğ‘™ = (I ğ‘€ âŠ— x ğ‘–ğ‘™ ) âŠ¤ ğ›€ 2 ğœ¸ ğ‘¥ ğ‘šğ‘™ , where ğœ¸ ğœ‚ ğ‘šğ‘› and ğœ¸ ğ‘¥</formula><p>ğ‘šğ‘™ denote the vectors of basis coefficients for the functional parameters ğ›¾ ğœ‚ ğ‘šğ‘› (ğ‘¡) and ğ›¾ ğ‘¥ ğ‘šğ‘™ (ğ‘¡), respectively. Finally, a scalar covariate (corresponding to a smooth or linear effect) is denoted via ğ‘¥ ğ‘–ğ‘™ , while for curve covariates ğ‘¥ ğ‘–ğ‘™ (ğ‘¡) with concurrent or historical effects, x ğ‘–ğ‘™ indicates the vector of basis coefficients for the functional covariate.</p><p>Let {â„ ğ‘™ğ‘Ÿ } ğ‘Ÿ â‰¥1 be another set of arbitrary basis functions for the Hilbert space ğ¿ 2 (ğœ ğ‘™ ), where ğœ ğ‘™ denotes the range of the covariate ğ‘¥ ğ‘™ for ğ‘™ = 1, 2, . . . , ğ‘„. For the smooth and linear effects of the covariates in the structural model given by (8), we obtain respectively</p><formula xml:id="formula_14">s ğ‘¥ ğ‘–ğ‘šğ‘™ = E âŠ— h ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ) âŠ¤ ğœ¸ ğ‘¥ ğ‘šğ‘™ and s ğ‘¥ ğ‘–ğ‘šğ‘™ = E âŠ¤ ğœ¸ ğ‘¥ ğ‘šğ‘™ ğ‘¥ ğ‘–ğ‘™ , in which h ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ) = â„ ğ‘™ğ‘Ÿ (ğ‘¥ ğ‘–ğ‘™ ) 1â‰¤ğ‘Ÿ â‰¤ ğ½ and ğœ¸ ğ‘¥</formula><p>ğ‘šğ‘™ denote the vectors of unknown parameters (see Appendix C). Consider the matrix</p><formula xml:id="formula_15">S ğœ‚ ğ‘– = (EE âŠ¤ ) -1 E(I ğ‘€ âŠ— ğœ¼ ğ‘–1 ) âŠ¤ ğ›€ * | â€¢ â€¢ â€¢ |(EE âŠ¤ ) -1 E(I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘ ) âŠ¤ ğ›€ * .</formula><p>Similarly to the FM case, model ( <ref type="formula" target="#formula_11">8</ref>) can be rewritten as</p><formula xml:id="formula_16">ğœ¼ ğ‘–ğ‘š = S ğ‘– B ğ‘š ğœ¸ ğ‘š + ğœ» ğ‘–ğ‘š ,<label>(9)</label></formula><p>where ğœ¸ ğ‘š is the vector of basis coefficients for all functional parameters, and</p><formula xml:id="formula_17">S ğ‘– = [S ğœ‚ ğ‘– |(EE âŠ¤ ) -1 ES ğ‘¥ ğ‘–1 | â€¢ â€¢ â€¢ |(EE âŠ¤ ) -1 ES ğ‘¥ ğ‘–ğ‘„ ],</formula><p>where S ğ‘¥ ğ‘–ğ‘™ for ğ‘™ = 1, 2, . . . , ğ‘„ can be in different forms depending on the type of effect of ğ‘¥ ğ‘™ on ğœ‚ ğ‘š . Moreover,</p><formula xml:id="formula_18">B ğ‘š = diag B ğœ‚ ğ‘š , B ğ‘¥ ğ‘š , in which B ğœ‚ ğ‘š = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğ‘ ğœ‚ ğ‘š1 I col(ğ›€ * ) 0 â€¢ â€¢ â€¢ 0 0 ğ‘ ğœ‚ ğ‘š2 I col(ğ›€ * ) â€¢ â€¢ â€¢ 0 . . . . . . . . . . . . 0 0 â€¢ â€¢ â€¢ ğ‘ ğœ‚ ğ‘šğ‘ I col(ğ›€ * ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» ,<label>and</label></formula><formula xml:id="formula_19">B ğ‘¥ ğ‘š = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğ‘ ğ‘¥ ğ‘š1 I col(S ğ‘¥ 1ğ‘š1 ) 0 â€¢ â€¢ â€¢ 0 0 ğ‘ ğ‘¥ ğ‘š2 I col(S ğ‘¥ 1ğ‘š2 ) â€¢ â€¢ â€¢ 0 . . . . . . . . . . . . 0 0 â€¢ â€¢ â€¢ ğ‘ ğ‘¥ ğ‘šğ‘„ I col(S ğ‘¥ 1ğ‘šğ‘„ ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£»</formula><p>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Estimation procedure</head><p>In this section, the Expectation-Maximization (EM) algorithm employed to provide the maximum likelihood estimates of both scalar and functional parameters in the model is described in full detail. In order to estimate the functional parameters, their corresponding basis coefficients are estimated and, subsequently, the parameter curves are estimated using the basis expansions. In what follows, to provide estimates of the parameters in the measurement and structural models ( <ref type="formula" target="#formula_1">2</ref>) and (3), we consider the following assumptions:</p><p>(a) The measurement model is reflective, i.e., the indicators are explained by one or more common factors, and the structural models are recursive, meaning that there are no permitted feedback effects between the latent variables; (b) the ğ‘¦ ğ‘— 's are conditionally independent given the latent variables for ğ‘— = 1, 2, . . . , ğ‘; (c) the measurement error terms ğœ– ğ‘– ğ‘—ğ‘¡ 's are supposed to be independent for ğ‘— = 1, 2, . . . , ğ‘ and across time; (d) the terms ğœ– ğ‘– ğ‘—ğ‘¡ 's are independent of ğœ€ ğ‘– ğ‘— 's; (e) the latent variables ğœ‚ ğ‘š 's for ğ‘š = 1, 2, . . . , ğ‘, are conditionally independent given the observed and latent variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">EM algorithm implementing the smoothing procedure</head><p>To write the complete-data log-likelihood function, we stack y ğ‘– ğ‘— , z ğ‘– ğ‘— and ğœ¼ ğ‘–ğ‘š first for all subjects and then for ğ‘— = 1, 2, . . . , ğ‘ and ğ‘š = 1, 2, . . . , ğ‘ into the vectors y, z and ğœ¼, respectively. We also suppose x is the vector of all explanatory variables in the structural model, stacked for all subjects. Then, setting ğœ½ as the set of all model parameters and based on the assumptions considered for the functional and structural parts of the FSEM, the complete-data log-likelihood function is written as â„“ com (ğœ½ |z, y, ğœ¼, x) = log ğ‘“ (z, y, ğœ¼, x; ğœ½), where ğ‘“ (z, y, ğœ¼, x; ğœ½) denotes the joint probability density function (pdf) of z, y, ğœ¼, x and the set of model parameters ğœ½.</p><p>In the E-step at iteration ğ‘š â€² + 1, we compute the expectation of the complete-data log-likelihood function with respect to the joint distribution of the latent variables y and ğœ¼ given the observed variables z and x and the model parameters at iteration ğ‘š â€² as</p><formula xml:id="formula_20">ğ‘„(ğœ½ | ğœ½ (ğ‘š â€² ) ) = E y,ğœ¼ |z,x;ğœ½ (ğ‘š â€² ) [â„“ com (ğœ½ |z, y, ğœ¼, x)].</formula><p>We implement the smoothing procedure in the M-step to extract smooth estimates for the functional coefficients. For this purpose, let ğœ¶ be the vector stacking all smoothing parameters corresponding to functional coefficients from the measurement and structural part of the FSEM, respectively, i.e. ğ›¼ ğ‘— and ğ›¼ ğ‘š for ğ‘— = 1, 2, . . . , ğ‘ and ğ‘š = 1, 2, . . . , ğ‘. In the M-step, we maximize the expectation </p><formula xml:id="formula_21">ğ‘„ ğœ¶ (ğœ½ | ğœ½ (ğ‘š â€² ) ) =E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) [log ğ‘“ (z,</formula><formula xml:id="formula_22">P ğœ† ğ‘— = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° P ğœ† ğ‘—1 0 â€¢ â€¢ â€¢ 0 0 P ğœ† ğ‘—2 â€¢ â€¢ â€¢ 0 . . . . . . . . . . . . 0 0 â€¢ â€¢ â€¢ P ğœ† ğ‘—ğ‘ ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£»</formula><p>, and</p><formula xml:id="formula_23">P ğ›¾ ğ‘š = diag{P ğ›¾ ğœ‚ ğ‘š , P ğ›¾ ğ‘¥ ğ‘š }, in which P ğ›¾ ğœ‚ ğ‘š = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° P ğ›¾ ğœ‚ ğ‘š1 0 â€¢ â€¢ â€¢ 0 0 P ğ›¾ ğœ‚ ğ‘š2 â€¢ â€¢ â€¢ 0 . . . . . . . . . . . . 0 0 â€¢ â€¢ â€¢ P ğ›¾ ğœ‚ ğ‘šğ‘ ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£»</formula><p>, and</p><formula xml:id="formula_24">P ğ›¾ ğ‘¥ ğ‘š = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° P ğ›¾ ğ‘¥ ğ‘š1 0 â€¢ â€¢ â€¢ 0 0 P ğ›¾ ğ‘¥ ğ‘š2 â€¢ â€¢ â€¢ 0 . . . . . . . . . . . . 0 0 â€¢ â€¢ â€¢ P ğ›¾ ğ‘¥ ğ‘šğ‘„ ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£»</formula><p>.</p><p>Let e (ğ‘™) (ğ‘¡) = [ğ‘’ (ğ‘™) ğ‘Ÿ (ğ‘¡)] 1â‰¤ğ‘Ÿ â‰¤ ğ½ be the vector of the ğ‘™ th order derivatives of ğ‘’ ğ‘Ÿ (ğ‘¡). Depending on the type of effects in the measurement model (1) and structural model (3), P ğœ† ğ‘—ğ‘š , P ğ›¾ ğœ‚ ğ‘šğ‘› and P</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ğ›¾ ğ‘¥</head><p>ğ‘šğ‘Ÿ can take different forms, and specifically âˆ« ğœ e (2) (ğ‘¡)e ( <ref type="formula" target="#formula_1">2</ref>)âŠ¤ (ğ‘¡)ğ‘‘ğ‘¡ for the concurrent effect, and</p><formula xml:id="formula_25">âˆ« ğœ âˆ« ğœ e (1) (ğ‘¡) âŠ— e (1) (ğ‘ ) e (1)âŠ¤ (ğ‘¡) âŠ— e (1)âŠ¤ (ğ‘ ) ğ‘‘ğ‘ ğ‘‘ğ‘¡ + âˆ« ğœ âˆ« ğœ e(ğ‘¡) âŠ— e (2) (ğ‘ ) e âŠ¤ (ğ‘¡) âŠ— e (2)âŠ¤ (ğ‘ ) ğ‘‘ğ‘ ğ‘‘ğ‘¡ + âˆ« ğœ âˆ« ğœ e (2) (ğ‘¡) âŠ— e(ğ‘ ) e (2)âŠ¤ (ğ‘¡) âŠ— e âŠ¤ (ğ‘ ) ğ‘‘ğ‘ ğ‘‘ğ‘¡,</formula><p>for the historical effect. Moreover,</p><formula xml:id="formula_26">P ğ›¾ ğ‘¥ ğ‘šğ‘Ÿ = âˆ« ğœ e (2) (ğ‘¡) âŠ— h ğ‘Ÿ (ğ‘¥ ğ‘Ÿ ) e (2)âŠ¤ (ğ‘¡) âŠ— h âŠ¤ ğ‘Ÿ (ğ‘¥ ğ‘Ÿ ) ğ‘‘ğ‘¡,</formula><p>when the effect of ğœ‚ ğ‘š on ğ‘¥ ğ‘Ÿ is smooth.</p><p>Let us stack the matrices F ğ‘– and S ğ‘– for ğ‘– = 1, 2, . . . , ğ‘ respectively into the block matrices F and S and the vectors (EE âŠ¤ ) -1 Ef â€² ğ‘– ğ‘—ğ‘š , y ğ‘– ğ‘— and ğœ¼ ğ‘–ğ‘š for ğ‘– = 1, 2, . . . , ğ‘ into the vectors f â€² ğ‘—ğ‘š , y ğ‘— and ğœ¼ ğ‘š , respectively.</p><p>The parameter estimates at iteration ğ‘š â€² + 1 are updated as</p><formula xml:id="formula_27">ğ€ (ğ‘š â€² +1) ğ‘— = A ğ‘— E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) F âŠ¤ (I ğ‘ âŠ— ğšº ğœ€ (ğ‘š â€² +1) ğ‘— ) -1 F A ğ‘— + ğ›¼ ğœ† ğ‘— P ğœ† ğ‘— -1 Ã— A ğ‘— E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) F âŠ¤ (I ğ‘ âŠ— ğšº ğœ€ (ğ‘š â€² +1) ğ‘— ) -1 y ğ‘— - ğ‘ âˆ‘ï¸ ğ‘š=1 f â€² ğ‘—ğ‘š ğ‘ â€² ğ‘—ğ‘š , ğšº ğœ€ (ğ‘š â€² +1) ğ‘— = 1 ğ‘ ğ‘ âˆ‘ï¸ ğ‘–=1 E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) y ğ‘– ğ‘— -(EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘š=1 f â€² ğ‘—ğ‘š ğ‘ â€² ğ‘—ğ‘š -F ğ‘– A ğ‘— ğ€ (ğ‘š â€² +1) ğ‘— Ã— y ğ‘– ğ‘— -(EE âŠ¤ ) -1 E ğ‘ âˆ‘ï¸ ğ‘š=1 f â€² ğ‘—ğ‘š ğ‘ â€² ğ‘—ğ‘š -F ğ‘– A ğ‘— ğ€ (ğ‘š â€² +1) ğ‘— âŠ¤ , ğœ 2(ğ‘š â€² +1) ğ‘— = 1 ( ğ‘ ğ‘–=1 ğ‘€ ğ‘– ğ‘— ) ğ‘ âˆ‘ï¸ ğ‘–=1 E y|z,x;ğœ½ (ğ‘š â€² ) z ğ‘– ğ‘— -E âŠ¤ ğ‘– ğ‘— y ğ‘– ğ‘— âŠ¤ z ğ‘– ğ‘— -E âŠ¤ ğ‘– ğ‘— y ğ‘– ğ‘— ,</formula><p>for ğ‘— = 1, 2, . . . , ğ‘, and</p><formula xml:id="formula_28">ğœ¸ (ğ‘š â€² +1) ğ‘š = B ğ‘š E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) S âŠ¤ (I ğ‘ âŠ— ğšº ğœ (ğ‘š â€² +1) ğ‘š ) -1 S B ğ‘š + ğ›¼ ğ›¾ ğ‘š P ğ›¾ ğ‘š -1 Ã— B ğ‘š E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) S âŠ¤ (I ğ‘ âŠ— ğšº ğœ (ğ‘š â€² +1) ğ‘š ) -1 ğœ¼ ğ‘š , ğšº ğœ (ğ‘š â€² +1) ğ‘š = 1 ğ‘ ğ‘ âˆ‘ï¸ ğ‘–=1 E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) ğœ¼ ğ‘–ğ‘š -S ğ‘– B ğ‘š ğœ¸ (ğ‘š â€² +1) ğ‘š Ã— ğœ¼ ğ‘–ğ‘š -S ğ‘– B ğ‘š ğœ¸ (ğ‘š â€² +1) ğ‘š âŠ¤ , for ğ‘š = 1, 2, . . . , ğ‘.</formula><p>We evaluate the convergence of the EM algorithm by looking at the two following criteria</p><formula xml:id="formula_29">tol ğœ 2 = max âˆ¥ğœ 2 (ğ‘š â€² +1) ğ‘— -ğœ 2 (ğ‘š â€² ) ğ‘— âˆ¥ 2 ğ‘—=1,2,..., ğ‘ tol ğ‘ğ‘œğ‘’ ğ‘“ = max âˆ¥ğ€ -(ğ‘š â€² +1) ğ‘—ğ‘š -ğ€ -(ğ‘š â€² ) ğ‘—ğ‘š âˆ¥ 2 , âˆ¥ ğœ· (ğ‘š â€² +1) ğ‘— -ğœ· (ğ‘š â€² ) ğ‘— âˆ¥ 2 , âˆ¥ğœ¸ (ğ‘š â€² +1) ğ‘šğ‘› -ğœ¸ (ğ‘š â€² ) ğ‘šğ‘› âˆ¥ 2 , âˆ¥ğœ¸ (ğ‘š â€² +1) ğ‘šğ‘™ -ğœ¸ (ğ‘š â€² )</formula><p>ğ‘šğ‘™ âˆ¥ 2 , where the maximum in ğ‘¡ğ‘œğ‘™ ğ‘ğ‘œğ‘’ ğ‘“ is taken over ğ‘— = 1, 2, . . . , ğ‘; ğ‘š, ğ‘› = 1, 2, . . . , ğ‘; ğ‘™ = 1, 2, . . . , ğ‘„, and where ğ€ -(ğ‘š â€² ) ğ‘—ğ‘š denotes the vector ğ€ ğ‘—ğ‘š at iteration ğ‘š â€² excluding the estimates for the intercept ğ›½ ğ‘— . To evaluate the convergence of the EM, we compare the values of ğ‘¡ğ‘œğ‘™ ğœ 2 and ğ‘¡ğ‘œğ‘™ ğ‘ğ‘œğ‘’ ğ‘“ with a pre-specified tolerance, which can be different for the two criteria.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.">Generator distributions</head><p>The updates of parameter estimates given by the expectations described in Section 3.1 can be computed numerically by applying the Monte Carlo approach.</p><p>Suppose we stack ğœ¼ ğ‘–ğ‘š for ğ‘š = 1, 2, . . . , ğ‘ into ğœ¼ ğ‘– . If we define the matrices</p><formula xml:id="formula_30">A â€² ğ‘— = diag(ğ‘ â€² ğ‘—ğ‘š I ğ½ ) 1â‰¤ğ‘šâ‰¤ğ‘ and A * ğ‘— = diag ğ‘ ğ‘—ğ‘š I ğ½ 1â‰¤ğ‘šâ‰¤ğ‘ , as well as the matrices B ğœ‚ * ğ‘š = diag(ğ‘ ğœ‚ ğ‘šğ‘› I ğ½ ) 1â‰¤ğ‘›â‰¤ğ‘ and B ğ‘¥ * ğ‘š = diag(ğ‘ ğ‘¥ ğ‘šğ‘™ I ğ‘ğ‘œğ‘™ (ğšª ğ‘¥ ğ‘šğ‘™ ) )</formula><p>1â‰¤ğ‘™ â‰¤ğ‘„ , the models ( <ref type="formula" target="#formula_7">6</ref>) and ( <ref type="formula" target="#formula_16">9</ref>) can be rewritten as</p><formula xml:id="formula_31">y ğ‘– ğ‘— = ğœ· ğ‘— + ğš² â€² ğ‘— A â€² ğ‘— ğœ¼ ğ‘– + ğš² ğ‘— A * ğ‘— ğœ¼ ğ‘– + ğœº ğ‘– ğ‘— ,<label>(10)</label></formula><p>and</p><formula xml:id="formula_32">ğœ¼ ğ‘–ğ‘š = ğšª ğœ‚ ğ‘š B ğœ‚ * ğ‘š ğœ¼ ğ‘– + ğšª ğ‘¥ ğ‘š B ğ‘¥ * ğ‘š x ğ‘– + ğœ» ğ‘–ğ‘š ,<label>(11)</label></formula><p>where </p><formula xml:id="formula_33">ğš² ğ‘— = (EE âŠ¤ ) -1 E[ğš² ğ‘—1 |ğš² ğ‘—2 | . . . |ğš² ğ‘—ğ‘ ],</formula><formula xml:id="formula_34">(I ğ‘€ âŠ— ğœ¸ ğ‘¥ ğ‘šğ‘™ ) âŠ¤ ğ›€ 1 , (I ğ‘€ âŠ— ğœ¸ ğ‘¥ ğ‘šğ‘™ ) âŠ¤ ğ›€ * 2 , E âŠ¤ ğš« ğ‘šğ‘™ , or E âŠ¤ ğœ¸ ğ‘¥</formula><p>ğ‘šğ‘™ depending on the type of effect of the covariate being respectively concurrent, historical, smooth or linear. In the form corresponding to the smooth effect, ğš« ğ‘šğ‘™ is the matrix of basis coefficients. Depending on the different types of effects, x ğ‘–ğ‘™ indicates the vector of basis coefficients of ğ‘¥ ğ‘™ when its effect is either concurrent or historical, x ğ‘–ğ‘™ = h ğ‘Ÿ (ğ‘¥ ğ‘™ ) if the effect is smooth, and x ğ‘–ğ‘™ = ğ‘¥ ğ‘–ğ‘™ in case of linear effect.</p><p>Model (10) can be written as</p><formula xml:id="formula_35">y = ğœ· + (ğš² + ğš² â€² )W ğœ¼ ğœ¼ + ğœº, where ğœ· = (1 ğ‘ âŠ— ğœ· ğ‘— ) 1â‰¤ ğ‘— â‰¤ ğ‘ , ğš² â€² = [I ğ‘ âŠ— (ğš² â€² ğ‘— A â€² ğ‘— )] 1â‰¤ ğ‘— â‰¤ ğ‘ , ğš² = [I ğ‘ âŠ— (ğš² ğ‘— A * ğ‘— )] 1â‰¤ ğ‘— â‰¤ ğ‘ .</formula><p>W ğœ¼ is a weight matrix associated to the vector ğœ¼, and ğœº has Gaussian distribution with mean zero and covariance matrix diag</p><formula xml:id="formula_36">I ğ‘ âŠ— ğšº ğœ€ ğ‘— 1â‰¤ ğ‘— â‰¤ ğ‘ .</formula><p>For the structural model ( <ref type="formula" target="#formula_32">11</ref>) we can write</p><formula xml:id="formula_37">ğœ¼ = ğšª ğœ‚ W ğœ¼ ğœ¼ + ğšª ğ‘¥ x + ğœ», where ğšª ğœ‚ = I ğ‘ âŠ— ğšª ğœ‚ ğ‘š B ğœ‚ * ğ‘š 1â‰¤ğ‘šâ‰¤ğ‘ , ğšª ğ‘¥ = I ğ‘ âŠ— (ğšª ğ‘¥ ğ‘Ÿ B ğ‘¥ * ğ‘Ÿ ) 1â‰¤ğ‘Ÿ â‰¤ğ‘„ and ğœ» is Gaussian with zero mean and covariance matrix diag{I ğ‘ âŠ— ğšº ğœ ğ‘š } 1â‰¤ğ‘šâ‰¤ğ‘ . This implies that ğœ¼ âˆ¼ N ( ğ ğœ¼ , ğšº ğœ¼ ), with ğ ğœ¼ = (I ğ‘ ğ‘ ğ½ -ğšª ğœ‚ W ğœ¼ ) -1 ğšª ğ‘¥ x and ğšº ğœ¼ = (I ğ‘ ğ‘ ğ½ - ğšª ğœ‚ W ğœ¼ ) -1 diag{I ğ‘ âŠ— ğšº ğœ ğ‘š } 1â‰¤ğ‘šâ‰¤ğ‘ (I ğ‘ ğ‘ ğ½ -ğšª ğœ‚ W ğœ¼ ) -âŠ¤ .</formula><p>Analogously ğ‘— diag(I ğ‘€ ğ‘– ğ‘— ) 1â‰¤ğ‘– â‰¤ ğ‘ } 1â‰¤ ğ‘— â‰¤ ğ‘ . Thanks to the normality of y, z and ğœ¼, the joint distributions of (y, z) and (ğœ¼, y) are also Gaussian. Thus, the generator distributions are also Gaussian, and their parameters can be simply derived. The selection of the weight matrix W ğœ¼ is quite crucial and it depends on the specific model, with the flexibility to vary on a case-by-case basis.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Confidence bands</head><p>In this section, we quantify the uncertainty of the estimates for the factor loading parameters in the measurement model ( <ref type="formula" target="#formula_1">2</ref>) and for the regression coefficients in the structural model (3). For this purpose, the confidence regions are constructed based on the geometric approach developed by <ref type="bibr" target="#b2">Choi &amp; Reimherr (2018)</ref>. To construct the confidence regions, we need to estimate the covariance matrices of the estimates for ğ€ ğ‘— and ğœ¸ ğ‘š at the final step of the EM algorithm, denoted by Î£ğ€ ğ‘— and Î£ğœ¸ ğ‘š . We employ a nonparametric bootstrapping method to extract the covariance matrices Î£ğ€ ğ‘— and Î£ğœ¸ ğ‘š . Considering the matrices diag( Î£ğ€ ğ‘— ) = diag( Î£ğ€ ğ‘—ğ‘š ) 1â‰¤ğ‘šâ‰¤ğ‘ , and diag( Î£ğœ¸ ğ‘š ) = diag{diag( Î£ğœ¸ ğœ‚ ğ‘šğ‘› ) 1â‰¤ğ‘›â‰¤ğ‘ , diag( Î£ğœ¸ ğ‘¥ ğ‘šğ‘™ ) 1â‰¤ğ‘™ â‰¤ğ‘„ }, the pointwise covariances for the factor loading parameters are estimated as cov ğœ† ğ‘—ğ‘š (ğ‘ ), ğœ† ğ‘—ğ‘š (ğ‘¡) = e âŠ¤ (ğ‘ ) Î£ğ€ ğ‘—ğ‘š e(ğ‘¡), and cov ğœ† ğ‘—ğ‘š (ğ‘ , ğ‘¡ 1 ), ğœ† ğ‘—ğ‘š (ğ‘ , ğ‘¡ 2 ) = e âŠ¤ (ğ‘¡ 1 ) âŠ— e âŠ¤ (ğ‘ ) Î£ğ€ ğ‘—ğ‘š e(ğ‘¡ 2 ) âŠ— e(ğ‘ ) , for the concurrent and historical effects of ğ‘¦ ğ‘— on ğœ‚ ğ‘š , respectively. Similarly, the pointwise covariances for the regression coefficients are estimated as cov ğ›¾ </p><formula xml:id="formula_38">(ğ‘¥ ğ‘˜ğ‘™ ) = h âŠ¤ ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ) Î£ğœ¸ ğ‘¥ ğ‘šğ‘™ h ğ‘™ (ğ‘¥ ğ‘˜ğ‘™ ).</formula><p>Using the pointwise estimate of each parameter accompanied by the estimate of the corresponding pointwise covariance matrix and incorporating them into the hyper-ellipsoid confidence regions provided by the package fregion <ref type="bibr" target="#b2">(Choi &amp; Reimherr, 2018)</ref>, we can derive a confidence band for each functional parameter estimate. The coverage rate (CR) of these proposed confidence bands has been investigated via a simulation study, whose results are detailed in Section 6.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Goodness of fit indices</head><p>To assess the fit of the FSEM introduced in this paper, we provide two extensions for several absolute and relative goodness of fit indices used for the conventional SEM. The first extension calculates the point-wise fit indices at each time point, and is used to examine the model fit indices at all time points in the domain. The second extension obtains instead the average of the fit indices over the entire time domain.</p><p>Suppose that the degree of freedom is denoted by ğ‘‘ğ‘“ = ğ‘( ğ‘ + 1)/2 -ğ‘˜, where ğ‘ denotes the number of observed variables and ğ‘˜ is the number of estimated parameters. The absolute fit indices at time ğ‘¡ include the normed chi-square (ğœ’ 2 /ğ‘‘ğ‘“ ) defined as , where ğ‘  ğ‘— ğ‘˜ (ğ‘¡) is the observed covariance of ğ‘§ ğ‘— (ğ‘¡) and ğ‘§ ğ‘˜ (ğ‘¡), and Ïƒ2</p><formula xml:id="formula_39">ğœ’ 2 (ğ‘¡) = (ğ‘ -1)ğ¹ ğ‘€ ğ¿ (ğ‘¡),</formula><p>ğ‘— ğ‘˜ (ğ‘¡) = cov(ğ‘§ ğ‘— (ğ‘¡), ğ‘§ ğ‘˜ (ğ‘¡)) denotes the predicted covariance (see Appendix D). Finally, the Goodness-of-Fit Index (GFI) can be extended as</p><formula xml:id="formula_40">GFI(ğ‘¡) = 1 - ğ‘ ğ‘—=1 ğ‘ ğ‘˜=1 (ğ‘  ğ‘— ğ‘˜ (ğ‘¡) -Ïƒ2 ğ‘— ğ‘˜ (ğ‘¡)) 2 ğ‘ ğ‘—=1 ğ‘ ğ‘˜=1 ğ‘  ğ‘— ğ‘˜ (ğ‘¡) 2</formula><p>.</p><p>The relative fit indices compare a ğœ’ 2 for the target model to a null (independent) model. The null model is a model in which there are no latent variables. The relative fit indices used in this paper include an extension to the Comparative Fit Index (CFI) to the Incremental Fit Index (IFI)</p><formula xml:id="formula_41">CFI(ğ‘¡) = 1 - ğœ’ 2 model (ğ‘¡) -ğ‘‘ğ‘“ model ğœ’ 2 null (ğ‘¡) -ğ‘‘ğ‘“ null ,</formula><formula xml:id="formula_42">IFI(ğ‘¡) = ğœ’ 2 null (ğ‘¡) -ğœ’ 2 model (ğ‘¡) ğœ’ 2 null (ğ‘¡) -ğ‘‘ğ‘“ null ,</formula><p>and to the Tucker-Lewis Index (TLI)</p><formula xml:id="formula_43">TLI(ğ‘¡) = ğœ’ 2 null (ğ‘¡)/ğ‘‘ğ‘“ ğ‘›ğ‘¢ğ‘™ğ‘™ -ğœ’ 2 model (ğ‘¡)/ğ‘‘ğ‘“ ğ‘šğ‘œğ‘‘ğ‘’ğ‘™ ğœ’ 2</formula><p>null (ğ‘¡)/ğ‘‘ğ‘“ (ğ‘›ğ‘¢ğ‘™ğ‘™) -1 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Simulation studies</head><p>In this section, we evaluate the performance of the FSEM by carrying out two simulation studies for two separate models. In the first simulation study, described in Section 6.1, we use a simpler model setting, but we experiment across regular and irregular sampling designs, to determine the effect on estimation accuracy and coverage of the number and location of time points per curve. In the second simulation study, described in Section 6.2, we instead test the performance of the FSEM in a more complex model setup.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1.">Simulation 1</head><p>For the first simulation, we consider a latent factor ğœ‚ that is identified through ğ‘ = 3 indicators in a simple measurement model as illustrated by the path diagram in Figure <ref type="figure" target="#fig_2">1</ref>. Suppose the indicators are denoted by ğ‘§ 1 , ğ‘§ 2 , ğ‘§ 3 . The measurement model takes the following form</p><formula xml:id="formula_44">ğ‘§ ğ‘– ğ‘— (ğ‘¡) = ğ›½ ğ‘— (ğ‘¡) + ğœ† ğ‘— (ğ‘¡)ğœ‚ ğ‘– (ğ‘¡) + ğœ€ ğ‘– ğ‘— (ğ‘¡) + ğœ– ğ‘– ğ‘—ğ‘¡ , ğ‘— = 1, 2, (<label>12</label></formula><formula xml:id="formula_45">) ğ‘§ ğ‘–3 (ğ‘¡) = ğ›½ 3 (ğ‘¡) + âˆ« ğœ ğœ† 3 (ğ‘ , ğ‘¡)ğœ‚ ğ‘– (ğ‘ )ğ‘‘ğ‘  + ğœ€ ğ‘–3 (ğ‘¡) + ğœ– ğ‘–3ğ‘¡ ,<label>(13)</label></formula><p>where ğ‘– = 1, 2, . . . , ğ‘. We use a Karhunen-LoÃ¨ve expansion to write the residual functions as</p><formula xml:id="formula_46">ğœ€ ğ‘– ğ‘— (ğ‘¡) = ğ‘Ÿ â‰¥1 âˆš ğœˆ ğ‘—ğ‘Ÿ ğ‘¢ ğ‘– ğ‘—ğ‘Ÿ ğœ™ ğ‘—ğ‘Ÿ (ğ‘¡)</formula><p>, where ğ‘¢ ğ‘– ğ‘—ğ‘Ÿ are i.i.d. standard Gaussian random variables and ğœˆ ğ‘—ğ‘Ÿ and ğœ™ ğ‘—ğ‘Ÿ are the eigenvalues and eigen-functions of the covariance operator of ğœ€ ğ‘— , respectively. Furthermore, the measurement error terms ğœ– ğ‘– ğ‘—ğ‘¡ have zero mean Gaussian distributions with variance ğœ 2 ğ‘— . Finally, ğœ‚ ğ‘– (ğ‘¡) = ğ‘Ÿ â‰¥1 âˆš ğœ‡ ğ‘Ÿ ğ‘£ (ğ‘™) ğ‘–ğ‘Ÿ ğœ“ ğ‘Ÿ (ğ‘¡), where ğœ‡ ğ‘Ÿ and ğœ“ ğ‘Ÿ are the eigen-values and eigen-functions of the covariance operator of ğœ‚ ğ‘– , respectively, and ğ‘£ ğ‘–ğ‘šğ‘Ÿ , are independent standard Gaussian variables.</p><p>We consider two sampling designs in this simulation study. In the first design, the indicators ğ‘§ 1 , ğ‘§ 2 , ğ‘§ 3 are observed at regular time points ğ‘¡ 1 , ğ‘¡ 2 , . . . , ğ‘¡ ğ‘€ in the domain. In the second design, the indicators ğ‘§ ğ‘– ğ‘— for ğ‘– = 1, 2, . . . , ğ‘ and ğ‘— = 1, 2, 3 are observed at the irregular time points ğ‘¡ ğ‘– ğ‘—1 , ğ‘¡ ğ‘– ğ‘—2 , . . . , ğ‘¡ ğ‘– ğ‘— ğ‘€ ğ‘– ğ‘— , with ğ‘€ ğ‘– ğ‘— âˆ¼ ğ‘ˆ ({ğ‘(1/2) ğ‘€ , ğ‘(1/2) ğ‘€ -1 , . . . , ğ‘(1/2) 1 }) where ğ‘ = 2 ğ‘€ /(2 ğ‘€ -1) is the normalizing constant, and with ğ‘¡ ğ‘– ğ‘— ğ‘˜ âˆ¼ ğ‘ˆ ( [0, 1]) i.i.d. for ğ‘˜ = 1, 2, . . . , ğ‘€ ğ‘– ğ‘— (in increasing order in ğ‘˜); ğ‘ˆ ( ğ´) denotes the uniform distribution over the (continuous or discrete) set ğ´. We set the functional intercepts and regression coefficients in the measurement model respectively as ğ›½ ğ‘— (ğ‘¡) = ğ‘—ğ‘¡ 2 , ğœ† ğ‘— (ğ‘¡) = 1 + 1 2 sin(ğœ‹ âˆš ğ‘—ğ‘¡/2) for ğ‘— = 1, 2, and ğœ† 3 (ğ‘¡) = 1 + 1 2 cos(ğœ‹ âˆš 3(ğ‘  + ğ‘¡)). The covariance structures for residual functions are constructed as ğœˆ ğ‘—ğ‘Ÿ = ğ‘˜ ğœŒ (ğ‘Ÿ -1) , where ğ‘˜ &gt; 0 is a fixed value and 0 &lt; ğœŒ &lt; 1, and for ğ‘Ÿ â‰¥ 0, we set the eigen-functions as ğœ™ ğ‘— (2ğ‘Ÿ ) (ğ‘¡) = âˆš 2 sin(2ğœ‹ğ‘¡ğ‘Ÿ ğ‘—) and ğœ™ ğ‘— (2ğ‘Ÿ+1) (ğ‘¡) = âˆš 2 cos(ğœ‹ğ‘¡ (2ğ‘Ÿ + 1) ğ‘—). Moreover, we suppose that the covariance function for the latent variable ğœ‚ is defined as ğ¾ ğœ‚ (ğ‘ , ğ‘¡) = exp{-(ğ‘¡ -ğ‘ ) 2 }, which belongs to the family of MatÃ©n covariance functions. The measurement error variances are chosen using the Signal-to-Noise Ratio (SNR), defined by</p><formula xml:id="formula_47">ğ‘†ğ‘ ğ‘… = âˆ« 1 0 ğ¾ ğœ€ ğ‘— (ğ‘¡, ğ‘¡)ğ‘‘ğ‘¡ ğœ 2 ğ‘— ,</formula><p>where ğ¾ ğœ€ ğ‘— denotes the kernel function for the covariance operator of ğœ€ ğ‘— . We assume that only the first 8 eigen-values are non-zero in the Karhunen-LoÃ¨ve expansions of the residual functions and of the latent variable. The decay rate of eigen-values is identified by choosing the parameter ğœŒ. Values of ğœŒ approaching zero (one) correspond to smoother (less smooth) residual functions. Consequently, by changing the value of ğœŒ, we can change the complexity of the covariance structure.</p><p>We run the simulations for ğ‘˜ = 1, ğœŒ = 0.3, ğ‘†ğ‘ ğ‘… = 4, and all the following combinations of sampling designs and model parameters:</p><p>â€¢ ğ‘€ = 10, 20 for a small and large number of time points, respectively.</p><p>â€¢ ğ‘ = 50, 100 for a small and large sample size, respectively.</p><p>â€¢ Regular and irregular sampling designs.</p><p>Moreover, we set ğ½ = 10, 12 for ğ‘€ = 10, 20, respectively.</p><p>The accuracy of the estimates is evaluated by calculating the Mean Squared Error (MSE) of the estimators by using an MCMC algorithm with 200 iterations. The results are reported in Table <ref type="table" target="#tab_5">1</ref>. The Coverage Rate (CR) of the 95% confidence bands computed as described in Section 4 is reported in Table <ref type="table" target="#tab_6">2</ref>.</p><p>As shown in Table <ref type="table" target="#tab_5">1</ref>, the MSE of the estimates is generally quite low, indicating a good accuracy of the FSEM; the MSE decreases with an increase in ğ‘, and it sometimes increases in the IR setting, as expected. Additionally, the CRs in Table <ref type="table" target="#tab_6">2</ref> indicate a good coverage both for the regular and irregular designs, with a slightly better performance in the former case (and for larger ğ‘), as expected. All in all, from these tables we can conclude that the FSEM provides a good overall fit, yielding accurate parameter estimates and well-calibrated CRs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2.">Simulation 2</head><p>For the second simulation study, we implement a scenario that resembles the model that will be fitted to the real data example detailed in Section 7. For this purpose, consider an FSEM with ğ‘ = 3 indicators and ğ‘ = 1 latent factor, together with ğ‘„ = 2 observed scalar-valued explanatory variables (see the path diagram illustrated in Figure <ref type="figure" target="#fig_3">2</ref>). Suppose the latent variable ğœ‚ is measured through indicators ğ‘§ 1 , ğ‘§ 2 , ğ‘§ 3 via the measurement model defined as</p><formula xml:id="formula_48">ğ‘§ ğ‘– ğ‘— (ğ‘¡) = ğ›½ ğ‘— (ğ‘¡) + ğœ† ğ‘— (ğ‘¡)ğœ‚ ğ‘– (ğ‘¡) + ğœ€ ğ‘– ğ‘— (ğ‘¡) + ğœ– ğ‘– ğ‘—ğ‘¡ , ğ‘— = 1, 2, 3,<label>(14)</label></formula><p>for ğ‘– = 1, 2, . . . , ğ‘. Further, for the structural part of the FSEM, we have</p><formula xml:id="formula_49">ğœ‚ ğ‘– (ğ‘¡) = ğ›¾ ğ‘¥ 1 (ğ‘¡)ğ‘¥ ğ‘–1 (ğ‘¡) + ğ›¾ ğ‘¥ 2 (ğ‘¡)ğ‘¥ ğ‘–2 (ğ‘¡) + ğœ ğ‘– (ğ‘¡). (<label>15</label></formula><formula xml:id="formula_50">)</formula><p>We assume that the indicators ğ‘§ ğ‘– ğ‘— for ğ‘– = 1, 2, . . . , ğ‘ and ğ‘— = 1, 2, 3 are observed at regular missing-atrandom time points ğ‘¡ ğ‘– ğ‘— ğ‘˜ = ğ‘˜/ğ‘€, ğ‘˜ = 1, 2, . . . , ğ‘€. The indicator ğ‘§ ğ‘– ğ‘— may be missing at ğ‘¡ ğ‘– ğ‘— ğ‘˜ according to a Bernoulli distribution with success probability ğ‘ = 0.12. For generating data from the FSEM represented in Figure <ref type="figure" target="#fig_3">2</ref>, the functional coefficients in the measurement models are chosen as ğ›½ ğ‘— (ğ‘¡) = ğ‘—ğ‘¡, ğœ† ğ‘— (ğ‘¡) = 1 + 1 2 cos(ğœ‹ âˆš ğ‘—ğ‘¡) for ğ‘— = 1, 2, 3, and for the structural models, we choose the parameters ğ›¾ ğ‘¥ 1 (ğ‘¡) = ğ‘¡ 2 and ğ›¾ ğ‘¥ 2 (ğ‘¡) = 2ğ‘¡ 2 .  The covariance structures for the residual functions are constructed using the Karhunen-LoÃ¨ve expansions with the same eigen-values and eigen-functions used in Simulation 1. The unique factors are constructed using covariance functions belonging to the MatÃ©rn family. We use the MatÃ©rn covariance functions ğ¾ ğœ ğ‘š (ğ‘ , ğ‘¡) = exp (-2ğ‘š|ğ‘¡ -ğ‘ |), for ğ‘š = 1, 2, 3. The values for ğœ 2 ğ‘— , ğ‘˜, and ğœŒ are set as in Simulation 1. The remaining parameters are selected as follows: ğ½ = 6, ğ‘€ = 8, and ğ‘ = 100. To assess the accuracy of the estimates, the MSEs of the estimators for the functional parameters, including factor loadings and regression coefficients, and the CRs of 95% confidence bands, are reported in Table <ref type="table">3</ref>. The table shows a pretty good accuracy and coverage of the model for nearly all parameters, with the exception of ğœ¸ ğ‘¥ 2 , which shows slightly worse MSE and CR. Table <ref type="table">3</ref>: Results of Simulation 2. MSE and CR of parameter estimates for the measurement and the structural models defined in ( <ref type="formula" target="#formula_48">14</ref>) and ( <ref type="formula" target="#formula_49">15</ref>), respectively. For the purposes of this analysis, a random sample of 400 participants who were involved in eight waves of data collection, from 2008 to 2022, was selected. The main goal of the analysis is to investigate the General Factor of Personality (GFP) as a latent factor identified by the Big Five personality traits.</p><p>Covariates available in the HRS include 'sex' (0=female, 1=male), 'cancer' (0=no cancer, 1=having been diagnosed with any type of cancer), 'diabetes' (0=no diabetes, 1=having been diagnosed with diabetes), 'heart conditions' (0=no heart disease, 1=having been diagnosed with any type of heart disease), and the Big Five personality traits including 'neuroticism', 'extraversion', 'openness', 'agreeableness', and 'conscientiousness'. The Big Five personality traits are regularly measured at eight measurement time points for each participant, but the data may be missing for some participants in some years.</p><p>The main goal of the analysis is to address the following research questions: (1) how does the structure of GFP, as a latent variable that explains the functional covariance between the Big Five personality traits, evolve in time (i.e., how the factor loadings estimated for GFP change across time)? (2) how do the personality factors constitute GFP? (3) how does GFP score differ between men and women over a time window from 2008 to 2022? And finally (4) how does GFP change if a person has been diagnosed with any type of cancer (with respect to no diagnosis)?</p><p>A matching procedure was employed to select a balanced sample of 400 participants, divided equally into two groups: those diagnosed with any type of cancer and those without any diagnosis. Initially, 200 participants with a cancer diagnosis were randomly selected. For each participant in the cancer group, a corresponding participant without a cancer diagnosis was chosen. The matching process ensures that each pair is comparable in terms of sex, diabetes status, and cardiovascular conditions. This approach aimed to control for these confounding variables, thereby enhancing the validity of the comparative analysis between the two groups.</p><p>The latent function GFP is identified through the Big Five personality traits. Here, each of the five traits has been considered as an observed variable by computing the arithmetic mean of its items (per measurement time points), and it thus can be considered as an 'item parcel' as in <ref type="bibr">(Newsom, 2015, p. 168)</ref>.</p><p>Although item parcels have various potential drawbacks, they are used here for pedagogical convenience to circumvent a more complex second-order factor model. Item parcels are generally less problematic when their components can be demonstrated to originate from a common factor that exhibits a strong relationship with the overarching factor <ref type="bibr" target="#b1">(Bandalos, 2001</ref>).</p><p>An FSEM with ğ‘ = 1 latent variable, ğ‘ = 5 indicators, and different covariates is fitted to the data to assess the relationship between the observed covariates 'sex' and 'cancer' at baseline, and the latent response variable GFP. The functional latent variable GFP for the ğ‘– th participant is denoted by GFP ğ‘– , and its corresponding indicators including 'neuroticism', 'extraversion', 'openness', 'agreeableness', and 'conscientiousness' are represented respectively by ğ‘§ ğ‘– ğ‘— for ğ‘— = 1, 2, . . . , 5 with ğ‘– = 1, 2, . . . , 400. Moreover, the variables G ğ‘– , and C ğ‘– indicate respectively the Sex and Cancer covariates for the ğ‘– th participant.</p><p>The following FSEM model is fitted to the dataset to obtain smooth estimates for the factor loadings in the measurement model and for the regression coefficients in the structural model:</p><formula xml:id="formula_51">ğ‘§ ğ‘– ğ‘— (ğ‘¡ ğ‘˜ ) = ğ›½ ğ‘— (ğ‘¡ ğ‘˜ ) + ğœ† ğ‘— (ğ‘¡ ğ‘˜ )GFP ğ‘– (ğ‘¡ ğ‘˜ ) + ğœ€ ğ‘– ğ‘— (ğ‘¡ ğ‘˜ ) + ğœ– ğ‘– ğ‘—ğ‘¡ ğ‘˜ ,<label>(16)</label></formula><formula xml:id="formula_52">GFP ğ‘– (ğ‘¡ ğ‘˜ ) = ğ›¾ ğ‘¥ 1 (ğ‘¡ ğ‘˜ )G ğ‘– + ğ›¾ ğ‘¥ 2 (ğ‘¡ ğ‘˜ )C ğ‘– + ğ›¾ ğ‘¥ 3 (ğ‘¡ ğ‘˜ )G ğ‘– C ğ‘– + ğœ ğ‘– (ğ‘¡ ğ‘˜ ),<label>(17)</label></formula><p>for ğ‘˜ = 1, 2, . . . , 8, where ğœ€ ğ‘– ğ‘— and ğœ ğ‘– stand for the residual function and the unique factor, and ğœ– ğ‘– ğ‘—ğ‘¡ ğ‘˜ represents the measurement error. The main effects of 'diabetes' and 'heart condition' and their two-way interactions with other covariates are also included in the structural part (17) of the model (not shown for the sake of simplicity). For some participants, missing values occur at some time points ğ‘¡ ğ‘˜ ; ğ‘˜ = 1, 2, . . . , 8. We assume a regular design with equally spaced, Missing Completely-At-Random (MCAR) time points for the study since Little's test <ref type="bibr" target="#b11">(Li, 2013)</ref> did not reject the hypothesis of MCAR.</p><p>The FSEM model defined above is fitted to the data with ğ½ = 6 basis functions. Figure <ref type="figure" target="#fig_5">3</ref> demonstrates convergence of the fitting procedure when inspecting the sum of tolerances of the estimated functional parameters including factor loadings and regression coefficients as well as the sum of the tolerances of the estimated measurement error variances ğœ 2 ğ‘— ; ğ‘— = 1, 2, . . . , 5. The smooth estimates of the factor loadings are shown in Figure <ref type="figure">4</ref>, while the regression coefficients for the main effects of 'sex' and 'cancer' (their two-way interaction was not significant, therefore not shown) are illustrated in Figure <ref type="figure" target="#fig_6">5</ref>. The main effects of the 'diabetes' and 'heart conditions' and their two-way  To evaluate the FSEM model fit to the data, all the fit indices defined in Section 5 were calculated and are presented in Table <ref type="table" target="#tab_7">4</ref>. Additionally, the SRMR and IFI functions for the fit of the model are depicted in Figure <ref type="figure">6</ref>. The values of the indices indicate that the model fit is generally good. Further, according to the SRMR and IFI functions in Figure <ref type="figure">6</ref>, IFI at all time points is higher than 0.9 and SRMR is lower than 0.08, implying the fit is stable and satisfactory over time.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.">Discussion and conclusion</head><p>In this paper, we developed a novel more general family of functional SEMs, namely FSEMs, for dealing with observed longitudinal or functional data, and for problems incorporating latent variables that might also possibly be functional. We proposed a maximum likelihood framework that properly handles data with repeated measurements observed at either equally spaced regular or non-equally spaced irregular time points, therefore proposing a framework capable of flexibly handling different missing data structures. We proposed a computational solution based on the EM algorithm to estimate the functional parameters, including the factor loadings, the regression coefficients, the covariance operators of the residual functions, and the unique factors. We provided smooth estimates for the functional parameters by applying a penalized likelihood approach that chooses the smoothing parameters using a cross-validation approach.</p><p>The proposed FSEM model has potentially a very broad impact, as it would be beneficial to researchers from applied fields who need to deal with latent structures in a repeated measurement setting. For example, potential medical applications could include modeling longitudinal trajectories of disease biomarkers as a function of underlying latent disease progression factors. The factor loadings can be chosen as either scalar or functional parameters, depending on the problem at hand: for a measurement model with time-independent loadings one can choose scalar factor loadings, otherwise, to obtain a time-dynamic measurement model, concurrent or historical functional factor loadings can be used.</p><p>We examined the performance of the proposed framework thanks to a set of simulation studies considering two different models and various data scenarios. We ran the simulation studies for combinations of different sample sizes, number of time points where the indicator curves are observed, and sampling designs. We considered two sampling designs, one with regular and another with irregular time points, to demonstrate the ability of the proposed framework to perform accurate estimation in the presence of various different data structures.</p><p>The proposed FSEM was also successfully employed to analyze a subset of the data available within the HRS <ref type="bibr" target="#b8">(Heeringa et al., 1995)</ref>, to examine the trend over time of the factor loading curves corresponding to the latent variable General Factor of Personality (GFP), and in general to assess whether the results obtained via the FSEM were in accordance to the previous literature on the topic. The relationship between the variable GFP and the covariates 'sex' and 'cancer' in the course of eight years from 2008 to 2022 for adults aged 50 and over was also explored thanks to the FSEM fit. The variable GFP was supposed to be identified through its corresponding indicators, including the Big Five personality traits 'neuroticism', 'extraversion', 'openness', 'agreeableness', and 'conscientiousness'. According to the results derived from fitting the FSEM to the dataset, all the factor loadings of the indicators were positive and constant over time except for the factor loading of 'neuroticism', which was negative and changed over time. Relatively constant factor loadings over time support the established idea that the GFP is a stable personal characteristic over time, and also the signs of the estimated factor loadings are in concordance with those reported in the literature. Moreover, there was no significant difference in the GFP score between cancer and no cancer groups, while this variable was higher for women compared to men, both also being quite reasonable and thus expected conclusions. Finally, the model fit was evaluated using goodness of fit indices developed for FSEM, and the values indicated a generally good model fit.</p><p>A limitation of the current work concerns the computational scalability to ultra-large datasets of the proposed EM algorithm. Currently, we are limited to handle designs with a few hundreds observations, and in the order of tens factors. However, we are in the process of optimizing the code by using the Rcpp R package <ref type="bibr" target="#b4">(Eddelbuettel &amp; Franc Â¸ois, 2011;</ref><ref type="bibr" target="#b5">Eddelbuettel et al., 2024)</ref>, which will significantly enhance the computational performance. All functions fitting the FSEM, as well as the scripts for reproducing the simulations, are available at <ref type="url" target="https://github.com/asgari-fatemeh/FSEM">https://github.com/asgari-fatemeh/FSEM</ref>.</p><p>We foresee a potential extension for the current work in dealing with the case when the indicators are not fully observed along time, but their discretized versions are observed at each time point, in the same spirit as in <ref type="bibr" target="#b0">Asgari et al. (2020)</ref>. In such a situation, a binary indicator might be simply observed as zero when a certain symptom or condition is not present, and 1 when it is present. A latent functional indicator variable can then be estimated being positive when the corresponding dichotomized indicator is observed to be 1, and negative when it is zero.</p><p>Finally, a future research direction could focus on developing a multi-level FSEM for handling clustered or hierarchical data structures. This would extend the current FSEM framework to accommodate smooth functional latent variables and their corresponding smooth functional indicators that vary at different levels of the hierarchy.</p><p>A. Appendix A Based on the Karhunen-LoÃ¨ve expansion of ğœ€ ğ‘– ğ‘— (ğ‘¡), we have</p><formula xml:id="formula_53">ğœ€ ğ‘– ğ‘— = ğ½ âˆ‘ï¸ ğ‘Ÿ=1 âˆš ğœˆ ğ‘—ğ‘Ÿ ğ‘¤ ğ‘—ğ‘Ÿ ğœ™ ğ‘—ğ‘Ÿ = ğ“ âŠ¤ ğ‘— diag ğœˆ ğ‘— (1) , . . . , ğœˆ ğ‘— ( ğ½ ) 1/2 w ğ‘– ğ‘— ,<label>(A1)</label></formula><p>where the ğ½-dimensional vector w ğ‘– ğ‘— has a multivariate standard Gaussian distribution and ğ“ ğ‘— denotes the vector of eigen-functions for ğœ€ ğ‘– ğ‘— (ğ‘¡). Suppose the function ğ‘¦ ğ‘– ğ‘— (ğ‘¡) is evaluated at the time points ğ‘¡ 1 , ğ‘¡ 2 , . . . , ğ‘¡ ğ‘€ .</p><p>From equations ( <ref type="formula" target="#formula_0">1</ref>) and (A1), we can write</p><formula xml:id="formula_54">ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğ‘¦ ğ‘– ğ‘— (ğ‘¡ 1 ) ğ‘¦ ğ‘– ğ‘— (ğ‘¡ 2 ) . . . ğ‘¦ ğ‘– ğ‘— (ğ‘¡ ğ‘€ ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğ›½ ğ‘— (ğ‘¡ 1 ) ğ›½ ğ‘— (ğ‘¡ 2 ) . . . ğ›½ ğ‘— (ğ‘¡ ğ‘€ ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» + ğ‘ âˆ‘ï¸ ğ‘š=1 ğ‘ â€² ğ‘—ğ‘š ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ 1 ) ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ 2 ) . . . ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ ğ‘€ ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» + ğ‘ âˆ‘ï¸ ğ‘š=1 ğ‘ ğ‘—ğ‘š ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ 1 ) ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ 2 ) . . . ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡ ğ‘€ ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» + ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğ“ âŠ¤ ğ‘— (ğ‘¡ 1 ) ğ“ âŠ¤ ğ‘— (ğ‘¡ 2 ) . . . ğ“ âŠ¤ ğ‘— (ğ‘¡ ğ‘€ ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» G 1/2 ğ‘— w ğ‘– ğ‘— ,<label>(A2)</label></formula><p>where diag ğœˆ ğ‘— (1) , . . . , ğœˆ ğ‘— ( ğ½ ) is denoted by G ğ‘— . Using the basis expansions ğ‘¦ ğ‘– ğ‘— (ğ‘¡) = e âŠ¤ (ğ‘¡)y ğ‘– ğ‘— ,</p><formula xml:id="formula_55">ğ›½ ğ‘– ğ‘— (ğ‘¡) = e âŠ¤ (ğ‘¡) ğœ· ğ‘– ğ‘— , ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = e âŠ¤ (ğ‘¡)f ğ‘– ğ‘—ğ‘š , ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = e âŠ¤ (ğ‘¡)f â€² ğ‘– ğ‘—ğ‘š , and ğ“ ğ‘— (ğ‘¡) = ğš½ âŠ¤ ğ‘— e(ğ‘¡)</formula><p>, where ğš½ ğ‘— ğ‘Ÿ ğ‘˜ = âŸ¨ğœ™ ğ‘— (ğ‘˜ ) , ğ‘’ ğ‘Ÿ âŸ©, for ğ‘Ÿ, ğ‘˜ = 1, . . . , ğ½, the equation (A2) can be rewritten as </p><formula xml:id="formula_56">E âŠ¤ y ğ‘– ğ‘— = E âŠ¤ ğœ· ğ‘— + ğ‘ âˆ‘ï¸ ğ‘š=1 f â€² ğ‘– ğ‘—ğ‘š ğ‘ â€² ğ‘—ğ‘š + ğ‘ âˆ‘ï¸ ğ‘š=1 f ğ‘– ğ‘—ğ‘š ğ‘ ğ‘—ğ‘š + E âŠ¤ ğš½ ğ‘— G 1/2 ğ‘— w ğ‘– ğ‘— ,<label>(</label></formula><formula xml:id="formula_57">f ğ‘– ğ‘—ğ‘š = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğœ¼ âŠ¤ ğ‘–ğ‘š e(ğ‘¡ 1 )ğœ† ğ‘—ğ‘š ğœ¼ âŠ¤ ğ‘–ğ‘š e(ğ‘¡ 2 )ğœ† ğ‘—ğ‘š . . . ğœ¼ âŠ¤ ğ‘–ğ‘š e(ğ‘¡ ğ‘€ )ğœ† ğ‘—ğ‘š ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» = (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘š ) âŠ¤ ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° e(ğ‘¡ 1 ) e(ğ‘¡ 2 ) . . . e(ğ‘¡ ğ‘€ ) ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» ğœ† ğ‘—ğ‘š ,</formula><p>in which [e(ğ‘¡ ğ‘˜ )] 1â‰¤ ğ‘˜ â‰¤ ğ‘€ is denoted by ğ.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B.2. Concurrent effect</head><p>When the effect is concurrent, we have ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = ğœ‚ ğ‘–ğ‘š (ğ‘¡) and ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = ğœ† ğ‘—ğ‘š (ğ‘¡)ğœ‚ ğ‘–ğ‘š (ğ‘¡). Thus, based on (B1) and ğœ† ğ‘—ğ‘š (ğ‘¡) = e âŠ¤ (ğ‘¡)ğ€ ğ‘—ğ‘š , we obtain f â€² ğ‘– ğ‘—ğ‘š = E âŠ¤ ğœ¼ ğ‘–ğ‘š and  For the smooth effect ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡), let g ğ‘™ = (ğ‘” ğ‘™1 , ğ‘” ğ‘™2 , . . . , ğ‘” ğ‘™ğ½ ) be a ğ½-vector of basis functions of the space ğ¿ 2 (ğœ ğ‘™ ), where ğœ ğ‘™ stands for the range of the covariate ğ‘¥ ğ‘™ for all ğ‘™ = 1, 2, . . . , ğ‘„. Then, the basis expansion for ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡) can be written as   </p><formula xml:id="formula_58">f ğ‘– ğ‘—ğ‘š = ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ğœ¼ âŠ¤ ğ‘–ğ‘š e(ğ‘¡ 1 )e âŠ¤ (ğ‘¡ 1 )ğ€ ğ‘—ğ‘š ğœ¼ âŠ¤ ğ‘–ğ‘š e(ğ‘¡ 2 )e âŠ¤ (ğ‘¡ 2 )ğ€ ğ‘—ğ‘š . . . ğœ¼ âŠ¤ ğ‘–ğ‘š e(ğ‘¡ ğ‘€ )e âŠ¤ (ğ‘¡ ğ‘€ )ğ€ ğ‘—ğ‘š ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£» = (I ğ‘€ âŠ— ğœ¼ ğ‘–ğ‘š ) âŠ¤ ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° e(</formula><formula xml:id="formula_59">ğ‘ </formula><formula xml:id="formula_60">ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£»</formula></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><label></label><figDesc>, y âˆ¼ N ( ğ y , ğšº y ), with ğ y = ğœ· + (ğš² + ğš² â€² )W ğœ¼ ğ ğœ¼ and ğšº y = (ğš² + ğš² â€² )W ğœ¼ ğšº ğœ¼ W ğœ¼ (ğš² + ğš² â€² ) âŠ¤ + diag I ğ‘ âŠ— ğšº ğœ€ ğ‘— 1â‰¤ ğ‘— â‰¤ ğ‘ . Accordingly, from (7) and defining E * = diag{diag(E âŠ¤ ğ‘– ğ‘— ) 1â‰¤ğ‘– â‰¤ ğ‘ } 1â‰¤ ğ‘— â‰¤ ğ‘ , where E ğ‘– ğ‘— = (e(ğ‘¡ ğ‘– ğ‘—1 ), e(ğ‘¡ ğ‘– ğ‘—2 ), . . . , e(ğ‘¡ ğ‘– ğ‘— ğ‘€ ğ‘– ğ‘— )), then we have z âˆ¼ N ( ğ z , ğšº z ), with ğ z = E * ğ y and ğšº z = E * ğšº y E * âŠ¤ + diag{ğœ 2</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>with ğ¹ ğ‘€ ğ¿ (ğ‘¡) = log |ğšº ğ‘¡ (ğœ½)| + tr(S ğ‘¡ ğšº ğ‘¡ (ğœ½) -1 )log |S ğ‘¡ | -ğ‘ denoting the minimum value of the fit function, where ğšº ğ‘¡ (ğœ½) is the model implied covariance matrix, and S ğ‘¡ is the sample covariance matrix (see Appendix D). One can then extend the Root Mean Square Error of Approximation (RMSEA) as RMSEA(ğ‘¡) = âˆšï¸„ ğœ’ 2 (ğ‘¡) -ğ‘‘ğ‘“ ğ‘‘ğ‘“ (ğ‘ -ğ‘— ğ‘˜ (ğ‘¡) -Ïƒ2 ğ‘— ğ‘˜ (ğ‘¡)) 2 ğ‘( ğ‘ + 1)/2</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 1 :</head><label>1</label><figDesc>Fig. 1: Path diagram for the FSEM used in Simulation 1, where ğ‘ = 3 and ğ‘ = 1.</figDesc><graphic coords="11,137.75,81.26,334.74,126.78" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 2 :</head><label>2</label><figDesc>Fig. 2: Path diagram for the FSEM used in Simulation 2, where ğ‘ = 3 and ğ‘ = 1.</figDesc><graphic coords="14,120.11,81.27,334.75,171.01" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><label></label><figDesc>of the FSEM to the analysis of the Health and Retirement Study (HRS) data In this section, a subset of the dataset extracted from the HRS (Health and Retirement Study, 2024) is analyzed to demonstrate the performance of the FSEM. This analysis uses Early Release data from the Health and Retirement Study, (Public Survey Data), sponsored by the National Institute on Aging (grant number NIA U01AG009740) and conducted by the University of Michigan. These data have not been cleaned and may contain errors that will be corrected in the Final Public Release version of the dataset.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 3 :</head><label>3</label><figDesc>Fig. 3: Results of the HRS data analysis. Convergence of parameters estimation along the EM algorithm iterations. Left panel: total tolerance of the functional parameters, as estimated via the sum of the tolerances of factor loadings and regression coefficients. Right panel: total tolerance of the measurement errors, as estimated via the sum of the tolerances of the measurement error for each of the indicators.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 5 :</head><label>5</label><figDesc>Fig. 5: Results of the HRS data analysis. Estimated regression coefficients with the corresponding 95% confidence bands. Left panel: main effect of sex; right panel: main effect of cancer status.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><label></label><figDesc>A3) where E = [e(ğ‘¡ 1 ), e(ğ‘¡ 2 ) . . . , e(ğ‘¡ ğ‘€ )] âˆˆ R ğ½ Ã—ğ‘¡ ğ‘€ and ğš½ ğ‘— G 1/2 ğ‘— w ğ‘– ğ‘— is denoted by ğœº ğ‘– ğ‘— . Finally, by multiplying both sides of the equation (A3) by (EE âŠ¤ ) -1 E, the model in (4) is derived. B. Appendix B B.1. Fixed effect For the fixed effect, we have ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = ğœ‚ ğ‘–ğ‘š (ğ‘¡) and ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = ğœ† ğ‘—ğ‘š ğœ‚ ğ‘–ğ‘š (ğ‘¡). Based on the basis expansion ğœ‚ ğ‘–ğ‘š (ğ‘¡) = e âŠ¤ (ğ‘¡)ğœ¼ ğ‘–ğ‘š , (B1) we can write f â€² ğ‘– ğ‘—ğ‘š = E âŠ¤ ğœ¼ ğ‘–ğ‘š and</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><label></label><figDesc>is denoted by ğš«. The basis expansion of ğœ† ğ‘—ğ‘š (ğ‘ , ğ‘¡) can be written asğœ† ğ‘—ğ‘š (ğ‘ , ğ‘¡) = e âŠ¤ (ğ‘ ) [ğœ† ( ğ‘—ğ‘š) ğ‘Ÿ ğ‘˜ ] 1â‰¤ğ‘Ÿ ,ğ‘˜ â‰¤ ğ½ e(ğ‘¡) = (e âŠ¤ (ğ‘¡) âŠ— e âŠ¤ (ğ‘ ))vec( [ğœ† ( ğ‘—ğ‘š)ğ‘Ÿ ğ‘˜ ] 1â‰¤ğ‘Ÿ ,ğ‘˜ â‰¤ ğ½ ), ğ‘˜,â„â‰¤ ğ½ ) is denoted by ğ€ ğ‘—ğ‘š . Hence, based on (B1) and (B2), we have f ) (e âŠ¤ (ğ‘¡ ğ‘€ ) âŠ— e âŠ¤ (ğ‘ ))ğ‘‘ğ‘ ğ€ ğ‘—ğ‘š ) (e âŠ¤ (ğ‘¡ 1 ) âŠ— e âŠ¤ (ğ‘ ))ğ‘‘ğ‘  âˆ«ğ‘ â‰¤ğ‘¡ 2 e(ğ‘ ) (e âŠ¤ (ğ‘¡ 2 ) âŠ— e âŠ¤ (ğ‘ ))ğ‘‘ğ‘  .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head></head><label></label><figDesc>According to the models given in (1), (2), and (3), the elements of the model covariance matrix ğšº ğ‘¡ (ğœ½) can be derived ascov(ğ‘§ ğ‘— (ğ‘¡), ğ‘§ ğ‘˜ (ğ‘¡)) = cov(ğ‘¦ ğ‘— (ğ‘¡), ğ‘¦ ğ‘˜ (ğ‘¡)) + cov(ğœ– ğ‘—ğ‘¡ , ğœ– ğ‘˜ğ‘¡ ), ğ‘—, ğ‘˜ = 1, 2, . . . , ğ‘, (D1) cov(ğ‘§ ğ‘— (ğ‘¡), ğ‘¥ ğ‘™ (ğ‘¡)) = cov(ğ‘¦ ğ‘— (ğ‘¡), ğ‘¥ ğ‘™ (ğ‘¡)), ğ‘— = 1, 2, . . . , ğ‘, ğ‘™ = 1, 2, . . . , ğ‘„,(D2)and cov(ğ‘¥ ğ‘Ÿ (ğ‘¡), ğ‘¥ ğ‘  (ğ‘¡)) for ğ‘Ÿ, ğ‘  = 1, 2, . . . , ğ‘„.For the equation (D1), we have cov(ğœ– ğ‘—ğ‘¡ , ğœ– ğ‘˜ğ‘¡ ) = ğœ 2 ğ‘— for ğ‘— = ğ‘˜, otherwise equals zero. Moreover, from (1), we obtaincov(ğ‘¦ ğ‘— (ğ‘¡), ğ‘¦ ğ‘˜ (ğ‘¡)) = ğ‘ âˆ‘ï¸ ğ‘š=1 cov ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘š , ğ‘¡), ğ‘“ ğ‘˜ğ‘š (ğœ‚ ğ‘š , ğ‘¡) ğ‘ ğ‘—ğ‘š ğ‘ ğ‘˜ğ‘š + cov(ğœ€ ğ‘— (ğ‘¡), ğœ€ ğ‘˜ (ğ‘¡)),where cov(ğœ€ ğ‘— (ğ‘¡), ğœ€ ğ‘˜ (ğ‘¡)) = ğ‘˜ ğœ€ ğ‘— (ğ‘¡, ğ‘¡) for ğ‘— = ğ‘˜, otherwise is zero. For the concurrent effect, we have cov ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘š , ğ‘¡), ğ‘“ ğ‘˜ğ‘š (ğœ‚ ğ‘š , ğ‘¡) = ğœ† ğ‘—ğ‘š (ğ‘¡)ğœ† ğ‘˜ğ‘š (ğ‘¡)var(ğœ‚ ğ‘š (ğ‘¡)), and for the historical effect, we can write cov ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘š , ğ‘¡), ğ‘“ ğ‘˜ğ‘š (ğœ‚ ğ‘š , ğ‘¡) = âˆ« ğ‘  1 â‰¤ğ‘¡</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>2 , . . . , ğ‘¥ ğ‘„ are either scalar or functional observed explanatory variables. The effects of the latent factors and of these explanatory variables on the latent factors are respectively described by the terms ğ‘  ğ‘–ğ‘™ is a curve over time. If ğœ‚ ğ‘š is regressed on ğœ‚ ğ‘› and ğ‘¥ ğ‘™ , the corresponding terms ğ‘ ğ‘› (to exclude the effect of each functional factor on itself). Furthermore, ğœ ğ‘–ğ‘š for ğ‘š = 1, 2, . . . , ğ‘ are Gaussian with mean functions zero and covariance operators ğ¶ ğ‘š .</figDesc><table /><note><p>ğœ‚ ğ‘šğ‘› (ğœ‚ ğ‘–ğ‘› , ğ‘¡) and ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡). The term ğ‘  ğœ‚ ğ‘šğ‘› (ğœ‚ ğ‘–ğ‘› , ğ‘¡) can be of the forms concurrent or historical, as this term describes the effect on the functional factor of another functional factor. The term ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡) instead describes the effect of the explanatory variables, and it might be smooth over time or linear, i.e., ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡) = ğ›¾ ğ‘¥ ğ‘šğ‘™ (ğ‘¡)ğ‘¥ ğ‘–ğ‘™ , when the covariate ğ‘¥ ğ‘–ğ‘™ is a scalar-valued variable, and concurrent or historical, when ğ‘¥ ğœ‚ ğ‘šğ‘› and ğ‘ ğ‘¥ ğ‘šğ‘™ take value 1, otherwise they are 0. The term ğ‘ ğœ‚ ğ‘šğ‘› is always zero for ğ‘š =</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>ğ€ ğ‘— ) = ğ€ âŠ¤ ğ‘— P ğœ† ğ‘— ğ€ ğ‘— and pen(ğœ¸ ğ‘š ) = ğœ¸ âŠ¤ ğ‘š P ğ›¾ ğ‘š ğœ¸ ğ‘š are the penalty terms corresponding to the parameters ğ€ ğ‘— and ğœ¸ ğ‘š , respectively. Further, the penalty matrices P ğœ† ğ‘— and P</figDesc><table><row><cell></cell><cell>ğ‘</cell><cell></cell><cell></cell><cell>ğ‘</cell><cell></cell></row><row><cell>-ğ›¼ ğœ† ğ‘—</cell><cell>âˆ‘ï¸</cell><cell>pen(ğ€ ğ‘— ) -ğ›¼</cell><cell>ğ›¾ ğ‘š</cell><cell>âˆ‘ï¸</cell><cell>pen(ğœ¸ ğ‘š ),</cell></row><row><cell></cell><cell>ğ‘—=1</cell><cell></cell><cell></cell><cell>ğ‘š=1</cell><cell></cell></row><row><cell cols="6">where pen(ğ›¾ ğ‘š are defined as</cell></row></table><note><p>y, ğœ¼, x; ğœ½)] =E y|z,x;ğœ½ (ğ‘š â€² ) [log ğ‘“ (z|y, x; ğœ½)] + E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) [log ğ‘“ (y|ğœ¼, x; ğœ½)] + E y|z,x;ğœ½ (ğ‘š â€² ) E ğœ¼ |y,x;ğœ½ (ğ‘š â€² ) [log ğ‘“ (ğœ¼|x; ğœ½)]</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>âŠ¤</head><label></label><figDesc>âŠ¤ and ğš² ğ‘—ğ‘š = (I ğ‘€ âŠ— ğ€ âŠ¤ ğ‘—ğ‘š )ğ›€ 1 . When the effect is instead historical, we have ğš² ğš« and ğš² ğ‘—ğ‘š = (I ğ‘€ âŠ— ğ€ âŠ¤ âŠ¤ (ğ‘ )ğ‘‘ğ‘  1â‰¤ ğ‘˜ â‰¤ ğ‘€ . Furthermore, x ğ‘– = (x ğ‘–ğ‘™ ) 1â‰¤ğ‘™ â‰¤ğ‘„ and ğšª ğ›€ 1 in the case of concurrent effect of ğœ‚ ğ‘› on ğœ‚ ğ‘š and ğšª</figDesc><table><row><cell>ğ‘—ğ‘š )ğ›€  *  2 with ğ›€  *  2 = (e(ğ‘¡ ğœ‚ âˆ« ğ‘ â‰¤ğ‘¡ ğ‘˜ ğ‘š = (EE âŠ¤ ) -1 E ğšª ğœ‚ ğ‘š1 |ğšª ğœ‚ ğœ‚ ğ‘šğ‘ , where ğšª ğ‘š2 | . . . |ğšª ğœ‚ ğ‘šğ‘› = (I ğ‘€ âŠ— ğœ¸ ğœ‚ ğ‘šğ‘› ) âŠ¤ ğ›€  *  2 , when historical. Finally, ğ‘š2 | . . . |ğšª ğ‘¥ ğ‘š1 |ğšª ğ‘¥ ğ‘š = (EE âŠ¤ ) -1 E ğšª ğ‘¥ ğšª ğ‘¥ ğ‘šğ‘„ , where ğšª ğ‘¥ ğ‘šğ‘™ can take the following different forms:</cell></row></table><note><p>and the same definition holds for ğš² â€² ğ‘— with ğš² â€² ğ‘—ğ‘š for ğ‘š = 1, . . . , ğ‘ instead. When the effect of ğœ‚ ğ‘š on ğ‘¦ ğ‘— is fixed we have ğš² â€² ğ‘—ğ‘š = E âŠ¤ and ğš² ğ‘—ğ‘š = ğœ† ğ‘—ğ‘š E âŠ¤ , while for the concurrent effect we obtain ğš² â€² ğ‘—ğ‘š = E â€² ğ‘—ğ‘š = ğ‘˜ ) âŠ— e(ğ‘ ))e ğœ‚ ğ‘šğ‘› = (I ğ‘€ âŠ— ğœ¸ ğœ‚ ğ‘šğ‘› )</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head></head><label></label><figDesc>= e âŠ¤ (ğ‘ ) Î£ğœ¸ ğœ‚ ğ‘šğ‘› e(ğ‘¡) when the effect of ğœ‚ ğ‘š on ğœ‚ ğ‘› is concurrent, and as cov ğ›¾ ğœ‚ ğ‘šğ‘› (ğ‘ , ğ‘¡ 1 ), ğ›¾ ğœ‚ ğ‘šğ‘› (ğ‘ , ğ‘¡ 2 ) = e âŠ¤ (ğ‘¡ 1 ) âŠ— e âŠ¤ (ğ‘ ) Î£ğœ¸ ğœ‚ ğ‘šğ‘› e(ğ‘¡ 2 ) âŠ— e(ğ‘ ) when it is historical. Furthermore, in the case when the effect of ğœ‚ ğ‘š on ğ‘¥ ğ‘™ is smooth, we have cov ğ›¾ ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘™ , ğ‘¡), ğ›¾ ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘™ , ğ‘¡) = e âŠ¤ (ğ‘¡) âŠ— h âŠ¤ ğ‘™ (ğ‘¥ ğ‘™ ) Î£ğœ¸ ğ‘¥ ğ‘šğ‘™ e(ğ‘¡) âŠ— h ğ‘™ (ğ‘¥ ğ‘™ ) , and for the constant effect of ğœ‚ ğ‘š on ğ‘¥ ğ‘™ , we can write cov ğ›¾ ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ ), ğ›¾ ğ‘¥ ğ‘šğ‘™</figDesc><table><row><cell>ğœ‚ ğ‘šğ‘› (ğ‘ ), ğ›¾</cell><cell>ğœ‚ ğ‘šğ‘› (ğ‘¡)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head>Table 1 :</head><label>1</label><figDesc>Results of Simulation 1. MSE of parameter estimates for the measurement models defined in (12) and (13), in the case of regular (R) and irregular (IR) designs.</figDesc><table><row><cell></cell><cell>N</cell><cell>M</cell><cell>ğœ· 1</cell><cell>ğ€ 1</cell><cell>ğ“ 11</cell><cell>ğ‚ 11</cell><cell>ğˆ 2 1</cell></row><row><cell>R</cell><cell>50</cell><cell cols="5">10 0.053 0.024 0.022 0.110 20 0.051 0.028 0.021 0.092</cell><cell>0.004 &lt;0.001</cell></row><row><cell>FM(1)</cell><cell>100</cell><cell cols="5">10 0.027 0.012 0.018 0.064 20 0.031 0.021 0.018 0.070</cell><cell>0.003 &lt;0.001</cell></row><row><cell>IR</cell><cell>50 100</cell><cell cols="5">10 0.048 0.037 0.039 0.053 20 0.045 0.021 0.036 0.052 10 0.024 0.021 0.026 0.046 20 0.024 0.010 0.024 0.054</cell><cell>&lt;0.001 &lt;0.001 &lt;0.001 &lt;0.001</cell></row><row><cell></cell><cell>N</cell><cell>M</cell><cell>ğœ· 2</cell><cell>ğ€ 2</cell><cell>ğ“ 21</cell><cell>ğ‚ 21</cell><cell>ğˆ 2 2</cell></row><row><cell>R</cell><cell>50</cell><cell cols="5">10 0.048 0.025 0.026 0.043 20 0.048 0.026 0.021 0.038</cell><cell>0.003 &lt;0.001</cell></row><row><cell>FM(2)</cell><cell>100</cell><cell cols="5">10 0.025 0.013 0.012 0.020 20 0.028 0.016 0.009 0.023</cell><cell>0.002 &lt;0.001</cell></row><row><cell>IR</cell><cell>50 100</cell><cell cols="5">10 0.042 0.031 0.044 0.030 20 0.034 0.020 0.032 0.023 10 0.021 0.016 0.028 0.013 20 0.018 0.010 0.027 0.013</cell><cell>&lt;0.001 &lt;0.001 &lt;0.001 &lt;0.001</cell></row><row><cell></cell><cell>N</cell><cell>M</cell><cell>ğœ· 3</cell><cell>ğ€ 3</cell><cell>ğ“ 31</cell><cell>ğ‚ 31</cell><cell>ğœ 2 3</cell></row><row><cell>R</cell><cell>50</cell><cell cols="5">10 0.024 0.081 0.259 0.191 20 0.024 0.061 0.025 0.052</cell><cell>0.003 0.001</cell></row><row><cell>FM(3)</cell><cell>100</cell><cell cols="5">10 0.015 0.065 0.232 0.154 20 0.016 0.048 0.019 0.023</cell><cell>0.002 0.001</cell></row><row><cell>IR</cell><cell>50 100</cell><cell cols="5">10 0.021 0.046 0.039 0.024 20 0.018 0.042 0.021 0.023 10 0.012 0.037 0.019 0.014 20 0.010 0.030 0.011 0.011</cell><cell>0.003 &lt;0.001 0.004 0.001</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>Table 2 :</head><label>2</label><figDesc></figDesc><table><row><cell>design</cell><cell>N</cell><cell>M</cell><cell>ğ€ 1</cell><cell>ğ€ 2</cell><cell>ğ€ 3</cell></row><row><cell>R</cell><cell>50 100</cell><cell cols="4">10 0.951 0.957 0.962 20 0.940 0.954 0.935 10 0.960 0.970 0.914 20 0.906 0.956 0.919</cell></row><row><cell>IR</cell><cell>50 100</cell><cell cols="4">10 0.912 0.923 0.934 20 0.932 0.935 0.937 10 0.914 0.928 0.914 20 0.944 0.950 0.916</cell></row></table><note><p>Results of Simulation 1. CR of the confidence bands for the regression coefficient estimates in the case of regular (R) and irregular (IR) designs.</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head>Table 4 :</head><label>4</label><figDesc>The values for the goodness of fit indices.</figDesc><table><row><cell></cell><cell></cell><cell></cell><cell>ğœ’ 2 /ğ‘‘ ğ‘“</cell><cell cols="2">RMSEA SRMR</cell><cell>CFI</cell><cell>IFI</cell><cell>GFI</cell><cell>TLI</cell></row><row><cell></cell><cell></cell><cell></cell><cell>2.549</cell><cell>0.094</cell><cell>0.022</cell><cell cols="3">0.922 0.940 0.956 0.893</cell></row><row><cell></cell><cell>1.00</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>0.08</cell><cell></cell></row><row><cell>IFI</cell><cell>0.85</cell><cell></cell><cell></cell><cell></cell><cell>SRMR</cell><cell>0.04</cell><cell></cell></row><row><cell></cell><cell>0.70</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>0.00</cell><cell></cell></row><row><cell></cell><cell>2008</cell><cell>2012</cell><cell>2016</cell><cell>2020</cell><cell></cell><cell></cell><cell>2008</cell><cell>2012</cell><cell>2016</cell><cell>2020</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>Year</cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell cols="7">Fig. 6: Model fit over time. Left panel: IFI function. Right panel: SRMR function.</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8"><head></head><label></label><figDesc>ğ‘¡ 1 )e âŠ¤ (ğ‘¡ 1 ) e(ğ‘¡ 2 )e âŠ¤ (ğ‘¡ 2 ) . . . ğ‘¡ ğ‘˜ )e âŠ¤ (ğ‘¡ ğ‘˜ ) 1â‰¤ ğ‘˜ â‰¤ ğ‘€ is denoted by ğ›€ 1 . B.3. Historical effect We know that ğ‘“ â€² ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = âˆ« ğ‘ â‰¤ğ‘¡ ğœ‚ ğ‘–ğ‘š (ğ‘ )ğ‘‘ğ‘  and ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘–ğ‘š , ğ‘¡) = âˆ« ğ‘ â‰¤ğ‘¡ ğœ† ğ‘—ğ‘š (ğ‘ , ğ‘¡)ğœ‚ ğ‘–ğ‘š (ğ‘ )ğ‘‘ğ‘ . Due to (B1), we can write</figDesc><table><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>e(ğ‘¡ ğ‘€ )e âŠ¤ (ğ‘¡ ğ‘€ )</cell><cell>ï£¹ ï£º ï£º ï£º ï£» ï£º ï£º ï£º ï£º</cell><cell>ğ€ ğ‘—ğ‘š ,</cell></row><row><cell cols="3">where e(f â€² ğ‘– ğ‘—ğ‘š =</cell><cell>ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° âˆ« âˆ« ğ‘ â‰¤ğ‘¡ 1 âˆ« ğ‘ â‰¤ğ‘¡ 2 ğ‘ â‰¤ğ‘¡ ğ‘€</cell><cell>e âŠ¤ (ğ‘ )ğ‘‘ğ‘  e âŠ¤ (ğ‘ )ğ‘‘ğ‘  . . . e âŠ¤ (ğ‘ )ğ‘‘ğ‘ </cell><cell>ï£¹ ï£º ï£º ï£º ï£» ï£º ï£º ï£º ï£º ï£º</cell><cell>ğœ¼ ğ‘–ğ‘š ,</cell></row><row><cell>where</cell><cell>âˆ« ğ‘ â‰¤ğ‘¡ ğ‘˜</cell><cell>e âŠ¤ (ğ‘ )ğ‘‘ğ‘ </cell><cell></cell><cell></cell></row></table><note><p>1â‰¤ ğ‘˜ â‰¤ ğ‘€</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9"><head></head><label></label><figDesc>= (e âŠ¤ (ğ‘¡) âŠ— g âŠ¤ ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ))vec [ğ›¾(ğ‘™)  ğ‘Ÿ ğ‘˜ ] 1â‰¤ğ‘Ÿ ,ğ‘˜ â‰¤ ğ½ , (C1)where vec [ğ›¾(ğ‘™)  ğ‘Ÿ ğ‘˜ ] 1â‰¤ğ‘Ÿ ,ğ‘˜ â‰¤ ğ½ is denoted by ğœ¸ ğ‘¥ ğ‘šğ‘™ . Using (C1), we can write(e âŠ¤ (ğ‘¡ 1 ) âŠ— g âŠ¤ ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ))ğœ¸ ğ‘¥ ğ‘šğ‘™ (e âŠ¤ (ğ‘¡ 2 ) âŠ— g âŠ¤ ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ))ğœ¸ ğ‘¥ ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ) ğœ¸ ğ‘¥ ğ‘šğ‘™ , in which [e âŠ¤ (ğ‘¡ ğ‘˜ )] âŠ¤ 1â‰¤ ğ‘˜ â‰¤ ğ‘€ is denoted by E.In case the effect is linear, we know ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡) = ğ›¾ ğ‘¥ ğ‘šğ‘™ (ğ‘¡)ğ‘¥ ğ‘–ğ‘™ . Thus, according to the basis expansion ğ›¾ ğ‘¥ ğ‘šğ‘™ (ğ‘¡) = e âŠ¤ (ğ‘¡)ğœ¸ ğ‘¥ ğ‘šğ‘™ , we obtain âŠ¤ (ğ‘¡ 1 )ğœ¸ ğ‘¥ ğ‘šğ‘™ ğ‘¥ ğ‘–ğ‘™ e âŠ¤ (ğ‘¡ 2 )ğœ¸ ğ‘¥ ğ‘šğ‘™ ğ‘¥ ğ‘–ğ‘™ . . .</figDesc><table><row><cell>s ğ‘¥ ğ‘–ğ‘šğ‘™ =</cell><cell>ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£°</cell><cell cols="2">ğ‘šğ‘™ ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ))ğœ¸ ğ‘¥ (e âŠ¤ (ğ‘¡ ğ‘€ ) âŠ— g âŠ¤ . . . ğ‘šğ‘™</cell><cell>ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£»</cell><cell>=</cell><cell></cell><cell cols="2">ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° e âŠ¤ (ğ‘¡ ğ‘€ ) e âŠ¤ (ğ‘¡ 1 ) e âŠ¤ (ğ‘¡ 2 ) . . .</cell><cell>ï£¹ ï£º ï£º ï£º ï£» ï£º ï£º ï£º ï£º</cell><cell>âŠ— g âŠ¤</cell></row><row><cell></cell><cell></cell><cell></cell><cell cols="5">C.2. Linear effect</cell></row><row><cell></cell><cell></cell><cell>s ğ‘¥ ğ‘–ğ‘šğ‘™ =</cell><cell>ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° e e âŠ¤ (ğ‘¡ ğ‘€ )ğœ¸ ğ‘¥ ğ‘šğ‘™ ğ‘¥ ğ‘–ğ‘™</cell><cell>ï£¹ ï£º ï£º ï£º ï£º ï£º ï£º ï£º ï£»</cell><cell>=</cell><cell>ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£°</cell><cell>e âŠ¤ (ğ‘¡ 1 ) e âŠ¤ (ğ‘¡ 2 ) . . . e âŠ¤ (ğ‘¡ ğ‘€ )</cell><cell>ï£¹ ï£º ï£º ï£º ï£» ï£º ï£º ï£º ï£º</cell><cell>ğœ¸ ğ‘¥ ğ‘šğ‘™ ğ‘¥ ğ‘–ğ‘™ .</cell></row><row><cell></cell><cell></cell><cell></cell><cell cols="5">D. Appendix D</cell></row><row><cell cols="4">Let us define the vector of observed variables as</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell cols="3">ğ‘§ 1 (ğ‘¡) ğ‘§ 2 (ğ‘¡) . . . ğ‘§ ğ‘ (ğ‘¡) ğ‘¥ 1 (ğ‘¡) ğ‘¥ 2 (ğ‘¡) . . . ğ‘¥ ğ‘„ (ğ‘¡) ï£® ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£¯ ï£° ï£¯</cell><cell></cell><cell></cell></row></table><note><p>ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘–ğ‘™ , ğ‘¡) = g âŠ¤ ğ‘™ (ğ‘¥ ğ‘–ğ‘™ ) [ğ›¾ (ğ‘™) ğ‘Ÿ ğ‘˜ ] 1â‰¤ğ‘Ÿ ,ğ‘˜ â‰¤ ğ½ e(ğ‘¡)</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_10"><head>âˆ«</head><label></label><figDesc>ğ‘  2 â‰¤ğ‘¡ ğœ† ğ‘—ğ‘š (ğ‘  1 , ğ‘¡)ğœ† ğ‘˜ğ‘š (ğ‘  2 , ğ‘¡)cov(ğœ‚ ğ‘š (ğ‘  1 ), ğœ‚ ğ‘š (ğ‘  2 ))ğ‘‘ğ‘  1 ğ‘‘ğ‘  2 .Further, based on equation (3), we can write cov(ğœ‚ ğ‘š (ğ‘  1 ),ğœ‚ ğ‘š (ğ‘  2 )) = ğœ‚ ğ‘› , ğ‘  1 ), ğ‘  ğœ‚ ğ‘šğ‘› (ğœ‚ ğ‘› , ğ‘  2 ) ğ‘ ğ‘¥ ğ‘™ , ğ‘  1 ), ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘™ , ğ‘  2 ) ğ‘ ğ‘¥ 2 ğ‘šğ‘™ + ğ‘˜ ğœ ğ‘š (ğ‘  1 , ğ‘  2 ).For the equation given in (D2), we have cov(ğ‘¦ ğ‘— (ğ‘¡), ğ‘¥ ğ‘™ (ğ‘¡)) = ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘š , ğ‘¡), ğ‘¥ ğ‘™ (ğ‘¡))ğ‘ ğ‘—ğ‘š , in which cov( ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘š , ğ‘¡), ğ‘¥ ğ‘™ (ğ‘¡)) = ğœ† ğ‘—ğ‘š (ğ‘¡)cov(ğœ‚ ğ‘š (ğ‘¡), ğ‘¥ ğ‘™ (ğ‘¡)), in case the effect is concurrent and cov( ğ‘“ ğ‘—ğ‘š (ğœ‚ ğ‘š , ğ‘¡), ğ‘¥ ğ‘™ (ğ‘¡)) = âˆ« ğ‘¢â‰¤ğ‘¡ ğœ† ğ‘—ğ‘š (ğ‘¢, ğ‘¡)cov(ğœ‚ ğ‘š (ğ‘¢), ğ‘¥ ğ‘™ (ğ‘¡))ğ‘‘ğ‘¢, if the effect is historical. Moreover, cov(ğœ‚ ğ‘š (ğ‘¢), ğ‘¥ ğ‘™ (ğ‘¡)) =</figDesc><table><row><cell cols="2">ğ‘</cell><cell></cell></row><row><cell cols="2">âˆ‘ï¸</cell><cell cols="2">cov ğ‘ </cell><cell>ğœ‚ ğ‘šğ‘› (ğœ‚ 2 ğ‘šğ‘›</cell></row><row><cell cols="2">ğ‘›=1</cell><cell></cell></row><row><cell></cell><cell cols="2">ğ‘„</cell></row><row><cell>+</cell><cell cols="2">âˆ‘ï¸ ğ‘™=1</cell><cell>cov ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘</cell></row><row><cell></cell><cell></cell><cell></cell><cell>âˆ‘ï¸ ğ‘š=1 cov( ğ‘</cell></row><row><cell></cell><cell></cell><cell></cell><cell>âˆ‘ï¸</cell><cell>cov(ğ‘ </cell><cell>ğœ‚ ğ‘šğ‘›</cell></row><row><cell></cell><cell></cell><cell></cell><cell>ğ‘›=1</cell></row><row><cell></cell><cell></cell><cell></cell><cell>+</cell></row></table><note><p>ğœ‚ ğ‘šğ‘› (ğœ‚ ğ‘› , ğ‘¢), ğ‘¥ ğ‘™ (ğ‘¡))ğ‘ ğ‘„ âˆ‘ï¸ ğ‘Ÿ=1 cov(ğ‘  ğ‘¥ ğ‘šğ‘™ (ğ‘¥ ğ‘Ÿ , ğ‘¢), ğ‘¥ ğ‘™ (ğ‘¡))ğ‘ ğ‘¥ ğ‘šğ‘Ÿ .</p></note></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgment</head><p>The first author was supported by <rs type="funder">ERA-NET-NEURON</rs>, <rs type="funder">JTC 2020/Norwegian Research Council</rs> (grant number <rs type="grantNumber">323047</rs>), and the <rs type="funder">South-Eastern Norway Regional Health Authority</rs> (grant number <rs type="grantNumber">2021046</rs>).</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_jWMQVpn">
					<idno type="grant-number">323047</idno>
				</org>
				<org type="funding" xml:id="_2aFPuwB">
					<idno type="grant-number">2021046</idno>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>interactions are not shown, as they were not significant due to their 95% confidence bands including zero throughout the domain.</p><p>According to Figure <ref type="figure">4</ref>, the factor loadings of the indicators 'extraversion', 'openness', 'agreeableness', and 'conscientiousness' are all positive, and they seem to constant in time, as their confidence bands resemble a constant line. In contrast, the factor loading of 'neuroticism' is overall negative, but it changes slightly over time, with its amplitude increasing until the end of 2019 and decreasing afterward. According to the sign of the estimated factor loadings, higher fitted GFP score is related to more openness, extraversion, agreeableness, conscientiousness, and less neuroticism. As a result, the proposed method reproduces the pattern of the Big Five personality traits given by <ref type="bibr" target="#b6">Funder (1991)</ref>. Moreover, the estimated regression coefficients shown in Figure <ref type="figure">5</ref> also depict significantly higher GFP score for women as compared to men, and no significant difference between cancer and no cancer groups.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Latent function-on-scalar regression models for observed sequences of binary data: a restricted likelihood approach</title>
		<author>
			<persName><forename type="first">F</forename><surname>Asgari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">H</forename><surname>Alamatsaz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Vitelli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Hayati</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2012.02635</idno>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Item parceling issues in structural equation modeling</title>
		<author>
			<persName><forename type="first">D</forename><surname>Bandalos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advanced structural equation modeling: New developments and techniques</title>
		<imprint>
			<publisher>Lawrence Erlbaum Associates</publisher>
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A geometric approach to confidence regions and bands for functional parameters</title>
		<author>
			<persName><forename type="first">H</forename><surname>Choi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Reimherr</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society Series B: Statistical Methodology</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page" from="239" to="260" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">A causal approach to functional mediation analysis with application to a smoking cessation intervention</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">L</forename><surname>Coffman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">J</forename><surname>Dziak</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Litson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Chakraborti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">E</forename><surname>Piper</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Multivariate Behavioral Research</title>
		<imprint>
			<biblScope unit="page" from="1" to="18" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Rcpp: Seamless R and C++ integration</title>
		<author>
			<persName><forename type="first">D</forename><surname>Eddelbuettel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Franc Â¸ois</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Software</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page" from="1" to="18" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Rcpp: Seamless R and C++ Integration. R package version 1</title>
		<author>
			<persName><forename type="first">D</forename><surname>Eddelbuettel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Francois</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Allaire</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Ushey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Q</forename><surname>Kou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Russell</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Ucar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Bates</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Chambers</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2024">2024</date>
			<biblScope unit="page" from="0" to="13" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Global traits: A neo-allportian approach to personality</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">C</forename><surname>Funder</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychological Science</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="31" to="39" />
			<date type="published" when="1991">1991</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Public Survey Data. Produced and distributed by the University of Michigan with funding from the National</title>
		<author>
			<persName><forename type="first">W</forename><surname>Guo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Health and Retirement Study</title>
		<imprint>
			<date type="published" when="2002">2002. 2024</date>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="page" from="121" to="128" />
		</imprint>
	</monogr>
	<note>Functional mixed effects models. Institute on Aging (grant number NIA U01AG009740</note>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Technical description of the health and retirement survey sample design</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">G</forename><surname>Heeringa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">H</forename><surname>Connor</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1995">1995</date>
			<publisher>University of Michigan</publisher>
			<pubPlace>Ann Arbor</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">K.-Y</forename><surname>Lee</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Functional structural equation model</title>
		<author>
			<persName><forename type="first">L</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society Series B: Statistical Methodology</title>
		<imprint>
			<biblScope unit="volume">84</biblScope>
			<biblScope unit="page" from="600" to="629" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Little&apos;s test of missing completely at random</title>
		<author>
			<persName><forename type="first">C</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Stata Journal</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="795" to="809" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Functional causal mediation analysis with an application to brain connectivity</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Lindquist</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Statistical Association</title>
		<imprint>
			<biblScope unit="volume">107</biblScope>
			<biblScope unit="page" from="1297" to="1309" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">The historical functional linear model</title>
		<author>
			<persName><forename type="first">N</forename><surname>Malfait</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">O</forename><surname>Ramsay</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Canadian Journal of Statistics</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="115" to="128" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Bayesian latent factor regression for functional and longitudinal data</title>
		<author>
			<persName><forename type="first">S</forename><surname>Montagna</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">T</forename><surname>Tokdar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Neelon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">B</forename><surname>Dunson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrics</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="page" from="1064" to="1073" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Wavelet-based functional mixed models</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Morris</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Carroll</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society: Series B (Statistical Methodology)</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="page" from="179" to="199" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">T</forename><surname>Newsom</surname></persName>
		</author>
		<title level="m">Longitudinal structural equation modeling: A comprehensive introduction</title>
		<imprint>
			<publisher>Routledge</publisher>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Bayesian latent factor regression for multivariate functional data with variable selection</title>
		<author>
			<persName><forename type="first">H</forename><surname>Noh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Choi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Park</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Chung</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Korean Statistical Society</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="page" from="901" to="923" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">O</forename><surname>Ramsay</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">W</forename><surname>Silverman</surname></persName>
		</author>
		<title level="m">Fitting differential equations to functional data: Principal differential analysis</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Estimating the mean and covariance structure nonparametrically when the data are curves</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Rice</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">W</forename><surname>Silverman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society: Series B (Methodological)</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page" from="233" to="243" />
			<date type="published" when="1991">1991</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Applied functional data analysis: methods and case studies</title>
		<author>
			<persName><forename type="first">B</forename><surname>Silverman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Ramsay</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">The general factor of personality (gfp) as social effectiveness: Review of the literature</title>
		<author>
			<persName><forename type="first">D</forename><surname>Van Der Linden</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">S</forename><surname>Dunkel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Petrides</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Personality and Individual Differences</title>
		<imprint>
			<biblScope unit="volume">101</biblScope>
			<biblScope unit="page" from="98" to="105" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Functional data analysis</title>
		<author>
			<persName><forename type="first">J.-L</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-M</forename><surname>Chiou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H.-G</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annual Review of Statistics and its application</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="257" to="295" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">Functional linear regression analysis for longitudinal data</title>
		<author>
			<persName><forename type="first">F</forename><surname>Yao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H.-G</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-L</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Causal mediation analysis for sparse and irregular longitudinal data</title>
		<author>
			<persName><forename type="first">S</forename><surname>Zeng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Rosenbaum</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">C</forename><surname>Alberts</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">A</forename><surname>Archie</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of Applied Statistics</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="747" to="767" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<monogr>
		<title level="m" type="main">Functional mediation analysis with an application to functional magnetic resonance imaging data</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Luo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Lindquist</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Caffo</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1805.06923</idno>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Robust, adaptive functional regression in functional mixed model framework</title>
		<author>
			<persName><forename type="first">H</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">J</forename><surname>Brown</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Morris</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Statistical Association</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="page" from="1167" to="1179" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
