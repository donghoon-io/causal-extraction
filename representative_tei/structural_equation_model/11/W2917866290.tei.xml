<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Distributed-lag Linear Structural Equation Models in R: The dlsem Package</title>
				<funder ref="#_Zqx5tXk">
					<orgName type="full">European Union</orgName>
				</funder>
				<funder ref="#_2y2dmPt">
					<orgName type="full">University of Florence (Florence, Italy)</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Alessandro</forename><surname>Magrini</surname></persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Dep. Statistics</orgName>
								<orgName type="department" key="dep2">Computer Science</orgName>
								<orgName type="institution">Applications University of Florence</orgName>
								<address>
									<country key="IT">Italy</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Distributed-lag Linear Structural Equation Models in R: The dlsem Package</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.17713/ajs.v48i2.777</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-21T19:52+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>constrained lag shapes</term>
					<term>directed acyclic graphs</term>
					<term>dynamic causal inference</term>
					<term>probabilistic graphical models</term>
					<term>time series</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>In this paper, an extension of linear Markovian structural causal models is introduced, called distributed-lag linear structural equation models (DLSEMs), where each factor of the joint probability distribution is a distributed-lag linear regression with constrained lag shapes. DLSEMs account for temporal delays in the dependence relationships among the variables and allow to assess dynamic causal effects. As such, they represent a suitable methodology to investigate the effect of an external impulse on a multidimensional system through time. In this paper, we present the dlsem package for R implementing inference functionalities for DLSEMs. The use of the package is illustrated through an example on simulated data and a real-world application aiming at assessing the impact of agricultural research expenditure on multiple dimensions in Europe.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Structural causal models (SCMs, <ref type="bibr">Pearl 2000, Chapter 5</ref>) represent one of the prevalent methodologies for causal inference in contemporary applied sciences. In particular, a Markovian SCM is such that a directed acyclic graph (DAG) encodes causal relationships among the variables, which also implies a factorization of the joint probability distribution according to conditional independence relationships. In a linear parametric formulation (linear Markovian SCM), each factor of the joint probability distribution is a linear regression model, and a causal effect is associated to each edge, directed path or couple of nodes in the DAG to represent average changes in the value of a variable induced by an intervention provoking a unit variation in the value of another variable. A linear Markovian SCM can be extended by letting each factor of the joint probability distribution be a dynamic linear model, in order to account for temporal variations in the dependence relationships among the variables.</p><p>When the objective is forecasting, a large variety of dynamic linear models is available. For example, linear regression with polynomial lag shapes <ref type="bibr" target="#b13">(Almon 1965</ref>) is a common feature of dynamic predictive models. Mixed-data sampling (MIDAS) regression <ref type="bibr" target="#b14">(Andreou, Ghysels, and Kourtellos 2007;</ref><ref type="bibr" target="#b19">Ghysels, Sinko, and Valkanov 2007)</ref>, implemented in the R package midasr <ref type="bibr" target="#b18">(Ghysels, Kvedaras, and Zemlys 2016)</ref>, is a broader class of time series models dealing with data sampled at different frequencies. The R package dlnm <ref type="bibr" target="#b17">(Gasparrini 2011</ref>) contains functionalities for linear and non-linear regression models with spline lag-shapes. However, the assessment of causal effects in a dynamic context requires to take into account prior knowledge on lag shapes, and a predictive model may not be adequate without introducing appropriate mathematical constraints. For instance, the effect of an intervention has typically the same sign, or at least is null, at all the possible time lags, but neither the Almon's nor a spline lag shape can be directly applied to this purpose, as they cannot avoid regression coefficients to have different signs.</p><p>Constrained lag shapes <ref type="bibr">(Judge, Griffiths, Hill, Lutkepohl, and Lee 1985, Chapters 9-10)</ref> overcome such problem, because regression coefficients are non-zero only outside a pre-specified interval of time lags, and within that interval they are allowed to rise from value zero to a maximum before declining again to zero, or to simply decrease from a maximum value to zero. Also, parameter estimation is straightforward, because, given the interval of time lags, the maximum value can be estimated using ordinary least squares. Thus, if prior knowledge on the interval is available, it can be directly exploited, while if the interval is not known a-priori, it may be determined by model selection across all the possible ones.</p><p>In this paper, we introduce an extension of linear Markovian SCMs, called distributed-lag linear structural equation models <ref type="bibr">(DLSEMs)</ref>, where each factor of the joint probability distribution is a distributed-lag linear regression with constrained lag shapes. They were introduced for the first time by <ref type="bibr" target="#b25">Magrini (2018)</ref> in the context of lag exposure assessment. DLSEMs represent a suitable methodology to investigate the effect of an external impulse on a multidimensional system through time.</p><p>The aim of this paper is to illustrate the dlsem package, which implements inference functionalities for DLSEMs in R. The paper is structured as follows. In Section 2, theory on DLSEMs is presented. In Section 3, instructions for the installation of the dlsem package are provided. In Section 4, the practical use of the dlsem package is illustrated through an example on simulated data. In Section 5, the dlsem package is applied to address a real-world application aiming at assessing the impact of agricultural research expenditure on multiple dimensions in Europe. Section 6 includes conclusive remarks and considerations on future development.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Theory</head><p>In this section, theory on distributed-lag linear regression and on structural causal models is provided (Subsections 2.1 and 2.2), then distributed-lag linear structural equation models are presented (Subsection 2.3).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.">Distributed-lag linear regression</head><p>Lagged instances of one or more covariates may be included in the linear regression model to account for temporal delays in their influence on the response:</p><formula xml:id="formula_0">y t = β 0 + J j=1 L j l=0 β j,l x j,t-l + t t ∼ N(0, σ 2 ) (1)</formula><p>where y t is the value of the response variable at time t and x j,t-l is the value of the j-th covariate at l time lags before t. The set (β j,0 , β j,1 , . . . , β j,L j ) is denoted as the lag shape of the j-th covariate and represents its regression coefficient (in the remainder, simply 'coefficient') at different time lags.</p><p>Parameter estimation is inefficient because lagged instances of the same covariate are typically highly correlated. The Almon's polynomial lag shape <ref type="bibr" target="#b13">(Almon 1965</ref>) is a well-known solution Distributed-lag Linear Structural Equation Models in R: The dlsem Package to this problem, where coefficients for lagged instances of a covariate are forced to follow a polynomial of order Q:</p><formula xml:id="formula_1">β j,l = φ j,0 l = 0 Q q=0 φ j,q l q otherwise (2)</formula><p>Unfortunately, the Almon's polynomial lag shape may show multiple modes and coefficients with different signs, thus entailing problems of interpretation. Constrained lag shapes <ref type="bibr">(Judge et al. 1985, Chapters 9-10)</ref> overcome this deficiency. Some examples are the endpointconstrained quadratic lag shape:</p><formula xml:id="formula_2">β j,l =    θ j - 4 (b j -a j +2) 2 l 2 + 4(a j +b j ) (b j -a j +2) 2 l - 4(a j -1)(b j +1) (b j -a j +2) 2 a j ≤ l ≤ b j 0 otherwise (3)</formula><p>the quadratic decreasing lag shape:</p><formula xml:id="formula_3">β j,l =    θ j l 2 -2(b j +1)l+(b j +1) 2 (b j -a j +1) 2 a j ≤ l ≤ b j 0 otherwise (4)</formula><p>and the gamma lag shape:</p><formula xml:id="formula_4">β j,l = θ j (l + 1) δ 1-δ λ l j    δ j (δ j -1)log(λ j ) δ j 1-δ j λ δ j (δ j -1)log(λ j ) -1 j    -1 0 &lt; δ j &lt; 1 0 &lt; λ j &lt; 1<label>(5)</label></formula><p>The endpoint-constrained quadratic lag shape is zero for a lag l ≤ a j -1 or l ≥ b j + 1, and symmetric with mode equal to θ j at lag (a j + b j )/2. The quadratic decreasing lag shape decreases from value θ j at lag a j to value 0 at lag b j + 1 according to a quadratic function.</p><p>The gamma lag shape is positively skewed with mode equal to θ j at lag δ j (δ j -1)log(λ j ) . Value a j is denoted as the gestation lag, value b j as the lead lag, and value b j -a j as the lag width. A static coefficient (no lag shape) is obtained if a j = b j = 0. Since it is not expressed as a function of a j and b j , the gamma lag shape cannot reduce to a static coefficient, but the corresponding values of a j and b j may be computed through numerical approximation from the values of δ j and λ j .</p><p>For these three lag shapes it holds:</p><formula xml:id="formula_5">β j,l &gt; 0 ⇐⇒ θ j &gt; 0 β j,l &lt; 0 ⇐⇒ θ j &lt; 0 ∀ a j ≤ l ≤ b j (6)</formula><p>and we refer to the lag sign as the sign of parameter θ j .</p><p>A linear regression model with constrained lag shapes is linear in parameters β 0 , θ 1 , . . . , θ J , provided that the values of a 1 , . . . , a J , b 1 , . . . , b J are known. Thus, one may use ordinary least squares to estimate parameters β 0 , θ 1 , . . . , θ J for several models with different values of a 1 , . . . , a J , b 1 , . . . , b J , and then select the one with the minimum value of the Bayesian Information Criterion (BIC, Schwarz 1978) 1 . A heuristic algorithm is shown below.</p><p>0. Let J be the number of covariates and T the greatest time lag under consideration. Initialize selected as an empty vector. Set candidates = {X 1 , . . . , X J }. For j = 1, . . . , J, set a j = 0 and b j = 0.</p><p>1. Repeat until candidates is not empty: a) initialize fitting as an empty vector. Set cand.temp = candidates;</p><p>1 Alternatively, the Akaike Information Criterion (AIC, Akaike 1974) may be used.</p><p>b) repeat until cand.temp is not empty: b1) determine j such that the first element in cand.temp is X j . Initialize fit.temp as an empty matrix with T + 1 rows and T + 1 columns; b2) for s 1 = 0, . . . , T and for s 2 = 0, . . . , T : b2.1) set a j = s 1 , b j = s 2 and cov.temp = {selected ∪ X j }; b2.2) use ordinary least squares to estimate parameters β 0 , θ 1 , . . . , θ J for the model with covariates cov.temp, gestation lags {a k : X k ∈ cov.temp} and lead lags {b k : X k ∈ cov.temp}. Compute the BIC for this model and insert it into fit.temp(s 1 , s 2 ); b3) determine k 1 and k 2 such that fit.temp(k 1 , k 2 ) is the best value in fit.temp.</p><p>Insert fit.temp(k 1 , k 2 ) into fitting. Set a j = k 1 and b j = k 2 . Remove X j from cand.temp; c) determine X k such that the k-th value in fitting is the minimum one. Insert X k into selected and remove X k from candidates.</p><p>2. Use ordinary least squares to estimate parameters β 0 , θ 1 , . . . , θ J for the model with covariates in selected, gestation lags a 1 , . . . , a J and lead lags b 1 , . . . , b J .</p><p>Note that neither the response variable nor the covariates must contain unit root in order to obtain unbiased estimates with ordinary least squares <ref type="bibr" target="#b20">(Granger and Newbold 1974)</ref>. A reasonable procedure is to sequentially apply differentiation to all variables until the Augmented Dickey-Fuller test <ref type="bibr" target="#b16">(Dickey and Fuller 1981)</ref> rejects the hypothesis of unit root for all of them.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.">Structural causal models</head><p>Structural causal models (SCMs) were developed by <ref type="bibr" target="#b30">Pearl (2000)</ref> in the context of causal inference. They are rooted to path analysis <ref type="bibr" target="#b34">(Wright 1934</ref>) and simultaneous equation models <ref type="bibr" target="#b21">(Haavelmo 1943;</ref><ref type="bibr" target="#b23">Koopmans, Rubin, and Leipnik 1950)</ref>. A SCM consists of a tuple {V , U , Ω V , Ω U , f , P U }, where:</p><p>-V = {V 1 , . . . , V J } is a set of endogenous variables;</p><p>-</p><formula xml:id="formula_6">Ω V = Ω V 1 × . . . × Ω V J is the cartesian product of the domains of variables in V ; -U = {U 1 , . . . , U K } is a set of unobserved variables; -Ω U = Ω U 1 × . . . × Ω U K is the cartesian product of the domains of variables in U ; -f : Ω V × Ω U -→ Ω V is a measurable function; -P U is a probability measure on Ω U .</formula><p>Markovian SCMs <ref type="bibr">(Pearl 2000, Chapter 3</ref>) are a special case where f is acyclic and variables in U are each other independent. In a Markovian SCM, the following factorization of the joint probability distribution of variables in V holds:</p><formula xml:id="formula_7">p(v 1 , . . . , v J ) = J j=1 p(v j | Π j = π j ) (7)</formula><p>where Π j is the set of variables in V such that, for j &gt; 1, V j is independent of variables in {V 1 , . . . , V j-1 } \ Π j , given variables in Π j . This means that the joint probability distribution of variables in V can be factored according to conditional independence relationships holding among them disregarding variables in U . <ref type="bibr">Pearl (2000, pages 12 and following)</ref> shows that these conditional independence relationships are encoded into a directed acyclic graph (DAG) such that Π j is the parent set of V j , ∀ j = 1, . . . , J. For example, in the Markovian SCM associated to the DAG in Figure <ref type="figure" target="#fig_0">1</ref>, it holds:</p><formula xml:id="formula_8">p(v 1 , v 2 , v 3 , v 4 , v 5 , v 6 ) = p(v 1 ) p(v 2 ) p(v 3 | v 1 ) p(v 4 | v 2 , v 3 ) p(v 5 | v 3 ) p(v 6 | v 3 , v 4 , v 5 ) (8)</formula><p>and, by way of illustration, V 6 is independent of V 1 and V 2 given V 3 , V 4 and V 5 .</p><p>Let do(V i = v i ) denote an intervention setting the value of V i to v i . Then, in a Markovian SCM it holds:</p><formula xml:id="formula_9">p(v 1 , . . . , v J | do(V i = v i )) = j =i p(v j | π j ) | V i =v i (9)</formula><p>where</p><formula xml:id="formula_10">| V i =v i indicates that p(v i | π i ) is replaced by value v i .</formula><p>This formula, called truncated factorization <ref type="bibr" target="#b30">(Pearl 2000</ref>, Section 3.2), allows to compute the effect of an intervention from the (pre-intervention) distribution in Formula 7, that is to predict the effect of an intervention from non-experimental (observational) data. In a Markovian SCM, the effect of do(V i = v i ) on V j , called causal effect of V i on V j , is given by the following expression (see Pearl 2000, page 70 and following):</p><formula xml:id="formula_11">p(V j = v j | do(V i = v i )) = π i p(V j = v j | V i = v i , Π i = π i )p(Π i = π i ) (10)</formula><p>where Π i is the parent set of V i .</p><p>In a linear parametric formulation (linear Markovian SCMs), each factor p(v j | π j ) of the joint probability distribution in Formula 7 is the linear regression model where V j is the response variable and variables in Π j are the covariates. For example, in the linear Markovian SCM associated to the DAG in Figure <ref type="figure" target="#fig_0">1</ref>, p(v 4 | v 2 , v 3 ) is the linear regression model where V 4 is the response variable and V 2 and V 3 are the covariates.</p><p>In a linear Markovian SCM, the computation of causal effects involves the coefficients of the regression models only, without the need of Formula 10, as shown in the following paragraphs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Direct causal effects</head><p>The coefficient of V i in the regression model of V j , say β j|i , represents the expected value of V j given a unit variation of V i given constant values of the parents of V j besides V i :</p><formula xml:id="formula_12">β j|i := E(V j | ∆V i = 1, ∆V k: V k ∈{Π j \V i } = 0)) (<label>11</label></formula><formula xml:id="formula_13">)</formula><p>Expression 11 is a special case of Expression 10, where the intervention is do(∆V i = 1) and the conditioning set is {Π j \ V i } instead of Π i . Since variables in Π i but not in Π j are independent of V j conditionally to variables in Π j (see Formula 7), we can conclude that β j|i represents the average effect of do(∆V i = 1) on V j :</p><formula xml:id="formula_14">β j|i := E(V j | ∆V i = 1, ∆V k: V k ∈{Π j \V i } = 0)) = E(V j | do(∆V i = 1); &lt; V i , V j &gt;) (12) which is called direct causal effect of V i on V j . The notation E(V j | do(∆V i = 1); &lt; V i , V j &gt;)</formula><p>emphasizes that the causal effect in Formula 12 is associated to the edge &lt; V i , V j &gt;. For example, in the linear Markovian SCM associated to the DAG in Figure <ref type="figure" target="#fig_0">1</ref>, β 4|3 represents the expected value of V 4 given a unit variation of V 3 given constant value of V 2 , equating the direct causal effect of V 3 on V 4 .</p><p>Indirect causal effects and the overall causal effect Suppose that there exists more than one directed path connecting variable V i to variable V j . In this case, it is straightforward to show that the intervention do(∆V i = 1) influences the expected value of V j independently through each directed path connecting V i to V j , for an overall causal effect equal to the sum of the causal effects associated to each of these paths:</p><formula xml:id="formula_15">E(V j | do(∆V i = 1)) := &lt;V d 0 ,...,V dm &gt;: d 0 =i∧dm=j E(V j | do(∆V i = 1); &lt; V d 0 , . . . , V dm &gt;) (13)</formula><p>where</p><formula xml:id="formula_16">E(V j | do(∆V i = 1); &lt; V d 0 , . . . , V dm &gt;) is the causal effect of do(∆V i = 1) on V j associated to the directed path &lt; V d 0 , . . . , V dm &gt; (d 0 = i and d m = j) connecting V i to V j , denoted as the pathwise causal effect of V i on V j through &lt; V d 0 , . . . , V dm &gt;.</formula><p>A pathwise causal effect associated to an edge (direct causal effect) can be computed using Formula 12. Instead, a pathwise causal effect associated to a multi-edge directed path, also referred as indirect causal effect, can be computed through the product of the regression coefficients associated to each edge in the path (see, for example, <ref type="bibr" target="#b34">Wright 1934</ref>):</p><formula xml:id="formula_17">E(V j | do(∆V i = 1); &lt; V i , . . . , V j &gt;) := k: V k ∈&lt;V i ,...,V j &gt;∧k =i E(V k | do(∆V k-1 = 1); &lt; V k-1 , V k &gt;) = = k: V k ∈&lt;V i ,...,V j &gt;∧k =i β k|k-1</formula><p>(14) Note that Formula 2.2 is a generalization of Formula 12. In this view, it is clear that both direct and indirect causal effects belong to the class of pathwise causal effects. For example, in the linear Markovian SCM associated to the DAG in Figure <ref type="figure" target="#fig_0">1</ref>, there are three directed paths connecting</p><formula xml:id="formula_18">V 3 to V 6 : &lt; V 3 , V 6 &gt; with pathwise (direct) causal effect β 6|3 , &lt; V 3 , V 4 , V 6 &gt; with pathwise (indirect) causal effect β 4|3 • β 6|4 , and &lt; V 3 , V 5 , V 6 &gt; with pathwise (indirect) causal effect β 5|3 • β 6|5 . Thus, the overall causal effect of V 3 on V 6 , namely E(V 6 | do(∆V 3 = 1)), is equal to β 6|3 + β 4|3 • β 6|4 + β 5|3 • β 6|5 .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.">Distributed-lag linear structural equation models</head><p>Delayed dependence relationships among the variables may be taken into account in a Markovian SCM by specifying each factor of the joint probability distribution in Formula 7 equal to the distributed-lag linear regression in Formula 1. We refer to this Markovian SCM as distributed-lag linear structural equation model (DLSEM). The definition of causal effects at different time lags in a DLSEM is provided in the following paragraphs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Direct causal effects Let b (l)</head><p>j|i be the coefficient of V i at lag l in the regression model of V j . Such coefficient equates the direct causal effect of V i on V j at lag l:</p><formula xml:id="formula_19">E (l) (V j | do(∆V i = 1); &lt; V i , V j &gt;) := b (l) j|i (15) Indirect causal effects Let &lt; V d 0 , . . . , V dm &gt;, d 0 = i and d m = j, be a directed path composed of m edges connecting V i to V j , and Q (l)</formula><p>m be the set of all the possible ordered muples of time lags such that their sum is equal to l. If we compute the m direct causal effects associated to each edge in &lt; V d 0 , . . . , V dm &gt; at one of the m-uples in Q (l) m , say (q 1 , . . . , q m ), and multiply them each other:</p><formula xml:id="formula_20">e (q 1 ,...,qm) (&lt; V d 0 , . . . , V dm &gt;; d 0 = i, d m = j) = m k=1 b (q k ) d k |d k-1 (16)</formula><p>we obtain one of the possible causal effects of V i on V j through &lt; V d 0 , . . . , V dm &gt; at lag l. Thus, the indirect causal effect of V i on V j through &lt; V d 0 , . . . , V dm &gt; (d 0 = i and d m = j) at lag l is equal to the sum of all the causal effects that can be obtained from Formula 16:</p><formula xml:id="formula_21">E (l) (V j | do(∆V i = 1); &lt; V d 0 , . . . , V dm &gt;, d 0 = i, d m = j) := (q 1 ,...,qm)∈Q (l) m m k=1 b (q k ) d k |d k-1 (17)</formula><p>Overall causal effects The overall causal effect of V i on V j at lag l, say E (l) (V j | do(∆V i = 1)), is represented by the sum of the pathwise causal effects at lag l associated to each directed path connecting V i to V j .</p><p>The cumulative causal effect at a pre-specified time lag, say l, is obtained by summing all the causal effects at each time lag up to l. A pathwise causal lag shape is the set of causal effects associated to a path at different time lags. An overall causal lag shape is the set of the overall causal effects of a variable on another one at different time lags.</p><p>The DAG of a DLSEM includes all the possible temporal instances of each variable in V , but it may be represented in a static version for more clarity. For example, only a single temporal instance for each variable is represented, and an edge &lt; V i , V j &gt; exists if and only if there exists at least one time lag where the coefficient of variable V i in the regression model of variable V j is non-zero.</p><p>A DLSEM is a special case of dynamic Bayesian network <ref type="bibr" target="#b29">(Murphy 2002)</ref>, where endogenous variables follow the Gaussian distribution and lag shapes are possibly constrained to predefined functional forms.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Installation</head><p>Before installing dlsem, you must have installed R version 2.1.0 or higher, which is freely available at <ref type="url" target="http://www.r-project.org/">http://www.r-project.org/</ref>.</p><p>To install the dlsem package, type the following in the R command prompt: &gt; install.packages("dlsem") and R will automatically install the package to your system from CRAN. In order to keep your copy of dlsem up to date, use the command:</p><formula xml:id="formula_22">&gt; update.packages("dlsem")</formula><p>All the results shown in this paper are obtained using R 3.4.3 with the dlsem package version 2.3. The official web page of dlsem is: <ref type="url" target="https://cran.r-project.org/web/packages/dlsem/">https://cran.r-project.org/web/packages/ dlsem/</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Example on simulated data</head><p>In this section, the practical use of the dlsem package is illustrated through a simple impact assessment problem referred as "industrial development problem". The objective is to test whether the influence through time of the number of job positions in industry (proxy of the industrial development, label: Job) on the amount of greenhouse gas emissions (proxy of pollution, label: Pollution) is direct and/or mediated by the amount of private consumption (label: Consum). The static representation of the DAG for the industrial development problem is shown in Figure <ref type="figure">2</ref>. The analysis will be conducted on the dataset industry, containing simulated data for 10 imaginary regions in the period 1983-2015.  <ref type="figure">-------------------------------------------------------------------------------</ref>  <ref type="figure">-------------------------------------------------------------------------------</ref>  <ref type="figure">-------------------------------------------------------------------------------</ref>  <ref type="figure">------------------------------------------------------------------------------</ref>  <ref type="figure">------------------------------------------------------------------------------</ref>  <ref type="figure">------------------------------------------------------------------------------</ref>  <ref type="figure">------------------------------------------------------------------------------</ref>  <ref type="figure">-------------------------------------------------------------------------------</ref>  These summaries highlight a relevant heterogeneity between regions. As shown in the remainder, the dlsem package can take into account a grouping factor, thus explaining the variance due to differences among several groups. Furthermore, it can be noted that regions have the same number of measurements:</p><formula xml:id="formula_23">-------------------------------------------------------------------------------</formula><formula xml:id="formula_24">&gt; table(industry$Region)</formula><p>1 2 3 4 5 6 7 8 9 10 32 32 32 32 32 32 32 32 32 32</p><p>This feature is not essential for the application of DLSEMs: in general, the sample size is not required to be equal for all groups.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Specification of the model code</head><p>The first step to build a DLSEM with the dlsem package is the definition of the model code, which includes the formal specification of the regression models. The variables for which a regression model is specified are called endogenous variables. The other variables are referred as exogenous variables.</p><p>The model code must be a list of formulas, one for each regression model. In each formula, the response and the covariates must be quantitative variables<ref type="foot" target="#foot_0">foot_0</ref> , and operators quec.lag(•), qdec.lag(•) and gamma.lag(•) can be employed to specify, respectively, an endpoint-constrained quadratic, a quadratic decreasing or a gamma lag shape. Operators quec.lag(•) and qdec.lag(•) have three mandatory arguments:</p><p>• the name of the covariate to which the lag shape is applied,</p><p>• the gestation lag (a j ),</p><p>• the lead lag (b j ).</p><p>Operator gamma.lag(•) has three mandatory arguments:</p><p>• the name of the covariate to which the lag shape is applied,</p><p>• parameter δ j ,</p><p>• parameter λ j .</p><p>If none of these two operators is applied to a covariate, it is assumed that its coefficient is equal to 0 for time lags greater than 0 (no lag shape). The group factor and exogenous variables must not appear in the model code (see Subsection 4.3 for the way to include them).</p><p>The following code specifies all lag shapes as endpoint-constrained quadratic lag shapes between 0 and 15 time lags: The formula of regression models with no endogenous covariates may be omitted from the model code. For example, the following code (where the formula specifying the regression model for variable Job is omitted) is equivalent to the previous one:</p><formula xml:id="formula_25">&gt;</formula><p>&gt; indus.code &lt;-list( + Consum ~quec.lag(Job,0,15), + Pollution ~quec.lag(Job,0,15)+quec.lag(Consum,0,15) + )</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">Specification of control options</head><p>The second step to build a DLSEM with the dlsem package is the specification of control options, which are distinguished into global (applied to all regression models) and local (model-specific) options.</p><p>Global control options must be a named list with one or more of the following components:</p><p>• adapt: a logical value indicating if adaptation of lag shapes must be performed, that is parameters of lag shapes must be chosen on the basis of fit to data. Default is FALSE, meaning no adaptation;</p><p>• max.gestation: the maximum gestation lag for all lag shapes. If not provided, it is taken as equal to max.lead (see below);</p><p>• max.lead: the maximum lead lag for all lag shapes. If not provided, it is computed accordingly to the sample size;</p><p>• min.width: the minimum lag width for all lag shapes. It cannot be greater than max.lead. If not provided, it is taken as 0;</p><p>• sign: the lag sign for all lag shapes, that can be either '+' for positive or '-' for negative. If not provided, adaptation will disregard the lag sign;</p><p>• selection: the criterion to be used for the adaptation of lag shapes, that can be one among 'bic' (the default) and 'aic' to minimise BIC or AIC, respectively.</p><p>Local control options must be a named list containing one or more among the following components:</p><p>• adapt: a named vector of logical values, where each component must have the name of one endogenous variable and indicate if adaptation of lag shapes must be performed for the regression model of that variable;</p><p>• max.gestation: a named list. Each component of the list must have the name of one endogenous variable and be a named vector. Each component of the named vector must have the name of one covariate in the regression model of the endogenous variable above and include the maximum gestation lag for its lag shape;</p><p>• max.lead: the same as max.gestation, with the exception that the named vector must include the maximum lead lag;</p><p>• min.width: the same as max.gestation, with the exception that the named vector must include the minimum lag width;</p><p>• sign: the same as max.gestation, with the exception that the named vector must include the lag sign (either '+' for positive or '-' for negative).</p><p>Local control options have no default values, and global ones are applied in their absence. If some local control options conflict with global ones, only the former are applied.</p><p>Suppose that one wants to perform adaptation with the following constraints for all lag shapes: (i) maximum gestation lag of 3 years, (ii) maximum lead lag of 15 years, (iii) minimum lag width of 5 years, (iv) positive lag sign. Control options for these constraints can be expressed in several ways. The most simple solution is to specify only global control options, as the constraints hold for all regression models: </p><formula xml:id="formula_26">&gt;</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.">Parameter estimation</head><p>Once the model code and control options are specified, parameter estimation can be performed using the command dlsem(•). The main arguments of the command include:</p><p>• model.code, the first argument of the command, requiring the model code in the format defined in Subsection 4.1;</p><p>• group, accepting the name of a single group factor (optional). By indicating the group factor, one intercept for each level of the group factor will be estimated in each regression model.</p><p>• exogenous, accepting the name of exogenous variables (optional). Exogenous variables can be either qualitative or quantitative, and will be included in each regression model with no lag shape;</p><p>• log, a logical value indicating whether logarithmic transformation must be applied to all strictly positive quantitative variables (default is FALSE). If log is set to TRUE, the coefficient of each strictly positive quantitative covariate is (approximatively) interpreted as an elasticity, that is as an expected percentage increase in the value of the response variable for 1% increase in the value of the covariate 3 ;</p><p>• data, requiring an object of class data.frame containing data;</p><p>• global.control and local.control, accepting global and local options, respectively, in the format defined in Subsection 4.2 (optional).</p><p>Before parameter estimation, differentiation is performed until the hypothesis of unit root is rejected by the Augmented Dickey-Fuller test for all quantitative variables. If the group factor is specified, the panel version of the Augmented Dickey-Fuller test proposed by <ref type="bibr" target="#b24">Levin, Lin, and Chub (2002)</ref> is used instead. Also, missing values, if present, are imputed with their conditional mean using the Expectation-Maximization algorithm <ref type="bibr" target="#b15">(Dempster, Laird, and Rubin 1977)</ref> 4 . For further arguments controlling differentiation and imputation options, see the documentation of command dlsem(•) by typing ?dlsem.</p><p>In the following code, the region is indicated as the group factor, population and gross domestic product are indicated as exogenous variables, the logarithmic transformation is requested, and both global and local control options specified in Subsection 4.2 are provided:</p><p>&gt; indus.mod &lt;-dlsem(indus.code,group="Region",exogenous=c("Population","GDP"), Messages inform that differentiation was applied one time in order to achieve stationarity of all time series. No mention to imputation was made, meaning that data are complete. The results of command dlsem(•) is an object of class dlsem. Among the components of dlsem objects, we highlight:</p><p>• estimate: a list of objects of class lm, one for each endogenous variable;</p><p>3 The true expected growth rate for the response variable due to 1% increase in the value of a covariate with coefficient κ is equal to 1.01 κ , which corresponds to a percentage increase equal to (1.01 κ -1) • 100. The approximation (1.01 κ -1) • 100 ≈ κ here proposed is reasonable for |κ| &lt; 10.</p><p>4 Imputation of missing values is performed after eventual logarithmic transformation and differentiation by assuming group-specific means and time-invariant covariance matrix. Qualitative variables cannot contain missing values. Each quantitative variable must have at least 3 observed values if the group factor is not specified, otherwise it must have at least 3 observed values per group.</p><p>• model.code: the model code after eventual adaptation;</p><p>• data.used: data after eventual logarithmic transformation and differentiation.</p><p>The summary method for class dlsem returns the summary of the estimation: We see that the number of job positions in industry (Job) significantly influences, on one hand, the amount of private consumption (Consum) from 0 to 5 years and, on the other hand, the amount of greenhouse gas emissions (Pollution) from 1 to 8 years, while the amount of private consumption (Consum) significantly influences the amount of greenhouse gas emissions (Pollution) from 1 to 6 years. This result provides evidence that the influence of industrial development on pollution is both direct and mediated by private consumption.</p><p>The plot method for class dlsem displays the DAG of the model in the static representation, where each edge is coloured with respect to the sign of the estimated causal effect (green: positive, red: negative, light gray: not statistically significant):</p><p>&gt; plot(indus.mod) Note that the DAG includes only the endogenous variables. Argument conf in the plot method controls the confidence level, which is equal to 0.95 by default. Here, a statistically significant and positive causal effect is associated to each edge, thus all of them are shown in green (Figure <ref type="figure">3</ref>). Colours can be suppressed by setting option style to 1 in the plot method (default is style=2). Instead, by setting option style to 0, all edges are shown in black disregarding statistical significance of causal effects (see Figure <ref type="figure">2</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4.">Assessment of causal effects</head><p>After parameter estimation is performed by means of command dlsem(•), the command causalEff(•) can be used on the resulting object of class dlsem to compute all the path-The output of command causalEff(•) is a list of matrices including point estimates, standard errors 5 and asymptotic confidence intervals for all the pathwise causal lag shapes and the overall one connecting the starting variables to the ending variable.</p><p>Since the logarithmic transformation was applied to all quantitative variables, the resulting causal effects are interpreted as elasticities, that is, for a 1% of job positions more, greenhouse gas emissions are expected to grow by 0.61% after 5 years and by 1.11% after 10 years. The influence ends after 11 years, as the cumulative causal effects at lags 11 and 12 are equal.</p><p>A pathwise or an overall causal lag shape can be displayed using the command lagPlot(•). For instance, one may display the causal lag shape associated to each path connecting the number of job positions to the amount of greenhouse gas emissions (asterisks separate the name of variables in a path):</p><p>&gt; lagPlot(indus.mod,path="Job*Pollution") &gt; lagPlot(indus.mod,path="Job*Consum*Pollution") while the following code displays the the overall causal lag shape of the number of job positions on the amount of greenhouse gas emissions:</p><p>5 A pathwise causal effect composed by the direct causal effects κ1, . . . , κm is equal to m i=1 κi, and the estimates of κ1, . . . , κm, say κ1, . . . , κm, are each other independent as they refer to different regression models. Thus, it holds:</p><formula xml:id="formula_27">Var m i=1 κi = m i=1 κ2 i + Var[κi] - m i=1 κ2 i Job * Pollution</formula><p>Lag Coefficient q q q q q q q q q q 0 1 2 3 4 5 6 7 8 9 -0.17 -0.119 -0.0679 -0.017 0.034 0.0849 0.136 Effective lags: 1 to 8 Cumulative coefficient: 0.62104 95% CI: (0.27162, 0.97046)</p><p>Job * Consum * Pollution Lag Coefficient q q q q q q q q q q q q q 0 1 2 3 4 5 6 7 8 9 10 11 12 -0.111 -0.0776 -0.0333 0 0.0222 0.0554 0.0887 Effective lags: 1 to 11 Cumulative coefficient: 0.48795 95% CI: (0.36754, 0.60837)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Pollution ~ Job</head><p>Lag Coefficient q q q q q q q q q q q q q 0 1 2 &gt; lagPlot(indus.mod,from="Job",to="Pollution")</p><p>The resulting graphics are shown in Figure <ref type="figure" target="#fig_1">4</ref>. Note that a multi-edge pathwise causal lag shape is a mixture of different lag shapes, thus it may show an irregular aspect, like it is the case of the overall causal lag shape displayed in the lower panel of Figure ??.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.5.">Model comparison</head><p>We now fit two alternative models for the industrial development problem, such that all lag shapes are quadratic decreasing and gamma lag shapes, respectively: We see that the three models provide different results. The BIC method for class dlsem can be used to compare them according to the BIC:</p><p>&gt; lapply(list(QUEC=indus.mod,QDEC=indus.mod_2,GAMMA=indus.mod_3),BIC)</p><p>$QUEC Job Consum Pollution (overall) -1733. <ref type="bibr">060 -1553.811 -1349.505 -4636.377</ref> $QDEC Job Consum Pollution (overall)</p><p>For further details, see the documentation of the agres dataset by typing ?agres.</p><p>In order to highlight the opportunity to include qualitative exogenous variables, we consider an additional variable in the context level, that is a dummy indicating whether the Decoupling policy implemented in 2005 is in vigour or not. Such variable can be defined with the following code:</p><p>&gt; agres$POLICY &lt;-factor(1*(agres$YEAR&gt;=2005)) &gt; levels(agres$POLICY) &lt;-c("no","yes")</p><p>It is important to indicate qualitative variables with numerical labels as factors, otherwise they will be interpreted as quantitative variables. With the following code we define the four causal levels and request the summary of the considered data:</p><p>&gt; context.var &lt;-c("GDP","EMPL_AGR","UAA","PATENT_OTHER","POLICY") &gt; investment.var &lt;-c("GBAORD_AGR","BERD_AGR") &gt; research.var &lt;-c("RD_EDU_AGR","PATENT_AGR") &gt; impact.var &lt;-c("ENTR_INCOME_AGR","PPI_AGR") &gt; all.var <ref type="bibr">&lt;-c(context.var,investment.var,research.var,impact.var)</ref> &gt; summary(agres[,c("COUNTRY",all.var)])</p><p>From these summaries it seems that propensity to research investments is heterogeneous across countries: those with higher gross domestic product and utilized agricultural area tend to expend more for agricultural research. We hypothesize the DAG for the agricultural research problem on the basis of the assumption of conditional independence within the same level, and on the following causal order: investment level, research level, impact level (Figure <ref type="figure" target="#fig_3">5</ref>). Also, we consider the variables in the context level as exogenous variables, and assume endpoint-constrained quadratic lag shapes for all covariates. On these grounds, the model code can be defined as follows:</p><p>&gt; auxcode &lt;-c( + paste(investment.var,"~1",sep=""), + paste(research.var,"~",paste("quec.lag(",investment.var,",0,20)", + collapse="+",sep=""),sep=""), + paste(impact.var,"~",paste <ref type="bibr">("quec.lag(",c(investment.var,research.var)</ref>,",0,20)", + collapse="+",sep=""),sep="") + ) &gt; agres.code &lt;-list() &gt; for(i in 1:length(auxcode Parameter estimation takes a couple of minutes. Messages inform that logarithmic transformation was not applied to POLICY as it is a qualitative variable, and that differentiation was applied one time in order to achieve stationarity of all time series. Also, the Expectation-Maximization algorithm was run, as data contain missing values.</p><p>The summary of parameter estimation can be obtained using the summary method. Here, we display the summary for the endogenous part only by accessing to the component endogenous: The static representation of the DAG with coloured edges is shown in Figure <ref type="figure">6:</ref> &gt; plot(agres.mod)</p><p>Results show that business enterprise research expenditure (BERD_AGR) influences producer price (PPI_AGR) both directly from 3 to 20 years, and indirectly through the number of researchers with tertiary education (RD_EDU_AGR) from 0 to 5 years. Producer price (PPI_AGR) is also influenced by the number of patent applications (PATENT_AGR) from 1 to 6 years, independently of business enterprise research expenditure (BERD_AGR), which also influences entrepreneurial income (ENTR_INCOME_AGR) from 0 to 12 years.</p><p>The pathwise causal lag shapes and the overall one connecting BERD_AGR and PPI_AGR can be displayed by means of the following code (results shown in Figure <ref type="figure">7</ref>):</p><p>&gt; lagPlot(agres.mod,path="BERD_AGR*PPI_AGR") &gt; lagPlot(agres.mod,path="BERD_AGR*RD_EDU_AGR*PPI_AGR") &gt; lagPlot(agres.mod,from="BERD_AGR",to="PPI_AGR")</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>GBAORD_AGR BERD_AGR</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>RD_EDU_AGR PATENT_AGR ENTR_INCOME_ PPI_AGR</head><p>Figure <ref type="figure">6</ref>: The static representation of the DAG for the agricultural research problem (endpoint-constrained lag shapes) where each edge is coloured with respect to the sign of the estimated causal effect. Green, red and light grey indicate positive, negative and not statistically significant causal effects, respectively.</p><p>We see that the path connecting BERD_AGR to PPI_AGR passing through RD_EDU_AGR is composed by two edges with causal effects of different signs. However, the absolute value of the negative one is greater, thus the causal effect associated to the path results negative (upper right panel of Figure <ref type="figure">7</ref>). As a consequence, the cumulative overall causal effect is monotonically negative (lower panel of Figure <ref type="figure">7</ref>). We can conclude that for a 1% of business enterprise research expenditure more, producer price is expected to increase by 2.03% after 20 years:</p><p>&gt; causalEff(agres.mod,from="BERD_AGR",to="PPI_AGR",lag=20,cumul=T)$overall estimate lower 95% upper 95% 20 -2.032343 -2.277942 -1.786745</p><p>As a further step, we fit a second model using gamma lag shapes instead of endpointconstrained quadratic ones: &gt; auxcode_2 &lt;-c(paste(investment.var,"~1",sep=""), + paste(research.var,"~",paste("gamma.lag(",investment.var,",0.5,0.5)", + collapse="+",sep=""),sep=""), + paste(impact.var,"~",paste("gamma.lag <ref type="bibr">(",c(investment.var,research.var)</ref>,",0.5,0.5)", + collapse="+",sep=""),sep="")) &gt; agres.code_2 &lt;-list() &gt; for(i in 1:length(auxcode_2 BERD_AGR * PPI_AGR Lag Coefficient q q q q q q q q q q q q q q q q q q q q 0 1 2 3 4 5 6 7 8 9 </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Lag</head><p>Coefficient q q q q q q q q q q q q q q 0 1 2 3 4 5 6 7 8 9 10 11 -0.047 -0.0329 -0.0141 0 0.0094 0.0235 0.0376 Effective lags: 0 to 11 Cumulative coefficient: -0.19364 95% CI: (-0.29063, -0.09665)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>PPI_AGR ~ BERD_AGR</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Lag</head><p>Coefficient q q q q q q q q q q q q q q q q q q q q q q q 0 1 2 3 4 5 6 7 8 9 The static representation of the DAG with coloured edges is shown in Figure <ref type="figure" target="#fig_4">8</ref>: According to the BIC, the model with gamma lag shapes should be preferred: </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Conclusions and future development</head><p>Distributed-lag linear structural equation models (DLSEMs) allow to study the dynamic causal path generated by an external impulse into a multi-dimensional system, thanks to a variety of lag shapes characterized by flexibility and simplicity of estimation. In the real-world application illustrated in this paper, DLSEMs are applied to an impact assessment problem in the field of agricultural economics, but they appear as a suitable solution in several other scientific domains where the effect of an external impulse is studied through time. For instance, epidemiologic problems may be addressed, like the analysis of the dynamic effect of pollutants on human health <ref type="bibr" target="#b28">(Martins, Pereira, Lin, Santos, Prioli, do Carmo Luiz, Saldiva, and Ferreira Braga 2006;</ref><ref type="bibr" target="#b33">Steinvil, Fireman, Kordova-Biezuner, Cohen, Shapira, Berliner, and Rogowski 2009)</ref>. Also, viticultural-oenological domains can be dynamically characterized by focusing, for example, on grape maturation <ref type="bibr" target="#b26">(Magrini, Di Blasi, and Stefanini 2017</ref>) and vinification <ref type="bibr" target="#b32">(Stefanini and Pantani 2013;</ref><ref type="bibr" target="#b27">Magrini, Pantani, Bartolini, and Stefanini 2016)</ref>. Lag shapes included in the package may represent a large number of real-world lag structures: unimodal symmetric (with the endpoint-constrained quadratic lag shape), unimodal asymmetric (with the gamma lag shape) and skewned ones (with the quadratic decreasing lag shape). Nevertheless, additional lag shapes with further specific features may be added in future.</p><p>Parameter estimation in DLSEM cannot be performed in a single step unless gestation and lead lags are all known. Since the number of possible models rises exponentially as the number of covariates and time lags increases, complete search is infeasible for most real-world applications, thus a heuristic search was implemented. Further development of the package may be directed towards the improvement of the search strategy.</p><p>The main limitation of DLSEMs relies in the sample size to achieve efficient estimates. Likewise all lag models proposed in the literature, DLSEMs require to drop away a number of statistical units in order to estimate as many regression coefficients at different time lags. Thus, long time series are typically required to efficiently estimate wide lag structures. An extensive simulation study to assess the potential of the method as a function of the sample size is a natural continuation of the research on this topic.</p><p>DLSEMs are a special case of dynamic Bayesian networks <ref type="bibr" target="#b29">(Murphy 2002)</ref>, where endogenous variables follow the Gaussian distribution and lag shapes are possibly constrained to predefined functional forms. An important functionality of DLSEMs implemented in the dlsem package is the opportunity to condition on exogenous variables of any type, either categorical or continuous.</p><p>The current implementation of the package deals with grouped data through fixed effects estimation. Feature releases may include random effects estimation to enhance inference whenever the considered groups are a subset of the possible ones, or covariates with values constant within groups (second-level covariates) are involved.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: An example of directed acyclic graph.</figDesc><graphic coords="5,191.25,59.05,220.50,122.97" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: The pathwise causal lag shapes (upper panels) and the overall one (lower panel) connecting Job and Pollution. 95% asymptotic confidence intervals are shown in grey.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>(Job,0,15), &gt; Pollution~qdec.lag(Job,0,15)+qdec.lag(Consum,0,15) &gt; ) &gt; indus.mod_2 &lt;-dlsem(indus.code_2,group="Region",exogenous=c("Population","GDP"), &gt; data=industry,global.control=indus.global,local.control=indus.local,log=T) &gt; summary(indus.mod_2) A distributed-lag linear structural equation model Group factor: Region (10 groups) Exogenous variables: 0.8547, AIC: -4278.3, BIC: -4133.748 &gt; # model 3: gamma lag shapes &gt; indus.code_3 &lt;-list( &gt; Job ~1, &gt; Consum~gamma.lag(Job,0.5,0.5), &gt; Pollution~gamma.lag(Job,0.5,0.5)+gamma.lag(Consum,0.5,0.5) &gt; ) &gt; indus.mod_3 &lt;-dlsem(indus.code_3,group="Region",exogenous=c("Population","GDP"), &gt; data=industry,global.control=indus.global,local.control=indus.local,log=T) &gt; summary(indus.mod_3) A distributed-lag linear structural equation model Group factor: Region (10 groups) Exogenous variables</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: The static representation of the DAG for the agricultural research problem.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 8 :</head><label>8</label><figDesc>Figure 8: The static representation of the DAG for the agricultural research problem (gamma lag shapes) where each edge is coloured with respect to the sign of the estimated causal effect. Green, red and light grey indicate positive, negative and not statistically significant causal effects, respectively.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>The static representation of the DAG for the industrial development problem. 'Job': number of job positions in industry. 'Consum': private consumption index. 'Pollution': amount of greenhouse gas emissions.</figDesc><table><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell>Job</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell cols="3">Consum</cell></row><row><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell cols="3">Pollution</cell></row><row><cell cols="3">Figure 2: &gt; data(industry)</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell cols="3">&gt; summary(industry)</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Region</cell><cell></cell><cell>Year</cell><cell></cell><cell cols="2">Population</cell><cell></cell><cell>GDP</cell></row><row><cell>1</cell><cell>: 32</cell><cell>Min.</cell><cell cols="2">:1983</cell><cell>Min.</cell><cell cols="2">: 4771649</cell><cell>Min.</cell><cell>: 97119</cell></row><row><cell>2</cell><cell>: 32</cell><cell cols="3">1st Qu.:1991</cell><cell cols="3">1st Qu.: 8310737</cell><cell>1st Qu.: 186783</cell></row><row><cell>3</cell><cell>: 32</cell><cell cols="3">Median :1998</cell><cell cols="3">Median :25381874</cell><cell>Median : 463942</cell></row><row><cell>4</cell><cell>: 32</cell><cell>Mean</cell><cell cols="2">:1998</cell><cell>Mean</cell><cell cols="2">:32368547</cell><cell>Mean</cell><cell>: 727735</cell></row><row><cell>5</cell><cell>: 32</cell><cell cols="3">3rd Qu.:2006</cell><cell cols="3">3rd Qu.:56273337</cell><cell>3rd Qu.:1307044</cell></row><row><cell>6</cell><cell>: 32</cell><cell>Max.</cell><cell cols="2">:2014</cell><cell>Max.</cell><cell cols="2">:78308254</cell><cell>Max.</cell><cell>:1883702</cell></row><row><cell cols="2">(Other):128</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>Job</cell><cell></cell><cell cols="2">Consum</cell><cell></cell><cell cols="2">Pollution</cell></row><row><cell>Min.</cell><cell>: 34.77</cell><cell cols="2">Min.</cell><cell cols="2">: 37.35</cell><cell>Min.</cell><cell cols="2">: 3161</cell></row><row><cell cols="2">1st Qu.:105.07</cell><cell cols="4">1st Qu.: 87.88</cell><cell cols="3">1st Qu.: 7536</cell></row><row><cell cols="2">Median :137.03</cell><cell cols="4">Median :108.47</cell><cell cols="2">Median : 25320</cell></row><row><cell>Mean</cell><cell>:127.61</cell><cell cols="2">Mean</cell><cell cols="2">:108.17</cell><cell>Mean</cell><cell>: 32202</cell></row><row><cell cols="2">3rd Qu.:152.68</cell><cell cols="4">3rd Qu.:124.85</cell><cell cols="2">3rd Qu.: 47109</cell></row><row><cell>Max.</cell><cell>:200.83</cell><cell cols="2">Max.</cell><cell cols="2">:211.16</cell><cell>Max.</cell><cell cols="2">:101441</cell></row><row><cell cols="9">Since data are grouped into regions, we inspect minimum and maximum values by region:</cell></row><row><cell cols="9">&gt; by(industry[,-c(1:2)],industry$Region,function(x){apply(x,2,quantile,prob=c(0,1))})</cell></row><row><cell cols="3">industry$Region: 1</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell cols="2">Population</cell><cell>GDP</cell><cell></cell><cell>Job</cell><cell cols="3">Consum Pollution</cell></row><row><cell>0%</cell><cell cols="8">9819005 175519 83.41447 112.1351 6957.444</cell></row><row><cell>100%</cell><cell cols="8">9973483 190379 200.83461 126.4740 7794.559</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_14"><head></head><label></label><figDesc>Constraints for the adaptation of lag shapes are the following: (i) 3 years of maximum gestation lag for all lag shapes; (ii) 5 years of minimum lag width for all lag shapes; (iii) 15 years of maximum lag lead for the lag shapes in the regression model of variables in the research level; (iv) 20 years of maximum lag lead for the lag shapes in the regression model of variables in the impact level; (v) negative lag sign for the lag shapes in the regression model of producer price of agricultural output (PPI_AGR), and positive lag sign for all other lag shapes. The last constraint is motivated by the fact that lower values of producer price typically indicate an improvement of economic conditions. The following code defines these constraints efficiently:</figDesc><table><row><cell></cell><cell>)) {</cell></row><row><cell>+</cell><cell>agres.code[[i]] &lt;-formula(auxcode[i])</cell></row><row><cell>+</cell><cell>}</cell></row><row><cell cols="2">&gt; agres.global &lt;-list(adapt=T,max.gestation=3,min.width=5,max.lead=20,sign="+")</cell></row><row><cell cols="2">&gt; auxcon1 &lt;-rep(15,length(investment.var))</cell></row><row><cell cols="2">&gt; names(auxcon1) &lt;-investment.var</cell></row><row><cell cols="2">&gt; auxcon2 &lt;-rep("-",length(investment.var)+length(research.var))</cell></row><row><cell cols="2">&gt; names(auxcon2) &lt;-c(investment.var,research.var)</cell></row><row><cell cols="2">&gt; agres.local &lt;-list(max.lead=list(RD_EDU_AGR=auxcon1,PATENT_AGR=auxcon1),</cell></row><row><cell>+</cell><cell>sign=list(PPI_AGR=auxcon2))</cell></row><row><cell cols="2">Finally, we request the logarithmic transformation for all quantitative variables in order to</cell></row><row><cell cols="2">interpret coefficients as elasticities. The code performing parameter estimation is the follow-</cell></row><row><cell>ing:</cell><cell></cell></row><row><cell cols="2">&gt; agres.mod &lt;-dlsem(agres.code,group="COUNTRY",exogenous=context.var,data=agres,</cell></row><row><cell>+</cell><cell>global.control=agres.global,local.control=agres.local,log=T)</cell></row><row><cell cols="2">Logarithm not applied to variables: POLICY</cell></row><row><cell cols="2">Checking stationarity...</cell></row><row><cell cols="2">Order 1 differentiation performed</cell></row><row><cell cols="2">EM converged after 32 iterations. Log-likelihood: 2372.762</cell></row><row><cell cols="2">Estimating regression model 1/6 (GBAORD_AGR)</cell></row><row><cell cols="2">Estimating regression model 2/6 (BERD_AGR)</cell></row><row><cell cols="2">Estimating regression model 3/6 (RD_EDU_AGR)</cell></row><row><cell cols="2">Estimating regression model 4/6 (PATENT_AGR)</cell></row><row><cell cols="2">Estimating regression model 5/6 (ENTR_INCOME_AGR)</cell></row><row><cell cols="2">Estimating regression model 6/6 (PPI_AGR)</cell></row><row><cell cols="2">Estimation completed</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_18"><head></head><label></label><figDesc>Figure 7: The pathwise causal lag shapes (upper panels) and the overall one (lower panel) connecting BERD_AGR to PPI_AGR. 95% asymptotic confidence intervals are shown in grey.</figDesc><table><row><cell cols="7">GBAORD_AGR 0 5 0.03513002 0.1543571 0.2275892 8.201452e-01</cell></row><row><cell>BERD_AGR</cell><cell cols="6">0 5 0.78183701 0.1185141 6.5969981 2.350165e-10 ***</cell></row><row><cell cols="2">Response: PATENT_AGR</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>a b</cell><cell>theta se(theta)</cell><cell cols="2">t value</cell><cell cols="2">Pr(&gt;|t|)</cell></row><row><cell cols="7">GBAORD_AGR 0 15 0.31217999 0.1802083 1.7323291 0.08578436 .</cell></row><row><cell>BERD_AGR</cell><cell cols="6">1 6 0.02856498 0.1018026 0.2805917 0.77950677</cell></row><row><cell cols="3">Response: ENTR_INCOME_AGR</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>a b</cell><cell>theta se(theta)</cell><cell></cell><cell cols="2">t value</cell><cell>Pr(&gt;|t|)</cell></row><row><cell cols="7">GBAORD_AGR 0 5 0.09161682 0.3597409 0.2546745 0.80006248</cell></row><row><cell>BERD_AGR</cell><cell cols="6">0 18 -0.33275458 0.1326417 -2.5086732 0.01554989 *</cell></row><row><cell cols="7">RD_EDU_AGR 2 15 0.53828995 0.2395878 2.2467339 0.02929268 *</cell></row><row><cell cols="7">PATENT_AGR 0 20 0.36390869 0.1558521 2.3349617 0.02377460 *</cell></row><row><cell cols="2">Response: PPI_AGR</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>a b</cell><cell cols="2">theta se(theta)</cell><cell cols="2">t value</cell><cell>Pr(&gt;|t|)</cell></row><row><cell cols="7">GBAORD_AGR 0 12 -0.049777487 0.02186578 -2.2765021 0.02461862 *</cell></row><row><cell>BERD_AGR</cell><cell cols="6">0 5 0.061170793 0.03929708 1.5566243 0.12223777</cell></row><row><cell cols="7">RD_EDU_AGR 0 15 -0.066418855 0.02109762 -3.1481683 0.00208097 **</cell></row><row><cell cols="7">95% CI: (-3.0318, -1.0328) Effective lags: 0 to 20 Cumulative coefficient: -2.0323 PATENT_AGR 1 6 -0.006869514 0.02424436 -0.2833448 0.77740903 0.186</cell></row><row><cell></cell><cell></cell><cell>0.116</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell>-0.233 -0.163 -0.093 -0.0233 0.0465</cell><cell></cell><cell>11</cell><cell>13</cell><cell>15</cell><cell>17</cell><cell>19</cell></row><row><cell cols="5">Estimating regression model 3/6 (RD_EDU_AGR)</cell><cell></cell></row><row><cell cols="5">Estimating regression model 4/6 (PATENT_AGR)</cell><cell></cell></row><row><cell cols="6">Estimating regression model 5/6 (ENTR_INCOME_AGR)</cell></row><row><cell cols="4">Estimating regression model 6/6 (PPI_AGR)</cell><cell></cell><cell></cell></row><row><cell cols="3">Estimation completed</cell><cell></cell><cell></cell><cell></cell></row><row><cell cols="7">Parameter estimation with gamma lag shapes is longer and in this case takes a dozen of</cell></row><row><cell cols="7">minutes. Imputation and differentiation is obviously unchanged. Results with gamma lag</cell></row><row><cell cols="7">shapes are quite different from those with endpoint-constrained quadratic ones:</cell></row><row><cell cols="3">&gt; summary(agres.mod_2)$endogenous</cell><cell></cell><cell></cell><cell></cell></row><row><cell cols="2">Response: GBAORD_AGR</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>-</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell cols="2">Response: BERD_AGR</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>-</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell cols="2">Response: RD_EDU_AGR</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>a b</cell><cell>theta se(theta)</cell><cell cols="2">t value</cell><cell></cell><cell>Pr(&gt;|t|)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_19"><head></head><label></label><figDesc>&gt; lapply(list(QUEC=agres.mod,GAMMA=agres.mod_2),BIC)</figDesc><table><row><cell>PPI_AGR</cell><cell>(overall)</cell><cell></cell><cell></cell><cell></cell></row><row><cell>-135.99300</cell><cell>575.73078</cell><cell></cell><cell></cell><cell></cell></row><row><cell>$GAMMA</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>GBAORD_AGR</cell><cell>BERD_AGR</cell><cell>RD_EDU_AGR</cell><cell cols="2">PATENT_AGR ENTR_INCOME_AGR</cell></row><row><cell>27.98495</cell><cell>178.69873</cell><cell>160.36565</cell><cell>285.71881</cell><cell>84.81348</cell></row><row><cell>PPI_AGR</cell><cell>(overall)</cell><cell></cell><cell></cell><cell></cell></row><row><cell>-270.89223</cell><cell>466.68938</cell><cell></cell><cell></cell><cell></cell></row><row><cell>$QUEC</cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>GBAORD_AGR</cell><cell>BERD_AGR</cell><cell>RD_EDU_AGR</cell><cell cols="2">PATENT_AGR ENTR_INCOME_AGR</cell></row><row><cell>27.98495</cell><cell>178.69873</cell><cell>185.28630</cell><cell>248.85848</cell><cell>70.89533</cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_0"><p>Qualitative variables can be included only as exogenous variables, as described in Subsection 4.3.</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgements</head><p>This research was partially supported by the <rs type="funder">European Union</rs>'s <rs type="programName">Seventh Framework Programme</rs> (FP7/2007<ref type="bibr" target="#b32">-2013)</ref> under grant agreement <rs type="grantNumber">n°609448</rs> (<rs type="projectName">IMPRESA</rs> project, <ref type="url" target="http://www.impresa-project.eu">http://www. impresa-project.eu</ref>), and by the <rs type="funder">University of Florence (Florence, Italy)</rs> under funding framework Progetto strategico di ricerca di base per l'anno 2015, grant <rs type="projectName">Disegno e analisi di studi sperimentali e osservazionali per le decisioni in ambito epidemiologico</rs>, socio-economico, ambientale e tecnologico. We thank the anonymous reviewers for valuable comments that helped improving the presentation of our work. The authors declare that there are no conflicts of interest.</p></div>
			</div>
			<listOrg type="funding">
				<org type="funded-project" xml:id="_Zqx5tXk">
					<idno type="grant-number">n°609448</idno>
					<orgName type="project" subtype="full">IMPRESA</orgName>
					<orgName type="program" subtype="full">Seventh Framework Programme</orgName>
				</org>
				<org type="funded-project" xml:id="_2y2dmPt">
					<orgName type="project" subtype="full">Disegno e analisi di studi sperimentali e osservazionali per le decisioni in ambito epidemiologico</orgName>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Distributed-lag Linear Structural Equation Models in R: The dlsem Package Job Consum Pollution Figure <ref type="figure">3</ref>: The static representation of the DAG for the industrial development problem, where each edge is coloured with respect to the sign of the estimated causal effect. Green: positive causal effect. Red: negative causal effect. Light grey: not statistically significant causal effect (no such edges here).</p><p>wise causal lag shapes and the overall one connecting two variables. The main arguments of command causalEff(•) include:</p><p>• x, the first argument, requiring an object of class dlsem;</p><p>• from, requiring the name of one or more starting variables, that is the variables generating the causal effect;</p><p>• to, requiring the name of the ending variable, that is the variable receiving the causal effect;</p><p>• lag, accepting specific time lags at which the causal effect must be computed. If no values are provided, all the relevant time lags are considered.</p><p>• cumul, a logical value indicating whether the cumulative causal effect must be returned. Default is FALSE.</p><p>Only exogenous variables can be indicated as starting or ending variables. Note that, due to the properties of the multiple linear regression model, causal effects are net of the influence of the group factor and exogenous variables.</p><p>The following code returns the cumulative causal effect (by path and the overall one) of the number of job positions on the amount of greenhouse gas emissions:</p><p>&gt; causalEff(indus.mod,from="Job",to="Pollution",cumul=T) The model with endpoint-constrained quadratic lag shapes has the best fit according to the BIC. Note that the fit for variable Job is constant in each model because it has no endogenous covariates.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">A real-world application</head><p>In this section, we illustrate the use of the dlsem package to address a real-world application aiming at assessing the impact of agricultural research expenditure on multiple dimensions in Europe. We refer to this problem as "agricultural research problem". The dataset agres is used in the illustration, which contains official data for EU 15 countries in the period 1980-2014:</p><p>&gt; data(agres) &gt; names(agres)</p><p>[1] "COUNTRY" "YEAR" "GDP" "EMPL_AGR" [5] "UAA" "PATENT_OTHER" "GBAORD_AGR" "BERD_AGR" [9] "RD_EDU_AGR" "EU_PRO_AGR" "PATENT_AGR" "TFPC" [13] "EPC" "GVA_AGR" "PPI_AGR" "ENTR_INCOME_AGR" [17] "ENERGY_RENEW" "INCOME_RURAL" "UNEMPL_RURAL" "HEALTH_RURAL"</p><p>Dataset agres includes the code of the country (COUNTRY), the year (YEAR) and several other variables. We consider a subset of them in order to cover four interrelated causal levels:</p><p>• context level, including factors determining differences among countries and directly influencing the other levels;</p><p>• investment level, including factors contributing to fund agricultural research;</p><p>• research level, including indicators of the agricultural research activity;</p><p>• impact level: including variables affecting economic conditions of producers and consumers.</p><p>The considered variables for each level are:</p><p>• context level: gross domestic product (international dollars, label: GDP), persons employed in Agriculture (count, label: EMPL_AGR), utilized agricultural area (hectares, label: UAA), mechanical, chemical and environment-related patent applications (count, label: PATENT_OTHER);</p><p>• investment level: government research expenditure (million euro PPS, label: GBAORD_AGR), business enterprise research expenditure (million euro PPS, label: BERD_AGR);</p><p>• research level: agricultural researchers with tertiary education (count, label: RD_EDU_AGR), agricultural patent applications (count, label: PATENT_AGR);</p><p>• impact level: net entrepreneurial income of Agriculture (index 2005=100, label: ENTR_INCOME_AGR), producer price of agricultural output (index 2005=100, label: PPI_AGR). In order to verify the presence of heterogeneity between groups (here, countries), we inspect the summary of government research expenditure, gross domestic product and utilized agricultural area for some countries:</p><p>&gt; cou.ind &lt;-which(agres[,"COUNTRY"] %in% c("AT","DK","FR","IT")) &gt; by(agres[cou.ind,c("GBAORD_AGR","GDP","UAA")],factor(agres[cou.ind,"COUNTRY"]),summary) </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m">$ Job*Pollution estimate std. err. lower 95% upper 95</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">$overall estimate std</title>
		<idno>6210405 0.06590698 0.49186516 0.75021576 12 0.6210405 0.06590698 0.49186516 0.75021576</idno>
		<imprint>
			<biblScope unit="volume">95</biblScope>
			<biblScope unit="page">95</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<author>
			<persName><surname>Qu</surname></persName>
		</author>
		<title level="m">67.96 3</title>
		<imprint>
			<biblScope unit="page">2711500</biblScope>
		</imprint>
	</monogr>
	<note>rd Qu.:265359 3rd Qu</note>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">Min</forename></persName>
		</author>
		<imprint>
			<biblScope unit="page">28774000</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<author>
			<persName><surname>Qu</surname></persName>
		</author>
		<idno>1777188 1st Qu.:29227000 Median :316.7 Median :2081240 Median :29736000</idno>
		<title level="m">277.5 1st Qu</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title/>
		<author>
			<persName><surname>Qu</surname></persName>
		</author>
		<imprint>
			<biblScope unit="page">30109500</biblScope>
		</imprint>
	</monogr>
	<note>406.3 3rd Qu.:2264428 3rd Qu</note>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">Max</forename></persName>
		</author>
		<imprint>
			<biblScope unit="page">2351940</biblScope>
			<pubPlace>Max</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">30593000 NA s :1 NA s :1 NA s</title>
		<author>
			<persName><forename type="first">Max</forename></persName>
		</author>
		<imprint>
			<biblScope unit="page">1501700</biblScope>
		</imprint>
	</monogr>
	<note>cou.ind, &quot;COUNTRY&quot;]: IT GBAORD_AGR GDP UAA Min. :119.9 Min</note>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">Min</forename></persName>
		</author>
		<imprint>
			<biblScope unit="page">13630000</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title/>
		<author>
			<persName><surname>Qu</surname></persName>
		</author>
		<imprint>
			<biblScope unit="page">15653250</biblScope>
		</imprint>
	</monogr>
	<note>rd Qu.:1827698 3rd Qu</note>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">Max</forename></persName>
		</author>
		<idno>436.4 Max. :1918530</idno>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">16840000 NA s :3 NA s :1 NA s :1 References</title>
		<author>
			<persName><forename type="first">Max</forename></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">A New Look at the Statistical Identification Model</title>
		<author>
			<persName><forename type="first">H</forename><surname>Akaike</surname></persName>
		</author>
		<idno type="DOI">10.1109/TAC.1974.1100705</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Automatic Control</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="716" to="723" />
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">The Distributed Lag between Capital Appropriations and Net Expenditures</title>
		<author>
			<persName><forename type="first">S</forename><surname>Almon</surname></persName>
		</author>
		<idno type="DOI">10.2307/1911894</idno>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="178" to="196" />
			<date type="published" when="1965">1965</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Regression Models with Mixed Sampling Frequencies</title>
		<author>
			<persName><forename type="first">E</forename><surname>Andreou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Ghysels</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Kourtellos</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.jeconom.2010.01.004</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Econometrics</title>
		<imprint>
			<biblScope unit="volume">158</biblScope>
			<biblScope unit="page" from="246" to="261" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Maximum Likelihood from Incomplete Data via the EM Algorithm</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">P</forename><surname>Dempster</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">M</forename><surname>Laird</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Rubin</forename><surname>Db</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.jeconom.2010.01.004</idno>
		<idno>doi:10.1.1.133.4884</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society, Series B</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="38" />
			<date type="published" when="1977">1977</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Likelihood Ratio Statistics for Autoregressive Time Series with a Unit Root</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Dickey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">A</forename><surname>Fuller</surname></persName>
		</author>
		<idno type="DOI">10.2307/1912517</idno>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="page" from="1057" to="1072" />
			<date type="published" when="1981">1981</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Distributed Lag Linear and Non-Linear Models in R: The Package dnlm</title>
		<author>
			<persName><forename type="first">A</forename><surname>Gasparrini</surname></persName>
		</author>
		<idno type="DOI">10.18637/jss.v043.i08</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Software</title>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1" to="20" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Mixed Frequency Data Sampling Regression Models: The R Package midasr</title>
		<author>
			<persName><forename type="first">E</forename><surname>Ghysels</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Kvedaras</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Zemlys</surname></persName>
		</author>
		<idno type="DOI">10.18637/jss.v072.i04</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Software</title>
		<imprint>
			<biblScope unit="volume">72</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1" to="35" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">MIDAS Regressions: Further Results and New Directions</title>
		<author>
			<persName><forename type="first">E</forename><surname>Ghysels</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Sinko</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Valkanov</surname></persName>
		</author>
		<idno type="DOI">10.1080/07474930600972467</idno>
	</analytic>
	<monogr>
		<title level="j">Econometric Reviews</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="53" to="90" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Spurious Regressions in Econometrics</title>
		<author>
			<persName><forename type="first">Cwj</forename><surname>Granger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Newbold</surname></persName>
		</author>
		<idno type="DOI">10.1016/0304-4076(74)90034-7</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Econometrics</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="111" to="120" />
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">The Statistical Implications of a System of Simultaneous Equations</title>
		<author>
			<persName><forename type="first">T</forename><surname>Haavelmo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">1</biblScope>
			<date type="published" when="1943">1943. 194301</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">G</forename><surname>Judge</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">E</forename><surname>Griffiths</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">C</forename><surname>Hill</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Lutkepohl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">C</forename><surname>Lee</surname></persName>
		</author>
		<title level="m">The Theory and Practice of Econometrics. 2nd edition</title>
		<meeting><address><addrLine>New York, US-NY</addrLine></address></meeting>
		<imprint>
			<publisher>John Wiley &amp; Sons</publisher>
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Measuring the Equation Systems of Dynamic Economics</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">C</forename><surname>Koopmans</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Rubin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">B</forename><surname>Leipnik</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Statistical Inference in Dynamic Economic Models</title>
		<editor>
			<persName><surname>Tc Koopmans</surname></persName>
		</editor>
		<meeting><address><addrLine>New York, US-NY</addrLine></address></meeting>
		<imprint>
			<publisher>John Wiley &amp; Sons</publisher>
			<date type="published" when="1950">1950</date>
			<biblScope unit="page" from="53" to="237" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Unit Root Tests in Panel Data: Asymptotic and Finite-Sample Properties</title>
		<author>
			<persName><forename type="first">A</forename><surname>Levin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">J</forename><surname>Chub</surname></persName>
		</author>
		<idno type="DOI">10.1016/S0304-4076(01)00098-7</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Econometrics</title>
		<imprint>
			<biblScope unit="volume">108</biblScope>
			<biblScope unit="page" from="1" to="24" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Linear Markovian Models for Lag Exposure Assessment</title>
		<author>
			<persName><forename type="first">A</forename><surname>Magrini</surname></persName>
		</author>
		<idno type="DOI">10.2478/bile-2018-0012</idno>
	</analytic>
	<monogr>
		<title level="j">Biometrical Letters</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="179" to="195" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">A Conditional Linear Gaussian Network to Assess the Impact of Several Agronomic Settings on the Quality of Tuscan Sangiovese Grapes</title>
		<author>
			<persName><forename type="first">A</forename><surname>Magrini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Di</forename><surname>Blasi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Stefanini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">M</forename></persName>
		</author>
		<idno type="DOI">10.1515/bile-2017-0002</idno>
	</analytic>
	<monogr>
		<title level="j">Biometrical Letters</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="25" to="42" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">On Prefermentative Maceration Techniques: Statistical Analysis of Sensory Descriptors in Sangiovese Wine</title>
		<author>
			<persName><forename type="first">A</forename><surname>Magrini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><forename type="middle">L</forename><surname>Pantani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">B</forename><surname>Bartolini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">M</forename><surname>Stefanini</surname></persName>
		</author>
		<idno type="DOI">10.1515/bile-2016-0001</idno>
	</analytic>
	<monogr>
		<title level="j">Biometrical Letters</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="20" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">The Effects of Air Pollution on Cardiovascular Diseases: Lag Structures</title>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">C</forename><surname>Martins</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Laa</forename><surname>Pereira</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">A</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">U</forename><forename type="middle">P</forename><surname>Santos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Prioli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Carmo</forename><surname>Do</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Luiz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Phn</forename><surname>Saldiva</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ferreira</forename><surname>Braga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename></persName>
		</author>
		<idno type="DOI">10.1590/S0034-89102006000500018</idno>
	</analytic>
	<monogr>
		<title level="j">Revista de Saúde Pública</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="issue">4</biblScope>
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">Dynamic Bayesian Networks: Representation, Inference and Learning</title>
		<author>
			<persName><forename type="first">K</forename><surname>Murphy</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
			<pubPlace>US-CA</pubPlace>
		</imprint>
		<respStmt>
			<orgName>Computer Science Division, UC Berkeley</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">PhD Thesis</note>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<title level="m" type="main">Causality: Models, Reasoning, and Inference</title>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2000">2000</date>
			<publisher>Cambridge University Press</publisher>
			<pubPlace>Cambridge, UK.</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Estimating the Dimension of a Model</title>
		<author>
			<persName><forename type="first">G</forename><surname>Schwarz</surname></persName>
		</author>
		<idno type="DOI">10.1214/aos/1176344136</idno>
	</analytic>
	<monogr>
		<title level="j">Annals of Statistics</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="461" to="464" />
			<date type="published" when="1978">1978</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">A Bayesian Model to Compare Vinification Procedures</title>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">M</forename><surname>Stefanini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><forename type="middle">L</forename><surname>Pantani</surname></persName>
		</author>
		<idno type="DOI">10.2478/bile-2013-0018</idno>
	</analytic>
	<monogr>
		<title level="j">Biometrical Letters</title>
		<imprint>
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="61" to="80" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">Environmental Air Pollution Has Decremental Effects on Pulmonary Function Test Parameters up to One Week after Exposure</title>
		<author>
			<persName><forename type="first">A</forename><surname>Steinvil</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Fireman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Kordova-Biezuner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Cohen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Shapira</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Berliner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Rogowski</surname></persName>
		</author>
		<idno type="DOI">10.1097/MAJ.0b013e3181adb3ed.</idno>
	</analytic>
	<monogr>
		<title level="j">American Journal of Medical Science</title>
		<imprint>
			<biblScope unit="volume">338</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="273" to="279" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
	<note>b013e3181adb3ed</note>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">The Method of Path Coefficients</title>
		<author>
			<persName><forename type="first">S</forename><surname>Wright</surname></persName>
		</author>
		<idno type="DOI">10.1214/aoms/1177732676</idno>
		<idno>orcid.org/0000-0002-7278-5332</idno>
	</analytic>
	<monogr>
		<title level="j">Annals of Mathematical Statistics</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="161" to="215" />
			<date type="published" when="1934">1934</date>
			<pubPlace>Florence, Italy E-mail</pubPlace>
		</imprint>
		<respStmt>
			<orgName>Alessandro Magrini Department of Statistics, Computer Science, Applications University of</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<ptr target="http://www.osg.or" />
	</analytic>
	<monogr>
		<title level="m">published by the Austrian Society of Statistics</title>
		<imprint>
			<date type="published" when="2018-01-03">2018-01-03 January 2019</date>
			<biblScope unit="volume">48</biblScope>
			<biblScope unit="page" from="2018" to="2024" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
