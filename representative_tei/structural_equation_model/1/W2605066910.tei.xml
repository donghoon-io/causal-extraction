<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Continuous Time Structural Equation Modeling with R Package ctsem</title>
				<funder>
					<orgName type="full">Ωnyx (von Oertzen</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Charles</forename><forename type="middle">C</forename><surname>Driver</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Johan</forename><forename type="middle">H L</forename><surname>Oud</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Manuel</forename><forename type="middle">C</forename><surname>Voelkle</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Max Planck Institute for Human Development</orgName>
								<orgName type="institution" key="instit1">Radboud University Nijmegen</orgName>
								<orgName type="institution" key="instit2">Humboldt University</orgName>
								<address>
									<country>Berlin</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="department">Max Planck Institute for Human Development</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Continuous Time Structural Equation Modeling with R Package ctsem</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.18637/jss.v077.i05</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-14T17:37+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>time series</term>
					<term>longitudinal modeling</term>
					<term>panel data</term>
					<term>state space</term>
					<term>structural equation modeling</term>
					<term>continuous time</term>
					<term>stochastic differential equation</term>
					<term>dynamic models</term>
					<term>Kalman filter</term>
					<term>R</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>We introduce ctsem, an R package for continuous time structural equation modeling of panel (N &gt; 1) and time series (N = 1) data, using full information maximum likelihood. Most dynamic models (e.g., cross-lagged panel models) in the social and behavioural sciences are discrete time models. An assumption of discrete time models is that time intervals between measurements are equal, and that all subjects were assessed at the same intervals. Violations of this assumption are often ignored due to the difficulty of accounting for varying time intervals, therefore parameter estimates can be biased and the time course of effects becomes ambiguous. By using stochastic differential equations to estimate an underlying continuous process, continuous time models allow for any pattern of measurement occasions. By interfacing to OpenMx, ctsem combines the flexible specification of structural equation models with the enhanced data gathering opportunities and improved estimation of continuous time models. ctsem can estimate relationships over time for multiple latent processes, measured by multiple noisy indicators with varying time intervals between observations. Within and between effects are estimated simultaneously by modeling both observed covariates and unobserved heterogeneity. Exogenous shocks with different shapes, group differences, higher order diffusion effects and oscillating processes can all be simply modeled. We first introduce and define continuous time models, then show how to specify and estimate a range of continuous time models using ctsem.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Dynamic models, such as the well known vector autoregressive model, are widely used in the social and behavioral sciences. They allow us to see how fluctuations in processes re-late to later values of those processes, the effect of an input at a particular time, how the various factors relate to average levels of the processes, and many other possibilities. Some examples with panel data include the impact of European institutional changes on business cycles <ref type="bibr" target="#b4">(Canova, Ciccarelli, and Ortega 2012)</ref>, the coupling between sensory and intellectual functioning <ref type="bibr" target="#b9">(Ghisletta and Lindenberger 2005)</ref>, or the analysis of bidirectional links between children's delinquency and the quality of parent-child relationships <ref type="bibr" target="#b19">(Keijsers, Loeber, Branje, and Meeus 2011)</ref>. Examples of single subject approaches are studies on the decline in pneumonia rates in the USA after a vaccine introduction <ref type="bibr" target="#b11">(Grijalva, Nuorti, Arbogast, Martin, Edwards, and Griffin 2007)</ref>, or the lack of a relationship between antidepressant sales and public health in Iceland <ref type="bibr" target="#b15">(Helgason, Tomasson, and Zoega 2004)</ref>. At present, applications of dynamic models in the social and behavioral sciences are almost exclusively limited to discrete time models. In discrete time models it is generally assumed that time progresses in discrete steps, that time intervals between measurement occasions are equal, and that, in case of panel data, subjects are assessed with the same time intervals. In many cases, these assumptions are not met, resulting in biased parameter estimates and a misunderstanding of the strength and time course of effects. This concept is illustrated in Figure <ref type="figure">1</ref> (with a comprehensive example in Appendix A). In the upper panel, Figure <ref type="figure">1</ref> shows a true autoregressive effect of 0.80 between observed variables (represented by squares), assuming equal intervals of length ∆t = 1 (represented by equal distances between observed variables), while the lower panel shows a process with two intervals of ∆t = 1 and one interval ∆t = 2. In the top panel, the meaning of the estimate of 0.80 is clear -it refers to the autoregression estimate for 1 unit of time. In the lower case, however, the autoregression estimate of 0.73 is ambiguous -it is too low to characterize the relation between the first three occasions (correct value of 0.80 is in brackets) and too high between the last two occasions (correct value of 0.64).</p><p>Obviously, parameter estimates and, thus, scientific conclusions, are biased when observation intervals vary and this is not adequately accounted for. In simple cases, such as the example in Figure <ref type="figure">1</ref>, additional variables -so called phantom variables <ref type="bibr" target="#b28">(Rindskopf 1984)</ref>, with missing values for all individuals -could be added in order to artificially create equally spaced time intervals. For example, an additional variable could be specified at t4, resulting in equal time intervals and permitting the use of standard discrete time models. For complex patterns of individually varying time intervals, however, this approach quickly becomes untenable <ref type="bibr" target="#b30">(Voelkle and Oud 2013</ref>). Furthermore, with discrete time models it is difficult to compare results obtained from different studies with unequal time intervals, which poses a limitation to the production of cumulative knowledge in science <ref type="bibr" target="#b32">(Voelkle, Oud, Davidov, and Schmidt 2012)</ref>.</p><p>Continuous time models overcome these problems, offering researchers the possibility to estimate parameters free from bias due to unequal intervals, easily compare between studies and data sets with different observation schedules, gather data with variable time intervals between observations, understand changes in observed effects over time, and parsimoniously specify complex dynamics. Although continuous time models have a long history <ref type="bibr" target="#b6">(Coleman 1964;</ref><ref type="bibr" target="#b14">Hannan and Tuma 1979)</ref>, their use in the social sciences is still uncommon. At least in part, this is due to a lack of suitable software to specify and estimate continuous time models. With the introduction of ctsem <ref type="bibr" target="#b7">(Driver, Voelkle, and Oud 2017)</ref> in this article, we want to overcome this limitation. Although we will define continuous time models in the next section and provide several examples in the sections thereafter, a comprehensive treatment of continuous time models is beyond the scope of this article. For a more general introduction Figure <ref type="figure">1</ref>: Two autoregressive processes, each exhibiting a true autoregressive effect of 0.80 for 1 unit of time. The top process is measured with equal time intervals (represented by the space between observations) of 1 unit, while the lower process has unequal intervals.</p><p>to continuous time models by means of structural equation modeling (SEM), the reader is referred to <ref type="bibr" target="#b32">Voelkle et al. (2012)</ref>. For additional information on the technical details we refer the reader to <ref type="bibr" target="#b25">Oud and Jansen (2000)</ref>.</p><p>While there are already a range of packages that deal with continuous time (stochastic differential equation) models in R (R Core Team 2017), most focus on single subject applications. These include sde <ref type="bibr" target="#b18">(Iacus 2016)</ref>, yuima <ref type="bibr" target="#b3">(Brouste et al. 2014)</ref>, SIM.DiffProc <ref type="bibr" target="#b12">(Guidoum and Boukhetala 2017)</ref>, cts <ref type="bibr" target="#b34">(Wang 2013)</ref>, POMP <ref type="bibr" target="#b20">(King, Nguyen, and Ionides 2016)</ref>. For multisubject approaches, OpenMx (Neale et al. 2016) now includes the function mxExpectationStateSpaceContinuousTime, which can be combined with the function mxFitFunctionMultigroup for fixed effects based group analysis. ctsem is focused on providing an accessible workflow, for full information maximum likelihood estimation of continuous time multivariate autoregressive models with random intercepts, for both time series and panel data. Using ctsem, one may specify: cross lagged panel models; latent growth curve models; random intercepts at the latent or manifest level; damped oscillators; dynamic factor analysis models; constant or time dependent exogenous predictors; continuous time ARMAX models from the time series tradition; multiple groups or individuals with different parameters; or any combination of the preceding. First order models should be generally equivalent to discrete time first order models, if there is no variability in time intervals. For an example of this equivalence in regards to dual change score models see <ref type="bibr" target="#b31">Voelkle and Oud (2015)</ref>. For an R script and plot comparing estimates of a simple autoregressive model using ctsem and other packages, see Appendix B.</p><p>The remainder of this article is organized as follows: In Section 2, we provide a formal definition of the continuous time models dealt with in this package. In Section 3 we will show how to install ctsem and give an overview of the package. In Section 4, we will review different data structures and discuss the role of time in continuous time models. In Section 5, we will show how to specify continuous time models in ctsem, followed by a discussion of model estimation and testing in Section 6. In Section 7 we will discuss various extensions of basic continuous time models, including unobserved heterogeneity, time dependent and time-independent exogenous predictors, time series, multiple group models, higher order, and oscillating models. We will end with some discussion of various specification options and tips for model fitting in Section 8, and point to current limitations and future research and development directions in Section 9.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Continuous time models: Fundamentals</head><p>The class of continuous time models implemented in ctsem is represented by the multivariate stochastic differential equation:</p><formula xml:id="formula_0">dη i (t) = Aη i (t) + ξ i + Bz i + Mχ i (t) dt + GdW i (t).</formula><p>(1)</p><p>Vector η i (t) ∈ R v is a v-variable vector of the processes of interest at time t, for subject i. The matrix A ∈ R v×v represents the so-called drift matrix, with auto effects on the diagonal and cross effects on the off-diagonals characterizing the temporal relationships of the processes.</p><p>The long term level of processes η i (t) is determined by the v-length vector of random variables ξ i , with ξ i ∼ N(κ, φ ξ ) for every i, where vector κ ∈ R v denotes the continuous time intercepts, and matrix φ ξ ∈ R v×v the covariance across subjects. ξ i sets the long-term level of the processes and the long-term differences between the processes of individual subjects -without it the processes of a stable model would all trend towards zero in the long-run.</p><p>The matrix B ∈ R v×p represents the effect of the p-length vector of (fixed) time-independent predictors z ∈ R p on processes η i (t). Time-independent predictors would typically be variables that differ between subjects, but are constant within subjects for the time range in question.</p><p>Time-dependent predictors χ i (t) represent inputs to the system that vary over time and are independent of fluctuations in the system. Equation 1 shows a generalized form for timedependent predictors, that could be treated in a variety of ways dependent on the assumed time course (or shape) of time-dependent predictors. We use a simple impulse form, in which the predictors are treated as impacting the processes only at the instant of an observation. When necessary, the evolution over time can be modeled by extending the state matrices. This is demonstrated in the level change example in Section 7.1, wherein a model containing only the basic impulse has a persistent level change effect added. To achieve the impulse form we replace part of Equation 1 as follows:</p><formula xml:id="formula_1">χ i (t) = u ∈U i x i,u δ(t -u).<label>(2)</label></formula><p>Here, time-dependent predictors x i,u ∈ R l are observed at times u ∈ U i ⊂ R. The Dirac delta function δ(tu) is a generalized function that is ∞ at 0 and 0 elsewhere, yet has an integral of 1 (when 0 is in the range of integration). It is useful to model an impulse to a system, and here is scaled by the vector of time-dependent predictors x i,u . The effect of these impulses on processes η i (t) is then M ∈ R v×l .</p><p>W i (t) ∈ R v represent independent Wiener processes, with a Wiener process being a randomwalk in continuous time. dW i (t) is meaningful in the context of stochastic differential equations, and represents the stochastic error term, an infinitesimally small increment of the Wiener process. The lower triangular matrix G ∈ R v×v represents the effect of this noise on the change in η i (t). Q, where Q = GG , represents the variance-covariance matrix of the diffusion process in continuous time.</p><p>The solution of the stochastic differential Equation 1 for any time interval tt 0 , with t &gt; t 0 is:</p><formula xml:id="formula_2">η i (t) = e A(t-t 0 ) η i (t 0 ) + A -1 [e A(t-t 0 ) -I]ξ i + A -1 [e A(t-t 0 ) -I]Bz i + M u ∈U i x i,u δ(t -u) + ∫ t t 0 e A(t-s) GdW i (s)<label>(3)</label></formula><p>The five summands of this equation correspond to the five of Equation <ref type="formula">1</ref>, and give the link between the continuous time model and discrete instantiations of the process.</p><p>The last summand of Equation 3, the integral of the diffusion over the given time interval, exhibits the covariance matrix: cov</p><formula xml:id="formula_3">∫ t t 0 e A(t-s) GdW i (s) = ∫ t t 0 e A(t-s) Qe A (t-s) ds = irow A -1 # [e A # (t-t 0 ) -I] row(Q) ,<label>(4)</label></formula><p>where A # = A ⊗ I + I ⊗ A, with ⊗ denoting the Kronecker-product, row is an operation that takes elements of a matrix rowwise and puts them in a column vector, and irow is the inverse of the row operation.</p><p>The process vector η i (t) may be directly observed or latent with measurement model</p><formula xml:id="formula_4">y i (t) = Γ i + Λη i (t) + ζ i (t), where ζ(t) ∼ N(0, Θ), and Γ ∼ N(τ, Ψ),<label>(5)</label></formula><p>where c-length vector τ is the expected value of Γ i , which is distributed across subjects according to covariance matrix Ψ ∈ R c×c (referred to later as manifest traits -see Section 7.1). Λ ∈ R c×v is a matrix of factor loadings, y i (t) ∈ R c is a vector of manifest variables, and residual vector</p><formula xml:id="formula_5">ζ i ∈ R c has covariance matrix Θ ∈ R c×c .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.">Continuous time and SEM</head><p>Continuous time models have already been implemented as structural equation models, using either non-linear algebraic constraints <ref type="bibr" target="#b25">(Oud and Jansen 2000)</ref> or linear approximations of the matrix exponential <ref type="bibr" target="#b24">(Oud 2002)</ref>. Our formulation uses either the SEM RAM (reticular action model) specification as per <ref type="bibr" target="#b21">McArdle and McDonald (1984)</ref>, or the state space form recently added to <ref type="bibr">OpenMx (Neale et al. 2016;</ref><ref type="bibr" target="#b17">Hunter 2014)</ref>. For details on the equivalence and differences between SEM and state space modeling techniques, see <ref type="bibr" target="#b5">Chow, Ho, Hamaker, and Dolan (2010)</ref>. ctsem translates user specified input matrices and switches into an OpenMx model consisting of continuous time parameter matrices, algebraic transformations of these matrices to aid optimization (see Section 6), and algebraic transforms from the continuous time parameters to discrete time parameters for every unique time interval. Expectation matrices are then generated for each individual according to the specified inputs, constraints, and observed timing data. Optimization using either the Kalman filter or rowwise full information maximum likelihood (FIML) within OpenMx is used to estimate the parameters, typically with a first pass using a penalty term (or prior) to find a region of high probability without extreme parameters, and then a second FIML pass using the first as starting value.</p><p>To see exactly how the various matrices are transformed into a RAM SEM, one may run the following code after ctsem is installed (see Section 3). This example comprises two latent processes, three observed indicators, a time-dependent predictor, and two time-independent predictors, across three time points of observation.</p><p>R&gt; data("datastructure", package = "ctsem") R&gt; datastructure R&gt; semModel &lt;-ctModel(n.latent = 2, n.manifest = 3, TRAITVAR = "auto", + n.TIpred = 2, n.TDpred = 1, Tpoints = 3, + LAMBDA = matrix(c(1, "lambda21", 0, 0, 1, 0), nrow = 3)) R&gt; semFit &lt;-ctFit(datastructure, semModel, nofit = TRUE) R&gt; semFit$mxobj$A$labels R&gt; semFit$mxobj$S$labels R&gt; semFit$mxobj$M$labels R&gt; semFit$mxobj$F$values For more detailed information on the specification of continuous time structural equation models, the reader is referred to <ref type="bibr" target="#b25">Oud and Jansen (2000)</ref>; <ref type="bibr" target="#b0">Arnold (1974)</ref>; <ref type="bibr" target="#b29">Singer (1998)</ref>; <ref type="bibr" target="#b32">Voelkle et al. (2012)</ref>. Note that while earlier incarnations of continuous time modeling focused on approaches to implement the matrix exponential, OpenMx now includes a form of the exponential recommended in computational contexts, the scaling and squaring approach with Pade approximation <ref type="bibr" target="#b16">(Higham 2009)</ref>, which has been implemented in ctsem accordingly.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">ctsem package overview and installation</head><p>As ctsem is an R package, it requires R to be installed, available from <ref type="url" target="https://www.R-project.org/">https://www.R-project. org/</ref>. The R package OpenMx (Neale et al. 2016) is required, and although it will be installed automatically via the Comprehensive R Archive Network (CRAN) if necessary, it is recommended to download it from <ref type="url" target="http://openmx.psyc.virginia.edu/">http://openmx.psyc.virginia.edu/</ref>, to allow use of the NPSOL optimizer <ref type="bibr" target="#b10">(Gill, Murray, Saunders, and Wright 2001)</ref>. ctsem is available from CRAN at <ref type="url" target="https://CRAN.R-project.org/package=ctsem">https://CRAN.R-project.org/package=ctsem</ref>, so to install and load within R simply use: R&gt; install.packages("ctsem") R&gt; library("ctsem")</p><p>For the latest development versions, <ref type="url" target="https://github.com/cdriveraus/ctsem">https://github.com/cdriveraus/ctsem</ref> provides the Github repository, which can also be used to flag any issues noted or request support.</p><p>Estimating continuous time models via ctsem comprises four steps: First, the data must be adequately prepared (Section 4). Then, the continuous time model must be specified by creating a ctsem model object using the function ctModel (Sections 5 and 7). After specification, the model must be fit to the data using the function ctFit, after which summary and plot methods may be used to examine parameter estimates, standard errors, and fit statistics (Section 6). We will discuss these steps in the following.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Data structure</head><p>The internal functions of ctFit use data in a wide layout, with all data for each individual in a single row, including the time intervals between measurement occasions for this individual. Because this is the format used internally when fitting, for the sake of transparency it is also required as the input format, and is detailed below in Section 4.1. In some cases it may however be simpler to maintain data in a long format, and use the ctLongToWide and ctIntervalise functions we provide to convert from long format with absolute times to wide format with time intervals. This functionality is discussed in Section 4.2. The choice of time scale and treatment of the initial time point can influence results and will be discussed in Section 4.3, though first time users may find it easier to return to it later.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Wide format</head><p>This is the data format required when fitting a model with ctsem. The example data below depicts two individuals, observed at three occasions, on three manifest variables, one timedependent predictor, and two time-independent predictors. A corresponding path diagram of one possible model for this data is shown in Figure <ref type="figure">2</ref>. The data are ordered into blocks as follows: manifest process variables, time-dependent predictors, time intervals, time-independent predictors. Manifest variables are grouped by measurement occasion and ordered within this by variable. In the example there are three manifest variables (Y1, Y2, Y3) assessed across three measurement occasions. In this case, the first three columns of the data (Y1_T0, Y2_T0, Y3_T0) represent the three manifest variables at the first measurement occasion, time point 0, followed by the columns of the second measurement occasion and so on. Note that measurement occasions subsequent to the first may occur at different times for different individuals. Also note the naming convention, wherein the variable name is followed by an underscore and T, followed by an integer denoting the measurement occasion, beginning at T0. After the manifest variables, any time-dependent predictors (there need not be any) are also grouped by measurement occasion and ordered within this by variable (changed since v2.2.0). These are named in the same way as the manifest variables, with the predictor name preceded by an underscore and T, then the measurement occasion integer beginning from 0. In the data below and the model in Figure <ref type="figure">2</ref>, there is only one time dependent predictor, TD1, though more could be added. After the time-dependent predictors, T -1 time intervals are specified in chronological order, with column names dT followed by the number of the measurement occasion occurring after the interval . That is, dT1 refers to the time interval between the first measurement occasion, T0, and the second, T1. In continuous time modelling it is imperative to know the time point at which an observation takes place. Thus, while missing values on observed scores are no problem, missing values on time intervals are not allowed. Finally, two time-independent predictors (TI1, TI2 -the naming here is only with variable names) are contained in the last two columns of the data structure. Y1_T0 Y2_T0 Y3_T0 Y1_T1 Y2_T1 Y3_T1 Y1_T2 Y2_T2 Y3_T2 TD1_T0 TD1_T1 TD1_T2 1 0.44 -0.83 -0.17 1. <ref type="bibr">13 -2.44</ref>  The first three time points of a two process continuous time model, with three manifest indicators (blue) measuring 2 latent processes (purple), one time-dependent predictor (dark green), and two time-independent predictors (light green). Variance/covariance paths are in orange, regressions in red. Light gray paths indicate those that are constrained to a function of other parameters. Note that the value of parameters for all paths to latents at time 2 and higher do not directly represent the effect, rather, the effect depends on a function including the shown parameter and the time interval ∆t. Manifest intercepts are not shown here.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">Conversion from long format with absolute times</head><p>Although ctsem uses the wide format as default data input, often data are stored in long format, that is, each subject has multiple rows of data, with each row reflecting a particular measurement occasion. In addition, time intervals may not be readily available at the individual level, instead the absolute time when a measurement took place is recorded. To convert from long format, the data must contain a subject identification column, columns for every observed variable, and a time variable. Unlike for the wide format data, at this point additional unused variables in the long structure are no problem. In the example below, three manifest variables of interest (Y1, Y2, Y3) have been observed across a number of occasions, along with one time-dependent predictor (TD1) and two time-independent predictors (TI1, TI2). The variable time contains the time when the measurement took place (e.g., in weeks from the beginning of the study). <ref type="table" target="#tab_1">1,</ref><ref type="table" target="#tab_4">] 2 1.13</ref> NA 10.77 9.57 -0.44 -0.24 1.98 [5,] 2 1.66 9.49 9.66 10.09 0.09 -0.24 1.98 [6,] 2 1.87 9.58 9.28 8.10 2.83 -0.24 1.98 [7,] 2 4.75 11.82 9.95 9.70 -0.72 -0.24 1.98</p><formula xml:id="formula_6">id time Y1 Y2 Y3 TD1 TI1 TI2 [</formula><p>Given the specific wide structure required by ctsem, and that the time points of measurement may vary across individuals, restructuring from long to wide can be complicated, so we have included functions to manage this. First, the long format data with information on the absolute time of measurement must be converted to the wide format, using the ctLongToWide function. (The number of Tpoints in the generated data is also messaged to the user at this point, to be used in the next step.) Then, subject specific time intervals based on the absolute time information must be generated, using the function ctIntervalise. One should take care that the defaults used by ctIntervalise for structuring the data and handling missing time information are appropriate.<ref type="foot" target="#foot_0">foot_0</ref> R&gt; data("longexample", package = "ctsem") R&gt; wideexample &lt;-ctLongToWide(datalong = longexample, id = "id", + time = "time", manifestNames = c("Y1", "Y2", "Y3"), + TDpredNames = "TD1", TIpredNames = c("TI1", "TI2")) R&gt; wide &lt;-ctIntervalise(datawide = wideexample, Tpoints = 4, + n.manifest = 3, n.TDpred = 1, n.TIpred = 2, + manifestNames = c("Y1", "Y2", "Y3"), TDpredNames = "TD1", + TIpredNames = c("TI1", "TI2"))</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.">Choice of initial time point and time scale</head><p>Choice of initial time point: Pre-determined or stationary?</p><p>An important aspect of continuous time modeling is the choice of how to handle the initial time point. In principle, there are two different ways to do so. One approach is to treat the first time point as predetermined, where no assumptions are made about the process prior to the initial time point. In this case, parameters regarding the initial latent variable (latent means and variances, and effect of predictors) are freely estimated. This is the default in ctsem, though it requires some constraining if fitting a single individual.<ref type="foot" target="#foot_1">foot_1</ref> When treating the first time point as predetermined, it is important to choose a meaningful starting point, as the process will gradually transition from the variances and means of the initial parameters, towards those of the parameters when the model is stationary. In principle, the initial time point does not have to reflect the first measurement occasion, and can also be set to any time prior. For example it may be of interest to set T0 to the beginning of the school year, although the first measurement was only taken two weeks after start of school. This can be specified using the startoffset argument to ctIntervalise, specifying the amount of time prior to the first observed measurement occasion. The other approach is to assume a stationary model, that is, a model where the first observations are merely random instantiations of a long term process with time-invariant mean and variance expectations. Or, put another way, we assume that sufficient time has elapsed from the unobserved, hypothetical start of the process to our first measurement occasion, such that whatever the start values were, they no longer influence the process. Strictly speaking, this requires an infinite length of time, or a process that began in a stationary state. However, in some practical cases without clear trends in the data it is possible that the improvement in estimation due to the stationarity assumption outweighs related losses (this may also be tested). To implement the stationarity assumption the means and variances of the first measurement occasion are constrained according to the model predicted means and variances across all time points. This is specified by including a character vector of the T0 matrices to constrain in the ctFit arguments: stationary = c("T0VAR", "T0MEANS") constrains both means and variances to stationarity. The ctModel specification of any matrices that are constrained to stationarity is ignored. Note that any between-subject variance parameters, factor loadings, manifest residuals, as well as drift and diffusion parameters, are inherently stationary (given the configuration of ctsem). More complex model specification within ctsem, or direct modification of the generated OpenMx model, is necessary for modeling time variability in the parameters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Choice of time scale: Individual or sample relative time?</head><p>An additional consideration when treating the first time point as predetermined is necessary in cases of individually varying time intervals. Here, two alternatives need to be distinguished. The default option is to treat the observation times as relative to the individual, the other is to treat them as relative to the sample. When we treat time as relative to the individual, the first observation of every individual is set to measurement occasion T0, even though different individuals may have been recorded many years apart. However if we treat time as relative to the sample, every individual's observation times are set relative to the very first observation in the entire sample. This may result in a larger and sparser data matrix, potentially with only a single observation at the first measurement occasion. To specify sample relative time when converting from absolute time to intervals, set the argument individualRelativeTime = FALSE in the ctIntervalise function. The choice between the individual or sample relative time may influence parameter estimates when the processes are not stationary. One way of deciding between the two may be to observe whether the changes of the individuals' processes is more closely aligned with the sample relative or individual relative time. The change in processes may be more aligned with individual relative time when we expect that the activity of measurement relates to changes in the process. clinic. Different individuals may come and go from the clinic over many years, but the mean level of abstinence is likely related to when each individual began attending the clinic and being measured -not the specific date the observation took place. In contrast, sample relative time could be more appropriate for a study of linguistic abilities in a cohort of schoolchildren over the years, with some individuals observed early and some only observed later, once they are older and more developed. In this case, we may expect changes in the average linguistic ability related to sample time. Another example that becomes conveniently available with continuous time models and these functions is to arrange the data in individual relative fashion but using age as the timing variable. In this case, age-related developmental trajectories may be studied. When considering these options one should be aware that consistent up or down trends over time may confound dynamic parameter estimates, if the innovation (latent residual) at t is correlated with the process at t -1. Pre-processing approaches that remove trend components, such as controlling for age or year, removing a linear trend, or differencing scores, may provide some check on model estimates, but the ramifications of these should be carefully considered. Alternatively one may wish to explicitly model higher order components, discussed in Section 7.5.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Model specification</head><p>Continuous time models are specified via the ctModel function. This function takes as input a series of arguments and parameter matrices, and outputs a list object containing matrices to be later evaluated by the ctFit function. The ctModel function contains many defaults that should be generally applicable and safe, in that most parameters are specified to be freely estimated, with a few exceptions. 3 However, as with all default settings, they should be checked as they may not be applicable. The arguments to the ctModel function and the relation to equations in Section 2 are shown in Table <ref type="table" target="#tab_1">1</ref> (required specification) and Table <ref type="table" target="#tab_3">2</ref> (optional specification). The matrices can be specified with either character labels, to indicate free parameter names, or numeric values, which indicate fixed values. A mixture of both in one matrix is fine. These generally need to be set when constraining parameters to equality (same character label), when fixing certain parameters to specific values (for instance, when you do not wish to have a certain parameter in the model, or when testing if an effect is different from 0), or when assigning non-standard names to output parameters.</p><p>3 ctModel defaults that may not be considered safe, as they are not freely estimated by default, are the TRAITVAR and MANIFESTTRAITVAR matrices. While it is very likely that with multiple subjects one or the other matrix will need to be freed, only one of the two trait matrices can be set at once. See Section 7.1 regarding the trait matrices.  An example model specification relying heavily on the defaults is:</p><formula xml:id="formula_7">R&gt; examplemodel &lt;-ctModel(n.latent = 2, n.manifest = 2, Tpoints = 3, + LAMBDA = diag(2))</formula><p>A visual representation of this model is shown in Figure <ref type="figure" target="#fig_0">3</ref>. With n.latent = 2, we have specified a model with 2 latent processes, shown in purple. Each of these is measured by a single manifest indicator (in blue), for a total of 2 manifest variables, specified with n.manifest = 2. Loadings between latents and manifests are fixed to 1.00 (indicated by the 2 × 2 diagonal LAMBDA matrix) at 3 measurement occasions, specified by Tpoints = 3.</p><p>Because no other parameters are specified, the model defaults are used, resulting in a bivariate latent process model where each manifest variable has a measurement error variance (manifestvar_Y1_Y1, manifestvar_Y2_Y2), and a mean fixed to 0. The initial latent variables of each process have freely estimated means (T0mean_eta1, T0mean_eta2), variances (T0var_eta1_eta1, T0var_eta2_eta2), and covariance (T0var_eta2_eta1). Subsequent latent variables of each process all have an innovation term, with the variance dependent on a function of the diffusion matrix (variances diffusion_eta1_eta1, diffusion_eta2_eta2, covariance diffusion_eta2_eta1), drift matrix, and time interval ∆t. (Note that although we speak here of variance and covariance parameters for the sake of intuitive understanding, ctsem works with Cholesky decomposed covariance matrices, discussed in Section 5.0.1.) Each latent variable in our two processes has continuous auto effects on itself according to the drift_eta1_eta1 and drift_eta2_eta2 parameters (the diagonals of the drift matrix), and cross effects to the other process according to the drift_eta1_eta2 and drift_eta2_eta1 parameters (the off diagonals). This drift matrix combines with time interval ∆t to generate the auto and cross regressions shown in the diagram. As usual, the first process listed in the parameter name represents the row of the drift matrix, and the second the column, with the direction of effects flowing from column to row -so the parameter drift_eta1_eta2 represents the effect of a change in process 2 on later values of process 1. Each process has a continuous intercept, which sets the level to which each process asymptotes. These are fixed to zero by default, as the manifest intercepts (the MANIFESTMEANS matrix) account for non zero levels, by default. To see the parameter matrices or simply view a model, printing the model object (e.g., print(examplemodel)) is recommended. To track how these matrices are used within the complete SEM specification, one must first estimate the model (discussed in Section 6), and may then view the A, S, F or M matrices typical to a RAM specification <ref type="bibr" target="#b21">McArdle and McDonald (1984)</ref> via example1fit$mxobj$A (for the A matrix).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cholesky decomposed variance/covariance input matrices</head><p>To ensure reliable estimation, some parameter transformations have been implemented in ctsem for the estimation of covariance matrices. Rather than directly operating on covariance matrices, ctsem takes as input Cholesky decomposed covariance matrices, as these allow for unbounded estimation. The Cholesky decomposition is such that the variance/covariance matrix is given by Σ = LL , where L is lower-triangular. This means that input variance/covariance matrices for ctsem must be lower triangular. The meaning of a 0 in the matrix is the same for both covariance and Cholesky decomposition approaches. An important point to be aware of is that while Cholesky matrices are required as input, for convenience, the matrices reported in the summary function are full variance/covariance matrices. These can be converted to the Cholesky decomposed form using code in the form t(chol(summary(ctfitobj)$varcovmatrix)).</p><p>While not affecting interpretations of the matrix input or output, internally, by default ctsem also optimizes over the natural logarithm of the diagonal of the Cholesky factor covariance matrices. These transformations are reflected in the raw OpenMx parameter output section of the output summary (when verbose = TRUE), but otherwise require no specific knowledge or action -the logarithmic transformations take place internally, and the regular variance/covariance matrices are displayed in the summary matrices.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Model estimation</head><p>The ctFit function estimates the specified model, calling the data in wide format along with the ctsem model object. For an example, we can fit a similar model to that defined in Section 5. We first load an example data set contained in the ctsem package, then use the ctFit function for parameter estimation. Output information can be obtained via the summary function. The data set used in this example, is a simulation of the relation between leisure time and happiness for 100 individuals across 6 measurement occasions. Because our data here does not use the default manifest variable names of Y1 and Y2, but rather LeisureTime and Happiness, we must include a manifestNames character vector in our model specification.</p><p>Because each manifest directly measures a latent process, we can use the same character vector for the latentNames argument, though one could specify any character vector of length 2 here, or rely on the defaults of eta1 and eta2.</p><p>R&gt; data("ctExample1", package = "ctsem") R&gt; example1model &lt;-ctModel(n.latent = 2, n.manifest = 2, Tpoints = 6, + manifestNames = c("LeisureTime", "Happiness"), + latentNames = c("LeisureTime", "Happiness"), LAMBDA = diag(2)) R&gt; example1fit &lt;-ctFit(datawide = ctExample1, ctmodelobj = example1model)</p><p>The output of summary after fitting such a model includes the matrices representing the continuous time parameters (e.g., DRIFT), a list of estimates of only the free parameters, and fit information from the OpenMx summary function. Further information can be obtained using the argument verbose = TRUE, which will return the raw OpenMx parameter values and standard errors, as well as additional summary matrices of discrete time transformations for the time interval ∆t = 1 (e.g., discreteDRIFT), and when appropriate, asymptotic values for the parameters as the time interval ∆t approaches ∞ (e.g., asymDIFFUSION may be taken to represent the total within subject variance of a process). When appropriate, standardised matrices are also output with the suffix "std".<ref type="foot" target="#foot_2">foot_2</ref> </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>R&gt; summary(example1fit, verbose = TRUE)["discreteDRIFTstd"]</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>$discreteDRIFTstd</head><p>LeisureTime Happiness LeisureTime 0.9728 -0.0499 Happiness -0.0138 0.9146</p><p>The output above shows the standardized discrete time equivalent of the DRIFT matrix for time interval ∆t = 1. This is provided for convenience, but one should note that it only represents the temporal effects given the specific interval of 1 unit of time. (The specific interval shown for the discrete summary matrices may be modified with the argument timeInterval.) The unstandardized discreteDRIFT matrix may be calculated from the continuous drift matrix for any desired interval. The following code shows this calculation for a time interval of 2.5:</p><p>R&gt; expm(summary(example1fit)$DRIFT * 2.5)</p><p>See Equation <ref type="formula" target="#formula_2">3</ref>to understand how this arises. From the diagonals of the discreteDRIFTstd matrix we see that changes in the amount of leisure time one has tend to persist longer (indicated by a higher autoregression) than happiness. The cross-regression in row 2 column 1 suggests that as leisure time increases, this tends to be followed by decreases in happiness.</p><p>Similarly, the cross-regression in row 1 column 2 suggests that as happiness increases, this tends to be followed by decreases in leisure time. While these results are accurate for the specified model, the specified model is likely inappropriate for this data, which we explain more of in Section 7.1 on unobserved heterogeneity.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1.">Comparing different models</head><p>Suppose we wanted to test the model we fit above against a model where the effect of happiness on later leisure time (parameter drift_LeisureTime_Happiness) was constrained to 0. First we specify and fit the model under the null hypothesis by taking our previous model and fixing the desired parameter to 0:</p><formula xml:id="formula_8">R&gt; testmodel &lt;-example1model R&gt; testmodel$DRIFT[1, 2] &lt;-0 R&gt; testfit &lt;-ctFit(datawide = ctExample1, ctmodelobj = testmodel)</formula><p>The result may then be compared to the original model with a likelihood ratio test, using the OpenMx function mxCompare. To use this function a base model fit object and a comparison model fit object must be specified, with the latter being a constrained version of the former. Note that ctsem stores the original OpenMx fit object under a $mxobj sub-object, which must be referenced when using OpenMx functions directly.</p><p>R&gt; According to the conventional p &lt; 0.05 criterion, results show that the more constrained model fits the data significantly worse, that is, happiness has a significant effect on later leisure time for this model and data. An alternative to this approach is to estimate 95% profile-likelihood confidence intervals for our parameters of interest, from our already fit model:</p><formula xml:id="formula_9">R&gt; example1cifit &lt;-ctCI(example1fit, confidenceintervals = "DRIFT")</formula><p>lbound estimate ubound note drift_LeisureTime_LeisureTime -0.0468 -0.0280 -0.0125 drift_LeisureTime_Happiness -0.1083 -0.0697 -0.0377 drift_Happiness_LeisureTime -0.0312 -0.0111 0.0087 drift_Happiness_Happiness -0.1486 -0.0896 -0.0459</p><p>Now the summary function reports 95% confidence bounds for the continuous drift parameters, which in case of drift_Happiness_LeisureTime (DRIFT[1, 2]) does not include 0. For complicated models, the estimation of confidence intervals may increase computation time considerably. One could also compute a confidence interval by multiplying the standard error of the estimate (returned in the summary) by 1.96, however profile-likelihood confidence intervals are in general recommended as they do not assume symmetric intervals, which may be quite unlikely for such models. We have observed, however, that optimization difficulties can sometimes result in inacccurate (extremely close to the point estimate, accuracy can be checked in the lower and upper delta returned by example1cifit$mxobj$intervals subobject) or missing profile-likelihood confidence intervals, so the use of standard error based intervals can provide a helpful sanity check.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2.">Plots</head><p>A visual depiction of the relationships between the processes over time is given by the plot method for 'ctsemFit' objects, i.e., for any fit object created by ctFit. Depending on arguments, this function can show the processes' mean trajectories, within-subject variance, autoregression, and cross regression plots, as well as plots showing expected changes in each process given either an observed change of 1.00, or an exogenous input of 1.00. (The former is a mixture of the DIFFUSION and DRIFT matrices, while the latter is just an alternative representation of the auto and cross regression plots.) Autoregression plots show the impact of a 1 unit change in a process on later values of that process, while cross regression plots ctsem: Continuous Time Structural Equation Modeling in R</p><p>show the impact of a 1 unit change in one process on later values of other processes. Some examples can be seen in Figure <ref type="figure" target="#fig_1">4</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">Continuous time models: Extensions</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.1.">Unobserved heterogeneity</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Traits at the latent level</head><p>When modeling panel data, the continuous intercept parameter κ reflects the expected value for continuous time intercept ξ, which determines the average level of a process (κ is fixed to 0 in ctsem by default, as free manifest means account for non zero equilibrium levels in the data). In panel data, however, it is common that individuals exhibit stable differences in the level. Within ctsem we call such stable differences traits, but they may also be thought of more abstractly as unit level or between subject differences, or unobserved heterogeneity.</p><p>Fitting a model that fails to account for it will result in parameter estimates that will not reflect the processes of individual subjects, but will mix between and within-person information <ref type="bibr" target="#b1">(Balestra and Nerlove 1966;</ref><ref type="bibr" target="#b25">Oud and Jansen 2000;</ref><ref type="bibr" target="#b13">Halaby 2004</ref>). To avoid this bias, individual differences can be incorporated in two different ways. One way is to control for observed covariates as will be discussed in Section 7.2.1. However as covariates are likely to be insufficient, one may also estimate the latent trait variance by estimating the variance and covariance φ ξ of the intercept parameters ξ across individuals. <ref type="foot" target="#foot_3">5</ref> In ctsem, freely estimated latent trait variances and covariances may be added with the argument TRAITVAR = "auto" to the ctModel command. If the user is interested in a specific variance-covariance structure, it is of course also possible to specify the n.latent × n.latent lower-triangular matrix of free or fixed parameters by hand. To illustrate the inclusion of trait variance, we fit the same model on simulated leisure time and happiness introduced above, but also model the traits.</p><p>R&gt; data("ctExample1", package = "ctsem") R&gt; traitmodel &lt;-ctModel(n.manifest = 2, n.latent = 2, Tpoints = 6, + LAMBDA = diag(2), manifestNames = c("LeisureTime", "Happiness"), + latentNames = c("LeisureTime", "Happiness"), TRAITVAR = "auto") R&gt; traitfit &lt;-ctFit(datawide = ctExample1, ctmodelobj = traitmodel)</p><p>From Figure <ref type="figure" target="#fig_1">4</ref>, we can see that after accounting for differences in the trait levels of leisure time and happiness, the estimated auto and cross regression effects between latent processes are very different. Auto effects (persistence) have reduced, and the magnitude and sign of the cross effects have switched. Now, rather than a decrease in leisure time predicting an increase in happiness, after controlling for unobserved heterogeneity we see instead that increases in leisure time predict later increases in happiness. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Traits at the indicator level</head><p>Beyond differences in the level of the latent process, it is also possible that stable individual differences in the level of some or all indicators of a process may exist, and as such may be better accounted for at the measurement level. Take for instance a latent process, happiness, estimated using three survey questions at 10 time points for multiple individuals. According to the models we have described so far, the estimated manifest means apply equally to all individuals. However, consider that question three queries happiness with work, which may for some people be consistently high, independent of their actual latent happiness, and for some may be consistently low. Calculating the latent process using the same mean for happiness with work again confounds between and within person information, but we can account for this by using what we will refer to as manifest traits -an additional, time invariant variance-covariance structure on the measurement level. These are specified by including the MANIFESTTRAITVAR matrix in the ctModel specification, either as MANIFESTTRAITVAR = "auto" wherein time invariant variance and covariance for all indicators is freely estimated, or the n.manifest × n.manifest lower-triangular matrix can be specified explicitly as usual. Such a specification may allow for improved fit of factor models, more realistic estimates of the dynamics of individual processes, and the testing of measurement related hypotheses. Note however that identifying restrictions will be necessary for any model that contains both manifest and process level traits -one possible form for this may be a free process level TRAITVAR matrix and a MANIFESTTRAITVAR matrix that is fixed to 0 across factors, but free within any factors that are measured by more than one indicator.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.2.">Predictors</head><p>ctsem allows the inclusion of time-independent as well as time-dependent exogenous predictors. Time-independent predictors could be variables such as gender, personality or sociodemographic background variables that remain constant over time. An example of a timedependent predictor could be a financial crisis, which all individuals in the sample experience at the same time, or the death of a loved one, which only some individuals may experience and for whom the time point of the event may differ. Both events may be thought of as adding some relatively distinct and sudden change to an individual's life, which influences the processes of interest. Time-dependent predictors are distinguished from the endogenous latent processes in that they are assumed to be independent of fluctuations in the processeschanges in the latent processes do not lead to changes in the predictor. Furthermore, no temporal structure between different time points is modeled. Because of these two assumptions, in any case where the time-dependent predictor depends on earlier values of either itself or the latent process, it may be better to model it as an additional latent process.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Time-independent predictors</head><p>Time-independent predictors are added by including the data as per the structures shown in Section 4, and specifying the number of time independent predictors, n.TIpred, in the ctModel arguments. If not using the default variable naming, a TIpredNames character vector should also be specified. For an example, we add the "number of close friends" as a timeindependent predictor to the earlier leisure time and happiness model. Note that, just like in any conventional regression analysis, if time-independent predictors are not centered around 0, the estimate of continuous intercept parameters depends on the mean of the predictor.</p><p>R&gt; data("ctExample1TIpred", package = "ctsem") R&gt; tipredmodel &lt;-ctModel(n.manifest = 2, n.latent = 2, n.TIpred = 1, + manifestNames = c("LeisureTime", "Happiness"), + latentNames = c("LeisureTime", "Happiness"), + TIpredNames = "NumFriends", Tpoints = 6, LAMBDA = diag(2), + TRAITVAR = "auto") R&gt; tipredfit &lt;-ctFit(datawide = ctExample1TIpred, ctmodelobj = tipredmodel) R&gt; summary(tipredfit, verbose = TRUE)["TIPREDEFFECT"] R&gt; summary(tipredfit, verbose = TRUE)["discreteTIPREDEFFECT"] R&gt; summary(tipredfit, verbose = TRUE)["asymTIPREDEFFECT"] R&gt; summary(tipredfit, verbose = TRUE)["addedTIPREDVAR"] The matrices output from summary, verbose = TRUE will now include matrices related to time-independent predictors, while the estimated parameters now also includes a range of variance, covariance, and effect parameters for time-independent predictors. Matrix TIPREDEFFECT displays the continuous time effect parameters, however discreteTIPREDEFFECT shows the effect added to the processes for each unit of time, which may provide a useful comparison with discrete time models. asymTIPREDEFFECT (asymptotic time-independent predictor effect) shows the expected total change in process means given an increase of 1 on the time independent predictor. From these matrices we see that the number of close friends has a negative relationship to leisure time, but a positive relationship to happiness. The final matrix, addedTIPREDVAR, displays the stable between-subject variance and covariance in the processes accounted for by the time-independent predictors.</p><formula xml:id="formula_10">$</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Time-dependent predictors</head><p>ctsem allows the specification of time-dependent predictors: The fundamental form of such a predictor is that of a sudden impulse to the system which then dissipates back to the process mean, however with some thought it is possible to specify a wide range of effect shapes. Figure <ref type="figure" target="#fig_2">5</ref> provides an example of two different extremes, the basic impulse form and a permanent level change form.</p><p>A single time-dependent predictor can be incorporated in a ctsem model by adding the argument n.TDpred = 1 to the ctModel function, as well as a TDpredNames vector if not using the default variable naming in your data, then fitting as usual. In the following example, we use the same two simulated processes as above and include an intervention that all individuals experience at time 5. For example, let us assume everyone receives a large amount of money and we are interested in the impact of this monetary gift on leisure time and happiness. We expect that some short term increase in both leisure time and happiness may occur, as people may take holidays or enjoy the unexpected boon otherwise, but we also want to check whether the gift we provide may also cause a longer term adjustment in leisure time or happiness. To this end we first fit a model with the basic impulse effect, coded in the data as a 1 when the intervention occurs and a 0 otherwise.<ref type="foot" target="#foot_4">foot_4</ref> R&gt; data("ctExample2", package = "ctsem") R&gt; tdpredmodel &lt;-ctModel(n.manifest = 2, n.latent = 2, n.TDpred = 1, + Tpoints = 8, manifestNames = c("LeisureTime", "Happiness"), + TDpredNames = "MoneyInt", latentNames = c("LeisureTime", "Happiness"), + LAMBDA = diag(2), TRAITVAR = "auto") The matrices reported from summary(tdpredfit, verbose = TRUE) will now include those related to the time-dependent predictor, and the parameters section will include all the additional free parameters estimated, including many variance and covariance related parameters, and the effect parameters TDpred_LeisureTime_MoneyInt and TDpred_Happiness_MoneyInt.</p><p>Looking at the summary matrices, TDPREDEFFECT shows us the initial impact of the predictor on the processes. From the matrices, we can see that the monetary intervention relates directly to subsequent increases in both leisure time and happiness. Standardized estimates are not provided because we assume no model for the variance of time-dependent predictors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Adding a level change predictor</head><p>To test the longer term changes introduced via the monetary intervention, we must model the impact of the predictor via an intermediate latent process: We fix the intercepts (T0MEANS and CINT) and random variances (T0VAR, DIFFUSION, and TRAITVAR) of this additional process to 0; set changes to persist indefinitely via a diagonal DRIFT value very close to 0 (precisely 0 causes computational problems); fix the impact of the predictor on the new process to 1 (to identify the effect); fix the impact of the two original latent processes on the new process to 0 (via the off-diagonals in the third row of DRIFT); and estimate the impact of the additional process on our original two processes of interest (via the off-diagonals in the third column of DRIFT). Alternatively, one could also estimate the time course of predictor effects by freeing the DRIFT diagonal of the additional process.</p><p>R&gt; data("ctExample2", package = "ctsem") R&gt; tdpredlevelmodel &lt;-ctModel(n.manifest = 2, n.latent = 3, n.TDpred = 1, + Tpoints = 8, manifestNames = c("LeisureTime", "Happiness"), + TDpredNames = "MoneyInt", + latentNames = c("LeisureTime", "Happiness", "MoneyIntLatent"), + LAMBDA = matrix(c(1, 0, 0, 1, 0, 0), ncol = 3), TRAITVAR = "auto") </p><formula xml:id="formula_11">R&gt; tdpredlevelmodel$TRAITVAR[3, ] &lt;-0 R&gt; tdpredlevelmodel$TRAITVAR[, 3] &lt;-0 R&gt; tdpredlevelmodel$DIFFUSION[, 3] &lt;-0 R&gt; tdpredlevelmodel$DIFFUSION[3, ] &lt;-0 R&gt; tdpredlevelmodel$T0VAR[3, ] &lt;-0 R&gt; tdpredlevelmodel$T0VAR[, 3] &lt;-0 R&gt; tdpredlevelmodel$CINT[3] &lt;-0 R&gt; tdpredlevelmodel$T0MEANS[3] &lt;-0 R&gt; tdpredlevelmodel$TDPREDEFFECT[1:3, ] &lt;-c(0, 0, 1) R&gt; tdpredlevelmodel$DRIFT[3, ] &lt;-c(0, 0, -0.000001) R&gt; tdpredlevelfit &lt;-ctFit(datawide = ctExample2, + ctmodelobj =</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.3.">N = 1 time series with multiple indicators</head><p>In the examples so far, we have dealt with multiple individuals with relatively few measurement occasions, and latent processes have been estimated by a single indicator. However, ctsem may also be used for the analysis of time series data for single subjects observed at many measurement occasions, as well as the estimation of latent factors estimated from multiple indicators. With single-subject data, a Kalman filter implementation is typically far quicker than the matrix arrangement we use for multiple subjects, however ctsem allows either to be used. To illustrate these features, we perform a dynamic factor analysis on a single individual, with three manifest indicators measured at 50 occasions. Because the model is fitted to a single individual, we cannot freely estimate both the latent variance and mean at the first measurement occasion, but we must fix the 1 × 1 T0VAR matrix to a reasonable value, or implement stationarity constraints as discussed in Section 4.3. The precise fixed value becomes unimportant as the time series length increases <ref type="bibr" target="#b8">(Durbin and Koopman 2012)</ref>. Note that in this example the LAMBDA matrix specifies a loading of 1.00 for manifest Y1 (for identification), while loadings for Y2 and Y3 are freely estimated. Note also that although ctsem uses the Kalman filter by default when a single subject is specified, this can be overridden by specifying the objective = "mxRAM" argument to ctFit, if one wishes to use the slower RAM implementation. The Kalman filter may also be specified for multiple subjects.</p><p>In this case, between subject trait or time independent predictor matrices are ignored -one may need to account for consistent differences between subjects through pre-processing or thoughtful expansion of the state matrices.</p><p>R&gt; data("ctExample3", package = "ctsem") R&gt; model &lt;-ctModel(n.latent = 1, n.manifest = 3, Tpoints = 100, + LAMBDA = matrix(c(1, "lambda2", "lambda3"), nrow = 3, ncol = 1), + MANIFESTMEANS = matrix(c(0, "manifestmean2", "manifestmean3"), + nrow = 3, ncol = 1)) R&gt; fit &lt;-ctFit(data = ctExample3, ctmodelobj = model, objective = "Kalman", + stationary = "T0VAR")</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.4.">Multiple group continuous time models</head><p>In some cases, certain groups or individuals may exhibit different model parameters. We can investigate group or individual level differences by specifying a multiple group model using the ctMultigroupFit function. For this example, we will use the same model structure as in the single subject example from Section 7.3, but apply it to two groups of 10 individuals, whom we expect to exhibit differences in the loading of the third manifest variable. When using ctMultigroupFit, all parameters are free across groups by default. However, in addition to the standard model specification you may also specify either a fixed model, or a free model.</p><p>A fixed model should be of the same structure as the base model, with any parameters you wish to constrain across groups set to the character string "groupfixed". The value for any other parameters is not important. Alternatively, one may specify a free model, where any parameters to freely estimate for each group are given the label "groupfree", and all others will be constrained across groups. In this example, because we only want to examine group differences on one parameter, we specify a free model in which the loading parameter between manifest3 and our latent process eta1 is labeled "groupfree" -this estimates distinct lambda3 parameters for each group, and constrains all other parameters across the two groups to equality. The group specific parameter estimates will appear in the resulting summary prefixed by the specified grouping vector. This is the final requirement for ctMultigroupFit and is simply a vector specifying a group label for each row of our data. In this case we have groups one and two, containing the first and the last 10 rows of data respectively, prefixed by the letter "g" to denote group.</p><p>R&gt; data("ctExample4", package = "ctsem") R&gt; basemodel &lt;-ctModel(n.latent = 1, n.manifest = 3, Tpoints = 20, + LAMBDA = matrix(c(1, "lambda2", "lambda3"), nrow = 3, ncol = 1), + MANIFESTMEANS = matrix(c(0, "manifestmean2", "manifestmean3"), + nrow = 3, ncol = 1)) R&gt; freemodel &lt;-basemodel R&gt; freemodel$LAMBDA[3, 1] &lt;-"groupfree" R&gt; groups &lt;-paste0("g", rep(1:2, each = 10)) R&gt; multif &lt;-ctMultigroupFit(datawide = ctExample4, groupings = groups, + objective = "Kalman", ctmodelobj = basemodel, freemodel = freemodel) g1_lambda3 g2_lambda3 1.417 0.208</p><p>Looking at the estimated parameters from the $omxsummary (OpenMx) portion of summary, verbose = TRUE, we indeed see a difference between parameters g1_lambda3 (group 1) and g2_lambda3 (group 2), and could test this with the usual approaches discussed in Section 6.1.</p><p>A point to note is that the multiple group and Kalman filter implementations can be easily combined by specifying a distinct group for each row of data. This can allow for a mixture of individual and group level parameters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.5.">Higher order models and simulating data</head><p>In the models discussed so far, the individual processes were only conceived of as first order processes, always tending to revert to baseline when away from it. However, what about a situation where we have variables which show very slow patterns of change, upwards or downwards trajectories that are maintained over many observations? This can provide for oscillations and slower patterns of change, as for example with damped linear oscillators, or moving average like effects as from the ARMA modeling framework.</p><p>Continuous time models of this variety are theoretically plausible, as changes to the level of a process are not necessarily always random in direction with a tendency to baseline, but may depend on contextual circumstances that have some persistence. Consider an individual's overall health over the course of 20 years, sampled every few months. If the individual changes exercise or eating habits, changes in health do not manifest instantly, rather we could expect either a slow increase or slow reduction, depending on whether the change of habits was positive or negative. Thus, for many measurements, the change in health from the previous measurement will likely be in the same direction as the change was one step earlier. The following details how to specify such a model, generate data using the ctGenerate function, simply plot the generated data, and estimate the parameters.</p><p>R&gt; genm &lt;-ctModel(Tpoints = 200, n.latent = 2, n.manifest = 1, + LAMBDA = matrix(c(1, 0), nrow = 1, ncol = 2), + DIFFUSION = matrix(c(0, 0, 0, 1), 2), + MANIFESTVAR = t(chol(diag(.6, 1))), + DRIFT = matrix(c(0, -0.1, 1, -0.2), nrow = 2), + CINT = matrix(c(1, 0), nrow = 2)) R&gt; data &lt;-ctGenerate(genm, n.subjects = 1, burnin = 200) rameters close (but not too close!) to 0, and then uses these estimates as starting values for maximum likelihood estimation. Though often useful, in some cases (particularly those with complex dynamics, or user specified starting values) it can help to switch this off. Beyond this, as a general guideline we suggest starting with simpler, more constrained models and freeing parameters in a stepwise fashion (not necessary as a means of model development, simply for fitting purposes). The ctRefineTo function can be used as a replacement for ctFit and automates this stepwise progression. One could do this manually by developing the measurement model separately, estimating only autoregressive parameters of the DRIFT matrix at first (in simple models, this means constraining the off-diagonals of the DRIFT matrix to 0), or fixing the factor loading matrix prior to free estimation. For such stepwise progression, the default of small and negative starting values for cross effects should be switched off by argument crossEffectNegStarts = FALSE, and starting values from the restricted model should be obtained via the omxStartValues argument, as shown here, using the model fit from from Section 6: R&gt; omxInits &lt;-omxGetParameters(example1fit$mxobj) R&gt; fitWithInits &lt;-ctFit(data = ctExample1, ctmodelobj = example1model, + omxStartValues = omxInits)</p><p>If stepwise model building with starting values based on simpler fits still fails to produce an improved solution, some of the following suggestions may be helpful. The time scale, although theoretically unimportant in the sense that all time ranges can be accounted for, can be computationally relevant. It is helpful to choose a scale that roughly matches the expected dynamics -for instance a time scale of nanoseconds for panel data measured yearly would be problematic, instead, a yearly or monthly time scale could be used. Centering the grand mean of the variables to 0 may help, as can standardizing the variances, particularly in cases where both a measurement model and dynamic model are estimated. One way to search for an improved solution is simply to try many times with varying starting values. This is automated by default using the mxTryHard function from OpenMx, however you may want to increase the retryattempts argument to ctFit, or simply re-run ctFit many times, as it generates unspecified starting values with some limited randomness. However, since both automated procedures begin within a similar range, for truly problematic cases one may consider adding more extensive randomness to the starting values manually. In situations with a limited number of time points or of high complexity, you may implement the stationarity assumption, so that parameters related to the first time point are no longer estimated, but constrained to the asymptotic effects, when the time interval ∆t → ∞. This can make optimization more straightforward, and may serve as a useful basis for determining starting values, or as a viable model in itself. For more discussion regarding stationarity conditions see Section 4.3. In some cases, optimizing over the continuous time parameters (the default) results in fits that do not pass every check and you may be left with warnings.</p><p>If this occurs, you can instead optimize over asymptotic variants of the parameters, by using the argument asymptotes = TRUE to ctFit. This will in general produce equivalent results if the DIFFUSION, CINT, and TIPRED matrices are all freely estimated, even though the raw parameters of these matrices will look different. If these matrices have been constrained in some way, this approach is not recommended.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.1.">Optimization performance</head><p>When time intervals vary for every individual, optimization can be quite slow. To quickly estimate approximate versions of a model, you may use the meanIntervals = TRUE argument to ctFit, which will set every individual's time intervals to the mean of the interval across all individuals. A step further even is to specify the argument objective = "cov" in order to estimate a covariance matrix from the supplied data and fit directly to that. In cases with variability in time intervals these approaches will substantially speed up optimization, but also waste information and bias parameters. Using such an approach in combination with a constrained DRIFT matrix to generate starting values may be a reasonable way to improve fitting speed and generate starting values for large and complex models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="9.">Limitations and future directions</head><p>Currently, a number of assumptions are present in the specification of continuous time models implemented in ctsem. Although the processes are allowed to begin at different levels and variances, from then on a time-invariant model is assumed. Thus, ctsem cannot presently account for time-varying aspects of the processes, except in the form of observed exogenous inputs via time-dependent predictors. Although as with many discrete models we could free various parameters across measurement occasions, their meaning would become unclear, as each measurement occasion (set of n.manifest columns in the wide format data) may contain observations from many different times. Instead, models which allow parameters to vary as a function of time could be incorporated in the future as per the time-varying specification in <ref type="bibr" target="#b25">Oud and Jansen (2000)</ref>. As we fit using full information maximum likelihood, standard assumptions regarding multivariate normality apply to manifest variables. Generalizations of the measurement model to allow for non-normal indicators could be implemented using the regular OpenMx functionality however. Although we allow for heterogeneity in the level of the processes across individuals, heterogeneity in other parameters is not accounted for, and can only be examined via multiple group approaches. Presently, effects are assumed to be transmitted near instantaneously, as we do not estimate a dead time between inputs and the effect of inputs. We believe this is unlikely to severely impact estimates unless the dead time is of a similar or greater order of magnitude as the time course of effects, however such a parameter could potentially be incorporated within the continuous time equations <ref type="bibr" target="#b27">(Richard 2003)</ref>. Although in such areas ctsem may benefit from expansion, ctsem as it stands allows for the straightforward specification of continuous time dynamic models for both panel and time series data, which may include a measurement model, exogenous predictors, multiple processes, unobserved heterogeneity, multiple groups, as well as easy to specify parameter constraints and more complex dynamic specifications.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 3 :</head><label>3</label><figDesc>Figure3: A two process continuous time model with manifest indicators (blue) measuring latent processes (purple). Variance/covariance paths are in orange, regressions in red. Light gray paths indicate those that are either fixed to certain values or constrained to other parameters. Note that the value of the parameters for all paths to latents at time 2 and higher do not directly represent the effect, rather, the effect depends on a function of the shown parameter and the time interval ∆t. This model includes neither observed or unobserved between person variance, nor any time-dependent predictors. Manifest intercepts are not shown.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: Top row shows parameter plots without accounting for trait variance, bottom row with trait variance accounted for. Plots show how auto and cross effects change depending on the length of time between observations.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Two shapes of time-dependent predictors: Both plots show 5 selected individuals data, all experiencing a time-dependent predictor at time point 5. The model-based expected trajectory of the predictor effect (including autoregression) is also shown as a solid black line. On the left, the processes spike up and then dissipate, reflecting a transient change, or impulse. On the right, the processes trend upwards towards a new equilibrium, reflecting a stable change in the level.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 :</head><label>1</label><figDesc>Required arguments for ctModel.</figDesc><table><row><cell>Argument</cell><cell cols="2">Symbol Meaning</cell></row><row><cell cols="2">n.manifest c</cell><cell>Number of manifest indicators per individual at each measurement</cell></row><row><cell></cell><cell></cell><cell>occasion.</cell></row><row><cell>n.latent</cell><cell>v</cell><cell>Number of latent processes.</cell></row><row><cell>Tpoints</cell><cell></cell><cell>Number of time points, or measurement occasions, in the data.</cell></row><row><cell>LAMBDA</cell><cell>Λ</cell><cell>n.manifest × n.latent loading matrix relating latent to manifest</cell></row><row><cell></cell><cell></cell><cell>variables.</cell></row></table><note><p>Consider for instance the relation between abstinence behavior and mood among individuals attending an alcohol addiction</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Table 2 :</head><label>2</label><figDesc>Optional arguments for ctModel -Part 1.</figDesc><table><row><cell>Argument</cell><cell cols="2">Symbol Default</cell><cell>Meaning</cell></row><row><cell>TRAITTDPREDCOV</cell><cell></cell><cell>0</cell><cell>n.latent rows × (n.TDpred × Tpoints)</cell></row><row><cell></cell><cell></cell><cell></cell><cell>columns covariance matrix for latent traits</cell></row><row><cell></cell><cell></cell><cell></cell><cell>and time-dependent predictors.</cell></row><row><cell>TDTIPREDCOV</cell><cell></cell><cell>0</cell><cell>(n.TDpred × Tpoints) rows × n.TIpred</cell></row><row><cell></cell><cell></cell><cell></cell><cell>columns covariance matrix between time-</cell></row><row><cell></cell><cell></cell><cell></cell><cell>dependent and independent predictors.</cell></row><row><cell>n.TIpred</cell><cell>p</cell><cell>0</cell><cell>Number of time-independent predictors.</cell></row><row><cell>TIpredNames</cell><cell></cell><cell cols="2">TI1, TI2, etc. n.TIpred length character vector of time-</cell></row><row><cell></cell><cell></cell><cell></cell><cell>independent predictor names.</cell></row><row><cell>TIPREDMEANS</cell><cell></cell><cell>free</cell><cell>n.TIpred × 1 matrix of time-independent</cell></row><row><cell></cell><cell></cell><cell></cell><cell>predictor means.</cell></row><row><cell>TIPREDEFFECT</cell><cell>B</cell><cell>free</cell><cell>n.latent × n.TIpred effect matrix of</cell></row><row><cell></cell><cell></cell><cell></cell><cell>time-independent predictors on latent</cell></row><row><cell></cell><cell></cell><cell></cell><cell>processes.</cell></row><row><cell>T0TIPREDEFFECT</cell><cell></cell><cell>free</cell><cell>n.latent × n.TIpred effect matrix of</cell></row><row><cell></cell><cell></cell><cell></cell><cell>time-independent predictors on latents at</cell></row><row><cell></cell><cell></cell><cell></cell><cell>T0.</cell></row><row><cell>TIPREDVAR</cell><cell></cell><cell>free</cell><cell>Lower triangular n.TIpred × n.TIpred</cell></row><row><cell></cell><cell></cell><cell></cell><cell>Cholesky matrix of time-independent pre-</cell></row><row><cell></cell><cell></cell><cell></cell><cell>dictors variance/covariance.</cell></row><row><cell>startValues</cell><cell></cell><cell>NULL</cell><cell>A named vector, where the names of each</cell></row><row><cell></cell><cell></cell><cell></cell><cell>value must match a parameter in the spec-</cell></row><row><cell></cell><cell></cell><cell></cell><cell>ified model, and the value sets the starting</cell></row><row><cell></cell><cell></cell><cell></cell><cell>value for that parameter during optimiza-</cell></row><row><cell></cell><cell></cell><cell></cell><cell>tion.</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 3 :</head><label>3</label><figDesc>Optional arguments for ctModel -Part 2.</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head></head><label></label><figDesc>Now, if we look at column 3 of the DRIFT matrix, we see that the monetary intervention process appears to cause long term increases in leisure time, but potentially reductions in happiness.</figDesc><table><row><cell></cell><cell cols="2">tdpredlevelmodel)</cell><cell></cell></row><row><cell cols="4">R&gt; summary(tdpredlevelfit, verbose = TRUE)[c("DRIFT", "TDPREDEFFECT")]</cell></row><row><cell>$DRIFT</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell cols="3">LeisureTime Happiness MoneyIntLatent</cell></row><row><cell>LeisureTime</cell><cell>-0.1393</cell><cell>-0.0394</cell><cell>0.569907</cell></row><row><cell>Happiness</cell><cell>0.0798</cell><cell>-0.1038</cell><cell>-0.357674</cell></row><row><cell>MoneyIntLatent</cell><cell>0.0000</cell><cell>0.0000</cell><cell>-0.000001</cell></row><row><cell>$TDPREDEFFECT</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>MoneyInt</cell><cell></cell><cell></cell></row><row><cell>LeisureTime</cell><cell>0</cell><cell></cell><cell></cell></row><row><cell>Happiness</cell><cell>0</cell><cell></cell><cell></cell></row><row><cell>MoneyIntLatent</cell><cell>1</cell><cell></cell><cell></cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0"><p>By default, when timing information is missing, variables measured at that time are also set to NA for the individual missing the information. Once this is done the actual time of measurement no longer influences parameter estimates or likelihood, so we can set it to an arbitrary minimum interval. By default, the mininterval argument to ctIntervalise is set to 0.001. This argument must be set lower than the minimum time interval recorded in the data, so that later observations can be adjusted without problems.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_1"><p>Either "T0VAR" or "T0MEANS" must be fixed, see Section 7.3.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="4" xml:id="foot_2"><p>Standardisations are based on only the relevant variance, not the total. For instance, DRIFT parameters are standardised using only the within-subject variance, asymDIFFUSION, because DRIFT parameters are typically intended to represent individual, or average individual, temporal dynamics.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="5" xml:id="foot_3"><p>Note that this is a substantially different approach to achieve unbiased effect estimates than the fixed effects approach (see for example<ref type="bibr" target="#b22">Mundlak 1978)</ref>, as our SEM specification, while a random effects model which have at times been associated with bias for within effects, allows unbiased estimation of within and between effects at the same time. For further details on the estimation of unobserved heterogeneity in an SEM context, see<ref type="bibr" target="#b2">Bollen and Brand (2010)</ref>.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6" xml:id="foot_4"><p>While this form of dummy coding works well, if there are predictors with no variance and the TDPREDVAR matrix is not specified, ctsem warns the user and fixes TDPREDVAR to a diagonal matrix with small variance.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="7" xml:id="foot_5"><p>The sum of squares of each parameter that is neither factor loading nor mean related is added to the likelihood, as is the inverse of any parameters on the diagonals of square matrices -essentially penalizing values at the extremes.</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgments</head><p>We would like to thank the <rs type="institution">Intra Person Dynamics</rs> and the Formal Methods research groups at the <rs type="institution">Max Planck Institute for Human Development</rs> for assistance with this work, as well as <rs type="person">Joshua Pritikin</rs> and the OpenMx development team for feedback and fast response to issues. The knitr <ref type="bibr" target="#b35">(Xie 2015)</ref> and <rs type="funder">Ωnyx (von Oertzen</rs>, <rs type="person">Brandmaier</rs>, and Tsang 2015) software packages were invaluable in constructing this document.</p></div>
			</div>
			<listOrg type="funding">
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>R&gt; ctIndplot(data, n.subjects = 1 , n.manifest = 1, Tpoints = 200) R&gt; model &lt;-ctModel(Tpoints = 200, n.latent = 2, n.manifest = 1, + LAMBDA = matrix(c(1, 0), nrow = 1, ncol = 2), + DIFFUSION = matrix(c(0, 0, 0, "diffusion"), 2), + DRIFT = matrix(c(0, "regulation", 1, "diffusionAR"), nrow = 2)) R&gt; fit &lt;-ctFit(data, model, stationary = "T0VAR")</p><p>In the above, we focus on a model for a single subject, and specify with LAMBDA that a single manifest variable measures only the first latent process. With DIFFUSION we specify that only the 2nd unobserved process experiences random innovations. With DRIFT, we specify that the 2nd process has a freely estimated autoregression term, that it directly impacts the first process with a 1:1 relationship, and that as the level of the first process increases, the level of the 2nd process decreases -providing necessary regulation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Damped linear oscillator</head><p>Voelkle and Oud (2013) discuss modeling a damped linear oscillator in detail, however here we demonstrate how to load the data and fit the oscillating model from their paper. In this case, we also specify good starting values with the startValues argument to ctModel, and because of this, set the argument carefulFit = FALSE. R&gt; data("Oscillating", package = "ctsem") R&gt; inits &lt;-c <ref type="bibr">(-39, -0.3, 1.01, 10.01, 0.1, 10</ref>.01, 0.05, 0.9, 0) R&gt; names(inits) &lt;-c("crosseffect", "autoeffect", "diffusion", + "T0var11", "T0var21", "T0var22", "m1", "m2", "manifestmean") R&gt; oscillatingm &lt;-ctModel(n.latent = 2, n.manifest = 1, Tpoints = 11, + MANIFESTVAR = matrix(0, nrow = 1, ncol = 1), + LAMBDA = matrix(c(1, 0), nrow = 1, ncol = 2), + T0MEANS = matrix(c("m1", "m2"), nrow = 2, ncol = 1), + T0VAR = matrix(c("T0var11", "T0var21", 0, "T0var22"), + nrow = 2, ncol = 2), + DRIFT = matrix(c(0, "crosseffect", 1, "autoeffect"), + nrow = 2, ncol = 2), + MANIFESTMEANS = matrix("manifestmean", nrow = 1, ncol = 1), + DIFFUSION = matrix(c(0, 0, 0, "diffusion"), nrow = 2, ncol = 2), + startValues = inits) R&gt; oscillatingf &lt;-ctFit(Oscillating, oscillatingm, carefulFit = FALSE)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.">Further specification options and tips for model estimation</head><p>Given the complexity of parameter constraints, and that for some classes of models multiple minima may exist, parameter estimation is sometimes difficult. To ensure reliable estimation, there are some additional approaches that may be helpful. By default the argument carefulFit = TRUE for the ctFit function is specified. This initiates a two-step procedure, in which the first step penalizes the likelihood 7 to help maintain potentially problematic pa-</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Comparison to discrete time approach</head><p>To highlight the problems associated with treating all time intervals in a data set as equivalent, in this example we use the data and model specified in Section 7.1, but set all the time intervals to the mean time interval. R&gt; data("ctExample1", package = "ctsem") R&gt; traitmodel &lt;-ctModel(n.manifest = 2, n.latent = 2, Tpoints = 6, + LAMBDA = diag(2), manifestNames = c("LeisureTime", "Happiness"), + latentNames = c("LeisureTime", "Happiness"), TRAITVAR = "auto") R&gt; traitfit &lt;-ctFit(datawide = ctExample1, ctmodelobj = traitmodel) R&gt; traitfit &lt;-ctCI(traitfit, confidenceintervals = DRIFT ) R&gt; discrete &lt;-ctExample1 R&gt; discrete[, paste0("dT", 1:5)] &lt;-mean(discrete[, paste0("dT", 1:5)]) R&gt; discretefit &lt;-ctFit(discrete, traitmodel) R&gt; discretefit &lt;-ctCI(discretefit, confidenceintervals = "DRIFT") R&gt; summary(traitfit)$omxsummary$Minus2LogLikelihood In this case, the log likelihood of the fit is worse, and the parameter estimates tend toward the nonsensical, with difficulties estimating confidence intervals for some parameters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Package comparisons</head><p>The following script loops over a sequence in which data is generated from a very simple model (to facilitate comparison), then various packages are used to fit the data, and the distribution of parameter estimates is then plotted. ctsem is used to generate 500 time points of data for a single individual, for a single perfectly measured, stationary process with a drift value of -0.3. The different packages at times use different transformations of the parameters, but for ease of comparison these are transformed to the drift parameter in ctsem. This comparison is not intended as a critique of any package, differences in intended use and estimation routines may result in the observed differences, and it is hoped the provided code may help others to explore alternatives when necessary.</p><p>R&gt; if (!requireNamespace("cts", quietly = TRUE)) { + stop(paste("cts package needed for this function to work.", + "Please install it."), call. = FALSE) + } R&gt; if (!requireNamespace("yuima", quietly = TRUE)) { + stop(paste("yuima package needed for this function to work.", + "Please install it."), call. = FALSE) + } R&gt; Tpoints &lt;-500 R&gt; output &lt;-matrix(NA, 100, 6) R&gt; colnames(output) &lt;-c( True , ctsem , cts , yuima , arima , OpenMx ) R&gt; for (i in 1:nrow(output)) { + generatingModel &lt;-ctModel(n.latent = 1, n.manifest = 1, + Tpoints = Tpoints, LAMBDA = diag(1), DRIFT = matrix(-0.3, nrow = 1), + CINT = matrix(3, 1, 1), MANIFESTVAR = diag(0.00001, 1), + DIFFUSION = t(chol(diag(5, 1)))) + output[i, 1] &lt;-generatingModel$DRIFT # true value + + ctsemData &lt;-ctGenerate(generatingModel, n.subjects = 1, burnin = 30) + longData &lt;-ctWideToLong(ctsemData, Tpoints = 500, n.manifest = 1) + longData &lt;-ctDeintervalise(longData)</p><p>## yuima package (not plotted -potential issues due to dT = 1) + library("yuima") + mod &lt;-setModel(drift = "drift * x + cint", diffusion = "diffusion") + ou &lt;-setYuima(model = mod, data = setData(longData[, "Y1"], + delta = 1)) + mlout &lt;-qmle(ou, start = list(drift = -0.3, diffusion = 1, cint = 1)) + output[i, 4] &lt;-mlout@coef[2] + + ## arima (from stats package, discrete time analysis only) + arfit &lt;-arima(longData[, "Y1"], order = c(1, 0, 0)) + log(arfit$coef[1]) # transform ar1 parameter to drift parameter + output[i, 5] &lt;-log(arfit$coef[1]) + + ## OpenMx state space function + ctsemModel &lt;-ctModel(n.latent = 1, n.manifest = 1, Tpoints = Tpoints, + MANIFESTVAR = diag(0.0001, 1), T0VAR = diag(1), LAMBDA = diag(1)) + cdim &lt;-list("Y1", "eta1") + + amat &lt;-mxMatrix("Full", 1, 1, TRUE, 0.3, name = "A", lbound = -10) + bmat &lt;-mxMatrix("Full", 1, 1, FALSE, 0, name = "B") + cmat &lt;-mxMatrix("Full", 1, 1, FALSE, 1, name = "C", dimnames = cdim) + dmat &lt;-mxMatrix("Full", 1, 1, TRUE, 1, name = "D") + qmat &lt;-mxMatrix("Full", 1, 1, TRUE, 1, name = "Q") + rmat &lt;-mxMatrix("Diag", 1, 1, FALSE, 0.0001, name = "R") + xmat &lt;-mxMatrix("Full", 1, 1, TRUE, 7, name = "x0", lbound = -10, + ubound = 10) + pmat &lt;-mxMatrix("Diag", 1, 1, FALSE, 1, name = "P0") + umat &lt;-mxMatrix("Full", 1, 1, FALSE, 1, name = "u") + tmat &lt;-mxMatrix("Full", 1, 1, name = "time", labels = "data.time") + + osc &lt;-mxModel("AR1", + amat, bmat, cmat, dmat, qmat, rmat, xmat, pmat, umat, tmat, + mxExpectationStateSpace("A", "B", "C", "D", "Q", "R", "x0", "P0", + "u"), mxFitFunctionML(), mxData(longData, "raw")) + + oscr &lt;-mxRun(osc) + + output[i, 6] &lt;-log(mxEval(A, oscr)) + } # end for loop R&gt; plot(density(output[1:i, 2]), xlim = c(-0.4, -0.1), lty = 2, lwd = 2, + ylab = "Density", + main = "Density of estimates of drift parameter (true value -0.3)") R&gt; points(density(output[1:i, 3]), col = "red", type = "l", lty = 3, + lwd = 3) R&gt; points(density(output[1:i, 5]), col = "blue", type = "l", lwd = 2, + lty = 2) R&gt; points <ref type="bibr">(density(output[1:i, 6]</ref>), col = "green", type = "l", lwd = 4, + lty = 5) R&gt; legend("topleft", bty = "n", text.col = c("black","red","blue", + "green"), legend = c("ctsem", "cts", "arima", "OpenMx"))</p><p>Affiliation: </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<author>
			<persName><forename type="first">L</forename><surname>Arnold</surname></persName>
		</author>
		<title level="m">Stochastic Differential Equations: Theory and Applications</title>
		<meeting><address><addrLine>New York</addrLine></address></meeting>
		<imprint>
			<publisher>John Wiley &amp; Sons</publisher>
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Pooling Cross Section and Time Series Data in the Estimation of a Dynamic Model: The Demand for Natural Gas</title>
		<author>
			<persName><forename type="first">P</forename><surname>Balestra</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Nerlove</surname></persName>
		</author>
		<idno type="DOI">10.2307/1909771</idno>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="585" to="612" />
			<date type="published" when="1966">1966</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A General Panel Model with Random and Fixed Effects: A Structural Equations Approach</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Bollen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">E</forename><surname>Brand</surname></persName>
		</author>
		<idno type="DOI">10.1353/sof.2010.0072</idno>
	</analytic>
	<monogr>
		<title level="j">Social Forces</title>
		<imprint>
			<biblScope unit="volume">89</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="34" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">The YUIMA Project: A Computational Framework for Simulation and Inference of Stochastic Differential Equations</title>
		<author>
			<persName><forename type="first">A</forename><surname>Brouste</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Fukasawa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Hino</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Iacus</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Kamatani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Koike</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Masuda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Nomura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Ogihara</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Shimuzu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Uchida</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Yoshida</surname></persName>
		</author>
		<idno type="DOI">10.18637/jss.v057.i04</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Software</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1" to="51" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Do Institutional Changes Affect Business Cycles? Evidence from Europe</title>
		<author>
			<persName><forename type="first">F</forename><surname>Canova</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Ciccarelli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Ortega</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.jedc.2012.03.017</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Economic Dynamics and Control</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="1520" to="1533" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Equivalence and Differences between Structural Equation Modeling and State-Space Modeling Techniques</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Chow</surname></persName>
		</author>
		<author>
			<persName><surname>Ho Mhr</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">L</forename><surname>Hamaker</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">V</forename><surname>Dolan</surname></persName>
		</author>
		<idno type="DOI">10.1080/10705511003661553</idno>
	</analytic>
	<monogr>
		<title level="j">Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="303" to="332" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
	<note>Structural Equation Modeling: A</note>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Coleman</surname></persName>
		</author>
		<title level="m">Introduction to Mathematical Sociology</title>
		<imprint>
			<publisher>London Free Press Glencoe</publisher>
			<date type="published" when="1964">1964</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<author>
			<persName><forename type="first">C</forename><surname>Driver</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Voelkle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Oud</surname></persName>
		</author>
		<ptr target="https://CRAN.R-project.org/package=ctsem" />
		<title level="m">ctsem: Continuous Time Structural Equation Modelling. R package version 2.3.0</title>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<author>
			<persName><forename type="first">J</forename><surname>Durbin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">J</forename><surname>Koopman</surname></persName>
		</author>
		<title level="m">Time Series Analysis by State Space Methods. 2nd edition</title>
		<imprint>
			<publisher>Oxford University Press</publisher>
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Exploring Structural Dynamics within and Between Sensory and Intellectual Functioning in Old and Very Old Age: Longitudinal Evidence from the Berlin Aging Study</title>
		<author>
			<persName><forename type="first">P</forename><surname>Ghisletta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">U</forename><surname>Lindenberger</surname></persName>
		</author>
		<idno type="DOI">10.1016/j.intell.2005.07.002</idno>
	</analytic>
	<monogr>
		<title level="j">Intelligence</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="555" to="587" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">NPSOL: A Fortran Package for Nonlinear Programming</title>
		<author>
			<persName><forename type="first">P</forename><surname>Gill</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Murray</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Saunders</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Wright</surname></persName>
		</author>
		<ptr target="http://www.sbsi-sol-optimize.com/asp/sol_product_npsol.htm" />
		<imprint>
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Decline in Pneumonia Admissions After Routine Childhood Immunisation with Pneumococcal Conjugate Vaccine in the USA: A Time-Series Analysis</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">G</forename><surname>Grijalva</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Nuorti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">G</forename><surname>Arbogast</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">W</forename><surname>Martin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">M</forename><surname>Edwards</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">R</forename><surname>Griffin</surname></persName>
		</author>
		<idno type="DOI">10.1016/S0140-6736(07)60564-9</idno>
	</analytic>
	<monogr>
		<title level="j">The Lancet</title>
		<imprint>
			<biblScope unit="volume">369</biblScope>
			<biblScope unit="issue">9568</biblScope>
			<biblScope unit="page" from="1179" to="1186" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">DiffProc: Simulation of Diffusion Processes</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">C</forename><surname>Guidoum</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Boukhetala</surname></persName>
		</author>
		<ptr target="https://CRAN.R-project.org/package=Sim.DiffProc" />
	</analytic>
	<monogr>
		<title level="m">R package version 3.7</title>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
	<note>Sim</note>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Panel Models in Sociological Research: Theory into Practice</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">N</forename><surname>Halaby</surname></persName>
		</author>
		<idno type="DOI">10.1146/annurev.soc.30.012703.110629</idno>
	</analytic>
	<monogr>
		<title level="j">Annual Review of Sociology</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="507" to="544" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Methods for Temporal Analysis</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">T</forename><surname>Hannan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">B</forename><surname>Tuma</surname></persName>
		</author>
		<idno type="DOI">10.1146/annurev.so.05.080179.001511</idno>
	</analytic>
	<monogr>
		<title level="j">Annual Review of Sociology</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="303" to="328" />
			<date type="published" when="1979">1979</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Antidepressants and Public Health in Iceland</title>
		<author>
			<persName><forename type="first">T</forename><surname>Helgason</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Tomasson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Zoega</surname></persName>
		</author>
		<idno type="DOI">10.1192/bjp.184.2.157</idno>
	</analytic>
	<monogr>
		<title level="j">The British Journal of Psychiatry</title>
		<imprint>
			<biblScope unit="volume">184</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="157" to="162" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">The Scaling and Squaring Method for the Matrix Exponential Revisited</title>
		<author>
			<persName><forename type="first">N</forename><surname>Higham</surname></persName>
		</author>
		<idno type="DOI">10.1137/090768539</idno>
	</analytic>
	<monogr>
		<title level="j">SIAM Review</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="747" to="764" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">D</forename><surname>Hunter</surname></persName>
		</author>
		<title level="m">State Space Dynamic Mixture Modeling: Finding People with Similar Patterns Of Change</title>
		<meeting><address><addrLine>Norman, OK</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2014">2014</date>
		</imprint>
		<respStmt>
			<orgName>University of Oklahoma</orgName>
		</respStmt>
	</monogr>
	<note>Ph.D. thesis</note>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">sde: Simulation and Inference for Stochastic Differential Equations</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Iacus</surname></persName>
		</author>
		<ptr target="https://CRAN.R-project.org/package=sde" />
	</analytic>
	<monogr>
		<title level="m">R package version 2.0.15</title>
		<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Bidirectional Links and Concurrent Development of Parent-Child Relationships and Boys&apos; Offending Behavior</title>
		<author>
			<persName><forename type="first">L</forename><surname>Keijsers</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Loeber</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Branje</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Meeus</surname></persName>
		</author>
		<idno type="DOI">10.1037/a0024588</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Abnormal Psychology</title>
		<imprint>
			<biblScope unit="volume">120</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="878" to="889" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Statistical Inference for Partially Observed Markov Processes via the R Package pomp</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">A</forename><surname>King</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Nguyen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">L</forename><surname>Ionides</surname></persName>
		</author>
		<idno type="DOI">10.18637/jss.v069.i12</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Software</title>
		<imprint>
			<biblScope unit="volume">69</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="1" to="43" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Some Algebraic Properties of the Reticular Action Model for Moment Structures</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">J</forename><surname>Mcardle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">P</forename><surname>Mcdonald</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.2044-8317.1984.tb00802.x</idno>
	</analytic>
	<monogr>
		<title level="j">British Journal of Mathematical and Statistical Psychology</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="234" to="251" />
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">On the Pooling of Time Series and Cross Section Data</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Mundlak</surname></persName>
		</author>
		<idno type="DOI">10.2307/1913646</idno>
	</analytic>
	<monogr>
		<title level="j">Econometrica</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="69" to="85" />
			<date type="published" when="1978">1978</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">OpenMx 2.0: Extended Structural Equation and Statistical Modeling</title>
		<author>
			<persName><forename type="first">Neale</forename><forename type="middle">Mc</forename><surname>Hunter</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">D</forename><surname>Pritikin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">N</forename><surname>Zahery</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Brick</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">R</forename><surname>Kirkpatrick</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">M</forename><surname>Estabrook</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Bates</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">C</forename><surname>Maes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">H</forename><surname>Boker</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename></persName>
		</author>
		<idno type="DOI">10.1007/s11336-014-9435-8</idno>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="535" to="549" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Continuous Time Modeling of the Cross-Lagged Panel Design</title>
		<author>
			<persName><forename type="first">Jhl</forename><surname>Oud</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Kwantitatieve Methoden</title>
		<imprint>
			<biblScope unit="volume">69</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="26" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Continuous Time State Space Modeling of Panel Data by Means of SEM</title>
		<author>
			<persName><forename type="first">Jhl</forename><surname>Oud</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Rarg</forename><surname>Jansen</surname></persName>
		</author>
		<idno type="DOI">10.1007/BF02294374</idno>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">65</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="199" to="215" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<monogr>
		<author>
			<persName><forename type="first">Team</forename><surname>Core</surname></persName>
		</author>
		<ptr target="https://www.R-project.org/" />
		<title level="m">R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing</title>
		<meeting><address><addrLine>Vienna, Austria</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Time-Delay Systems: An Overview of Some Recent Advances and Open Problems</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Richard</surname></persName>
		</author>
		<idno type="DOI">10.1016/S0005-1098(03)00167-5</idno>
	</analytic>
	<monogr>
		<title level="j">Automatica</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page" from="1667" to="1694" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Using Phantom and Imaginary Latent Variables to Parameterize Constraints in Linear Structural Models</title>
		<author>
			<persName><forename type="first">D</forename><surname>Rindskopf</surname></persName>
		</author>
		<idno type="DOI">10.1007/BF02294204</idno>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="37" to="47" />
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Continuous Panel Models with Time Dependent Parameters</title>
		<author>
			<persName><forename type="first">H</forename><surname>Singer</surname></persName>
		</author>
		<idno type="DOI">10.1080/0022250X.1998.9990214</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Mathematical Sociology</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="77" to="98" />
			<date type="published" when="1998">1998</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Continuous Time Modelling with Individually Varying Time Intervals for Oscillating and Non-Oscillating Processes</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">C</forename><surname>Voelkle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jhl</forename><surname>Oud</surname></persName>
		</author>
		<idno type="DOI">10.1111/j.2044-8317.2012.02043.x</idno>
	</analytic>
	<monogr>
		<title level="j">British Journal of Mathematical and Statistical Psychology</title>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="103" to="126" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Relating Latent Change Score and Continuous Time Models</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">C</forename><surname>Voelkle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jhl</forename><surname>Oud</surname></persName>
		</author>
		<idno type="DOI">10.1080/10705511.2014.935918</idno>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling: A Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="366" to="381" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">An SEM Approach to Continuous Time Modeling of Panel Data: Relating Authoritarianism and Anomia</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">C</forename><surname>Voelkle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jhl</forename><surname>Oud</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Davidov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Schmidt</surname></persName>
		</author>
		<idno type="DOI">10.1037/a0027543</idno>
	</analytic>
	<monogr>
		<title level="j">Psychological Methods</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="176" to="192" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">Structural Equation Modeling with Ωnyx</title>
		<author>
			<persName><forename type="first">T</forename><surname>Von Oertzen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">M</forename><surname>Brandmaier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Tsang</surname></persName>
		</author>
		<idno type="DOI">10.1080/10705511.2014.935842</idno>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling: A Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="148" to="161" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">cts: An R Package for Continuous Time Autoregressive Models via Kalman Filter</title>
		<author>
			<persName><forename type="first">Z</forename><surname>Wang</surname></persName>
		</author>
		<idno type="DOI">10.18637/jss.v053.i05</idno>
	</analytic>
	<monogr>
		<title level="j">Journal of Statistical Software</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="1" to="19" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<monogr>
		<title level="m" type="main">Dynamic Documents with R and knitr. 2nd edition</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Xie</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2015">2015</date>
			<publisher>Chapman &amp; Hall/CRC</publisher>
			<pubPlace>Boca Raton</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
