<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Correcting for confounding in longitudinal experiments: positioning non-linear mixed effects modeling as implementation of standardization using latent conditional exchangeability</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">Christian</forename><surname>Bartels</surname></persName>
							<email>christian.bartels@novartis.com</email>
							<affiliation key="aff0">
								<orgName type="institution">Novartis Pharma AG</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Martina</forename><surname>Scauda</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Statistical Laboratory</orgName>
								<orgName type="institution">Novartis Pharma AG</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Neva</forename><surname>Coello</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Novartis Pharma AG</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Thomas</forename><surname>Dumortier</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Novartis Pharma AG</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Bjoern</forename><surname>Bornkamp</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Novartis Pharma AG</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Giusi</forename><surname>Moffa</surname></persName>
							<affiliation key="aff3">
								<orgName type="department">Dep. of Mathematics and Computer Science</orgName>
								<orgName type="institution">University of Basel</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="institution">University of Cambridge</orgName>
								<address>
									<settlement>Cambridge</settlement>
									<country key="GB">United Kingdom</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff4">
								<orgName type="institution">Novartis Pharma AG</orgName>
								<address>
									<postCode>4002</postCode>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Correcting for confounding in longitudinal experiments: positioning non-linear mixed effects modeling as implementation of standardization using latent conditional exchangeability</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-14T19:30+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Nonlinear models. Mixed effects models</term>
					<term>Causal inference</term>
					<term>Standardization</term>
					<term>Confounding</term>
					<term>Pharmacometrics</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Non-linear mixed effects modeling and simulation (NLME M&amp;S) is evaluated to be used for standardization with longitudinal data in presence of confounders. Standardization is a well-known method in causal inference to correct for confounding by analyzing and combining results from subgroups of patients. The purpose of this paper is to show that non-linear mixed effects modeling is a particular implementation of standardization that conditions on individual parameters described by the random effects of the mixed effects model. The present work is motivated by the fact that in pharmacometrics NLME M&amp;S is routinely used to analyze clinical trials and to predict and compare potential outcomes of the same patient population under different treatment regimens. Such a comparison is a causal question sometimes referred to as causal prediction. Nonetheless, NLME M&amp;S is rarely positioned as a method for causal prediction.</p><p>As an example, a simulated clinical trial is used that assumes treatment confounder feedback in which early outcomes can cause deviations from the planned treatment schedule and are correlated with the final outcome due to their dependence on common individual parameters. Being interested in the outcome for the hypothetical situation that patients adhere to the planned treatment schedule, we put assumptions in a causal diagram. From the causal diagram, conditional independence assumptions are derived either using latent conditional exchangeability, conditioning on the individual parameters or using sequential conditional exchangeability, conditioning on earlier outcomes. Both conditional independencies can be used to estimate the estimand of interest, e.g., with standardization, and they give unbiased estimates. We will demonstrate this using a simulation-estimation experiment where assumptions required for identification of the estimand hold, including positivity, no unobserved confounding, and adequate specification of the models used for the analyses.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Introduction</head><p>Mixed effects models are routinely used to analyze longitudinal clinical trial data <ref type="bibr" target="#b0">1,</ref><ref type="bibr" target="#b1">2</ref> , however they are rarely discussed as method for causal inference in this setting <ref type="bibr" target="#b2">3,</ref><ref type="bibr" target="#b3">4,</ref><ref type="bibr" target="#b4">5</ref> . Here we position mixed effects modeling as implementation of standardization (Section 13 and 21.1 of Ref <ref type="bibr" target="#b5">6</ref> ) using latent conditional exchangeability. We do this by looking at an example of treatment-confounder feedback, and derive and apply two sets of equations to evaluate the estimand of interest:</p><p>1.</p><p>Standardization conditioning on early outcomes using sequential conditional exchangeability. This is one of the approaches proposed in textbooks on causal inference such as in part III section 21.1 of Ref <ref type="bibr" target="#b5">6</ref> . 2.</p><p>Standardization conditioning on individual parameters, which one could refer to as using latent exchangeability. This corresponds to what is routinely done in pharmacometrics with population PK or PKPD modeling.</p><p>For the comparison of the two approaches, we state the estimand <ref type="bibr" target="#b6">7,</ref><ref type="bibr" target="#b7">8</ref> and formulate the assumptions in a causal diagram. From the causal diagram, conditional independence assumptions are derived. The conditional independencies can be used to estimate the estimand of interest, i.e., they identify the estimand. When using the methods to analyze data in a simulation-estimation experiment they both give valid estimates of the estimand and correct for the confounding. The methods and results sections give details. The remaining sections of the introduction provide some background and considerations on the example trial that we selected for illustration.</p><p>The motivation for the present work stems from the routine use of non-linear mixed effects modeling and simulation (NLME M&amp;S) as an integral part of pharmacometrics <ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b9">10,</ref><ref type="bibr" target="#b10">11</ref> contributing to the analysis of clinical trials and to predict and compare potential outcomes of the same patient population under different hypothetical treatment regimens <ref type="bibr" target="#b11">12,</ref><ref type="bibr" target="#b12">13</ref> . Such a comparison is a causal question sometimes referred to as causal prediction <ref type="bibr" target="#b13">14</ref> . The relation between pharmacometric analyses and causal inference has been discussed recently <ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b14">15,</ref><ref type="bibr" target="#b15">16</ref> without however considering the role of mixed effects modeling and the implied conditioning on latent variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Background</head><p>The pharmacokinetics and pharmacodynamics of many drugs and their effects on clinical endpoints can often be well described with pharmacometric non-linear mixed effects models <ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b9">10,</ref><ref type="bibr" target="#b10">11</ref> . These models consist of a non-linear structural model that describes the evolution of the pharmacokinetics and pharmacodynamics over time, and a mixed effects model that accounts for the differences between patient groups. Patients with similar values of the random effects have similar outcomes in that administering the drug will result in similar profiles of the response. The models are referred to as pharmacometric models since they are semi-mechanistic and based on pharmacological principles.</p><p>In practice, NLME M&amp;S analyses are often executed by:</p><p>â€¢ First, fitting a non-linear mixed effects model to describe the observed data, i.e. the longitudinal response given the administered doses. â€¢ Use model diagnostics to evaluate and ensure the quality of the description of the observed data.</p><p>â€¢ Finally, based on the fitted models, simulate response and evaluate alternative scenarios including different dosing regimens.</p><p>Formally, a generic mixed effect model can be represented as ğ¸ !" = ğ‘“(ğ‘¥ !" , ğœƒ ! , ğ‘ ! ) + ğ‘”(ğ‘¥ !" , ğœƒ ! , ğœ‰)ğœ€ !"</p><p>ğœƒ ! = â„(ğœ‡, ğœ‚ ! ) ğœ‚ ! ~ğ‘(0, Î©) ğœ€ !" ~ğ‘(0,1)</p><p>where:</p><p>â€¢ ğ¸ !" is the response at time ğ‘¡ in subject ğ‘–.</p><p>â€¢ ğ‘“ is referred to as the structural model and is a differentiable function of individual parameters, ğœƒ ! , patient specific baseline covariates, ğ‘ ! , and design variables ğ‘¥ !" . â€¢ ğ‘” is referred to as the residual error model with additional residual error parameters ğœ‰, and with ğœ€ !" being the independent and identically distributed residual error. â€¢ â„ is the model of the individual parameters that depends on population parameters, ğœ‡, and patient specific random effects ğœ‚ ! .</p><p>â€¢ Î© is the covariance matrix of the distribution of the random effects.</p><p>For pharmacometric NLME models, the design variables usually contain the doses and the timing of the dose administrations and outcome assessments, e.g., ğ‘¥ !" = {ğ· !" , ğ‘‡ !" , â€¦ } with ğ‘‡ !" being all the times of dose administrations and outcome observations of patient ğ‘– and ğ· !" all the administered drug amounts. Oftentimes the structural model, ğ‘“(ğ‘¥ !" , ğœƒ ! ), is formulated as a set of first-order differential equations, the pharmacokinetics as a mammillary compartmental model and the pharmacodynamics as a direct or indirect response to the pharmacokinetics <ref type="bibr" target="#b16">17</ref> .</p><p>Standardization based on sequential conditional exchangeability is a method capable to adjust for timedependent confounding even in the presence of treatment-confounder feedback (Section 21.1 of Ref <ref type="bibr" target="#b5">6</ref> ). Exchangeability refers to the concept that a subgroup of patients from a study who receive a particular treatment are representative of the overall study population. Randomization of treatment implies that treatment assignment and the potential outcomes under the different hypothetical treatments are exchangeable which helps answering many clinical questions of interest. When exchangeability holds, then the response observed in a subgroup gives an unbiased estimate of the response in the overall population. For some questions of interest, randomization is not sufficient to ensure exchangeability (see example discussed below) while conditional exchangeability may still hold. This means that exchangeability holds when restricting to patients with given characteristics which define a subset of the study population, e.g., all patients with the same age. It is then possible to estimate a treatment effect for each stratum. By averaging the effects over all strata, we can obtain the overall population effect. This is the idea of standardization, which extends to longitudinal trials thanks to a condition known as sequential conditional exchangeability.</p><p>In practice, analyses using standardization to perform causal inference are often executed by:</p><p>â€¢ Stating the question of interest by specifying treatment, population, outcome variable, population summary measure and intercurrent events, e.g., in the form of an estimand. â€¢ Stating the assumptions on the data generating process, e.g., in the form of causal diagrams.</p><p>â€¢ Assess whether the estimand can be identified, i.e., whether it is possible, in principle and provided the assumptions are correct, to obtain a valid, unbiased estimate of the estimand of interest. â€¢ Estimate the estimand of interest based on the available data using one of the methods for causal estimation such as standardization.</p><p>From the previous descriptions in this section, NLME M&amp;S and standardization would appear as rather different approaches to analyze longitudinal data. In this work we aim to position NLME M&amp;S as an implementation of standardization using latent conditional exchangeability; "latent" because the conditioning is on the non-directly observed individual PK parameters which are estimated from the observed data as part of the mixed effect model. As an implementation of standardization, NLME M&amp;S is comparable to standardization using sequential conditional exchangeability. For certain situations, we find that they can be used almost interchangeably. For other situations, one or the other approach may be better suited, and we leave it to future work to demonstrate how the two approaches can complement each other.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Considerations</head><p>For the derivations, we focus on one particular type of treatment-confounder feedback with assumptions presented in causal diagrams. To ensure a higher degree of generality we keep the diagrams and the derivations that they support generic without being specific on the nature of the interventions and the outcomes.</p><p>For illustration, we use a simulation with plasma concentrations of the drug over time as outcome (aka PK concentrations, PK exposure or simply exposure or PK in pharmacometrics). The aim is then to estimate the expected potential plasma concentrations under different treatment regimens. The rationale is that non-linear mixed effect models are routinely used in pharmacometrics to characterize PK, they tend to give precise descriptions of observed PK profiles and estimating individual PK parameters from the observed plasma concentration profiles is often quite reliable <ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b10">11,</ref><ref type="bibr" target="#b17">18</ref> . As such we can expect adjustments on individual PK parameters to work well and our simulation-estimation exercise is realistic. Further, characterizing PK after dose administration is a first step towards a more complete but also more complex characterization of the drug and its effects using non-linear mixed effects population PKPD models <ref type="bibr" target="#b9">10</ref> .</p><p>The chosen simulation scenario was inspired by a planned dose-finding study. The study evaluates different up-titration schemes aiming at identifying different treatment regimens with which most of the patients can rapidly reach the target dose. Due to the limited duration of the study, it is anticipated that patients may not be able to up-titrate because of initial high sensitivity to the drug after the first administrations. This high sensitivity is expected to disappear as patients continue to take the drug. In this setting estimating the outcome assuming that all patients can adhere to the up-titration schedule could be of interest, as it is considered probable that in longer phase 3 studies or in clinical practice all patients are ultimately able to up-titrate, but it may take longer for some of them (see also <ref type="bibr">Refs 8,</ref><ref type="bibr" target="#b18">19</ref> for a discussion of the relevance of hypothetical estimands).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Methods</head><p>For deriving the estimators, we consider the generic situation of a randomized longitudinal trial in which drug administration at later time points may be affected by the outcome at earlier time points. The drug gets administered repeatedly at different times ğ‘¡ and the outcome is measured before each drug administration. The randomization assigns a treatment strategy to each patient that defines the doses that should be taken at each time point. Intercurrent events may occur that affect the subsequent dosing so that it deviates from the randomly assigned treatment strategy. The occurrence of intercurrent events, such as insufficient efficacy or adverse events, is thought to be related to earlier outcomes. The interest lies in estimating the potential outcome under the hypothetical situation that no intercurrent event occurs and patients adhere to the randomly assigned treatment regimen. This corresponds to a hypothetical strategy as defined in the ICH E9R1 addendum <ref type="bibr" target="#b6">7</ref> . Further, it is assumed that outcomes at different time points are correlated as they depend on the same set of individual parameters, and a mixed effects model adequately describes their statistical dependence. For expository purposes, we first present the derivation for a simpler case restricted to two dose administrations, and then extend to the general case of a longitudinal trial design with a larger number ğ‘› of dose administrations.</p><p>Directed acyclic graphs (DAGs) encode assumptions on experiments in the form of (conditional) independence relationships. The DAG in Figure <ref type="figure" target="#fig_1">1</ref> describes the assumptions for a trial with two administered doses. In the diagram, ğ‘… represents the randomization, ğ· " the dose administrations at times ğ‘¡, ğ¸ " the outcome just before the next dose at time ğ‘¡ + 1, ğ‘† " the intercurrent event, and Î˜ the individual parameters. The outcome at time ğ‘¡ depends on all the doses at previous times ğ‘¡' â‰¤ ğ‘¡. The same outcome has a causal effect on the intercurrent event at time ğ‘¡ , while the doses depend on the randomization and prior intercurrent events. The individual parameters characterize the individual predisposition to certain outcomes at different times. As such they constitute common causes of all outcomes determining the association that exists between outcomes at different time points. Both, the individual parameters and the previous outcome are confounders for the effect of the intercurrent event on the subsequent outcome: the intercurrent event affects this outcome via a directed path mediated by the following dose, and a confounding pathway exists via the individual parameters and the previous outcome. The individual parameters and the previous outcome differ in that the outcome is directly observed whereas the individual parameters are estimated from the observed data in the mixed effects model of the NLME.</p><p>The estimand is the outcome ğ¸ # in the study population for each treatment arm ğ‘Ÿ in a hypothetical scenario where the intercurrent event does not occur. Using the notation of counterfactuals, in a way similar to Ref 5 , we want to intervene on the intercurrent event, so that ğ‘  $ = 0 , and estimate the counterfactual distribution ğ‘ƒğ‘ŸEğ¸ # %,' ! () F. Single world intervention graphs (SWIGs) allow us to assess conditional exchangeabilities and establish whether the counterfactual distribution of interest is identifiable. Graphically conditional exchangeability holds if the target of intervention , ğ‘† $ % , and the outcome of interest, ğ¸ # ' ! () , are d-separated given the set of covariates we can use for the adjustment (Section 7.5 of Ref 6 ).</p><p>To obtain the SWIG corresponding to the DAG in Figure <ref type="figure" target="#fig_1">1</ref> we split the intervention nodes, ğ‘… and ğ‘† $ , and use the counterfactual notation, e.g. ğ¸ # %,' ! () , for any outcomes downstream of the interventions. The independence of randomization and any potential outcomes, together with the consistency assumption, imply that ğ‘ƒğ‘ŸEğ¸ # %,' ! () F = PrEğ¸ # ' ! () Jğ‘… = ğ‘ŸF. Because of the confounding paths through the individual parameters and the previous outcome, exchangeability does not hold between the potential outcome ğ¸ # ' ! () and the intercurrent event. Therefore, to estimate the counterfactual distribution from the observed data, we need to establish whether there are sets of observed variables with which conditional exchangeability between the potential outcome ğ¸ # ' ! () and the intercurrent event ğ‘† $ holds. Those socalled adjustment sets are such that they block all confounding paths when conditioned upon. An adjustment set from which no variable can be removed without losing conditional exchangeability constitutes a minimal adjustment set. The SWIG in Figure <ref type="figure" target="#fig_1">1</ref> has {ğ¸ $ } and {ğ· $ , Î˜} as the two minimally sufficient adjustment sets <ref type="bibr" target="#b19">20</ref> . Both adjustment sets block all incoming paths that lead up to the intervention ğ‘† $ . As such any other node can be added to the adjustment set without breaking the d-separation (see also Fine Point 6.1 of Ref 6 ). Because adding conditioning variables on a path that is not uniquely blocked by a collider will not open it, the randomization ğ‘… can be added to the adjustment sets without breaking d-separation. Further, if we consider only treatment arms that assign the doses deterministically, then the randomization uniquely defines ğ· $ and we may remove ğ· $ from any adjustment set containing ğ‘… . Therefore both {ğ¸ $ , ğ‘…} and {ğ‘…, Î˜} constitute valid adjustment sets to derive equations for standardization: With the observed outcome ğ¸ $</p><formula xml:id="formula_0">Pr (ğ¸ # ' ! () | ğ‘… = ğ‘Ÿ) = âˆ« ğ‘ƒğ‘ŸEğ¸ # ' ! () Jğ‘… = ğ‘Ÿ, ğ¸ $ = ğ‘’ $ )Pr (ğ¸ $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) * ! ğ‘‘ğ‘’ $ by law of total probability = âˆ« ğ‘ƒğ‘ŸEğ¸ # ' ! () Jğ‘… = ğ‘Ÿ, ğ¸ $ = ğ‘’ $ , ğ‘† $ = 0)Pr (ğ¸ $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) *$ ğ‘‘ğ‘’ $ by conditional exchangeability = âˆ« ğ‘ƒğ‘Ÿ(ğ¸ # |ğ‘… = ğ‘Ÿ, ğ¸ $ = ğ‘’ $ , ğ‘† $ = 0)Pr (ğ¸ $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) *$</formula><p>ğ‘‘ğ‘’ $ by consistency.</p><p>Similarly with the individual parameters Î˜  Going beyond two doses, the SWIG in Figure <ref type="figure">2</ref> represents a more general longitudinal trial with several administrations, where we assume interventions on the randomization and all the intercurrent events. ğ¸ " %,' "#! ,,,,,,() refers to the counterfactual outcome at time ğ‘¡ if intervening on the randomization ğ‘Ÿ and on all intercurrent events ğ‘  "-$ QQQQQQ prior to ğ‘¡. Quantities with an overbar and a time subscript, e.g., E . /,0() ,,,,,,,() F at the last time point ğ‘›, which is equal to</p><formula xml:id="formula_1">Pr (ğ¸ # ' ! () | ğ‘… = ğ‘Ÿ) = âˆ« ğ‘ƒğ‘ŸEğ¸ # ' ! () Jğ‘…</formula><formula xml:id="formula_2">ğ‘ƒğ‘ŸEğ¸ 3 %,' $#!</formula><p>,,,,,,,() |ğ‘… = ğ‘ŸF, thanks to the independence of the potential outcomes from randomization.</p><p>To derive estimation equations we follow arguments as in Technical Point 19.3 of Ref <ref type="bibr" target="#b5">6</ref> . In the longitudinal setting of the SWIG in Figure <ref type="figure">2</ref>, sequential conditional exchangeability holds for any given intercurrent event with observations (outcomes and doses) that occurr after the event conditional on all prior observations and intercurrent events, i.e., for ğœ &gt; ğ‘¡</p><formula xml:id="formula_3">Uğ· 1 %,' " 2 () , ğ¸ 1 %,' " 2 () V âŠ¥ ğ‘† " %,' "#! ,,,,,,() |ğ¸ " %,'() QQQQQQQQ , ğ· " %,'() QQQQQQQQ , ğ‘† "-$ %,'()</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>QQQQQQQQ , ğœƒ, ğ‘… = ğ‘Ÿ</head><p>The conditioning is redundant, in that similarly to the case with two doses, either the outcomes ğ¸ " %,'</p><p>QQQQQ or the doses and the random effects, ğ· " %,'</p><p>QQQQQ and ğœƒ, can be removed from the adjustment set without opening confounding paths into ğ‘† " %,' "#! ,,,,,, . Focusing on the set without prior outcomes, we have</p><formula xml:id="formula_4">Uğ· 1 %,' " 2 () , ğ¸ 1 %,' " 2 () V âŠ¥ ğ‘† " %,' "#!</formula><p>,,,,,,() | ğ· " %,'() QQQQQQQQ , ğ‘† "-$ %,'()</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>QQQQQQQQ , ğœƒ, ğ‘… = ğ‘Ÿ</head><p>Since in the example the doses are determined by the randomization and intercurrent event, it is redundant to condition on all three of them. The doses can be removed, which gives The derivation conditioning on earlier outcomes is similar, except that at each time point, earlier exposures need to be added to the conditioning set using the law of total probability e.g., see also Chapter ), counterfactuals on the right side can be replaced giving</p><formula xml:id="formula_5">Uğ· 1 %,' " 2 () , ğ¸ 1 %,' "<label>2</label></formula><formula xml:id="formula_6">Uğ· 1 %,' " 2 () , ğ¸ 1 %,' " 2 () V âŠ¥ ğ‘† " |ğ¸ " QQQ , ğ‘† "-$ QQQQQQ = 0, ğ‘… = ğ‘Ÿ</formula><p>Starting from this, we have for the first intercurrent event</p><formula xml:id="formula_7">ğ‘ƒğ‘ŸEğ¸ 3 %,' $#! ,,,,,,,() |ğ‘… = ğ‘ŸF = âˆ« ğ‘ƒğ‘ŸEğ¸ 3 %,' $#! ,,,,,,,() Jğ‘… = ğ‘Ÿ, E $ = ğ‘’ $ )Pr ( E $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) *$</formula><p>ğ‘‘ğ‘’ $ by law of total probability</p><formula xml:id="formula_8">= âˆ« ğ‘ƒğ‘ŸEğ¸ "4$ %,' $#! ,,,,,,,() Jğ‘… = ğ‘Ÿ, ğ‘† $ = 0, E $ = ğ‘’ $ )Pr ( E $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) *$</formula><p>ğ‘‘ğ‘’ $ by conditional exchangeability for time ğ‘¡ = 1.</p><p>Then for the second intercurrent event</p><formula xml:id="formula_9">ğ‘ƒğ‘ŸEğ¸ 3 %,' $#!</formula><p>,,,,,,,() |ğ‘… = ğ‘ŸF = by law of total probability</p><formula xml:id="formula_10">âˆ« ğ‘ƒğ‘ŸEğ¸ 3 %,' $#! ,,,,,,,() Jğ‘… = ğ‘Ÿ, ğ‘† $ = 0, E $ = ğ‘’ $ , E # = ğ‘’ # ) Ã— *$,*# Pr (E $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) Ã— Pr( E # = ğ‘’ # | ğ‘… = ğ‘Ÿ, ğ‘† $ = 0, E $ = ğ‘’ $ )ğ‘‘ğ‘’ $ ğ‘‘ğ‘’ # ğ‘ƒğ‘ŸEğ¸ 3 %,' $#!</formula><p>,,,,,,,() |ğ‘… = ğ‘ŸF = by conditional exchangeability for</p><formula xml:id="formula_11">âˆ« ğ‘ƒğ‘ŸEğ¸ 3 %,' $#!</formula><p>,,,,,,,() Jğ‘… = ğ‘Ÿ, ğ‘† $ = 0 , ğ‘†</p><formula xml:id="formula_12"># = 0, E $ =, E # =) Ã— *$,*# time ğ‘¡ = 2 Pr (E $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) Ã— Pr( E # = ğ‘’ # | ğ‘… = ğ‘Ÿ, ğ‘† $ = 0, E $ = ğ‘’ $ )ğ‘‘ğ‘’ $ ğ‘‘ğ‘’ #</formula><p>Repeating this for all intercurrent event up to time ğ‘› -1 and using the convention that terms with time index 0, i.e., ğ¸ ) '() QQQQQQ , can be removed, gives</p><formula xml:id="formula_13">ğ‘ƒğ‘ŸEğ¸ 3 %,' $#! ,,,,,,,() |ğ‘… = ğ‘ŸF = âˆ« ğ‘ƒğ‘ŸEğ¸ 3 %,' $#! ,,,,,,,() Jğ‘… = ğ‘Ÿ, ğ‘† 3-$ = 0 , E 3-$ QQQQQQQ = e 3-$ QQQQQQ) Ã— * $#! âˆ ğ‘ƒğ‘ŸEğ¸ " |ğ‘… = ğ‘Ÿ, ğ‘† "-$ = 0 , E "-$ QQQQQQQ = e "-$ QQQQQQF 3-$ "($ ğ‘‘ğ‘’ 3-$</formula><p>And finally by consistency</p><formula xml:id="formula_14">ğ‘ƒğ‘ŸEğ¸ 3 %,' $#! ,,,,,,,() |ğ‘… = ğ‘ŸF = âˆ« âˆ ğ‘ƒğ‘ŸEğ¸ " |ğ‘… = ğ‘Ÿ, ğ‘† "-$ = 0 , E "-$ QQQQQQQ = e "-$ QQQQQQF 3 "($ * $#! ğ‘‘ğ‘’ 3-$</formula><p>Both variants of the estimation equations, the one conditioning on the random effects or the one conditioning on earlier outcomes, can again be implemented using a parametric modeling and simulation approach. Estimation conditioning on earlier outcomes requires models ğ‘ƒğ‘Ÿ(ğ¸ " |ğ‘… = ğ‘Ÿ, ğ¸ "-$ QQQQQQ , ğ‘† "-$ QQQQQQ = 0) for all times ğ‘¡ . Conditioning on the random effects requires the conditional model for the outcome, ğ‘ƒğ‘Ÿ(ğ¸ 3 |ğ‘… = ğ‘Ÿ, ğ‘† = 0, Î˜ = ğœƒ) , and the model of the distribution of the random effect in the overall population, Pr(Î˜ = ğœƒ). With the deterministic relation of the doses given randomization and intercurrent event, the model of the outcome can be formulated as conditioning on the doses, ğ‘ƒğ‘Ÿ(ğ¸ 3 |ğ· ] = ğ‘‘ Ì… , Î˜ = ğœƒ), which is the variant that is commonly used in pharmacometrics NLME M&amp;S.</p><p>In both cases, the models are estimated from the observed data. The fitted models are used to simulate a large number, e.g., 5000, of counterfactual outcomes ğ¸ 3 %,' $#! ,,,,,,,() that represent the distribution of interest.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Results</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Simulation of a trial with treatment confounder feedback</head><p>To evaluate the different estimation methods, a trial was simulated assuming a treatment-confounder feedback as illustrated in the causal graph (Figure <ref type="figure">2</ref>) with PK exposure being the outcome, previous exposure having a direct effect on the intercurrent event and the exposures at different time points being correlated due to their dependence on common individual parameters. This simulated trial constitutes the observed data to be analyzed with the different standardization approaches. The study evaluates five treatment arms with different target doses and different up-titration schedules (Table <ref type="table" target="#tab_1">1</ref>). As outcome of interest, we focused on exposure at week 8, two weeks after the last dose.  Each treatment arm was simulated to consist of 5000 patients. The large number of patients was selected to reduce the statistical uncertainty in the estimates and facilitate the detection of causal biases in the estimation methods. A 1-compartment PK model with bolus intravenous administration which assumes a linear elimination was used for the simulations <ref type="bibr" target="#b20">21,</ref><ref type="bibr" target="#b21">22</ref> . The model includes random effects to estimate individual's clearances and volumes. The random effects were considered to be independent of each other. A proportional residual error model was used.</p><p>In terms of the generic NLME from the introduction, the design variables of the example consist of the doses and the timing of the doses and PK sampling, ğ‘¥ !" = {ğ· !" , ğ‘‡ !" }; to simplify we assume that taking the trough sample and administering the next dose happen immediately after each other at the same time ğ‘‡ !" . The one compartmental PK model corresponds to the structural model and can be written as a sum of exponentials, e.g., for trough exposure after ğ‘› dose administrations as</p><formula xml:id="formula_15">ğ‘“(ğ‘¥ !" , ğœ“ ! ) = $ 5 % âˆ‘ ğ· !" ğ‘’ -67 % 5 % 8 9: %($'!) -: %" ; 3 "($ ,</formula><p>where the individual parameters ğœƒ ! consist of the individual apparent clearance, ğ‘ğ‘™ ! , and apparent volume, ğ‘£ ! . The simulation model assumed independent log-normal distributions for the individual parameters, e.g., ğ‘ğ‘™ ! = expEğœ‡ 67 + ğœ‚ 67,! F with ğœ‚ 67,! ~ğ‘(0, ğœ” 67 ) and ğœ‡ 67 the fixed effect model parameter and ğœ” 67 the standard deviation of the random effect. The assumed proportional residual error is ğ‘”(ğ‘¥ !" , ğœ“ ! , ğœ‰)ğœ€ !" = ğ‘“(ğ‘¥ !" , ğœ“ ! ) ğœ‰ ğœ€ !" .</p><p>The parameters are listed in Table <ref type="table" target="#tab_2">2</ref>, and the resulting PK profiles are shown in Figure <ref type="figure" target="#fig_5">3</ref>.  Simulated profiles of plasma mean concentrations before (Ground truth) and after (Intent to treat) introducing the treatment-confounder feedback in the simulations. Target-dose and up-titration as defined in Table <ref type="table" target="#tab_1">1</ref>.</p><p>Treatment-confounder feedback was implemented with high exposure being associated with increased probability of adverse events leading to delayed up-titration (e.g., patients with adverse events stay on the same dose level rather than up-titrating as planned). The probability of nonadherence, ğ‘ &lt; , was assumed to be</p><formula xml:id="formula_16">ğ‘ &lt; = inv. logit Uğ›½ log U = " &gt; "</formula><p>VV.</p><p>The thresholds were set to increasing values ğ›¼ Q = (ğ›¼ $ , ğ›¼ # , ğ›¼ ? ) = (15, 40, 100) ng/mL at weeks 2, 4 and 6, respectively, and chosen to correspond to typical exposures at these times. The parameter ğ›½, which determines the strength of the association, was set to 5. These parameters were selected so that the treatment-confounder feedback had a clear impact on the outcome, e.g., an about 14% reduction in exposure for treatment arm 5 (target dose 240, up-titration b). Figure <ref type="figure" target="#fig_6">4</ref> depicts the resulting trough exposures at week 8 after the fourth dose for treatment arm 5 (target dose 240, up-titration b). The plot shows the distribution of exposures that would be observed with full adherence (Ground truth), and the distributions when there is treatment-confounder feedback in the overall population (Intent to treat), and in the subset of patients that were able to adhere to the protocol (Per protocol), respectively. The exposure in the intent to treat population is smaller than the ground truth, since some patients do not up-titrate and receive lower doses. The exposure in the per protocol population is lower than the ground truth, since it summarizes patients that have a propensity for low exposure, since these are the patients that are most likely to adhere. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Implementation of the estimation methods</head><p>The following subsections describe the implementation of the estimation methods. Focus is on standardization conditioning either on early exposure or individual PK parameters as derived in the methods section. Inverse probability weighting (IPW) <ref type="bibr" target="#b5">6</ref> is proposed and evaluated as alternative.</p><p>Collectively these estimation methods are referred to as g-methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Standardization conditioning on early exposure</head><p>Parametric standardization conditioning on previous exposures requires models for the conditional distribution of the outcome given the previous exposures ğ‘ƒğ‘Ÿ(ğ¸ " QQQ |ğ‘… = ğ‘Ÿ, ğ¸ "-$ QQQQQQ , ğ‘† "-$ QQQQQQ = 0). Note that the interventions, i.e., randomization and the intercurrent events, define the doses, and we use the doses rather than the randomization or intercurrent events to specify the models (see also Discussion).</p><p>For the first exposure we assume that the logarithm of the dose normalized exposure is normally distributed with location parameter ğ›½ ) and scale parameter ğ›¾ ) , i.e., as</p><formula xml:id="formula_17">ğ‘™ğ‘œğ‘” U = ! @ ! V = ğ›½ ) + ğ›¾ ) ğœ€.</formula><p>Here and subsequently ğœ€~ğ‘(0,1) is a standard normal distribution. For the conditional model of subsequent exposures, we also assume a normal distribution. Its location depends on prior doses and the dose normalized exposure after the first dose ğ¸ 3A%B = ğ¸ $ ğ· $ â„ , and its scale on the previous two doses, i.e., as</p><formula xml:id="formula_18">ğ¸ " = ğ›½ .,) + v ğ›½ ",1 ğ· 1 " 1($ ğ¸ 3A%B + ğ›¾ @ "#! ,@ "</formula><p>with the ğ›½ and ğ›¾ being model parameters and more specifically ğ›¾ @ "#! ,@ " being different scale parameters for each combination of prior doses. Both models were evaluated using model diagnostics that indicated an appropriate fit of the observed data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Using NLME to condition on individual PK parameters</head><p>Parametric standardization conditioning on individual PK parameters, Î˜ , requires models for the distribution of the individual PK parameters Pr(Î˜ = ğœƒ) and a conditional model for the outcome given individual PK parameters ğ‘ƒğ‘Ÿ(ğ¸ Q |ğ· ] , Î˜ = ğœƒ). As introduced in the background section, both are components of (non-linear) mixed effects models, i.e., â„(. ), ğ‘“(. ) and Î©, and can be estimated together by fitting the models to the observed data. We used the same parametric model as was used for the simulation of the trial (Table <ref type="table" target="#tab_2">2</ref>). Note again that the randomization and the intercurrent events together define the doses that a patient receives, and that as is commonly done in pharmacometrics NLME M&amp;S doses were used for the model fitting.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Using inverse probability weighting (IPW) conditioning on previous exposures</head><p>As an alternative to standardization, we also implemented inverse probability weighting (IPW) as described in text books e.g., section 21.2 of Ref <ref type="bibr" target="#b5">6</ref> . IPW requires a model of the probability of the intercurrent events given previous exposures. We use the same relation as was used to introduce the treatment-confounder feedback in the simulated trial.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Estimation using standardization</head><p>This section presents the estimates obtained for the hypothetical scenario that the intercurrent event does not occur for the simulated trial with treatment-confounder feedback. This scenario is known to us from the simulation setup, and we refer to it as ground truth (Figure <ref type="figure" target="#fig_6">4</ref>). Being interested in the exposure for the planned treatment schedule, we evaluate possibilities to correct for the confounding using NLME M&amp;S or other g-methods (inverse probability weighting (IPW), standardization) for causal inference. We find that all methods can correct for the confounding, as long as the identifiability assumptions required for valid causal inference hold, including in particular positivity, no unobserved confounding, and correct specification of parametric models.</p><p>Figures <ref type="figure" target="#fig_7">5</ref> and<ref type="figure" target="#fig_8">6</ref> summarize the results. Figure <ref type="figure" target="#fig_7">5</ref> shows trough exposures after the fourth dose for treatment arm 5 (target dose 240, up-titration b). The plot displays the distribution of exposures that would be observed under full adherence (Ground truth) as reference, and the distributions in the presence of treatment-confounder feedback in the overall population of the simulated trial (Intent to treat), and in the subset of patients that could adhere to the protocol (Per protocol), respectively. The ground truth represents our main estimand, which as outlined in the introduction, is of interest, since it represents the situation that all patients reach the target dose. Reaching the target dose is an important outcome because it reflects what could happen in longer trials or in clinical practice when patients have more time to up-titrate. The intent to treat aims at a different estimand. It is of interest here since its difference to the ground truth illustrates the magnitude of the confounding due to the treatment-confounder feedback and since it can also be seen as an estimate of our estimand of interest that fails to adjust for the confounding. With the per protocol analysis, we simply illustrate a suboptimal estimate of our main estimand of interest; it corresponds to the result of inverse probability weighting with all weights being equal. Thus, these three distributions provide a reference of what we aim at estimating (ground truth) and two erroneous estimates of it that fail to adjust for the confounding (per protocol and intent to treat). Relative to the suboptimal estimates represented by the per protocol and intend to treat analyses, all estimation methods approach the ground truth both as judged by the location and the scale of the distribution.</p><p>Figure <ref type="figure" target="#fig_8">6</ref> summarizes results across treatment arms for all estimation methods and lists the mean and standard deviations of the distributions. To facilitate comparison with the ground truth, it also lists the mean and standard deviation relative to those of the ground truth. When looking at these numbers, it appears that NLME performs better than the other estimation methods. This is an artifact, however, from the setup of our simulation-estimation experiment. For NLME, we have used the same parametric model for the analysis as that used to simulate the trial data. This contrasts with standardization which relied on generic regression models to fit the simulated data. This approximation contributes to the (small) differences between the estimates obtained with these methods relative to the ground truth. For the IPW method, we calculated the weights using the same model as that used in the simulations for the probability of the intercurrent event. However, IPW also suffers from lack of positivity, since we also chose to parametrize the treatment-confounder feedback in a way to introduce an important difference between the distribution observed in the per-protocol population and that of interest (ground truth). This means that estimating the distribution for high exposures of interest will be challenging, because there will remain very few patients in the per protocol population.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean and standard deviation (SD) of trough exposures at week 8 after the fourth dose for the different treatment arms (Table 1). Ground truth and estimates: Standardization, standardization conditioning on previous exposures; NLME, standardization conditioning on individual parameters; IPW, inverse probability weighting. The relative results are the mean and SD of the estimated values divided by the mean of the ground truth.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Discussion</head><p>Causal inference methods rely on identifiability assumptions, in particular, exchangeability (or no unobserved confounding), consistency, positivity and correct specification of parametric models. For the present illustration, we have purposedly chosen a ground truth scenario largely fulfilling the necessary assumptions. There was no unobserved confounding, positivity was maintained in an adequate range, and parametric models were either exactly matching the ground truth or provided a good approximation. In the presented evaluation using simulation-estimation with known ground truth, any of the methods can be made to fail.</p><p>From the point of view of evaluating the population PK approach, we noted that results were questionable when continuing to use a simple linear PK model for the analysis but change the ground truth and simulate the study data with non-linear PK assuming target mediated deposition (Figure <ref type="figure" target="#fig_9">7</ref>, scenario labelled nonLinear); see, e.g., Ref <ref type="bibr" target="#b21">22</ref> for an overview over some PK models. This would be a typical case of model misspecification (using the wrong parametric model), which in practice we can detect with the help of model diagnostics. Population PK results didn't change much when increasing the degree of confounding (more IEs) or the magnitude of the residual error (Figure <ref type="figure" target="#fig_9">7</ref>, scenario labelled highRes). Interestingly, all estimation methods performed reasonably well against attempts to introduce unobserved confounding. In this attempt, we simulated IEs with a probability dependent on the unobserved maximal PK concentration rather than observed trough concentrations. All the estimation methods continued to provide reasonable estimates of the ground truth (Figure <ref type="figure" target="#fig_9">7</ref>, scenario labelled cmax). In our setup the trough exposure depends on the individual PK parameters, both on the individual volume and the individual clearance, whereas the maximal exposure depends only on the individual volume. Thus, conditioning on the individual volume and clearance using NLME continues to block all confounding paths in this situation, and the NLME is expected to remain valid. Conditioning on prior trough exposure does not block all paths, and some bias in the estimates is expected. Nonetheless trough exposures are a proxy for maximal exposure up to the addition of random variability due to the variability of the clearance, and conditioning on prior trough exposure does help to correct for some of the confounding.</p><p>When assessing NLME as an implementation of causal standardization, it seems advantageous to use an example for which NLME models are well established. Here we looked at drug pharmacokinetic exposure (drug plasma concentrations) as outcome. The existence of well-established population PK models (NLME) for the PK exposure 21, 22 motivated our choice. Available PK models often describe the data well and the available data is often sufficient to enable reliable estimation of individual parameters. Future work should also look at treatment-confounder feedback with efficacy or safety outcomes as the focus. One may want to differentiate three situations. First, if there is sufficiently rich longitudinal efficacy data, all the approaches presented here including NLME could work. Second, if the intercurrent event does not depend on efficacy, e.g., it is driven by drug exposure and tolerability, then efficacy is not a confounder. The approaches proposed and evaluated here can be expanded by adding an exposureresponse component such as going to PKPD models. Third, if we have only limited longitudinal efficacy data such as in a trial evaluating time to a terminal event, and the IE nonetheless depends on some unobserved aspects of efficacy, then none of the discussed approaches seems to provide a solution.</p><p>We found that it was difficult to determine adequate parametric models for the different estimation methods, except when we knew the correct model from the simulations that generated the trial data. This was the case for the probability of nonadherence, which we used for the IPW approach, and in the models for standardization when conditioning on individual PK parameters. For the models for standardization conditioning on early exposure, we ended up using linear models with the dose normalized exposure after the first dose as regressor for the location of the conditional distribution. This choice was based on the knowledge that we have linear dose proportional PK, which we knew from the simulation setup. Also, model diagnostics can support the selection of an appropriate parametric model, and their use is common practice in pharmacometrics analyses of clinical data with NLMEs. Alternatively, machine learning or other non-parametric methods could be envisaged and may avoid the need of having to identify appropriate parametric models.  <ref type="table" target="#tab_2">2</ref>) increased to 0.3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conclusions</head><p>NLME M&amp;S can be seen as an implementation of standardization for longitudinal data. Standardization relies on models of the outcome of interest conditional on the confounder. Conventionally, standardization for longitudinal data tends to be implemented sequentially with separate models for subsequent time points that condition on earlier outcomes. In contrast, NLME M&amp;S tends to use a single model that conditions on individual PK parameters (random effects) to describe the evolution of the system over the entire time course. All the g-methods, including non-linear mixed effects modeling, can correct for treatment-confounder feedback, provided that the causal identifiability assumptions hold.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><label></label><figDesc>= ğ‘Ÿ, Î˜ = ğœƒ)Pr (Î˜ = ğœƒ| ğ‘… = ğ‘Ÿ) + ğ‘‘ğœƒ by law of total probability = âˆ« ğ‘ƒğ‘ŸEğ¸ # ' ! () Jğ‘… = ğ‘Ÿ, Î˜ = ğœƒ, ğ‘† $ = 0)Pr (Î˜ = ğœƒ| ğ‘… = ğ‘Ÿ)ğ‘‘ğœƒ + by conditional exchangeability = âˆ« ğ‘ƒğ‘Ÿ(ğ¸ # |ğ‘… = ğ‘Ÿ, Î˜ = ğœƒ, ğ‘† $ = 0)Pr (Î˜ = ğœƒ| ğ‘… = ğ‘Ÿ) + ğ‘‘ğœƒ by consistency = âˆ« ğ‘ƒğ‘Ÿ(ğ¸ # |ğ‘… = ğ‘Ÿ, Î˜ = ğœƒ, ğ‘† $ = 0)Pr (Î˜ = ğœƒ) + ğ‘‘ğœƒ using independence of the individual parameters from the randomization. Both equations rely on the distribution of a confounder in the overall population estimated from the observed data and the observed conditional distribution of the outcome given the intervention ğ‘† $ = ğ‘  $ and the confounder. The confounder is either the previous outcome Pr (ğ¸ $ = ğ‘’ $ | ğ‘… = ğ‘Ÿ) conditional on the treatment arm ğ‘Ÿ or the individual parameters Pr(Î˜ = ğœƒ) . The conditional distributions are Pr(ğ¸ # |ğ‘… = ğ‘Ÿ, Î˜ = ğœƒ, ğ‘† $ = ğ‘  $ ) or ğ‘ƒğ‘Ÿ(ğ¸ # |ğ‘… = ğ‘Ÿ, ğ¸ $ = ğ‘’ $ , ğ‘† $ = ğ‘  $ ) , respectively. To describe these distributions, we use parametric models which we estimate from the observed data. The fitted models characterize the distribution of the counterfactual outcomes ğ¸ # ' ! in that they can be used to sample counterfactuals under different treatment strategies (Section 21.1 of Ref 6 ). Conditioning on the previous outcome ğ¸ $ corresponds to standardization as described in Ref 5 . Conditioning on the individual PK parameters differs in that the parameters are not directly observed but estimated by the random effects of a (non-linear) mixed effects model. The mixed effects model consists of the model of the distribution of the individual parameters Pr(Î˜ = ğœƒ) and the conditional model of the outcome ğ‘ƒğ‘Ÿ(ğ¸ # |ğ‘… = ğ‘Ÿ, Î˜ = ğœƒ, ğ‘† $ = ğ‘  $ ) given the individual parameters and the treatments. In the NLME notation of the background section, they correspond to â„(. ) , Î©, and ğ‘“(. ), respectively. With the NLME model fitted to the observed data, we can then simulate the counterfactual outcomes 16 .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. DAG and SWIG for 2 doses.</figDesc><graphic coords="7,74.49,87.38,442.39,202.95" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>1 = âˆ« ğ‘ƒğ‘ŸEğ¸ 3 %Figure 2 .</head><label>132</label><figDesc>Figure 2. SWIG for longitudinal trial.</figDesc><graphic coords="8,72.00,432.95,464.59,188.95" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>III and section 19 . 3 of 1 %</head><label>1931</label><figDesc>Ref 6 or Ref 5 . When removing the redundant doses and random effects from the conditioning set, while retainining the earlier outcome, sequential exchangeability takes the form Uğ· Based on consistency (Technical Point 19.3 of Ref 6</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><label></label><figDesc>) given at day 1, and then after 2, 4 or 6 weeks.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 3 .</head><label>3</label><figDesc>Figure 3. Plasma concentration time profiles of the different treatment arms of the simulated study.</figDesc><graphic coords="11,72.00,334.76,326.50,326.50" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 4 .</head><label>4</label><figDesc>Figure 4. Different summaries of plasma concentrations for one treatment arm.</figDesc><graphic coords="12,72.00,372.79,244.80,244.80" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 5 .</head><label>5</label><figDesc>Figure 5. NLME M&amp;S and other g-methods do provide a good estimate of the ground truth.</figDesc><graphic coords="15,72.00,64.88,363.75,363.75" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 6 .</head><label>6</label><figDesc>Figure 6. Comparison of estimation methods for the different treatment arms.</figDesc><graphic coords="16,72.00,79.13,420.00,420.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure 7 .</head><label>7</label><figDesc>Figure 7. Comparison of different g-methods for different types of data.</figDesc><graphic coords="18,72.00,87.38,420.00,420.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 :</head><label>1</label><figDesc>Treatment arms of the simulated study.</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2 :</head><label>2</label><figDesc>Parameters used for simulations.</figDesc><table><row><cell>Parameter</cell><cell>Value</cell></row><row><cell>Structural parameters</cell><cell></cell></row><row><cell>Clearance (L/h), ğœ‡ 67</cell><cell>0.0025</cell></row><row><cell>Volume (L), ğœ‡ 5</cell><cell>2</cell></row><row><cell>Between-subject variability, SD (random effect)</cell><cell></cell></row><row><cell>BSV on clearance, ğœ” 67</cell><cell>0.3</cell></row><row><cell>BSV on volume, ğœ” 5</cell><cell>0.3</cell></row><row><cell>Residual variability, SD</cell><cell></cell></row><row><cell>Proportional, ğœ‰</cell><cell>0.02</cell></row></table><note><p>PK model parameters used for simulations; symbols and formula are explained in the text.</p></note></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgements</head><p>This publication is the result of a thought process that took place over several years. During these years, we discussed aspects and ideas related to this publication with many colleagues. In particular, we want to thank <rs type="person">Jean-Louis Steimer</rs> and <rs type="person">Matt Tudball</rs> with whom we started to work on and then abandoned a manuscript with a larger scope of comparing causal inference methods and pharmacometric approaches, in general.</p></div>
			</div>			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Mixed effects models for the population approach: models, tasks, methods and tools</title>
		<author>
			<persName><forename type="first">M</forename><surname>Lavielle</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014">2014</date>
			<publisher>CRC press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Introduction to population pharmacokinetic/pharmacodynamic analysis with nonlinear mixed effects models</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">S</forename><surname>Owen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Fiedler-Kelly</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014">2014</date>
			<publisher>John Wiley &amp; Sons</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Linear mixed models with endogenous covariates: modeling sequential treatment effects with application to a mobile health study</title>
		<author>
			<persName><forename type="first">T</forename><surname>Qian</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Klasnja</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">A</forename><surname>Murphy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statistical science: a review journal of the Institute of Mathematical Statistics</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">375</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Joint mixed-effects models for causal inference with longitudinal data</title>
		<author>
			<persName><forename type="first">M</forename><surname>Shardell</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Ferrucci</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statistics in medicine</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="829" to="846" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Hypothetical estimands in clinical trials: a unification of causal inference and missing data methods</title>
		<author>
			<persName><forename type="first">Olarte</forename><surname>Parra</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Daniel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">M</forename><surname>Bartlett</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">W</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statistics in Biopharmaceutical Research</title>
		<imprint>
			<biblScope unit="volume">2023</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="421" to="432" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Causal inference: What if</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Hernan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Robins</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2020">2020</date>
			<publisher>Chapman &amp; hill/crc</publisher>
			<pubPlace>boca raton</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">addendum on estimands and sensitivity analysis in clinical trials to the guideline on statistical principles for clinical trials</title>
		<author>
			<persName><surname>Ich E9</surname></persName>
		</author>
		<idno>EMA/CHMP/ICH/436221/2017</idno>
		<ptr target="https://www.ich.org" />
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">Estimands-What they are and why they are important for pharmacometricians. CPT: pharmacometrics &amp; systems pharmacology 2021</title>
		<author>
			<persName><forename type="first">M</forename><surname>Akacha</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Bartels</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Bornkamp</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Bretz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Coello</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Dumortier</surname></persName>
		</author>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">279</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Basic concepts in population modeling, simulation, and model-based drug development-part 2: introduction to pharmacokinetic modeling methods</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">R</forename><surname>Mould</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">N</forename><surname>Upton</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013">2013</date>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="1" to="14" />
		</imprint>
	</monogr>
	<note>CPT: pharmacometrics &amp; systems pharmacology</note>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Basic concepts in population modeling, simulation, and model-based drug development: part 3-introduction to pharmacodynamic modeling methods</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">N</forename><surname>Upton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">R</forename><surname>Mould</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2014">2014</date>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="1" to="16" />
		</imprint>
	</monogr>
	<note>CPT: pharmacometrics &amp; systems pharmacology</note>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Basic concepts in population modeling, simulation, and model-based drug development</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">R</forename><surname>Mould</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">N</forename><surname>Upton</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2012">2012</date>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="1" to="14" />
		</imprint>
	</monogr>
	<note>CPT: pharmacometrics &amp; systems pharmacology</note>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Study designs for dose-ranging</title>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">B</forename><surname>Sheiner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">L</forename><surname>Beal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">C</forename><surname>Sambol</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Clinical Pharmacology &amp; Therapeutics</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="63" to="77" />
			<date type="published" when="1989">1989</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Dose/exposure-response modeling in dose titration trials: Overcoming the titration paradox</title>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">R</forename><surname>Kristensen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>AgersÃ¸</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">CPT: Pharmacometrics &amp; Systems Pharmacology</title>
		<imprint>
			<biblScope unit="volume">2022</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="1592" to="1603" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">A scoping review of causal methods enabling predictions under hypothetical interventions. Diagnostic and prognostic research 2021</title>
		<author>
			<persName><forename type="first">L</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Sperrin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Jenkins</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">P</forename><surname>Martin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Peek</surname></persName>
		</author>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="1" to="16" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title level="m" type="main">Causa Nostra: the potentially legitimate business of drawing causal inferences from observational data</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Rogers</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019">2019</date>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">253</biblScope>
		</imprint>
	</monogr>
	<note>CPT: pharmacometrics &amp; systems pharmacology</note>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">An introduction to causal inference for pharmacometricians</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Rogers</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Maas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">P</forename><surname>Pitarch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">CPT: Pharmacometrics &amp; Systems Pharmacology</title>
		<imprint>
			<biblScope unit="volume">2023</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="27" to="40" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Comparison of four basic models of indirect pharmacodynamic responses</title>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">L</forename><surname>Dayneka</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Garg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">J</forename><surname>Jusko</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of pharmacokinetics and biopharmaceutics</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="457" to="478" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Parametric approaches in population pharmacokinetics</title>
		<author>
			<persName><forename type="first">M</forename><surname>Guidi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Csajka</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Buclin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Journal of Clinical Pharmacology</title>
		<imprint>
			<biblScope unit="volume">2022</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="125" to="141" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<title level="m" type="main">Randomized trials analyzed as observational studies. American College of Physicians</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>HernÃ¡n</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>HernÃ¡ndez-DÃ­az</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Robins</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013">2013</date>
			<biblScope unit="page" from="560" to="562" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Causal diagrams for epidemiologic research</title>
		<author>
			<persName><forename type="first">S</forename><surname>Greenland</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Robins</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Epidemiology</title>
		<imprint>
			<biblScope unit="page" from="37" to="48" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title level="m" type="main">Mathematical expressions of the pharmacokinetic and pharmacodynamic models implemented in the Monolix software</title>
		<author>
			<persName><forename type="first">J</forename><surname>Bertrand</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>MentrÃ©</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2008">2008</date>
			<biblScope unit="page" from="1" to="68" />
			<pubPlace>Paris Diderot University</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title level="m" type="main">Mathematical expressions of the pharmacokinetic and pharmacodynamic models implemented in the PFIM software</title>
		<author>
			<persName><forename type="first">A</forename><surname>Dubois</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Bertrand</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>MentrÃ©</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2011">2011</date>
		</imprint>
		<respStmt>
			<orgName>UniversitÃ© Paris Diderot and INSERM</orgName>
		</respStmt>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
