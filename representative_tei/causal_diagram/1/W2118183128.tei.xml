<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Using Causal Diagrams to Guide Analysis in Missing Data Problems</title>
				<funder ref="#_XsZHwHE">
					<orgName type="full">Medical Research Council, UK</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">Rhian</forename><forename type="middle">M</forename><surname>Daniel</surname></persName>
							<email>rhian.daniel@lshtm.ac.uk</email>
						</author>
						<author>
							<persName><forename type="first">Michael</forename><forename type="middle">G</forename><surname>Kenward</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Simon</forename><forename type="middle">N</forename><surname>Cousens</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Bianca</forename><forename type="middle">L</forename><surname>De Stavola</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Faculty of Epidemiology and Population Health</orgName>
								<orgName type="department" key="dep2">London School of Hygiene and Tropical Medicine</orgName>
								<orgName type="department" key="dep3">Department of Infectious Disease Epi- demiology</orgName>
								<address>
									<settlement>London</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="department">School of Hygiene and Tropical Medicine</orgName>
								<address>
									<addrLine>Keppel Street</addrLine>
									<postCode>WC1E 7HT</postCode>
									<settlement>London</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Faculty of Epidemiology and Population Health</orgName>
								<orgName type="department" key="dep2">London School of Hygiene and Tropical Medicine</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Using Causal Diagrams to Guide Analysis in Missing Data Problems</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-14T19:27+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>missing data</term>
					<term>causal inference</term>
					<term>causal diagram</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Estimating causal effects from incomplete data requires additional and inherently untestable assumptions regarding the mechanism giving rise to the missing data. We show that using causal diagrams to represent these additional assumptions both complements and clarifies some of the central issues in missing data theory, such as Rubin's classification of missingness mechanisms (as missing completely at random (MCAR), missing at random (MAR) or missing not at random (MNAR)) and the circumstances in which causal effects can be estimated without bias by analysing only the subjects with complete data. In doing so, we formally extend the back-door criterion of Pearl and others for use in incomplete data examples. These ideas are illustrated with an example drawn from an occupational cohort study of the effect of cosmic radiation on skin cancer incidence.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>A key aim of medical and epidemiological research is to establish causal links between treatment, or other exposures, and outcomes. The gold-standard approach to achieve this aim is to conduct an 'ideal' randomised controlled trial (RCT), where by 'ideal' we mean large, double-blind, with no missing data and full compliance. Such ideal RCTs ensure that the observed outcomes in different treatment arms are free from any systematic differences except for those induced by the treatments being compared.</p><p>As we move from this ideal, causal inference increasingly requires further assumptions. Causal diagrams <ref type="bibr">1,</ref><ref type="bibr">2</ref> can represent these and the accompanying theory is useful in informing the design and analysis of studies. Pearl and Greenland et al. <ref type="bibr">1,</ref><ref type="bibr">2</ref> show how causal diagrams can be used to guide the choice of variables for data collection (and subsequent conditioning in the analysis), in order to make causal inferences more plausible.</p><p>Causal diagrams are increasingly used in non-randomised studies, where the main focus is on the control of naturally occurring confounding and investigator-induced selection bias. <ref type="bibr" target="#b2">3</ref> The case for using causal diagrams to represent the mechanism assumed to give rise to missing data has not been extensively studied. In this article we fill this gap, showing that causal diagrams can complement and clarify some key issues relating to the analysis of incomplete data.</p><p>We consider the problem of estimating the causal effect of exposure A (e.g. exposure to cosmic radiation) on outcome Y (e.g. skin cancer), when either A, Y or both, are incompletely observed. We consider whether or not this causal effect can be estimated without bias using only the complete records, i.e. subjects for whom both exposure and outcome are observed, and refer readers to appropriate alternative methods when this is not the case. We often consider additional covariates Z, and consider estimating the causal effect of A on Y conditional on Z. In this case, the definition of a complete record becomes a subject for whom A, Y and Z are all observed.</p><p>The assumptions underpinning a causal analysis can be divided in two: (a) causal assumptions, such as 'missingness is affected by exposure to radiation' and (b) parametric assumptions, such as 'the logarithm of the odds of skin cancer increases linearly with age'. The causal effect of A on Y will only be estimated without bias if the assumptions made-both (a) and (b)-are close to being correct. We focus on assumptions of type (a) and assume that assumptions of type (b) (which should be checked using the data) hold.</p><p>We start, in §2, with our motivating example, an occupational cohort study of the effect of cosmic radiation on skin cancer incidence. We discuss, informally, how causal diagrams might be used here. This is formalised in §3.</p><p>In §4, we apply our algorithm to various incomplete data scenarios, before returning-in §5-to our motivating example. The theoretical details, and further examples, are given in the Web Appendix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Motivating example: the British Commercial Airline Pilots and Air Traffic Control Officers Study</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">The data</head><p>The British commercial airline pilots and air traffic control officers (ATCOs) study is an occupational cohort study set up to compare cause-specific mortality and site-specific cancer incidence rates between British professional pilots, ATCOs and those in the general population. <ref type="bibr" target="#b3">4</ref> We focus on the estimation of the causal effect of cosmic radiation on skin cancer incidence, with cumulative flying hours serving as a proxy for radiation exposure.</p><p>Data on cumulative flying hours were collected using a questionnaire sent to about 27,000 eligible pilots and ATCOs with a response rate of around 50%. In addition, their permission was sought to access Civil Aviation Authority (CAA) medical records and NHS vital and cancer records, and around 92% consented. Outcome data (including skin cancer incidence) are available from these records. Other employment and personal information was collected in the questionnaires.</p><p>Estimating the causal effect of interest from these data requires consideration of the measurement error in the exposure, and the possibility of unmeasured confounders, as well as missing data. In this paper, we focus only on the missing data and proceed as if the proxy data are sufficiently close to the true exposure, and that-for this example-data on a sufficient set of confounders have been collected.</p><p>We will consider subjects with complete records to be those who responded to the questionnaire and responded to all the questions to be used in the analysis, as well as agreeing for their CAA and NHS records to be accessed. It is customary to treat unit non-responders (subjects who don't respond at all) separately from item non-responders (subjects who provide partial information), as the mechanisms leading to each are likely to be different. For simplicity, we will not distinguish between item and unit nonresponse in this article, even though the methods discussed extend naturally to incorporate this distinction.</p><p>We define the missingness indicator R to be 1 for the subjects with complete records, and 0 otherwise. We will only consider settings in which R may be causally affected by other variables, and not situations in which other variables are affected by R. In many settings (including our motivating example) this assumption is reasonable, although in some prospective studies, the act of being measured could itself affect a subject's subsequent behaviour.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Informal application of causal diagrams</head><p>Figure <ref type="figure" target="#fig_8">1</ref> shows a possible causal diagram for our example. Further possible diagrams are discussed in the Web Appendix. Arrows between variables denote the assumed direction of causal influence. Thus, Figure <ref type="figure" target="#fig_8">1</ref> represents the assumptions that both age and exposure to cosmic radiation have a causal effect on both the probability of developing skin cancer and a subject's propensity to respond (i.e. the probability of having a complete record). In addition, age has a causal effect on the exposure, and there are unmeasured influences on both the outcome and the propensity to respond (for more detail see §5). The magnitude of these causal influences is not specified, and thus an effect of magnitude zero (and hence independence of cosmic radiation and skin cancer, for example) is permitted. It is the omission of arrows in causal diagrams that represent our assumptions. So, in Figure <ref type="figure" target="#fig_8">1</ref> it is assumed that exposure to cosmic radiation is independent of genetic factors.</p><p>Conditioning on a common effect of two independent causes induces an association between them within strata of the conditioning variable. For some intuition as to why, consider measuring the association between sport-ing and academic ability at a selective school where both are used as entry criteria. Even if uncorrelated in the population, they will be negatively correlated within the school, since a pupil with low academic ability is likely to have high sporting ability, and vice versa. A common effect of two independent causes could take the form of a collider (so called because two or more arrowheads 'collide' there; e.g. R in Figure <ref type="figure" target="#fig_8">1</ref>), but also includes descendants of colliders (an example is given in the Web Appendix). Conditioning on a variable is denoted by placing a square box around it, and associations induced as a result of conditioning are denoted by dashed lines. Thus conditioning on R = 1 in Figure <ref type="figure" target="#fig_8">1</ref> results in the graph shown in Figure <ref type="figure">2</ref>. Note that this is no longer a causal diagram, since it represents non-causal (as well as causal) associations between variables.</p><p>It is tempting to treat Figure <ref type="figure">2</ref> as if it were a causal diagram and apply the back-door criterion to determine whether the causal effect of interest can be estimated without bias using only the complete records. Instructions on how to apply the back-door criterion are given in Greenland et al. <ref type="bibr">2</ref> Briefly, we look for a path from the exposure to the outcome, other than the causal path (exposure to cosmic radiation→skin cancer), which does not contain a collider. If no such path exists, the causal effect of interest is estimated without bias. If such a path exists, it must be blocked, for example by conditioning on a variable on that path. In Figure <ref type="figure">2</ref>, many back-door paths exist. Two of these can be blocked by conditioning on age and hair colour, but others remain.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">The need for greater formality</head><p>The previous paragraph is informal for many reasons. First, we are treating Figure <ref type="figure">2</ref> as if it were a causal diagram. In other words, we are applying the back-door criterion to Figure <ref type="figure" target="#fig_8">1</ref> and including R in the conditioning set. However, this is not permitted when R is affected by the exposure. 2 Also, the dashed lines induced by conditioning on R are added prior to deleting the arrows emanating from the exposure, which again is not correct. Finally, in one of the examples included in the Web Appendix, a 'back-door path' is evident only when additional sources of variation in the outcome, independent of all other variables in the diagram, are included in the diagram. However, only common causes of two or more variables already in the diagram need be included, implying that these additional nodes are unnecessary.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Guidelines for the use of causal diagrams in missing data problems</head><p>Two conditions need to be satisfied for the causal effect of exposure A on outcome Y to be identified from the complete records alone, conditional on a sufficient set of variables Z. The technical details are given in the Web Appendix. A summary of the algorithm for determining whether these conditions are satisfied is given below. First we give a few definitions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Preliminary definitions Definition 1.</head><p>A causal diagram G consists of nodes denoting variables, and arrows between nodes denoting the assumed direction of causal influence. Any variable which is the common cause of two or more variables in G must be in G.</p><p>Let V 0 be the subset of variables in G which would have been observed on all subjects had there been no missing data. If there are unmeasured nodes in G, such as those shown in Figure <ref type="figure" target="#fig_8">1</ref>, V 0 will not contain every node in G.</p><formula xml:id="formula_0">Definition 2 (path). If W 1 and W m are disjoint nodes in G, a path W 1 W 2 . . . W m from W 1 to W m is a sequence of nodes such that, for each k = 1, . . . , m -1, there is either an arrow from W k to W k+1 or from W k+1 to W k in G. Definition 3 (directed path). The path W 1 W 2 . . . W m is directed if all arrows go from W k to W k+1 . Definition 4. If there is an arrow from W i to W j in G, W j is a child of W i ,</formula><p>and W i a parent of W j . If there is a directed path from W i to W j in G, W j is a descendant of W i , and W i an ancestor of W j .</p><p>For example, in Figure <ref type="figure" target="#fig_8">1</ref>, there is a directed path from 'Red hair' to R via 'Unmeasured behavioural factors'. 'Age' is a parent of 'Skin cancer', R is a child of 'Exposure to cosmic radiation', R is a descendant of 'Red hair', and 'Unmeasured genetic factors' is an ancestor of R.</p><p>Each child-parent family in G (containing n nodes W 1 , . . . , W n ) corresponds to a function</p><formula xml:id="formula_1">W i = f i (pa (W i ) , ε i ) i = 1, . . . , n<label>(1)</label></formula><p>from a nonparametric structural equations model, where {ε i : i = 1, . . . , n} are independent unobserved random disturbances, and pa (W i ) are the parents of W i in G.</p><p>Definition 5 (do operator). wj denotes the act of intervening on W j and setting its value to w j . W j = wj is verbalised "do W j equals w j " or "set W j equal to w j ".</p><p>Definition 6 (causal effect). For any l ̸ = k, the causal effect of W l on W k , denoted pr (w k | wl ), is a function from W l to the space of probability distributions on W k . For each w l , pr (w k | wl ) gives the probability of W k = w k induced by intervening on W l and setting its value to w l . This probability is calculated by removing W l = f l (pa (W l ) , ε l ) from (1) and replacing W l with w l in all other equations.</p><p>Thus, in general, the causal effect of W l on W k is a comparison of the different probability distributions for W k obtained under the (hypothetical) interventions we could perform on W l . However, often the term causal effect is used in connection with a specific function of pr (w k | wl ), such as the causal mean difference</p><formula xml:id="formula_2">E (W k | wl = 1 ) -E (W k | wl = 0 ) = ∑ w ′ :pr(w k =w ′ )&gt;0 w ′ pr (w k = w ′ | wl = 1 )- ∑ w ′ :pr(w k =w ′ )&gt;0 w ′ pr (w k = w ′ | wl = 0) ,</formula><p>or, for binary W k , the causal odds ratio</p><formula xml:id="formula_3">pr (w k = 1 | wl = 1 ) pr (w k = 0 | wl = 0) pr (w k = 0 | wl = 1 ) pr (w k = 1 | wl = 0) .</formula><p>In this article, we use causal effect to mean the full function pr (w k | wl ), although we also consider the properties of particular causal measures, such as the causal odds ratio.</p><p>The probability pr (w k | wl ) is fundamentally different from pr (w k |w l ). The former is the probability of observing W k = w k given that we force W l to take the value w l , whereas the latter is the probability of observing W k = w k given that we happen also to observe W l = w l (i.e. the familiar conditional probability function). Consider the variables 'Exposure to cosmic radiation' (A), 'Age' (L) and 'Skin cancer' (Y ) in Figure <ref type="figure" target="#fig_8">1</ref>, but-for the sake of this discussion-let us assume that there is no arrow from A to Y , i.e. no causal effect of the exposure on the outcome. Suppose that older people tend to have a higher exposure and a higher incidence of skin cancer. Now suppose we could intervene on A by coating all aeroplanes in a substance that absorbs cosmic radiation, thereby setting A = 0 for all subjects. According to our causal diagram (together with the assumption that A has no causal effect on Y ), this intervention would have no effect on Y . Thus, knowing that this intervention had been performed and that therefore a subject had zero exposure would tell us nothing about pr (Y = 1). That is, according to Figure <ref type="figure" target="#fig_8">1</ref> (and the additional assumption of no causal effect), pr (Y = 1 |ǎ) = pr (Y = 1). However, if-rather than intervening on A-we merely observe that a particular subject has a low exposure, this tells us that the subject is likely to be younger and thus less likely to have skin cancer, that is pr (Y = 1 |a) ̸ = pr (Y = 1). That pr (w k |w l ) ̸ = pr (w k | wl ) is a mathematical representation of the phrase "association is not causation". Definition 7 (conditional causal effect). The conditional causal effect of W l on W k , given W m , is denoted pr (w k | wl , w m ), and is defined as the conditional probability of W k = w k given W m = w m induced by intervening on W l and setting its value to wl .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Algorithm for determining whether or not the causal effect of</head><p>A on Y given Z can be identified from the complete records 1. Draw a causal diagram (G) for the problem.</p><p>2. Extend it (to G + ) by adding parents of A and parents of descendants of A (except for parents of R).</p><p>3. Take G + and draw a dashed line between any pair of variables that are both parents of R, or that share a child which is an ancestor of R. This is M + .</p><p>4. Draw a dashed line between any pair of variables that are both parents of a variable in Z, or that share a child which is an ancestor of a variable in Z.</p><p>5. Look for a generalised path (where a generalised path can consist of arrows in any direction and dashed lines) from A to Y , not passing through R, that either (i) starts with an arrow into A, or (ii) contains a dashed line. Does it contain a collider, and/or pass through a member of Z? If the answer is 'yes' for every generalised back-door path, condition 1. is satisfied. We call this condition the generalised back-door criterion.</p><p>6. Return to G. Remove all arrows into A.</p><p>7. Draw a dashed line between any pair of variables that are both parents of a variable in Z, or that share a child which is an ancestor of a variable in Z.</p><p>8. Look for a path from R to Y , not passing through A. Does it contain a collider, and/or pass through a member of Z? If the answer is 'yes' for every such path, condition 2. is satisfied.</p><p>If conditions 1 and 2 are satisfied then we show in the Web Appendixthat the causal effect of A on Y given Z can be identified from the complete records alone.</p><p>Intuitively, condition 1. ensures that any association seen between A and Y is causal. Suppose this association is estimated from a generalised linear model, then the coefficient of A can be given a causal interpretation if the first condition holds. Condition 2. concerns the 'intercept'. In order to identify pr (y |ǎ, z ) from the observed data, we must additionally be able to estimate the distribution of Y under the intervention ǎ = 0, and for this condition 2. is needed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Examples: applying the algorithm to various incomplete data settings</head><p>In this section, we look at examples of missing data mechanisms, use causal diagrams to represent them, and demonstrate how the algorithm above confirms and clarifies our understanding of the suitability of complete records analyses in these settings.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Missingness completely at random (MCAR)</head><p>An important distinction in the missing data literature is that between missing completely at random (MCAR), missing at random (MAR) and missing not at random (MNAR). <ref type="bibr" target="#b6">7</ref> A variable Z is MCAR if the probability that Z is observed, given the full data V 0 , is independent of V 0 . The MCAR assumption says that pr (R = 1 |v 0 ) is independent of the value of v 0 . Suppose that the missing questionnaires in our motivating example were missing as a result of a postal strike. It might then be reasonable to assume that the missing questionnaires are MCAR, i.e. that the fact that a questionnaire is missing is unrelated to the unseen answers written on that questionnaire.</p><p>In a causal diagram for this simple situation, R would be isolated from the rest of the graph. Thus, conditioning on R = 1 would have no consequence. More formally, the empty set satisfies the generalised back-door criterion, and there are no paths from Y to R. Thus, both conditions ( §3.2) are satisfied with Z = ∅. This confirms that a complete records analysis is valid when the mechanism is MCAR. This includes the situation in which Y is missing at random given (fullyobserved) A. To define the term missing at random we must first be more specific about what R = 0 implies. In particular, we suppose that Y is missing for some subjects, and that there is at least one variable in V 0 which is completely-observed. Y is missing at random (MAR) if the probability that R = 1, given the full data V 0 , is a function only of the observed part of V 0 , and not of the potentially missing value of Y . Suppose that A is employment status, and we believe that retired pilots were less likely to return the questionnaire than those still employed, but that apart from this, non-response was not related to any other variable, then assuming that data on current employment status are available from the CAA database, the data would be MAR given employment status.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Missingness driven only by exposure</head><p>Figure <ref type="figure" target="#fig_8">3(1a.</ref>) also includes the situation in which A is incomplete and the missingness mechanism depends only on A. This is a case of A being missing not at random: if A is neither MCAR nor MAR, A is MNAR. Given the full data, the probability that A is missing depends on the potentially unobserved value of A. Figure <ref type="figure" target="#fig_8">3(1a.</ref>) is a special case of MNAR, in which missingness depends only on A. An example is if high exposure to cosmic radiation increases the probability that pilots return their questionnaires (perhaps since increased exposure leads to more interest in the study).</p><p>The extended causal diagram (G + ) corresponding to Figure <ref type="figure" target="#fig_8">3(1a.</ref>) is shown in Figure <ref type="figure" target="#fig_8">3(1b.</ref>). Conditioning on R = 1 in the modified extended diagram (shown in Figure <ref type="figure" target="#fig_8">3(1c.</ref>)) does not introduce any dashed lines. Again, the empty set satisfies the generalised back-door criterion, and the only path from Y to R passes through A. Thus, both conditions ( §3.2) are satisfied by Z = ∅.</p><p>Without using causal diagrams, the implications for analysis of different missingness mechanisms can be illustrated using a simple artificial example with two continuous variables, an exposure A and an outcome Y , where Y is (apart from random error) a linear function of A (see Figure <ref type="figure" target="#fig_5">4</ref>). If Y is MCAR, then the complete records form a random subset of the full data, and any aspect of the joint distribution of A and Y (such as the mean of Y or the causal effect of A on Y ) can be consistently estimated using the complete records. This is not true when Y is MAR given A. If Y is more likely to be missing for high values of A, then the mean of the observed Y -values will be biased downwards as an estimate of the mean of Y . However, the causal effect of A on Y can be consistently estimated (for example using a linear regression of Y on A) using only the complete records. This can be seen in Figure <ref type="figure" target="#fig_5">4(A.</ref>), where Y is not observed if A &gt; 2.4 (hence MAR). The cut-off line drawn at A = 2.4 does not distort the unexplained variation in Y . Likewise, if A is MNAR dependent only on A, then the mean of the observed A-values will be biased but the causal effect of A on Y can be consistently estimated from the complete records.</p><p>Such extreme "cut-off" mechanisms are unlikely to occur in practice but their simplicity helps to illustrate the features also present in more plausible mechanisms.</p><p>The fact that, when exposures and/or covariates are MNAR given only themselves, a complete records analysis is valid, is not always wellunderstood, but has been demonstrated, for example, by Rathouz <ref type="bibr" target="#b11">12</ref> and confirmed in simulation studies by Giorgi et al. <ref type="bibr" target="#b12">13</ref> Illustrating the missingness mechanism using a causal diagram makes this considerably clearer. )), an association is induced between A and L through conditioning on their common child, R. This opens up the generalised back-door path A --L → Y and thus, for a complete records analysis to be unbiased, we must condition on L. In fact Z = {L} satisfies both conditions ( §3.2) and thus pr (y |ǎ, l ) can be identified from the complete records alone. This is consistent with the advice often given, that "if a variable is predictive of both outcome and missingness, it should be appropriately incorporated into the analysis".</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Missingness driven by exposure and covariates</head><p>The marginal causal effect pr (y |ǎ) is related to the conditional causal effect via pr</p><formula xml:id="formula_4">(y |ǎ) = ∑ l pr (y |ǎ, l ) pr (l)</formula><p>but pr (l) is not identifiable from the complete records, since L directly affects R. Thus this marginal causal effect cannot be identified. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Missingness driven by both outcome and exposure</head><note type="other">Figure</note></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.5">Missingness driven only by outcome</head><p>When missingness depends only on Y (see Figure <ref type="figure" target="#fig_0">3</ref>(4a.)), conditioning on R = 1 (see Figure <ref type="figure" target="#fig_5">3(4c.</ref>)) does not induce a dashed line between A and Y , but the generalised back-door path A --U 2 → Y is still created and cannot be blocked, and thus the conditions ( §3.2) remain violated. Note that this generalised back-door path would not have been uncovered had we not started by extending G to include U 2 .</p><p>Returning to Figure <ref type="figure" target="#fig_5">4(B.</ref>), the same picture is revealed. Using the line Y = 6 as a cut-off does distort the unexplained variation, and there is a corresponding bias in the estimate of the causal effect. Extremely high Yvalues for a given A are not observed under this MNAR mechanism, whereas extremely low Y -values for a given A are observed. This causes the attenuation seen in the estimate of the causal effect. This is mirrored in Figure <ref type="figure" target="#fig_5">3(4c.</ref>): by conditioning on R = 1, we induce an association between U 2 and A. When both U 2 and A are positively correlated with R, U 2 and A will be negatively associated within strata of R and the role of U 2 in a complete records analysis will be similar to that of a negative confounder for the causal effect of A on Y .</p><p>If the outcome is fully-observed, then principled methods for MAR in-complete data, such as direct likelihood, 8 multiple imputation, 9,10 or inverse probability weighting 11 might be considered. However, if the outcome is incomplete, then sensitivity analyses would again be advisable.</p><p>One apparent exception to the discussion relating to Figure <ref type="figure" target="#fig_5">3(4a.</ref>) is a well-conducted case-control study, where patients are selected with different probabilities according to the binary outcome Y (case or control) but, as a consequence of its reversibility, the odds ratio for the effect of A on Y in the selected subjects is known to be unbiased. <ref type="bibr" target="#b14">15</ref> The causal diagram for a case-control study is precisely that seen in Figure <ref type="figure" target="#fig_5">3(4a.</ref>). There is no contradiction here: when the causal diagram suggests that a particular causal effect (pr (y |ǎ)) is estimated with bias, this does not exclude the possibility that a particular many-to-one function of this causal effect (in this case, the causal odds ratio) could be estimated without bias.</p><p>Another case requiring special attention is Figure <ref type="figure" target="#fig_5">3(4a.</ref>) when the arrow from A to Y is removed (when the causal null hypothesis holds). In this case, condition 1. is satisfied, but condition 2. is not. A and Y remain independent even after conditioning on R = 1 (by condition 1.), but the distribution of Y is distorted (by the arrow from Y to R-condition 2.), and thus pr (y |ǎ) = pr (y) cannot be estimated without bias from the complete records. This agrees with the intuition given in §3.2.</p><p>Figure <ref type="figure" target="#fig_3">3(5a.</ref>) is the same as Figure <ref type="figure" target="#fig_5">3(4a.</ref>), except that a measured variable L has been added, which affects Y but nothing else. L can be thought of as a measured component of U 2 . Informally, conditioning on R = 1 induces confounding through both L and U 2 . We can condition on L and eliminate some of the bias. While this is in accord with another common piece of advice, "condition on as many covariates as possible to get closer to MAR", the theory of causal diagrams exposes the potential danger associated with this way of thinking: adjusting for variables which are affected by the exposure and/or outcome can introduce bias (cf. conditioning on R in Figures <ref type="figure" target="#fig_3">3(2a.</ref>-5a.)). Assuming that we take care to avoid introducing bias in this way, controlling for as many variables predictive of Y as possible is beneficial as it reduces the unexplained variation. This is analogous to reducing the 'spread' of the points about the straight line in Figure <ref type="figure" target="#fig_5">4(B.</ref>). This reduces (but does not eliminate) the bias in the coefficient of the exposure in the estimate of the causal effect.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.6">Missingness driven only by covariates</head><p>Finally, Figure <ref type="figure" target="#fig_7">3(6a.</ref>) is the same as Figure <ref type="figure" target="#fig_0">3</ref>(2a.), except that the effect of the exposure on R has been replaced with an effect of a cause M of the exposure on R. Thus, missingness is driven only by the covariates M and L, neither of which is a confounder of the relationship between A and Y , but one of which affects the exposure, the other the outcome. This sort of causal diagram has been the focus of many discussions. <ref type="bibr">2</ref> Conditioning on R = 1 (see Figure <ref type="figure" target="#fig_7">3(6c.</ref>)) induces an association between M and L, implying that we must additionally condition on either M or L (or both) in order for condition 1. ( §3.2) to be satisfied. However, for condition 2. to be satisfied, we must condition on L. In this case, the conditional causal effect of A on Y given L can be estimated from the complete records (but not the conditional causal effect of A on Y given M ). The symmetry of Figure <ref type="figure" target="#fig_0">3</ref>(6a.) with respect to L and M is misleading; when designing a study in such a situation, it would be far more important to plan measurement of L than of M .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Application: the British Commercial Airline Pilots and ATCOs Study</head><p>In the light of §3.2, we return to Figure <ref type="figure" target="#fig_8">1</ref> to give a more formal interpretation. First, in order to change the causal diagram to an extended causal diagram, we should include two additional nodes: one representing all causes of 'Exposure to cosmic radiation' and the other representing all other causes of 'Skin cancer' (not already in the diagram). It transpires in this case that these additional nodes have no bearing on any subsequent argument, and thus we have omitted them.</p><p>In addition to checking for unblocked generalised back-door paths (condition 1.), we must also check condition 2.: that there be no unblocked paths from 'Skin cancer' to R except through 'Exposure to cosmic radiation'.</p><p>We had already seen that the first condition given in §3.2 could not hold in Figure <ref type="figure" target="#fig_8">1</ref>. More formally, there are two generalised back-door paths that cannot be blocked ('exposure--Unmeasured behavioural factors→skin cancer' and 'exposure--Unmeasured behavioural factors←Unmeasured genetic factors→skin cancer'), while the paths via age and red hair can be blocked by conditioning on these variables.</p><p>Note that 'Red hair' plays a similar rôle to L in Figure <ref type="figure" target="#fig_0">3</ref>(5a.) and the same argument for adjusting for hair colour (along with age) to reduce some of this bias applies. Condition 2. also fails, since two paths from skin cancer to R remain open ('skin cancer←Unmeasured behavioural factors→R' and 'skin cancer←Unmeasured genetic factors→Unmeasured behavioural factors→R'). Collecting details on behavioural risk factors such as use of sun beds and hours spent sunbathing, and conditioning on these variables, would therefore be required to reduce the bias induced by missingness.</p><p>A discussion of other possible causal diagrams for this example is included in the Web Appendix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Discussion</head><p>In this article we have described a general graphical tool giving sufficient conditions under which the causal effect of an exposure A on an outcome Y can be identified (possibly conditionally on other variables Z) using only the collected variables (V 0 ) in the subjects with complete records. Although more sophisticated approaches than merely a complete records analysis are readily available and are, in general, to be advocated, it is important to know when a complete records analysis would suffice.</p><p>We reviewed (briefly, in §2.2) the use of causal diagrams to adjust for confounding using the back-door criterion. In §3, we extended this algorithm to the missing data setting. The theory is given in the Web Appendix. Further work is required, in particular with regards to the necessity of the conditions stated in §3.2. Nevertheless, we have shown these conditions to be sufficient and conjecture that they are also necessary.</p><p>Our approach is fully-integrable with the existing causal diagrams framework to deal with confounding. For this, the original causal diagram G is sufficient. In moving from G to M + , we have included additional nodes and additional (dashed) lines, but no node nor arrow has been removed, and thus the identification of the variables to control for confounding is not af-fected (cf. age in Figure <ref type="figure" target="#fig_8">1</ref>). When the data are incomplete, our algorithm encompasses the original back-door criterion found in Pearl 1 and Greenland et al. <ref type="bibr">2</ref> We considered a possible causal diagram for our motivating example (others are discussed in the Web Appendix), a study of the effect of exposure to cosmic radiation on skin cancer incidence in a population of airline pilots and air traffic control officers. Given the assumptions of Figure <ref type="figure" target="#fig_8">1</ref>, we showed that a complete records analysis of these data, even after adjusting for age and hair colour, would be biased. When planning another similar study, Figure <ref type="figure" target="#fig_8">1</ref> could be used to identify new questions to be included in the questionnaire, to provide observed variables on some of these generalised back-door paths.</p><p>As with all graphical approaches, the conclusions are only valid if the assumptions implied by the diagram are close to being correct. In the absence of good background knowledge of the subject area and the plausible causal mechanisms at play, including knowledge of the mechanisms giving rise to incomplete data, it is unfeasible to attempt a causally-interpretable analysis of the data.</p><p>One feature of our approach is that it concerns full causal effects rather than particular causal measures. It is possible for a particular causal measure (such as the causal odds ratio in a case-control study) to be identifiable from the complete records even when the full probability distribution of the outcome under varying exposure levels (i.e. the causal effect) cannot be identified. This is a consequence of the non-parametric nature of causal diagrams. The advantage of causal diagrams is their generality. They can be used to illustrate simply the relationships between many variables, and, using general rules, to focus attention on variables that lie on important pathways. The price to be paid for this generality is the lack of sensitivity to properties of particular causal measures, which must be established independently.</p><p>In summary, we have shown how Pearl's theory of causal diagrams can be used to determine whether a causal effect can be estimated without bias by analysing only the subjects with complete data. When this is not possible, the modified extended diagrams introduced in this article provide an intuitive tool to help understand how and why a complete records analysis is biased.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Exposure to cosmic radiation</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Skin cancer</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>R Age</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Unmeasured behavioural factors</head><p>Unmeasured genetic factors    </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Red hair</head><formula xml:id="formula_5">A Y 1a. R A Y L 2a. R A Y 3a. R A Y 4a. R A Y L 5a. R A Y M 6a. R L A Y 1b. R A Y L 2b. R A Y 3b. R A Y 4b. R A Y L 5b. R 6b. U 2 U 1 U 2 U 1 U 2 U 1 U 2 U 1 A Y M R L U 2 U 1 U 2 U 1 A Y 1c. R= 1 A Y L 2c. R= 1 A Y 3c. R= 1 A Y 4c. R= 1 A Y L 5c. R= 1 6c. U 2 U 1 U 2 U 1 U 2 U 1 U 2 U 1 A Y M R= 1 L U 2 U 1 U 2 U 1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Web Appendix</head><p>Using Causal Diagrams to Guide Analysis in Missing Data Problems</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Let G = {N , A} be a causal diagram representing the relevant variables for a particular problem and the causal influences believed to exist between them. N is the set of nodes, or variables, and A is the set of ordered pairs, or directed arrows, that exist between members of N . Let V 0 be the subset of N which would have been observed on all subjects had there been no missing data.</p><p>Let R ∈ V 0 be a binary variable taking the value 1 if all variables in V 0 are observed, and 0 otherwise. According to the definition of a causal diagram (see Pearl, 1995 1 ), any variable (whether observed or not) believed to be a common cause of two variables in N should itself be in N .</p><p>Let A ∈ V 0 be the exposure of interest, and Y ∈ V 0 be the outcome of interest.</p><p>Our aim is to determine from causal diagrams such as G 1 and G 2 shown in Figure <ref type="figure" target="#fig_8">1</ref> whether or not the causal effect of A on Y can be consistently estimated using only subjects with complete data on V 0 . In other words, can this causal effect be estimated using only variables in V 0 once we have conditioned on R = 1?</p><p>Using the knowledge that conditioning on a common effect of two independent causes (i.e. a collider or a descendant of a collider) induces an association between them within strata of the conditioning variable, we might try to modify G 1 and G 2 as shown in Figure <ref type="figure">2</ref>. Looking at the left-hand side of this figure, we see that conditioning on R = 1 has induced an association between A and L not present in the full data. Thus, in the subset of the data represented by the complete records, A is associated with L and L has a causal effect on Y . Even if A has no causal effect on Y , the two variables would be associated among the complete records, by virtue of their association with L. This suggests that we should control for L in any complete records analysis.</p><p>On the other hand, conditioning on R = 1 in G 2 appears not to have induced any new associations. However, if we extend G 2 to include the unmeasured residual error U in Y , then conditioning on R = 1 induces an association between A and U (see Figure <ref type="figure" target="#fig_0">3</ref>) which appears to be detrimental to our estimation of the causal effect of interest, since we cannot control for U .</p><p>Informally, we are modifying G 1 and G 2 to represent what happens when we condition on R. Then, we are looking for 'backdoor paths' from A to Y (A --L → Y and A --U → Y , respectively) and looking for variables on these paths that could be controlled in order to block these paths.</p><p>But there are several issues with this informal approach. First, the inclusion of U in G 2 seems essential to the subsequent argument, even though U is not required to be in the diagram according to the definition of a causal diagram. Second, we are attempting to apply the backdoor criterion to a modified diagram, containing associational lines as well as causal arrows. This is not well-defined. Put another way, we are applying the backdoor criterion including R in the conditioning set, when R is a consequence of the exposure, something which is not permitted by the backdoor criterion as set out by Pearl 1 and Greenland et al 2 .</p><p>Our aim in this note is to define a new class of causal diagrams, which we call extended causal diagrams, together with the rules for their construction, so that they include all the additional nodes needed for missing data problems. Then, we will extend the backdoor criterion for use in modified extended diagrams, containing associational lines as well as causal arrows. Finally, we will prove that this extended backdoor criterion when applied to modified extended diagrams, in conjunction with one additional condition, is sufficient for determining when causal effects can be identified from incomplete data using only the complete records.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Preliminary definitions Definition 1.</head><p>A causal diagram G consists of nodes (or points) denoting variables, and arrows between nodes denoting the assumed direction of causal influence. Any variable which is the common cause of two or more variables in G, must itself be in G.</p><p>We write G = {N , A} where N is the set of nodes, or variables, in G; and A is the set of ordered pairs (i.e. directed arrows) that exist between members of N in G. Let V 0 be the subset of N which would have been observed on all subjects had there been no missing data. Thus R takes the value 1 if all variables in V 0 are observed, and 0 otherwise. We assume that A, Y, R ∈ V 0 , that is we must include A, Y and R in our diagram.</p><formula xml:id="formula_6">Definition 2 (path). If W 1 and W m are disjoint nodes in G, a path W 1 W 2 . . . W m from W 1 to W m is a sequence of nodes such that, for each k = 1, . . . , m -1, there is either an arrow from W k to W k+1 or from W k+1 to W k in G. Definition 3 (directed path). If W 1 and W m are disjoint nodes in G, a directed path W 1 W 2 . . . W m from W 1 to W m is a sequence of nodes such that, for each k = 1, . . . , m -1, there is an arrow from W k to W k+1 in G. Definition 4.</formula><p>If there is an arrow from W i to W j in G, W j is said to be a child of W i , and W i a parent of W j . If there is a directed path from W i to W j in G, W j is said to be a descendant of W i , and W i an ancestor of W j .</p><p>Each child-parent family in G (containing n nodes W 1 , . . . , W n ) corresponds to a deterministic function</p><formula xml:id="formula_7">W i = f i (pa (W i ) , ε i ) i = 1, . . . , n<label>(1)</label></formula><p>from a nonparametric structural equations model, where {ε i : i = 1, . . . , n} are independent unobserved random disturbances, the distributions of which remain unspecified, and pa (W i ) are the parents of W i in G. In other words, the value of W i does not follow deterministically from the value of its parents, because of the unobserved random disturbance ε i , but as a function of its parents and ε i , the relationship is deterministic and given by the function</p><formula xml:id="formula_8">f i (•).</formula><p>Pearl 1 argues that this formulation leads naturally to the notion of intervening on a particular variable in the model. For example, setting the value of W j to w j is equivalent to removing W j = f j (pa (W j ) , ε j ) from ( <ref type="formula" target="#formula_1">1</ref>) and replacing W j with w j in all the other equations.</p><p>Definition 5 (do operator). The notation wi is used to denote the act of intervening on W i and setting its value to w i . W i = wi is verbalised "do W i equals w i " or "set W i equal to w i ".</p><p>Definition 6 (causal effect). For any l ̸ = k, the causal effect of W l on W k , denoted pr (w k | wl ), is a function from W l to the space of probability distributions on W k . For each realisation w l of W l , pr (w k | wl ) gives the probability of W k = w k induced by intervening on W l and setting its value to w l . This probability is calculated by removing W l = f l (pa (W l ) , ε l ) from (1) and replacing W l with w l in all the other equations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Definition 7 (A and its descendants). Let d G (A) be the set consisting of A and its descendants in G.</head><p>Definition 8 (extended causal diagram). Let G + be the graph formed by adding to G any node which is a parent of d G (A) \ {R} i.e. any node which is a parent of A or a parent of a descendant of A (except for parents of R). This includes unobserved, and even unobservable, nodes, i.e. those which we might think of as 'residual error'/'random error'/ 'chance', so that these nodes that are descended from A (except for R if it is one of them) and A itself are no longer 'probabilistic nodes' in the diagram-their values are exactly determined by their (possibly unobservable) parents. We could include parents of R here too, but as they are not needed, it is simpler to omit them.</p><p>The extended causal diagrams G + 1 and G + 2 corresponding to G 1 and G 2 are shown in Figure <ref type="figure" target="#fig_5">4</ref>.</p><p>Definition 9 (modified extended diagram). Take G + and join togetherwith a dashed line-any pair of variables that are both parents of R, or that share a child which is an ancestor of R. [Note that even if such a pair is already connected by an arrow (in either direction), a dashed line should be added as well.] The resulting diagram M + is known as the modified extended diagram.</p><p>The modified extended diagrams M + 1 and M + 2 corresponding to G 1 and G 2 are shown in Figure <ref type="figure">5</ref>.</p><p>Definition 10 (generalised path). A generalised path p in a modified extended diagram M + is a sequence of variables X 1 , . . . , X n ∈ M + such that each pair (X i , X i+1 ) is either connected by an arrow (in either direction) or a dashed line.</p><p>Note: A collider on a generalised path p is still defined as a variable X having converging arrows along p, so X 2 is not a collider on the path X 1 --X 2 ← X 3 . Also, a descendant of X is still defined as a node W connected to X via a directed path from X to W , i.e. X 3 is a descendant of X 1 in the path X 1 → X 2 → X 3 , but not in the path X 1 --X 2 → X 3 .</p><p>Definition 11 (blocking a generalised path). Let X , Y and Z be three disjoint subsets of nodes in a modified extended diagram M + . Let p be any generalised path from a node in X to a node in Y. Z blocks p if there is a node W on p satisfying one of the following:</p><p>1. W is a collider on p and neither W nor any of its descendants are in Z.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>2.</head><p>W is not a collider on p and W is in Z.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Proof of the main result</head><p>We prove the result using two lemmas. In the first lemma, we use the notation from Pearl 1 section 4: G X is the graph obtained from G by deleting any arrow emanating from X, and G X is the graph obtained from G by deleting any arrow pointing towards X.</p><p>Lemma 2. Let V 0 ⊂ N be the subset of N on which data have been collected on at least some subjects, i.e. a subject with a complete record would have data on all of V 0 and none of N \V 0 . If {R, Z} ⊂ V 0 satisfies the following:</p><formula xml:id="formula_9">1. (Y ⊥ ⊥ A |R, Z ) G A 2. (Y ⊥ ⊥ R |A, Z ) G A</formula><p>then pr (y |ǎ, z ) can be identified from the observed data on the complete records alone.</p><p>Proof. This follows from rules 1 and 2 in Theorem 3 of Pearl 1995 The proof of the main result follows automatically from these two lemmas. This implies the following algorithm for determining whether or not a set of variables Z is sufficient such that the conditional causal effect of A on Y given Z can be identified from the complete records alone. Intuitively, the first condition ensures that any association seen between A and Y (possibly conditional on other variables) is causal. Suppose this association is estimated from a generalised linear model, then the coefficient of A can be given a causal interpretation if the first condition holds. The second condition can intuitively be regarded as concerning the 'intercept'. In order to identify pr (y |ǎ, z ) from the observed data, we must additionally be able to estimate the distribution of Y under the intervention ǎ = 0, and for this to be identifiable from the complete records, the second condition is needed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">A note on our choice of Theorem 1 over Lemma 2 as a basis for our algorithm</head><p>It may seem counter-intuitive that we choose the first condition given in Theorem 1 as a basis for our algorithm (given in §3.2 of the main manuscript) rather than working directly with G and the first condition given in Lemma 2 (conditions 2 are identical in both). Our reasons for doing so are two-fold. First, as highlighted in §2.2 (also in the main manuscript), the condition given in Theorem 1 is more closely related to the informal use of causal diagrams in missing data problems that we have encountered in practice, and thus stating which extra nodes are required for this approach to be valid, and what exactly constitutes a back-door path in this setting via our generalised back-door criterion, achieves the goal of formalising what is already informally done. Second, the generalised back-door criterion allows us to see why and how the estimator of the causal effect may be biased. For example, in Figure <ref type="figure">2c</ref> in the main manuscript, we see that L acts as a confounder once we condition on R = 1. We do not believe that such an intuitive illustration of how biases arise can be obtained from using condition 1. of Lemma 2 instead. First, we informally treat Figures 9-11 as if they were causal diagrams and apply the back-door criterion to see if the causal effect of exposure to cosmic radiation on skin cancer can be estimated without bias using only the complete records.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Additional possible causal diagrams for the Airline Pilots and ATCOs study</head><p>In Figure <ref type="figure">9</ref>, there is a back-door path from exposure to outcome via age, suggesting that we should condition on age in the analysis.</p><p>In Figure <ref type="figure" target="#fig_8">10</ref>, there is a back-door path from exposure to outcome via occupation and unmeasured behavioural factors, suggesting that we should condition on one or other (or both) of these in the analysis. Since the latter is unmeasured, this would suggest conditioning on the former. Finally, in Figure <ref type="figure" target="#fig_8">11</ref>, the one back-door path cannot be blocked by measured variables.</p><p>In the light of the result given above, we now return to Figures <ref type="figure" target="#fig_7">6</ref><ref type="figure">7</ref><ref type="figure">8</ref>and attempt a more formal interpretation of these diagrams. First, it is necessary to include two additional nodes to each diagram: one representing all causes of 'Exposure to cosmic radiation' and the other representing all other causes of 'Skin cancer' (not already in the diagram). Assuming that 'Unmeasured genetic &amp; behavioural factors' includes all these for 'Skin cancer' in Figure <ref type="figure">8</ref>, it transpires that these additional nodes have no bearing on any subsequent argument relating to these particular diagrams, and thus we have not shown them. Now, in addition to checking for unblocked backdoor paths, we have learnt that we must also check one additional condition: that there be no unblocked paths from 'Skin cancer' to R except through 'Exposure to cosmic radiation'.</p><p>In Figure <ref type="figure" target="#fig_7">6</ref>, assuming that we adjust for age, this additional condition is satisfied. However, in Figure <ref type="figure">7</ref>, the path from R to 'Skin cancer' through 'Unmeasured behavioural factors' cannot be blocked and thus the conditions of Theorem 1 are not satisfied, even though there are no unblocked generalised back-door paths from the exposure to the outcome here. This is an example where condition 2. of Theorem 1 is required, and our original informal argument did not suffice.</p><p>Turning to Figure <ref type="figure">8</ref>, we had already noted that the first condition of Theorem 1 could not hold in this setting. As for the additional condition, this clearly does not hold either, by virtue of the direct arrow from 'Skin cancer' to R.   </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 3 (</head><label>3</label><figDesc>Figure 3(1a.) represents a causal diagram (G) with an arrow from A to R denoting that the probability of an incomplete record depends on A.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 3 (</head><label>3</label><figDesc>Figure 3(2a.) contains an additional variable L predictive both of missingness and Y . Without conditioning on R (e.g. when data are complete), an unadjusted analysis for the causal effect of A on Y is unbiased since there are no open back-door paths through L. However, upon extending the diagram (Figure 3(2b.)) and conditioning on R = 1 (Figure3(2c.)), an association is induced between A and L through conditioning on their common child, R. This opens up the generalised back-door path A --L → Y and thus, for a complete records analysis to be unbiased, we must condition on L. In fact Z = {L} satisfies both conditions ( §3.2) and thus pr (y |ǎ, l ) can be identified from the complete records alone.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 1 :Figure 2 :</head><label>12</label><figDesc>Figure 1: A possible causal diagram for the airline pilots study.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 :</head><label>3</label><figDesc>Figure 3: The first column shows the causal diagrams associated with various causal missingness mechanisms. In the second column, 1b.-6b. are extended causal diagrams corresponding to each of 1a.-6a. In the third column, 1c.-6c. are modified diagrams corresponding to each of 1b.-6b., showing the effect of conditioning on R = 1 on the relationship between other variables in the diagram.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: A comparison of (i) the full data estimate and (ii) the complete records estimate of the causal effect of A on Y under two different missingness mechanisms: missingness depends on A in panel A. and missingness depends on Y in panel B.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>2 . 1 . 1 .</head><label>211</label><figDesc>Z blocks every generalised path between A and Y which does not pass through R and which either (a) starts with an arrow into A, or (b) contains a dashed line [Note: this sort of a backdoor path can start with an arrow out of A]. 3 The main result Theorem If a set of variables Z ⊂ V 0 satisfies the following two conditions: Z satisfies the generalised back-door criterion relative to (A, Y ) in the modified diagram M + , and 2. having removed all arrows into A in G, all paths from R to Y are blocked by Z ∪ {A} then pr (y |ǎ, z ) is identifiable from the observed data on the complete records alone.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figures 6 -</head><label>6</label><figDesc>Figures 6-8 show three alternative candidate diagrams to the one shown in Figure 1 of the main manuscript. Conditioning on R = 1 results in the graphs shown in Figures 9-11.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: Two simple causal diagrams, G 1 (left) and G 2 (right).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure 2 : 1 UFigure 3 :Figure 4 :Figure 5 :</head><label>21345</label><figDesc>Figure 2: The same two simple diagrams, conditioning on R = 1.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Figure 7 :Figure 8 :Figure 10 :Figure 11 :</head><label>781011</label><figDesc>Figure 7: Another alternative causal diagram for the airline pilots study.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>3(3a.) shows missingness depending on both Y and A. Conditioning on R = 1 creates (see Figure3(3c.)) a dashed line between A and Y , which is itself a generalised back-door path, as well as the generalised back-door path A --U 2 → Y . Neither of these contains a measured variable and thus neither can be blocked. The conditions ( §3.2) are not satisfied by any Z ∈ V</figDesc><table /><note><p>0 . Whether A or Y (or both) is missing, this causal diagram represents a MNAR mechanism, where missingness depends on both A and Y . Complete records analyses are not valid in such settings and thus we should consider the robustness of our inferences to plausible MNAR mechanisms using sensitivity analyses (see, for example, Molenberghs and Kenward 14 , part V).</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>If Z satisfies the generalised backdoor criterion relative to (A, Y ) in M + then condition 1. of Lemma 2 holds.Proof. Suppose that this statement is false. Then, there must exist a graph G and a set of variables Z such that G A contains a back-door path p from A to Y not blocked by {Z, R}, but that all generalised back-door paths from A to Y in the corresponding M + are blocked by Z.Consider such a path p in G A . It must start with an arrow into A (since all arrows out of A have been deleted in forming G A ); p also exists in G, and in G + and hence in M + , since, in moving from G A to G to G + to M + , nodes and arrows are added, but never taken away.If p is open (after conditioning on {Z, R}) in G A but blocked by Z in M + , then we must be in one of the following two scenarios:1. A variable on p is a member of Z (and hence blocks p in M + ) but not of {Z, R} (and hence does not block p in G A ). This is clearly absurd since Z ⊂ {Z, R}. R}) in G A then p is an open generalised back-door path (after conditioning on Z) in M + , which proves the lemma.</figDesc><table><row><cell></cell><cell></cell><cell>1 . Pearl's</cell></row><row><cell cols="2">rule 2 states that if (Y ⊥ ⊥ A |R, Z ) G A , then</cell></row><row><cell cols="3">pr (y |ǎ, r, z ) = pr (y |a, r, z )</cell></row><row><cell cols="2">In particular, if (Y ⊥ ⊥ A |R, Z ) G A , then</cell></row><row><cell cols="3">pr (y |ǎ, R = 1, z ) = pr (y |a, R = 1, z )</cell></row><row><cell cols="2">Pearl's rule 1 states that if (Y ⊥ ⊥ R |A, Z ) G A</cell><cell>, then</cell></row><row><cell cols="3">pr (y |ǎ, r, z ) = pr (y |ǎ, z )</cell></row><row><cell>In particular, if (Y ⊥ ⊥ R |A, Z ) G A</cell><cell>, then</cell></row><row><cell cols="3">pr (y |ǎ, R = 1, z ) = pr (y |ǎ, z )</cell></row><row><cell cols="3">Putting both of these together, if (Y ⊥ ⊥ A |R, Z ) G A and (Y ⊥ ⊥ R |A, Z ) G A then</cell></row><row><cell cols="3">pr (y |ǎ, z ) = pr (y |a, R = 1, z )</cell></row><row><cell cols="3">We have re-written pr (y |ǎ, z ) as a quantity, pr (y |a, R = 1, z ), which in-</cell></row><row><cell cols="3">volves only an association between observed variables measured on subjects</cell></row><row><cell>with complete records.</cell><cell></cell></row><row><cell>Lemma 3.</cell><cell></cell></row></table><note><p>2. p contains a collider C such that either C belongs to {Z, R} or has descendants in {Z, R} (so that p is open in G A ), but C does not belong to Z and does not have descendants in Z (so that p is blocked in M + ). This means that p must contain a collider C with either C = R or C being an ancestor of R. Either way, p corresponds to a generalised back-door path p ′ in M + , which is identical to p except that C is not on p ′ and the parents of C on p are connected with a dashed line on p ′ . But if p is open in G A , then p ′ must be open in M + , since none of the variables (except for C) on p is in {Z, R} and thus none of the variables on p ′ is in Z. Thus we have shown that if a path p is open (after conditioning on {Z,</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head></head><label></label><figDesc>Extend this causal diagram by adding any variable which is a parent of A or a parent of a descendant of A (except for parents of R). This includes unobserved, and even unobservable, variables, i.e. those which we might think of as residual error or random error or 'chance'. Call this extended causal diagram G + .3. Take G + and join together-with a dashed line-any pair of variables that are both parents of R, or that share a child which is an ancestor of R. [Note that even if such a pair is already connected by an arrow (in either direction), a dashed line should be added as well.] The resulting diagram M + is known as the modified extended diagram.4. Join together-with a dashed line-any pair of variables that are both parents of a variable in Z, or that share a child which is an ancestor of a variable in Z.</figDesc><table><row><cell>2. 7. Join together-with a dashed line-any pair of variables that are both</cell></row><row><cell>parents of a variable in Z, or that share a child which is an ancestor</cell></row><row><cell>of a variable in Z.</cell></row><row><cell>8. Look for a path from R to Y , not passing through A. Does it contain</cell></row><row><cell>1. Draw a causal diagram (G) for the problem, making sure to include the a collider, and/or pass through a member of Z? If the answer to this</cell></row><row><cell>exposure of interest (A), the outcome of interest (Y ), and the missing-question is 'yes' for every such path, we say that condition 2. is</cell></row><row><cell>ness indicator (R). Any common parent of two or more variables in satisfied.</cell></row><row><cell>G must itself be included in G, irrespective of whether or not data on</cell></row><row><cell>this common cause have been collected.</cell></row></table><note><p><p>5. Look for a generalised path (where a generalised path can consist of arrows in any direction and dashed lines) from A to Y , not passing through R, that either (i) starts with an arrow into A, or (ii) contains a dashed line [Note: such a generalised path can start with an arrow out of A]. We call such a generalised path a generalised back-door path. Does it contain a collider, and/or pass through a member of Z? If the answer to this question is 'yes' for every generalised back-door path, we say that condition 1. is satisfied. We also call this condition the generalised back-door criterion.</p>6. Return to the original causal diagram, G. Remove all arrows into A.</p></note></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgements</head><p>We would like to thank <rs type="person">Prof. Stijn Vansteelandt</rs> for some illuminating discussion on this work, <rs type="person">Prof. Isabel dos Santos Silva</rs> for her guidance on the <rs type="institution">British</rs> airline pilots and ATCOs study used as an example in this paper, and <rs type="person">Prof. John Whittaker</rs> for his comments on an earlier version of the paper. We are also extremely grateful to two anonymous referees and a member of the editorial board for their very careful and constructive comments which have greatly improved the main article and the theoretical details given in the Web Appendix. This work was supported by a grant from the <rs type="funder">Medical Research Council, UK</rs> (Grant number: <rs type="grantNumber">G0701024</rs>).</p></div>
			</div>
			<listOrg type="funding">
				<org type="funding" xml:id="_XsZHwHE">
					<idno type="grant-number">G0701024</idno>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Exposure to cosmic radiation</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Skin cancer</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>R Age</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Exposure to cosmic radiation</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Skin cancer</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>R = 1 Age</head></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Causal diagrams for empirical research</title>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="page" from="669" to="709" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Causal diagrams for epidemiological research</title>
		<author>
			<persName><forename type="first">S</forename><surname>Greenland</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Robins</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Epidemiology</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="37" to="48" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A structural approach to selection bias</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Hernán</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Hernández-Díaz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Robins</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Epidemiology</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="615" to="625" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Lifestyle of UK commercial aircrews relative to air traffic controllers and the general population</title>
		<author>
			<persName><forename type="first">C</forename><surname>Pizzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">A</forename><surname>Evans</surname></persName>
		</author>
		<author>
			<persName><forename type="first">De</forename><surname>Stavola</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">L</forename><surname>Evans</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Clemens</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename></persName>
		</author>
		<author>
			<persName><forename type="first">Santos</forename><surname>Silva</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Aviation, Space, and Environmental Medicine</title>
		<imprint>
			<biblScope unit="volume">79</biblScope>
			<biblScope unit="page" from="964" to="974" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<author>
			<persName><surname>Causality</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>Cambridge University Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Formalising the use of causal diagrams in missing data problems</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">M</forename><surname>Daniel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">G</forename><surname>Kenward</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">N</forename><surname>Cousens</surname></persName>
		</author>
		<author>
			<persName><forename type="first">De</forename><surname>Stavola</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">L</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2010">2010</date>
		</imprint>
		<respStmt>
			<orgName>London School of Hygiene and Tropical Medicine</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Technical Report</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Inference and missing data</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">B</forename><surname>Rubin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="page" from="581" to="592" />
			<date type="published" when="1976">1976</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">Statistical Analysis with Missing Data</title>
		<author>
			<persName><forename type="first">Rja</forename><surname>Little</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Rubin</forename><surname>Db</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Multiple imputations in sample surveys</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">B</forename><surname>Rubin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Survey Research Methods Section</title>
		<meeting>the Survey Research Methods Section</meeting>
		<imprint>
			<publisher>American Statistical Association</publisher>
			<date type="published" when="1978">1978</date>
			<biblScope unit="page" from="20" to="34" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Multiple imputation after 18+ years</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">B</forename><surname>Rubin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Statistical Association</title>
		<imprint>
			<biblScope unit="volume">91</biblScope>
			<biblScope unit="page" from="473" to="489" />
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Analysis of semiparametric regression models for repeated outcomes in the presence of missing data</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Robins</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rotnitzky</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">P</forename><surname>Zhao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Statistical Association</title>
		<imprint>
			<biblScope unit="volume">90</biblScope>
			<biblScope unit="page" from="106" to="121" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Identifiability assumptions for missing covariate data in failure time regression models</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">J</forename><surname>Rathouz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="345" to="356" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">and the French Network of Cancer Registries FRANCIM. The performance of multiple imputation for missing covariate data within the context of regression relative survival analysis</title>
		<author>
			<persName><forename type="first">R</forename><surname>Giorgi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Belot</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Gaudart</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Launoy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statistics in Medicine</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="6310" to="6331" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">Missing Data in Clinical Studies</title>
		<author>
			<persName><forename type="first">G</forename><surname>Molenberghs</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">G</forename><surname>Kenward</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007">2007</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">A method of estimating comparable rates from clinical data: applications to cancer of the lung, breast and cervix</title>
		<author>
			<persName><forename type="first">J</forename><surname>Cornfield</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the National Cancer Institute</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="1269" to="1275" />
			<date type="published" when="1951">1951</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Causal diagrams for empirical research</title>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">82</biblScope>
			<biblScope unit="page" from="669" to="709" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Causal diagrams for epidemiological research</title>
		<author>
			<persName><forename type="first">S</forename><surname>Greenland</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pearl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Robins</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Epidemiology</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="37" to="48" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
