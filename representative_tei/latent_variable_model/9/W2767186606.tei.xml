<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Mostly harmless direct effects: a comparison of different latent Markov modeling approaches</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">Roberto</forename><surname>Di</surname></persName>
							<email>roberto.dimari@unict.it</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Economics and Business</orgName>
								<orgName type="laboratory">Zsuzsa Bakk Statistics Unit, Methodology</orgName>
								<orgName type="institution">University of Catania</orgName>
								<address>
									<country key="IT">Italy</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Institute of Psychology</orgName>
								<orgName type="institution">Leiden University</orgName>
								<address>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution">Corso Italia</orgName>
								<address>
									<addrLine>55</addrLine>
									<postCode>95129</postCode>
									<settlement>Catania</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Mostly harmless direct effects: a comparison of different latent Markov modeling approaches</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-14T17:22+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>latent Markov model</term>
					<term>direct effects</term>
					<term>model comparison</term>
					<term>stepwise modeling</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>We evaluate the performance of the most common estimators of Latent Markov (LM) models with covariates in the presence of direct effects of the covariates on the indicators of the LM model. In LM modeling it is common practice not to model such direct effects ignoring the consequences that might have on the overall model fit and the parameters of interest.</p><p>However, in general literature about latent variable modeling it is well known that unmodeled direct effects can severely bias the parameter estimates of the model at hand. We evaluate how the presence of direct effects influences the bias and efficiency of the three most common estimators of LM models, the one-step, two-step and three-step approaches. Furthermore we propose amendments (that were thus far not used in the context of LM modeling) to the two and three-step approaches that make it possible to account for direct effects and eliminate bias as a consequence. This is done by modeling the (possible) direct effects in the first step of the stepwise estimation procedures. We evaluate the proposed estimators through an extensive simulation study, and illustrate them via a real data application. Our results show, first, that the augmented two-step and three-step approaches are unbiased and efficient estimators of LM models with direct effects. Second, ignoring the direct effects leads to biased estimates with all existing estimators, the one-step approach being the most sensitive.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Mostly harmless direct effects: a comparison of different latent Markov modeling approaches.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Introduction</head><p>Latent Markov (LM) models are widely used in the social and behavioral sciences for modeling change over time. In its basic form, the model includes the repeated measurement over time of one or more variables of interest. Examples include estimating the change in brand choice behavior over time <ref type="bibr" target="#b13">(Poulsen, 1990)</ref> or modeling disease progression over time <ref type="bibr" target="#b6">(Jackson et al., 2003)</ref>.</p><p>These models assume the existence of a latent process, typically modeled as a first-order Markov chain with finite state space, which affects the distribution of the response variables.</p><p>A central assumption behind this approach is that the response variables are conditionally independent given this latent process. This is known as local independence, meaning that the latent process fully explains the observable behavior of a subject.</p><p>An extension of the model includes (time constant and time varying) covariates that predict the probability of belonging to certain latent states, or the transition probability between states over time. There are three main approaches to estimate LM models with covariates: one-step, two-step and three-step approaches.</p><p>Using the one-step approach (also known as full information maximum likelihood, FIML), the complete model of interest is estimated simultaneously. Although algorithms for simultaneous ML estimation exist (like the Baum-Welch type of EM algorithm), this approach is infeasible, hence hardly ever used in practice, when the number of time points, indicators and/or covariates is large. Furthermore, every time a small change is made to the model (for example adding a direct effect), the full model of interest has to be re-estimated. Because of these difficulties, stepwise estimation procedures, that break down the problem into smaller steps, have been suggested in literature.</p><p>One well known alternative is the three-step approach, whereby in step one the measurement model is estimated using a latent class (LC) model on the pooled data, then respondents are assigned to latent states (step 2), and in step three the assigned scores are related to covariates.</p><p>A problem with this approach is that the third step estimates are biased, due to ignoring the classification error introduced in step two. A bias-adjustment method was developed by J. K. <ref type="bibr" target="#b15">Vermunt (2010)</ref> for LC models, and implemented by Di Mari, <ref type="bibr" target="#b4">Oberski, &amp; Vermunt (2016)</ref> to LM models, which obtains unbiased estimates as long as the main assumptions are met.</p><p>Alternatively a two-step estimator proposed by <ref type="bibr" target="#b1">Bartolucci, Montanari, &amp; Pandolfi (2014)</ref> can be applied. Similarly to the three-step approach, in step one a LC model is estimated on the pooled data. In step two a LM model with covariates is estimated, while keeping the measurement model parameters fixed at the estimates obtained in step one. This approach is similar to the well known two-stage least square estimator from the econometric literature <ref type="bibr" target="#b9">(Murphy &amp; Topel, 1985;</ref><ref type="bibr" target="#b5">Hardin, 2002)</ref>. Using this approach, the complex estimation specific to FIML is broken down to manageable sized problems.</p><p>In the current paper we evaluate the bias and efficiency of the one-step, two-step and three-step approaches in the presence of direct effects. While using all of these approaches it is a common assumption that the covariates do not influence directly the indicator variables, the violation of this assumption was not evaluated thus far in the context of LM modeling. It is well known that both the one-step and three-step approaches are subject to severe bias when direct effects are present in latent class (LC), latent trait <ref type="bibr" target="#b0">(Asparouhov &amp; Muthén, 2014)</ref>, and regression mixture models <ref type="bibr" target="#b7">(Kim et al., 2016;</ref><ref type="bibr" target="#b10">Nylund-Gibson &amp; Masyn, 2016)</ref>. Notably, the amount of bias is increasing in the number of direct effects. As such it is of utmost importance to understand the consequences of the presence of unmodeled direct effects for LM models as well.</p><p>Furthermore, we propose alternative implementations of the stepwise approaches that model the direct effects in step one. Our proposal is motivated by the findings in <ref type="bibr" target="#b3">Bennink et al. (2015)</ref> for multilevel LC models, and <ref type="bibr" target="#b0">Asparouhov &amp; Muthén (2014)</ref> for LC models. Both papers show that including the direct effects in the first step leads to unbiased estimates of the parameters of interest in the last step model of LC models. Using the two-step approach, in step one the direct effects can be modeled, and the step two estimates conditioned on this adjusted step one model. Using this implementation, the final model contains the estimated effect of the covariates on the latent states and the transition probabilities, but also the direct effects, making it possible to interpret the direct effects, which is of interest in certain implementations.</p><p>Using the three-step approach, we propose an implementation that accounts for possible direct effects by modeling them as noise in an overparametrized step one model. Such an alternative makes it unnecessary to model the correct direct effects exclusively, rather using an augmented model that accounts for multiple possible direct effects. Then, the noise created by misspecifying the direct effects in the first step is dealt with by adding an absorbing second latent variable.</p><p>In the three-step approach, contrary to the one-step and the two-step approaches, using residual statistics to identify the correct direct effects cannot be done. In the augmented three-step approach, although it is not possible to interpret the direct effects in step three, it is possible to model them in a way that their presence does not affect the estimates of the parameters of interest.</p><p>The paper proceeds as follows: first we introduce the LM model in its most general form, discussing one-step, two-step and three-step ML estimation, including the proposed modifications to the stepwise approaches. Next we evaluate, using a simulation study, the performance of the various approaches and proceed to a real data example. In our conclusion we give a practical guideline to applied researchers about which approach to use under different circumstances.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The latent Markov model with covariates</head><p>Let Y 1t , . . . , Y Jt be J indicator variables measured for T + 1 time occasions, with t = 0, . . . , T. Let us indicate as Y t the full response pattern at time t, with realizations Y t , observed alongside with K covariates Z t . In addition, we denote the full set of response configurations and available covariates at the T + 1 measurement occasions respectively as Y and Z . The latent variable X t has a finite state space of size S and we let s t be one of the S possible latent states for time t. A latent Markov model formulates the probability of having a particular sequence of response configurations at the T + 1 time occasions, given the time-specific covariates, as follows</p><formula xml:id="formula_0">P (Y = y| Z) = S s0=1 S s1=1 • • • S s T =1 P (X 0 = s 0 | Z 0 ) T t=1 P (X t = s t |X t-1 = s t-1 , Z t ) T t=0 P (Y t = y t |X t = s t ),<label>(1)</label></formula><p>The model defined in Equation 1 is depicted in Figure <ref type="figure">1</ref>.</p><p>For the structural component we assume a first-order time-homogeneous Markov chain.</p><p>Covariates enter both in the initial state probability P (X 0 = s 0 | Z 0 ), and the latent transition</p><formula xml:id="formula_1">probability P (X t = s t |X t-1 = s t-1 , Z t ).</formula><p>The measurement component, as for standard latent class models for dichotomous responses, can be written as</p><formula xml:id="formula_2">P (Y t = y t |X t = s t ) = J j=1 P (Y jt = y jt |X t = s t ) (2)</formula><p>due to the assumption of mutual independence of the response variables given class membership, i.e. local independence. Although we assume time homogeneity, the measurement can be allowed to differ across time, and/or it can include direct effects of the covariates on one or more items. In our case it is natural to assume that, given the latent variable, Y jt has a Bernoulli distribution with success probability π sj .</p><p>For each combination of item and time, 1 ≤ j ≤ J and 0 ≤ t ≤ T, the conditional response probabilities can be parametrized as</p><formula xml:id="formula_3">log π sj 1 -π sj = θ js , for 1 ≤ s ≤ S,<label>(3)</label></formula><p>or</p><formula xml:id="formula_4">log π sj 1 -π sj = θ js + α j Z, for 1 ≤ s ≤ S,<label>(4)</label></formula><p>if direct effects of the covariantes are also included.</p><p>We estimate intitial state probabilities and transition probabilities using logistic models with the following parametrization</p><formula xml:id="formula_5">log P (X 0 = s| Z 0 ) P (X 0 = 1| Z 0 ) = β s0 + β s Z 0 ,<label>(5)</label></formula><p>with 1 &lt; s ≤ S, for the initial state probability, and</p><formula xml:id="formula_6">log P (X t = s|X t-1 = r, Z t ) P (X t = 1|X t-1 = r, Z t ) = γ 0s + γ 0rs + γ s Z t ,<label>(6)</label></formula><p>with 1 &lt; s ≤ S, and 1 &lt; r ≤ S for the transitions probabilities. We take the first category as reference -setting to zero the related parameters. For the transition model, this means that parameters related to the elements in the first row and column of the transition matrix are set to zero. This produces J × S measurement model</p><formula xml:id="formula_7">+ (S -1) × (K + 1) initial state probabilities + (S -1) × (1 + (S -1) + K)</formula><p>transition probabilities free parameters to be estimated.</p><p>The interpretation of category-specific effects is then in terms of difference from the first (reference) latent state.</p><p>Let</p><formula xml:id="formula_8">{(Y it , Z it )} n = {(Y 1t , Z 1t ), . . . , (Y nt , Z nt )</formula><p>} be a sample of independent observations, observed for t = 0, . . . , T time occasions. Parameter estimation is normally carried out in one step by maximizing the log-likelihood function</p><formula xml:id="formula_9">L = n i=1 log P (Y i = y i | Z i ).<label>(7)</label></formula><p>Iterative procedures, like the EM algorithm <ref type="bibr">(Dempster, Laird, and Rubin, 1977)</ref> can be used to maximize Equation (7). However, when using the standard EM, the time and storage required for parameter estimation of LM models increases exponentially with the number of time points <ref type="bibr">(Vermunt, Langeheine, &amp; Böckenholt, 1999)</ref>. For this reason, the forward-backward algorithm <ref type="bibr">(Baum, Petrie, Soules, &amp; Weiss, 1970;</ref><ref type="bibr">Welch, 2003)</ref> is typically implemented: this is a special version of the standard EM in which the size of the problem increases only linearly with the number of time occasions <ref type="bibr">(MacDonald, &amp; Zucchini, 1997</ref>). Yet, also estimation with forward-backward algorithm becomes infeasible when the number of time points, the number of indicators and/or the number of covariates one wants to include in the analysis are large <ref type="bibr" target="#b4">(Di Mari et al., 2016)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Stepwise estimation of latent Markov models</head><p>Bias-adjusted three-step method</p><p>The first step model treats repeated measures from the same individual as independent. The pooled observations are modeled using a LC model as shown in the leftmost side of Figure <ref type="figure">2</ref> and defined as follows:</p><formula xml:id="formula_10">P (Y = y) = S s=1 P (X = s)P (Y = y|X = s), (<label>8</label></formula><formula xml:id="formula_11">)</formula><p>where</p><formula xml:id="formula_12">P (Y = y|X = s) = J j=1 P (Y j = y j |X = s) (9)</formula><p>under local independence of responses given the latent process.</p><p>P (X = s), the class proportions, and P (Y j = y j |X = s), the conditional response probabilities, are parametrized with standard logistic regressions with only intercept terms, yielding to J × S + S -1 free parameters to be estimated. Estimation is done by maximizing the following log-likelihood function</p><formula xml:id="formula_13">L STEP1 = n i=1 T t=0 log P (Y it = y it ).<label>(10)</label></formula><p>In the second step, individuals are assigned to latent classes based on their posterior probabilities as shown in the middle part of Figure <ref type="figure">2</ref>. Posterior probabilities, or posterior class probabilities, are obtained as</p><formula xml:id="formula_14">P (X t = s t | Y t = y t ) = P (X t = s t )P (Y t = y t |X t = s t ) P (Y t = y t ) , (<label>11</label></formula><formula xml:id="formula_15">)</formula><p>by applying the Bayes rule. The most common classification rules, based on Equation (11), are modal assignment, which yields a hard partitioning of the data, and proportional assignment, which yields a soft (or crisp) partitioning. We will focus on modal assignment only 1 . Denoting the predicted class by W t , which only depends on Y t , modal assignment estimates W t allocating a weight w yts</p><formula xml:id="formula_16">= P (W t = s t | Y t = y t ) = 1 if P (X t = s t | Y t = y t ) is</formula><p>the largest, and a zero weight otherwise.</p><p>The amount of classification error can be evaluated as the probability of the estimated class value given the true one, which, by aggregating over the sample patterns, can be obtained <ref type="bibr" target="#b15">(Vermunt, 2010)</ref> as</p><formula xml:id="formula_17">P (W t = r t |X t = s t ) = 1 n(T +1) n i=1 T t=0 P (X t = s t | Y t = y t )w its P (X t = s t ) . (<label>12</label></formula><formula xml:id="formula_18">)</formula><p>In the third step (the rightmost part of Figure <ref type="figure">2</ref>), class assignments are used to estimate the structural component of the model in Equation ( <ref type="formula" target="#formula_0">1</ref>), while correcting for the classification error computed in step 2. Di Mari et al. ( <ref type="formula">2016</ref>) showed that the ML correction of <ref type="bibr" target="#b15">Vermunt (2010)</ref> for three-step estimation of LC models can be adapted for three-step estimation of LM models. That is, the relationship between covariates and the true state memberships X t can be estimated by defining a latent Markov model with the class assignments W t as a single indicator, while treating the classification error probabilities P (W t |X t ) as known:</p><formula xml:id="formula_19">P (W| Z) = X 0 ,...,Xt P (X 0 | Z 0 ) T t=1 P (X t |X t-1 , Z t ) T t=0 P (W t |X t ),<label>(13)</label></formula><p>with (S -1) × (K + 1) + (S -1) × (1 + (S -1) + K) free parameters to be estimated.</p><p>Hence, the estimation of the parameters of the structural component of ( <ref type="formula" target="#formula_0">1</ref>) is done by maximizing the following log-likelihood function:</p><formula xml:id="formula_20">L STEP3 = n i=1 log s0,...,s T P (X 0 = s 0 | Z i0 ) T t=1 P (X t = s t |X t-1 = s t-1 , Z it ) T t=0 P (W it = r it |X t = s t ).<label>(14)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Two-step method with direct effects</head><p>The first step model is a standard LC model estimated on the pooled data as described in Subsection "Bias-adjusted three-step method" and shown in the left hand side of Figure <ref type="figure">3</ref>. Let us denote as θ 1 the conditional response probabilities, defined in Equation ( <ref type="formula">9</ref>), which are patterns of each observation.</p><p>estimated in the first step model. <ref type="bibr" target="#b2">Bartolucci et al. (2015)</ref> showed that θ 1 can be used to consistently estimate the measurement model of Equation( <ref type="formula">2</ref>).</p><p>The second step consists in maximizing the following log-likelihood function</p><formula xml:id="formula_21">L(θ 2 |θ 1 = θ1 ) = n i=1 log P (Y i = y i | Z i ),<label>(15)</label></formula><p>where we denote the (S -1) × (K + 1) + (S -1) × (1 + (S -1) + K) parameters of the initial state probabilities and transition probabilities as θ 2 , and</p><formula xml:id="formula_22">P (Y i = y i | Z i ) = S s0=1 S s1=1 • • • S s T =1 P (X 0 = s 0 | Z 0 ) T t=1 P (X t = s t |X t-1 = s t-1 , Z it ) free T t=0 P (Y it = y it |X t = s t ) fixed . (<label>16</label></formula><formula xml:id="formula_23">)</formula><p>The log-likelihood of Equation ( <ref type="formula" target="#formula_21">15</ref>) is maximized with respect to θ 2 , whereby the J × S  <ref type="formula" target="#formula_21">15</ref>) is maximized again with respect to θ 2 . The estimation is broken down into peaces, making complex LM modeling with covariates manageable, whereas one-step estimation would be cumbersome, especially with many time points, indicators and/or covariates.</p><p>The augmented bias-adjusted three-step approach Unbiased three-step modeling in the presence of direct effects can be done if all residual associations are modeled correctly. Because the use of residual statistics to identify direct effects is not possible using the three-step approach, we propose an alternative somewhat overparametrized approach that could potentially obtain similar results to correctly modeling the (known) direct effects.</p><p>Let us introduce an additional latent variable Ψ, with state space of size P and we let p be one of the possible states. In addition, let us define D as the set of the J * , with J * ≤ J, indicators for which we might presume direct effects of the covariates. Instead of the model in Equation ( <ref type="formula" target="#formula_10">8</ref>), we consider modeling the pooled sample according to the following augmented first step model</p><formula xml:id="formula_24">P (Y = y) = S s=1 P (X = s)P (Y = y|X = s, Z, Ψ = p),<label>(18)</label></formula><p>where</p><formula xml:id="formula_25">P (Y = y|X = s, Z, Ψ = p) = j / ∈D P (Y j = y j |X = s) × j∈D P (Y j = y j |X = s, Z, Ψ = p). (<label>19</label></formula><formula xml:id="formula_26">)</formula><p>The parametrization we consider for the response probabilities is as follows</p><formula xml:id="formula_27">log π sj 1 -π sj = θ js + 1{j ∈ D}(ψ jp + α j Z),<label>(20)</label></formula><p>for 1 ≤ s ≤ S and 1 ≤ p ≤ P , with J × S + J * × P + J * × K free parameters. In most instances researchers have an initial knowedlge of which indicators are prone to have bias. In the augmented first step model of Equation ( <ref type="formula" target="#formula_24">18</ref>), the covariates assumed to have a direct effect are loaded on the indicators (see Figure <ref type="figure" target="#fig_2">4</ref>) based on a -even rough -knowledge on where the direct effects can be located. Intuitively, the additional latent variable Ψ is included in order to model the noise (D. <ref type="bibr" target="#b11">Oberski, 2016)</ref> that can be caused by misspecifying the direct effects. We choose to model such noise non-parametrically by using a discrete latent variable, similarly to what is done in the LC latent factor models of J. <ref type="bibr" target="#b14">Vermunt &amp; Magidson (2004)</ref>.</p><p>Once the step one model is estimated, posterior probabilities are computed using the formula in Equation ( <ref type="formula" target="#formula_14">11</ref>), and modal class assignments are then used -correcting for the classification error -to estimate the structural component of the model in Equation ( <ref type="formula" target="#formula_0">1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Simulation study</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Design</head><p>The objective of this simulation study is to evaluate the quality of the different modeling approaches for latent Markov models with covariates in the presence of one or more direct effects (DE) of the covariates on the indicators. Next to evaluating the commonly used approaches (one-step, two-step and three-step), we compare their performance to the hereby proposed modified stepwise estimators, that model the direct effects. Our expectation is that the approaches that model the direct effects (either explicitly or by modeling them as noise) will do better then the approaches that ignore these effects. We restrict ourselves to the situation where we model known direct effects, ignoring the problem of correctly selecting them. Indeed, our main interest is to investigate the percentage bias caused by the presence of direct effects, and whether this bias can be corrected if such direct effects are correctly modeled.</p><p>Each method will be assessed in terms of parameter estimates, percentage bias, relative efficiency (averaged standard error over averaged standard deviation), coverage rates and relative loss of precision in the estimate with respect to the correctly specified one-step (FIMLcorr) model. The methods included in the comparison are 1) one-step without DE (FIMLuncor), 2) correctly specified one-step (FIMLcorr), 3) two-step without DE (2STEP uncor) and 4) two-step with DE (2STEP corr), 5) bias-adjusted three-step with unmodeled DE (3STEP), 6) augmented bias-adjusted three-step (3STEPaug), where the second LV -discrete, with 6 latent states<ref type="foot" target="#foot_1">foot_1</ref> -and the covariate effects are loaded only on the three items which might have residual association with the covariates.</p><p>Class separation -strongly related to classification error -and sample size are known to affect stepwise modeling. In this simulation study, we manipulate separation only through the strength of the relationship between items and latent classes -conditional response probabilities -although other options are possible -e.g. number of items, the number of item categories, and the class sizes.</p><p>We generate the data from a three-class latent Markov model with six dichotomous responses (low/high) and two numeric time-fixed covariates, where one (Z 1 ) is included in both the initial state and the transition model, while the other (Z 2 ) is only included in the transition model. Z 1 is binary with scores -0.5, 0.5, while Z 2 has five categories, scored -2, -1, 0, 1, 2, and treated as continuous. Covariates Z 1 and Z 2 enter the structural models through the multinomial logit parametrization shown in Equations ( <ref type="formula" target="#formula_5">5</ref>) and ( <ref type="formula" target="#formula_6">6</ref>), with the first class as reference category. Parameter values are chosen such that initial state probabilities are about the same, and the probability of switching is about 0.2 -a typical setup in LM modeling, where stability tends to be larger than change. The intercepts of the initial state model were both set to 0, while β 2Z 1 = β 3Z 1 = -0.5. In the transition model, intercept terms are set to</p><formula xml:id="formula_28">γ 02 = γ 03 = -2, γ 022 = γ 033 = 4 and γ 023 = γ 032 = 2.</formula><p>Covariate parameters in the logit model for the transition probabilities were set to -1 for Z 1 in both classes, and to 0.25 for Z 2 in both classes. Z 1 has also a direct effect on the indicators, parametrized as in Equation ( <ref type="formula" target="#formula_4">4</ref>), according to the following three scenarios: a DE on the first item with α 1 = 0.5; DE's on the first and the last items, with α 1 = α 6 = 0.5; DE's on the first, the third and the last items, with α 1 = α 6 = 0.5, and α 3 = -0.5. All other α's are set to zero. The 3 scenarios are displayed in Table <ref type="table" target="#tab_0">1</ref>.</p><p>Classes' profiles are as follows: Class 1 is likely to give a high response on items 4 and 6, Class 2 on the first three items, and Class 3 on the first two and the last two items (Table <ref type="table" target="#tab_0">1</ref>).</p><p>The response probabilities for the most likely responses were set to 0.8 and 0.9, corresponding to moderate -entropy-based R 2 of about 0.7 -and high class separation -entropy-based R 2 of about 0.9 -in the first step model. The sample sizes used were 100, 500 and 1,000, and each sample unit is observed for 5 measurement occasions.</p><p>For all 18 simulation conditions, obtained by combining the specified class separation levels, sample sizes, and the three direct effect scenarios, we considered 500 replications and estimated the model using all six methods. Data generation and parameter estimation were carried out using Latent GOLD version 5.0 <ref type="bibr">(Vermunt and Magidson, 2013)</ref>, and results were analyzed in R. Results are presented in Subsection "Results".</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Results</head><p>Table 2 presents percentage bias, average relative efficiency (SE/SD), coverage of 95% CI's (CVG) and relative loss of parameter estimates with respect to FIML corr for all six methods, averaged over covariate effects, sample size and separation conditions for the three DE scenarios. As can be seen, the bias-adjusted three-step (3STEP) does systematically better than the one-step (FIML uncor) and the two-step (2STEP uncor) with unmodeled DE approaches in terms of bias. However all uncorrected estimators have a percentage bias up to as high as 6% in the conditions with two and three direct effects. At the same time the two-step approach with modeled DE (2STEP corr) shows the same performance as the correctly specified one-step approach (FIML corr) in all DE scenarios, having a % bias of 2 / 2.5 percent in all conditions. The augmented three-step (3STEPaug) represents a good alternative -in terms of bias, SE/SD, coverage and loss of accuracy with respect to FIML corr -to the two-step approach with modeled DE, with difference between the two approaches vanishing as the number of DE's increases. With all estimators, the SE/SD is close to 1, showing that the SE estimators approximate the sampling variance well. Furthermore the coverage is close to the 95% for all estimators. While some estimators show more bias, the coverage is close to the 95% in all cases, because the more biased estimators have a higher variability, thus higher SE's (not shown directly here, see Appendix B for details).</p><p>Next we zoom in on the results separately for each combination of sample size, separation and number of direct effects. We report the % bias, SE/SD and coverage for one of the parameter estimates measuring the covariate effect on the initial state (β 2Z 1 = -0.50). We do so because the amount of bias we observe in the covariate effects on the initial states is larger than on the transition parameters, so the least optimistic results are reported.</p><p>Table <ref type="table" target="#tab_2">3</ref> shows that in the one direct effect condition the approaches that ignore the direct effects are doing well, having small percentage bias in all situations. These results are in line with the findings of <ref type="bibr" target="#b0">Asparouhov &amp; Muthén (2014)</ref>, who also found that in the one direct effect condition ignoring the DE does not cause large bias, contrary to the conditions with more DEs. Similarly to the results reported in Table <ref type="table" target="#tab_1">2</ref> the coverage and SE/SD shows values close to nominal levels in all situations.</p><p>At the same time in Table <ref type="table" target="#tab_3">4,</ref> and<ref type="table" target="#tab_4">Table 5</ref>, where we zoom in the results in the two and three direct effects conditions, the situation is different. The uncorrected approaches have a percentage bias up to 17.5% for the FIML approach and 14.5% for the stepwise approaches in the smallest sample size and moderate separation condition for the two direct effect condition, and up to 24% for FIML, and 22% for the stepwise estimators in the three direct effect condition. When comparing over all conditions, in Tables <ref type="table" target="#tab_3">4</ref> and<ref type="table" target="#tab_4">5</ref>, the approaches that do not model the direct effects, a general trend emergies: the FIMLuncorr has the most bias, followed by the 2stepuncor, with the most robust estimator being the 3STEP. With modeling the direct effects, all estimators have a small amount of bias, and there is no clear ordering of their performance with regard to bias. Furthermore, in all conditions, the SE/SD and coverage rate are close to the nominal level. The reason for this is that the SE estimates are very high in the conditions with high bias (we report the SE and SD per condition in Appendix B, where this tendency becomes obvious). In any case, looking at coverage in situations with high bias is not recommended.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A latent markov model of tolerance types</head><p>Our choice of real data example is motivated by an example used by <ref type="bibr" target="#b8">McCutcheon (McCutcheon, 1985)</ref> who showed how age and education groups differ with regard to their tolerance toward minority groups on data from the 1976 and 1977 General Social Survey (GSS) using a naive three-step approach.</p><p>We used data from the panel version of the same GSS survey including measurements from three years: 2010, 2012 and 2014, with a sample size of 2044, 1551 and 1304 respectively.</p><p>The data is openly available 3 . We selected six items that measure whether the respondents would allow members of different out-groups to speak in a public space. The items are formulated as follows: "Suppose this ... wanted to make a speech in your community. Should he be allowed to speak?" with response options "(Yes/No)". The six items refer to: communists, atheists, militarists, homosexuals, racists and Muslims. These items are used to measure an aspect of tolerance toward out-groups. It is interesting to note that, in the 1976 /77 version of the questionnaire, the item measuring tolerance toward Muslims was not yet included.</p><p>The covariates were re-coded following the approach of McCutcheon. Education was coded into three categories: less than twelve degrees (1), completed highschool (2) and higher educated (3). Cohort was coded into four categories: old (62 years and older, group 4), middle age (43-61 years old, group 3), young adults (25-42 years old, group 2) and young (18-24 years old, group 1).</p><p>We applied all six approaches to analyze the data. The results are discussed below.</p><p>Using both stepwise approaches in step one, following the recommendations of Di Mari et al.</p><p>(2016), we run a latent class model on the pooled data from the three years on the six items representing the measurement model. Using this approach we assume a time invariant measurement model -an approach commonly used in stepwise modeling, known to be robust.</p><p>In Table <ref type="table" target="#tab_5">6</ref> the class sizes and class specific response probabilities of the best fitting three class model are presented (AIC=-4150.90, BIC= -24771.78, χ 2 = 4192.30).</p><p>The first class, labeled 'Intolerant', has a low probability to give a positive answer on all items, while the second class (which is the largest class) has a high probability to give a positive answer on all items. The last class, labeled 'Middle', has a low probability to allow to speak for Muslims and racists, while being more tolerant toward the other groups.</p><p>Using the three-step approach, after establishing the step one model, posterior classifications are obtained in step two, and in step three the Markov model is built using the posterior classifications while correcting for the classification error. We used two implementations: the three-step approaches without correcting for possible direct effects, and the augmented three-step approach. As for the latter option, we decided to model possible direct effects by regressing the predictors and the second latent variable (with 6 classes) on 3 items that can have direct effects in the first step. Using this more complex step one model the posterior classifications were obtained in step two and used in the step three analysis. The Latent GOLD syntax for the more complex augmented three-step approach is available in the appendix together with the syntax of the two-step approach modeling the direct effect.</p><p>Using the two-step approach, after establishing the LC model, in step two we estimate the transition probabilities of the Markov model, and the effect of the covariates on the initial states and on the transition probabilities. After estimating this model we check for residual dependencies between the covariates and the six indicator variables using the L-BVR statistic (J. K. <ref type="bibr" target="#b16">Vermunt &amp; Magidson, 2016)</ref>. Two high residuals are identified between 'homosexuals' and cohort (L-BVR=25.50) and between 'racists' and education (L-BVR=14.10). The presence of these residuals shows that, after controlling for the latent classification, there is still a strong association left between the covariates and these specific items that should be accounted for. In order to account for these direct effects, we refit the step one model including the direct effects, followed by the corrected second step.</p><p>Using the one-step approach a similar strategy is used as with the two-step approach. After fitting the FIML model ignoring all possible direct effects we checked the residual statistics.</p><p>Using the L-BVR the same direct effects were identified as with using the two-step approach, namely between 'homosexuals' and cohort (L-BVR=25.50) and between 'racists' and education (L-BVR=14.10). After identifying the direct effects the model was refitted by modeling these effects explicitly.</p><p>In Table <ref type="table" target="#tab_6">7</ref> we report the model fit statistics for the one-step and two-step approaches with and without modeling the direct effects. Using both approaches we can see a significant decrease in the L 2 value, which is also reflected in a decrease in the AIC, but not consistently in the BIC that controls for model complexity. Given the significant change in the L 2 , we proceed with the more complex model that includes the direct effects. In three-step modeling, such a model selection strategy cannot be used, as the step-one and step-three models are not nested.</p><p>The estimated transition probabilities from the step one model of remaining in the same class are .70 for class one and three (intolerant and middle), and .90 for class two (tolerant class).</p><p>We found that 25% of the respondents moved from class one (intolerant) to the moderately tolerant class (class three). Furthermore, the second largest switch is the transition over time from the middle to the tolerant class (18% of the respondents).</p><p>In Table <ref type="table" target="#tab_7">8</ref> we report the covariate effects on the initial states and transition probabilities using the different approaches. More educated people have a higher probability to be in the middle and the tolerant group than the intolerant in the initial state. Education has a similar positive effect also on the transition probabilities. The effect of cohort is similar. Younger people have a higher probability to be in the tolerant and middle group as compared to the intolerant group at the initial state. Cohort has a significant effect on the transition probabilities with both approaches, namely younger people have a higher probability to be in the tolerant and middle classes as compared to intolerant over time. Furthermore, after controlling for class, there is a direct effect of cohort on education, namely older people are more tolerant toward homosexuals then predicted only by the restrictive model. Using all the approaches, the same overall conclusions are reached with regard to the direction of the effects.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conclusion</head><p>In the current paper we addressed an issue which is genuinely overlooked in latent Markov modeling: the consequences of ignoring direct effects between indicators of the latent concept and covariates. While in literature on latent class analysis and regression mixtures it is well known that direct effects can bias the parameters of interest <ref type="bibr" target="#b7">(Kim et al., 2016;</ref><ref type="bibr" target="#b0">Asparouhov &amp; Muthén, 2014)</ref>, there is no literature on this issue in latent Markov modeling. The reason can be that LM models are very complex, and estimating these models ignoring the direct effects is already problematic. We compared the performance of the three estimators used in LM modeling: the one-step approach (also known as full information ML), and the stepwise estimators, the two-and three-step approaches. Furthermore we proposed two improved stepwise approaches that can take into account the direct effects while keeping the main benefit of stepwise estimation.</p><p>We compared the traditional approaches, namely the one-step approaches and the stepwise approaches, with the two-and three-step approaches with the hereby proposed augmented first step, that model the direct effects instead of ignoring them. All methods were compared to the one-step approach including the direct effects, which, although being the statistically most efficient and unbiased estimator, is in practice hardly ever used because of the complexities of model estimation.</p><p>The results of the simulation study show that ignoring the direct effects will lead to bias in the estimated relationship between the LC variable and the covariate effects. Even more, the bias is more severe with increasing number of direct effects. Both stepwise corrected approaches (modeling the direct effects) do better than the uncorrected approaches in all conditions, and they have estimates similar to the ones obtained with the correctly specified one-step model.</p><p>The two-step approach follows the one-step corrected closer than the three-step in the one and two direct effect conditions, however the differences are less then 1 % averaged over all conditions. Furthermore it is also relevant to see that, among the incorrectly specified models, the three-step approach has the least bias, so is the most robust to misspecifications.</p><p>Next to bias, we looked at coverage and variance of the estimators as well. All corrected models have approximately 95% coverage (given that the uncorrected models have biased estimates, looking at the coverage is less relevant). Comparing the corrected stepwise approaches to each other we can see that the augmented three-step approach has larger variability than the corrected two-step approach. These findings can also be seen in the real data application, where, using the augmented three-step approach, the same overall conclusion is reached as with the corrected one-step and two-step, but point estimates are further away from the other approaches.</p><p>A practical advice would be to use the two-steps approach if the direct effects are of substantive interest, whereas using the augmented three step is recommended when the direct effects are not of interest -but just a source of bias. An extra argument in favor of the three-step approach is the faster computational time <ref type="bibr" target="#b2">(Bartolucci et al., 2015)</ref>, which can make a difference for large datasets -especially with many time points, indicators and covariates.</p><p>In this paper we chose to treat the direct effects as known using the one-step and two-step approaches for the simplicity of exposition. However, often in applied research it is not known beforehand where the direct effects are, and their exact location needs to be investigated.</p><p>While we shortly discussed the issue of using residual statistics such as the L-BVR to identify direct effects, including this in the simulation study was outside the scope of this paper. As such we recommend for future research to investigate how direct effects can be best identified in the context of latent Markov modeling. In the context of simple LCA, the EPC statistic and the BVR are successfully implemented (D. L. <ref type="bibr" target="#b12">Oberski &amp; van Kollenburg, 2013)</ref>: how they perform in the context of LM modeling is still to be investigated. Using the three-step approach, these statistics can not be used, so the safest and most lucrative option would be to have an overparametrized model, where also the resulting extra noise is modeled, as we propose in this paper.</p><p>Using both the two-and three-step corrected approaches, the direct effects need to be modeled in step one. It is still unknown the effect of adding covariates in the first step model on model selection, an issue that should be addressed by future research.   1.46 (0.13) 1.41 (0.12) 1.20 (0.13) 1.41 (0.12) 1.32 (0.12) 1.27 (0.13) educ_state2 0.66 (0.12) 0.47 (0.12) 0.20 (0.14) 0.62 (0.11) 0.43 (0.12) 0.38 (0.13) cohort_state1 -0.19 (0.09) -0.19 (0.10) -0.33 (0.11) -0.23 (0.09) -0.33 (0.10) -0.32 (0.11) cohort_state2 -0.10 (0.10) -0.12 (0.11) -0.33 (0.14) -0.17 (0.10) -0.25 (0.12) -0.29 (0.13) educ_transition 0.80 (0.17) 0.79 (0.16) 0.71 (0.19) 0.77 (0.17) 0.83 (0.17) 0.83 (0.18) educ_transition 0.42 (0.12) 0.48 (0.14) 0.64 (0.21) 0.42 (0.13) 0.60 (0.15) 0.71 (0.21) cohort_transition -0.31 (0.13) -0.39 (0.13) -0.56 (0.16) -0.32 (0.13) -0.39 (0.15) -0.50 (0.16) cohort_transition -0.24 (0.11) -0.26 (0.12) -0.40 (0.16) -0.27 (0.11) -0.40 (0.14) -0.47 (0.15)</p><formula xml:id="formula_29">Z Z Z 0 Z Z Z 1 Z Z Z T X 0 X 1 X T Y Y Y 0 Y Y Y 1 Y Y Y T Figure 1</formula><p>. Latent Markov model with covariates: one-step model</p><formula xml:id="formula_30">X 0 X 1 X T Y Y Y 0 Y Y Y 1 Y Y Y T</formula><p>Step one</p><formula xml:id="formula_31">Y Y Y 0 Y Y Y 1 Y Y Y T W 0 W 1 W T</formula><p>Step two</p><formula xml:id="formula_32">Z Z Z 0 Z Z Z 1 Z Z Z T X 0 X 1 X T W 0 W 1 W T</formula><p>Step three fixed fixed fixed</p><p>Figure <ref type="figure">2</ref>. The steps of the three-step LM model</p><formula xml:id="formula_33">X 0 X 1 X T Y Y Y 0 Y Y Y 1 Y Y Y T</formula><p>Step one</p><formula xml:id="formula_34">Z Z Z 0 Z Z Z 1 Z Z Z T X 0 X 1 X T Y Y Y 0 Y Y Y 1 Y Y Y T</formula><p>Step two fixed fixed fixed</p><p>Figure <ref type="figure">3</ref>. The steps of the two-step LM model</p><formula xml:id="formula_35">X 0 X 1 X T Y Y Y 0 Y Y Y 1 Y Y Y T Z Z Z 0 Z Z Z 1 Z Z Z T Ψ Augmented step one Y Y Y 0 Y Y Y 1 Y Y Y T W 0 W 1 W T</formula><p>Step two</p><formula xml:id="formula_36">Z Z Z 0 Z Z Z 1 Z Z Z T X 0 X 1 X T W 0 W 1 W T</formula><p>Step three fixed fixed fixed </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><label></label><figDesc>parameters of the measurement model are fixed at their first step values θ1 (see the right hand side of Figure 3), and all direct effects of the covariates on the indicators are set to zero. To test whether this causes any misfit, a local fit measure like the Longitudinal BiVariate Residuals (L-BVR) statistic (J. K. Vermunt &amp; Magidson, 2016) can be used. If any direct effect of the covariates is picked up by the L-BVR, the indicators showing residual associations with Z are freed and the first step model is re-estimated by modeling the direct effect as follows: P (Y = y) = S s=1 P (X = s)P (Y = y|X = s, Z). (17) The conditional response probabilities of indicators showing no residual association are simply modeled by using P (Y = y|X = s) instead of P (Y = y|X = s, Z). The estimated parameters are then used as fixed-value parameters in the second step, where the log-likelihood function of Equation (</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 4 .</head><label>4</label><figDesc>Figure 4. The steps of the augmented three-step LM model</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1</head><label>1</label><figDesc>Item-class probabilities in the simulation, with associated direct effects and sign in parentheses.</figDesc><table><row><cell></cell><cell cols="3">Class 1 Class 2 Class 3</cell><cell></cell><cell></cell><cell></cell></row><row><cell>Item</cell><cell></cell><cell></cell><cell></cell><cell cols="3">1 D.E. 2 D.E. 3 D.E.</cell></row><row><cell>1</cell><cell>low</cell><cell>high</cell><cell>high</cell><cell>(+)</cell><cell>(+)</cell><cell>(+)</cell></row><row><cell>2</cell><cell>low</cell><cell>high</cell><cell>high</cell><cell>×</cell><cell>×</cell><cell>×</cell></row><row><cell>3</cell><cell>low</cell><cell>high</cell><cell>low</cell><cell>×</cell><cell>×</cell><cell>(-)</cell></row><row><cell>4</cell><cell>high</cell><cell>low</cell><cell>low</cell><cell>×</cell><cell>×</cell><cell>×</cell></row><row><cell>5</cell><cell>low</cell><cell>low</cell><cell>high</cell><cell>×</cell><cell>×</cell><cell>×</cell></row><row><cell>6</cell><cell>high</cell><cell>low</cell><cell>high</cell><cell>×</cell><cell>(+)</cell><cell>(+)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 2</head><label>2</label><figDesc>Simulation Results -Covariate percentage bias (%Bias), SE/SD, coverage rates (CVG), and relative loss -RelLoss -of parameter estimates with respect to the correctly specified model (FIMLcorr), averaged over all covariate effects and simulation conditions.</figDesc><table><row><cell></cell><cell cols="2">%Bias SE/SD CVG RelLoss</cell></row><row><cell></cell><cell>1 direct effect</cell><cell></cell></row><row><cell>FIMLcorr</cell><cell>0.025 0.998 0.953</cell><cell>-</cell></row><row><cell>FIMLuncor</cell><cell>0.036 0.997 0.952</cell><cell>1.004</cell></row><row><cell cols="2">2STEP uncor 0.033 1.000 0.952</cell><cell>0.998</cell></row><row><cell>2STEPcorr</cell><cell>0.019 0.991 0.950</cell><cell>0.996</cell></row><row><cell>3STEP</cell><cell>0.035 1.005 0.955</cell><cell>0.999</cell></row><row><cell>3STEPaug</cell><cell>0.034 0.988 0.948</cell><cell>0.978</cell></row><row><cell></cell><cell>2 direct effects</cell><cell></cell></row><row><cell>FIMLcorr</cell><cell>0.021 0.998 0.953</cell><cell>-</cell></row><row><cell>FIMLuncor</cell><cell>0.057 0.997 0.949</cell><cell>1.039</cell></row><row><cell cols="2">2STEP uncor 0.051 0.204 0.948</cell><cell>1.037</cell></row><row><cell>2STEPcorr</cell><cell>0.016 0.204 0.953</cell><cell>0.993</cell></row><row><cell>3STEP</cell><cell>0.053 1.004 0.950</cell><cell>1.035</cell></row><row><cell>3STEPaug</cell><cell>0.025 1.005 0.951</cell><cell>1.001</cell></row><row><cell></cell><cell>3 direct effects</cell><cell></cell></row><row><cell>FIMLcorr</cell><cell>0.026 0.994 0.950</cell><cell>-</cell></row><row><cell>FIMLuncor</cell><cell>0.060 0.992 0.946</cell><cell>1.041</cell></row><row><cell cols="2">2STEP uncor 0.054 0.204 0.947</cell><cell>1.037</cell></row><row><cell>2STEPcorr</cell><cell>0.021 0.204 0.950</cell><cell>0.993</cell></row><row><cell>3STEP</cell><cell>0.057 0.994 0.949</cell><cell>1.039</cell></row><row><cell>3STEPaug</cell><cell>0.025 1.005 0.951</cell><cell>1.001</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 3</head><label>3</label><figDesc>Simulation Results -Covariate percentage bias (%Bias), SE/SD, coverage rates (CVG) -of β 2 Z 1 =(-0.50) separatly for all combinations of sample size and separation for the one direct effect condition.</figDesc><table><row><cell></cell><cell></cell><cell>Moderate separation</cell><cell></cell></row><row><cell></cell><cell>n=100</cell><cell>n=500</cell><cell>n=1000</cell></row><row><cell></cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell></row><row><cell>FIMLcorr</cell><cell>0.054 0.966 0.960</cell><cell>0.017 1.019 0.958</cell><cell>0.004 1.063 0.964</cell></row><row><cell>FIMLuncorr</cell><cell>0.008 0.964 0.960</cell><cell>0.079 1.016 0.954</cell><cell>0.057 1.065 0.962</cell></row><row><cell>2STEPuncor</cell><cell>0.027 0.975 0.958</cell><cell>0.083 1.022 0.954</cell><cell>0.059 1.067 0.962</cell></row><row><cell>2STEPcorr</cell><cell>0.085 0.969 0.948</cell><cell>0.037 1.089 0.978</cell><cell>0.017 0.982 0.942</cell></row><row><cell>3STEP</cell><cell>0.052 0.986 0.966</cell><cell>0.079 1.006 0.958</cell><cell>0.064 1.089 0.970</cell></row><row><cell>3STEPaug</cell><cell>0.124 1.016 0.962</cell><cell>0.099 0.995 0.954</cell><cell>0.122 0.985 0.926</cell></row><row><cell></cell><cell></cell><cell>Large separation</cell><cell></cell></row><row><cell></cell><cell>n=100</cell><cell>n=500</cell><cell>n=1000</cell></row><row><cell></cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell></row><row><cell>FIMLcorr</cell><cell>0.030 1.035 0.974</cell><cell>0.029 0.973 0.942</cell><cell>0.020 1.044 0.950</cell></row><row><cell>FIMLuncorr</cell><cell>0.001 1.035 0.972</cell><cell>0.003 0.974 0.942</cell><cell>0.052 1.043 0.952</cell></row><row><cell>2STEPuncor</cell><cell>0.009 1.046 0.976</cell><cell>0.005 0.974 0.942</cell><cell>0.053 1.044 0.950</cell></row><row><cell>2STEPcorr</cell><cell>0.026 1.061 0.974</cell><cell>0.006 0.998 0.952</cell><cell>0.003 1.024 0.960</cell></row><row><cell>3STEP</cell><cell>0.009 1.049 0.978</cell><cell>0.002 0.978 0.942</cell><cell>0.050 1.038 0.950</cell></row><row><cell>3STEPaug</cell><cell>0.018 1.036 0.956</cell><cell>0.052 0.969 0.932</cell><cell>0.027 0.988 0.940</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Table 4</head><label>4</label><figDesc>Simulation Results -Covariate percentage bias (%Bias), SE/SD, coverage rates (CVG) -of β 2 (-0.50) separatly for all combinations of sample size and separation for the two direct effect condition.</figDesc><table><row><cell></cell><cell></cell><cell>Moderate separation</cell><cell></cell></row><row><cell></cell><cell>n=100</cell><cell>n=500</cell><cell>n=1000</cell></row><row><cell></cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell></row><row><cell>FIMLcorr</cell><cell>0.070 0.928 0.944</cell><cell>0.008 1.019 0.962</cell><cell>0.019 1.013 0.956</cell></row><row><cell>FIMLuncorr</cell><cell>0.175 0.934 0.942</cell><cell>0.091 1.013 0.960</cell><cell>0.081 1.015 0.950</cell></row><row><cell>2STEPuncor</cell><cell>0.145 0.956 0.950</cell><cell>0.084 1.014 0.958</cell><cell>0.075 1.012 0.946</cell></row><row><cell>2STEPcorr</cell><cell>0.032 0.953 0.950</cell><cell>0.016 1.021 0.964</cell><cell>0.024 1.011 0.956</cell></row><row><cell>3STEP</cell><cell>0.143 0.974 0.952</cell><cell>0.087 1.014 0.958</cell><cell>0.070 0.984 0.942</cell></row><row><cell>3STEPaug</cell><cell>0.091 0.991 0.950</cell><cell>0.068 1.022 0.958</cell><cell>0.031 0.965 0.942</cell></row><row><cell></cell><cell></cell><cell>Large separation</cell><cell></cell></row><row><cell></cell><cell>n=100</cell><cell>n=500</cell><cell>n=1000</cell></row><row><cell></cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell></row><row><cell>FIMLcorr</cell><cell>0.032 0.970 0.954</cell><cell>0.033 1.033 0.954</cell><cell>0.027 1.036 0.950</cell></row><row><cell>FIMLuncorr</cell><cell>0.013 0.972 0.954</cell><cell>0.076 1.031 0.944</cell><cell>0.071 1.040 0.950</cell></row><row><cell>2STEPuncor</cell><cell>0.005 0.989 0.960</cell><cell>0.075 1.032 0.944</cell><cell>0.069 1.042 0.952</cell></row><row><cell>2STEPcorr</cell><cell>0.043 0.987 0.960</cell><cell>0.032 1.035 0.956</cell><cell>0.025 1.039 0.95</cell></row><row><cell>3STEP</cell><cell>0.004 1.003 0.964</cell><cell>0.073 1.034 0.938</cell><cell>0.069 1.043 0.946</cell></row><row><cell>3STEPaug</cell><cell>0.012 0.999 0.962</cell><cell>0.076 1.025 0.930</cell><cell>0.068 1.047 0.950</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 5</head><label>5</label><figDesc>Simulation Results -Covariate percentage bias (%Bias), SE/SD, coverage rates (CVG) -of β 2 (-0.50) separatly for all combinations of sample size and separation for the three direct effect condition.</figDesc><table><row><cell></cell><cell></cell><cell>Moderate separation</cell><cell></cell></row><row><cell></cell><cell>n=100</cell><cell>n=500</cell><cell>n=1000</cell></row><row><cell></cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell></row><row><cell>FIMLcorr</cell><cell>0.054 1.029 0.946</cell><cell>0.032 1.021 0.954</cell><cell>0.025 1.043 0.948</cell></row><row><cell>FIMLuncorr</cell><cell>0.242 1.023 0.952</cell><cell>0.142 1.021 0.948</cell><cell>0.147 1.028 0.930</cell></row><row><cell>2STEPuncor</cell><cell>0.225 1.037 0.956</cell><cell>0.136 1.028 0.946</cell><cell>0.140 1.030 0.928</cell></row><row><cell>2STEPcorr</cell><cell>0.029 1.044 0.960</cell><cell>0.037 1.029 0.954</cell><cell>0.029 1.043 0.950</cell></row><row><cell>3STEP</cell><cell>0.214 1.038 0.964</cell><cell>0.140 1.047 0.954</cell><cell>0.148 1.013 0.930</cell></row><row><cell>3STEPaug</cell><cell>0.025 1.074 0.968</cell><cell>0.095 1.042 0.956</cell><cell>0.096 0.998 0.946</cell></row><row><cell></cell><cell></cell><cell>Large separation</cell><cell></cell></row><row><cell></cell><cell>n=100</cell><cell>n=500</cell><cell>n=1000</cell></row><row><cell></cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell><cell>%Bias SE/SD CVG</cell></row><row><cell>FIMLcorr</cell><cell>0.026 0.981 0.960</cell><cell>0.012 0.946 0.936</cell><cell>0.002 1.016 0.964</cell></row><row><cell>FIMLuncorr</cell><cell>0.054 0.981 0.960</cell><cell>0.068 0.945 0.936</cell><cell>0.083 1.017 0.946</cell></row><row><cell>2STEPuncor</cell><cell>0.047 0.995 0.964</cell><cell>0.066 0.949 0.938</cell><cell>0.081 1.017 0.946</cell></row><row><cell>2STEPcorr</cell><cell>0.033 0.995 0.958</cell><cell>0.014 0.951 0.938</cell><cell>0.001 1.017 0.964</cell></row><row><cell>3STEP</cell><cell>0.042 1.011 0.962</cell><cell>0.062 0.957 0.944</cell><cell>0.076 1.020 0.946</cell></row><row><cell>3STEPaug</cell><cell>0.018 1.008 0.952</cell><cell>0.059 0.963 0.946</cell><cell>0.067 1.029 0.948</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head>Table 6</head><label>6</label><figDesc>Class sizes and conditional probabilities to give all-tolerant answers given the latent class.</figDesc><table><row><cell></cell><cell cols="3">"Intolerant" "Tolerant" "Middle"</cell></row><row><cell>Class size</cell><cell>0.19</cell><cell>0.51</cell><cell>0.30</cell></row><row><cell>Allow to speak...</cell><cell></cell><cell></cell><cell></cell></row><row><cell>Atheists</cell><cell>0.17</cell><cell>0.99</cell><cell>0.84</cell></row><row><cell>Communists</cell><cell>0.06</cell><cell>0.99</cell><cell>0.56</cell></row><row><cell>Militarists</cell><cell>0.16</cell><cell>0.97</cell><cell>0.64</cell></row><row><cell>Racists</cell><cell>0.13</cell><cell>0.94</cell><cell>0.44</cell></row><row><cell>Homosexuals</cell><cell>0.52</cell><cell>0.99</cell><cell>0.92</cell></row><row><cell>Muslims</cell><cell>0.02</cell><cell>0.86</cell><cell>0.07</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>Table 7</head><label>7</label><figDesc>Model fit statistics with the one-step and two-step approach</figDesc><table><row><cell></cell><cell>AIC</cell><cell>BIC</cell><cell cols="2">L 2 df difference L 2 dif</cell><cell>p</cell></row><row><cell>1-step</cell><cell cols="3">3660.57 -7640.98 7680.57</cell></row><row><cell cols="4">1-step direct 3597.64 -7692.66 7613.64</cell><cell>2 66.93 &lt;.001</cell></row><row><cell>2-step</cell><cell cols="3">3692.32 -7710.44 7748.32</cell></row><row><cell cols="4">2-step direct 3646.46 -7711.32 7685.46</cell><cell>2 62.76 &lt;.001</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head>Table 8</head><label>8</label><figDesc>The covariate effects on the initial states and transition probabilities obtained using the different approaches with class one as reference category</figDesc><table /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0"><p>In principle, both modal and proportional assignment rules can be used. Yet, proportional assignment may become infeasible with larger number of time points, as nonzero weights are allocated to all possible latent state</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_1"><p>A larger number of states was also tried, but in all cases we observed that a number approximately twice as large as the number of states in the latent variable of interest was enough to approximate the distribution of the noise.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="3" xml:id="foot_2"><p>https://www.icpsr.umich.edu/icpsrweb/ICPSR/series/28/studies/7398 ?archive=ICPSR&amp;sort</p></note>
		</body>
		<back>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix A</head><p>Latent GOLD syntaxes for the real data example for the two-step approach</p><p>Step one model including the direct effects Step two model Step three model  </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Auxiliary variables in mixture modeling: Three-step approaches using Mplus</title>
		<author>
			<persName><forename type="first">T</forename><surname>Asparouhov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Muthén</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="329" to="341" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A comparison of some estimation methods for latent markov models with covariates</title>
		<author>
			<persName><forename type="first">F</forename><surname>Bartolucci</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Montanari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Pandolfi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Compstat 2014-proceedings in computational statistics</title>
		<editor>
			<persName><forename type="first">M</forename><surname>Gilli</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">G</forename><surname>Gonzalez-Rodriguez</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">&amp;</forename><forename type="middle">A</forename><surname>Nieto-Reyes</surname></persName>
		</editor>
		<meeting><address><addrLine>Heidelberg, Germany</addrLine></address></meeting>
		<imprint>
			<publisher>Physica Verlag</publisher>
			<date type="published" when="2014">2014</date>
			<biblScope unit="page" from="423" to="431" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Three-step estimation of latent markov models with covariates</title>
		<author>
			<persName><forename type="first">F</forename><surname>Bartolucci</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Montanari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Pandolfi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computational Statistics and Data Analysis</title>
		<imprint>
			<biblScope unit="volume">83</biblScope>
			<biblScope unit="page" from="287" to="301" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Stepwise latent class models for explaining group-level outcomes using discrete individual-level predictors</title>
		<author>
			<persName><forename type="first">M</forename><surname>Bennink</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Croon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">K</forename><surname>Vermunt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Multivariate Behavioral Research</title>
		<imprint>
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="page" from="662" to="675" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Bias-adjusted three-step latent markov modeling with covariates</title>
		<author>
			<persName><forename type="first">R</forename><surname>Di Mari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">L</forename><surname>Oberski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">K</forename><surname>Vermunt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling: A Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="649" to="660" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">The robust variance estimator for two-stage models</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">W</forename><surname>Hardin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Stata Journal</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="253" to="266" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Multistate markov models for disease progression with classification error</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">H</forename><surname>Jackson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">D</forename><surname>Sharples</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">G</forename><surname>Thompson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">W</forename><surname>Duffy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Couto</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Royal Statistical Society: Series D (The Statistician)</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="page" from="193" to="209" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Modeling predictors of latent classes in regression mixture models</title>
		<author>
			<persName><forename type="first">M</forename><surname>Kim</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">K</forename><surname>Vermunt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Bakk</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Jaki</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">L</forename><surname>Van Horn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling: A Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="601" to="614" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">A latent class analysis of tolerance for nonconformity in the american public</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Mccutcheon</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Public Opinion Quarterly</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="474" to="488" />
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Estimation and inference in two-step econometric models</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">M</forename><surname>Murphy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">H</forename><surname>Topel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Business and Economic Statistics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="88" to="97" />
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Covariates and mixture modeling: Results of a simulation study exploring the impact of misspecified effects on class enumeration</title>
		<author>
			<persName><forename type="first">K</forename><surname>Nylund-Gibson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">E</forename><surname>Masyn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling: A Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="782" to="797" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Beyond the number of classes: separating substantive from non-substantive dependence in latent class analysis</title>
		<author>
			<persName><forename type="first">D</forename><surname>Oberski</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in Data Analysis and Classification</title>
		<imprint>
			<date type="published" when="2016">2016</date>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="171" to="182" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">A monte carlo evaluation of three methods to detect local dependence in binary data latent class models</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">L</forename><surname>Oberski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">K</forename><surname>Van Kollenburg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Geert</surname></persName>
		</author>
		<author>
			<persName><surname>Vermunt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Advances in Data Analysis and Classification</title>
		<imprint>
			<date type="published" when="2013">2013</date>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="267" to="279" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Mixed markov and latent markov modelling applied to brand choice behaviour</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">S</forename><surname>Poulsen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International Journal of Research in Marketing</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="5" to="19" />
			<date type="published" when="1990">1990</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Factor analysis with categorical indicators: A comparison between traditional and latent class approaches</title>
		<author>
			<persName><forename type="first">J</forename><surname>Vermunt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Magidson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">New developments in categorical data analysis for the social and behavioral sciences</title>
		<editor>
			<persName><forename type="first">L</forename><surname>Van Der Ark</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">M</forename><surname>Croon</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">K</forename><surname>Sijtsma</surname></persName>
		</editor>
		<meeting><address><addrLine>Mahwah, NJ</addrLine></address></meeting>
		<imprint>
			<publisher>Erlbaum</publisher>
			<date type="published" when="2004">2004</date>
			<biblScope unit="page" from="41" to="63" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Latent class modeling with covariates: Two improved three-step approaches</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">K</forename><surname>Vermunt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Political Analysis</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="450" to="469" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">Technical guide for latent gold 5.1: Basic, advanced, and syntax</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">K</forename><surname>Vermunt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Magidson</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2016">2016</date>
			<publisher>Statistical Innovations Inc</publisher>
			<pubPlace>Belmont, MA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">+</forename></persName>
		</author>
		<imprint/>
	</monogr>
	<note>e1)State+ (e2)education</note>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">SPKMSLM ← (f)1 + (f1)</title>
		<imprint/>
	</monogr>
	<note>State</note>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main"># place here the fixed value parameters estimated in step one</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
