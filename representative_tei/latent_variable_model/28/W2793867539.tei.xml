<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A two-stage estimation procedure for non-linear structural equation models</title>
				<funder>
					<orgName type="full">Innovation Fund Denmark</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability  status="unknown">
					<licence/>
				</availability>
				<date type="published" when="2018-10-09">9 Oct 2018</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Klaus</forename><surname>Kähler Holst</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Esben</forename><surname>Budtz-Jørgensen</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Copenhagen</orgName>
								<address>
									<addrLine>Øster Farimagsgade 5, entr. B</addrLine>
									<postBox>P.O.Box 2099</postBox>
									<postCode>DK-1014</postCode>
									<settlement>Copenhagen K</settlement>
									<country key="DK">Denmark</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Maersk Analytics</orgName>
								<address>
									<addrLine>Esplanaden 50</addrLine>
									<postCode>DK-1098</postCode>
									<settlement>Copenhagen K</settlement>
									<country key="DK">Denmark</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="laboratory">Neurobiology Research Unit</orgName>
								<orgName type="institution" key="instit1">Rigshospitalet</orgName>
								<orgName type="institution" key="instit2">Copenhagen University Hospital</orgName>
								<address>
									<addrLine>Juliane Maries Vej 28 3rd floor</addrLine>
									<postCode>6931 DK-2100</postCode>
									<settlement>Copenhagen</settlement>
									<country key="DK">Denmark</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A two-stage estimation procedure for non-linear structural equation models</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2018-10-09">9 Oct 2018</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/biostatistics/kxy082</idno>
					<idno type="arXiv">arXiv:1803.06578v2[stat.ME]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-21T19:11+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Applications of structural equation models (SEMs) are often restricted to linear associations between variables. Maximum likelihood (ML) estimation in non-linear models may be complex and require numerical integration. Furthermore, ML inference is sensitive to distributional assumptions. In this paper, we introduce a simple two-stage estimation technique for estimation of non-linear associations between latent variables. Here both steps are based on fitting linear SEMs: first a linear model is fitted to data on the latent predictor and terms describing the non-linear effect are predicted by their conditional means. In the second step, the predictions are included in a linear model for the latent outcome variable. We show that this procedure is consistent and identifies its asymptotic distribution. We also illustrate how this framework easily allows the association between latent variables to be modelled using restricted cubic splines and we develop a modified estimator which is robust to non-normality of the latent predictor. In a simulation study, we compare the proposed method to MLE and alternative two-stage estimation techniques.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Over the last decades linear structural equation models have been useful in many fields of research. These models typically consists of two parts, a measurement part where observed outcomes are assumed to be reflections of underlying latent variables and a structural part relating the latent variables to each other. Important extensions of this framework have used more flexible measurement models to allow inclusion of binary, ordinal and censored outcomes <ref type="bibr" target="#b26">(Muthén (1984)</ref>, <ref type="bibr" target="#b39">Skrondal and Rabe-Hesketh (2004)</ref>). In this paper we focus on the structural part and consider models which allow for non-linear relations between the latent variables. Until now most research in this topic has been on the interaction model assuming a linear effect of the product of two latent variables (i.e., η = β 1 ξ 1 + β 2 ξ 2 + β 3 ξ 1 ξ 2 + ζ) or more general polynomial models including terms of higher order (e.g., η = β 1 ξ 1 + β 2 ξ 2 1 + ζ), but a more general framework is of obvious interest. Maximum likelihood inference in linear SEMs are facilitated by the fact that a closed form expression for the likelihood function is obtained when integrating out the latent variables. Non-linear models do not have this property and numerical methods are needed. Today, the so-called LMS algorithm <ref type="bibr" target="#b17">(Klein and Moosbrugger, 2000)</ref> is perhaps the most widely used method. It approximates the likelihood function using a mixture of multivariate normal distributions and then this function is maximized with the EM-algorithm. For simple non-linear models (productinteraction model and second degree polynomial), this algorithm has been implemented in the widely used software package Mplus <ref type="bibr" target="#b27">(Muthén and Muthén, 2012</ref>). An alternative EM-algorithm was proposed by <ref type="bibr" target="#b19">Lee and Zhu (2002)</ref>, while <ref type="bibr" target="#b44">Wall (2009)</ref> used Adaptive Gaussian Quadrature (AGQ) and <ref type="bibr" target="#b32">Rizopoulos and Moustaki (2008)</ref> suggested a hybrid EM-algorithm based on AGQ. Bayesian techniques have also been considered for non-linear models <ref type="bibr" target="#b1">(Arminger and Muthén (1998)</ref>, <ref type="bibr" target="#b18">Lee and Zhu (2000)</ref>) and these have been extended to more flexible semi-parametric models <ref type="bibr" target="#b48">(Yang and Dunson (2010)</ref>, <ref type="bibr" target="#b41">Song et al. (2010)</ref>, <ref type="bibr">Kelava and Brandt (2014)</ref>). Due to the complexity of the ML-procedure for estimation of non-linear SEMs, a number of simpler so-called limited information methods have been developed. <ref type="bibr" target="#b16">Kenny and Judd (1984)</ref> developed the first estimator for the product-interaction model by fitting a modified linear model including an additional latent variable with indicators given by products of indicators of the two interacting latent variables. Since then this technique has been refined by several researchers (see <ref type="bibr" target="#b21">Marsh et al. (2004)</ref> for an overview), but it remains rather ad-hoc and cannot be used for more general non-linear models. For the polynomial model, <ref type="bibr" target="#b45">Wall and Amemiya (2000)</ref> proposed a two-step method (2SMM), where the latent variables were first predicted using the so-called Bartlett score, while the second step estimated the parameters of the non-linear relations using a method-of-moments procedure allowing for uncertainty in the predicted variables. Despite some nice statistical properties, this method has not been used much in practice. <ref type="bibr" target="#b24">Mooijaart and Bentler (2010)</ref> developed a method-of-moments procedure by including third degree moments for estimation of non-linear effects in the polynomial model. A computationally very simple two-stage least squares (2SLS) method was developed by Bollen <ref type="bibr" target="#b4">(Bollen (1995)</ref>, <ref type="bibr" target="#b6">Bollen and Paxton (1998)</ref>). Here instrumental variables must be identified also for non-linear terms. It is not clear whether this method can be used in general models, but the method is non-iterative and easy to implement in standard statistical software. However, simulation studies have indicated that this method has a rather low efficiency compared to ML-estimation <ref type="bibr" target="#b36">(Schermelleh-Engel et al., 1998)</ref>. In this paper we present a new two-stage method for estimation in non-linear structural equation models. As in 2SMM, we first have a prediction step, but instead of the Bartlett score we use the Empirical Bayes method and instead of predicting the latent variables we predict the latent non-linear effect terms. Therefore, in the second step, it is sufficient to fit a linear structural equation model with the predicted variables included as covariates. We show that the method yields consistent estimation and derive expressions for asymptotic standard errors. We illustrate how splines can be included and by using mixture models in the first step, we extent the method so that it becomes robust to non-normality of latent predictor variables. In simulation studies the method is compared to ML, 2SMM, 2SLS and an alternative two-stage estimator of semi-parametric associations between latent variables <ref type="bibr" target="#b14">(Kelava et al., 2017)</ref>. Finally, we illustrate the usefulness of the method analysing data from neuroscience on the regional binding potential of different serotonergic markers in the human brain.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">A non-linear structural equation model</head><p>We consider a model where a latent response variable η i = (η i1 , ..., η ip ) t of subject i (i = 1, . . . , n) is assumed to be non-linearly related to a latent predictor ξ i = (ξ i1 , ..., ξ iq ) t after adjustment for covariates Z i = (Z i1 , ..., Z ir )</p><formula xml:id="formula_0">η i = α + Bϕ(ξ i ) + ΓZ i + ζ i ,</formula><p>(1) such that ϕ(ξ i ) = (ϕ 1 (ξ i ), ..., ϕ l (ξ i )) t has finite variance. The main parameter B(p × l) describes the non-linear relation between ξ i and η i . Note, that ϕ may also depend on some of the covariates thereby allowing the introduction of interaction terms, but we here omit this to simplify notation. The latent predictors (ξ i ) are related to each other and the covariates in a linear structural equation</p><formula xml:id="formula_1">ξ i = α + Bξ i + ΓZ i + ζi ,<label>(2)</label></formula><p>where diagonal elements in B are zero and the residual terms ζ i and ζi are assumed to be independent with mean 0 and covariance matrices of Ψ and Ψ, respectively. The observed variables X i = (X i1 , ..., X ih ) t and Y i = (Y i1 , ..., Y im ) t are linked to the latent variable in the two measurement models</p><formula xml:id="formula_2">Y i = ν + Λη i + KZ i + i (<label>3</label></formula><formula xml:id="formula_3">)</formula><formula xml:id="formula_4">X i = ν + Λξ i + KZ i + ˜ i ,<label>(4)</label></formula><p>where the error terms i and ˜ i are assumed to be independent with mean 0 and covariance matrices of Ω and Ω, respectively. The parameters are collected into θ = (θ 1 , θ 2 ), where θ 1 = (α, B, γ, ν, Λ, K, Ω, Ψ) are the parameters of the linear SEM describing the conditional distribution of X i given Z i . The rest of the parameters are collected into θ 2 .</p><p>For identification of the model, we need to impose some parameter constraints <ref type="bibr" target="#b4">(Bollen, 1989)</ref>. Generally, measurement models can be made identifiable by selecting a reference indicator for each latent variable. For this variable we fix the regression coefficient of the latent variable (element of Λ or Λ) to 1 and the inter-cept (element of ν or ν) to 0. Alternatively, the variance of latent variables can be fixed to 1, and their intercepts (element of α or α) set to 0. In the estimation procedure described below, it turns out to be crucial to use the reference indicator restriction in the measurement model for Y i . Also, we model the covariance Ψ of the latent outcomes (η i ) using an unrestricted covariance matrix. The likelihood function is</p><formula xml:id="formula_5">Y 1 Y 2 Y 3 η Z ξ X 1 X 2 X 3 Bϕ(ξ) Model 1</formula><formula xml:id="formula_6">L(Y, X, Z, θ) = n i=1 p θ (Y i , X i |η i , ξ i , Z i )p θ 2 (η i |ξ i , Z i )p θ 1 (ξ i |Z i )dξ i dη i .</formula><p>Assuming joint normality of (ζ i , ζi , i , ˜ i ) , a closed form expression for L, is available only if ϕ is linear. In the general case numerical integration techniques are necessary for ML-estimation, which in practice for even moderately sized problems (number of latent variables) is computationally intractable. Instead, we exploit that the structural equation ( <ref type="formula">1</ref>) is linear in the parameters to get</p><formula xml:id="formula_7">E(η i |X i , Z i ) = α + BE θ 1 [ϕ(ξ i )|X i , Z i ] + ΓZ i , (<label>5</label></formula><formula xml:id="formula_8">)</formula><p>noting that the conditional expectation on the right-hand side depends only on the distribution parametrized by θ 1 . Equation ( <ref type="formula" target="#formula_7">5</ref>) suggests that parameters can be estimated in two steps. First, the linear SEM given by equations ( <ref type="formula" target="#formula_1">2</ref>) and ( <ref type="formula" target="#formula_4">4</ref>) is fitted to (X i , Z i , i = 1, . . . , n) and the latent covariate ϕ(ξ i ) is predicted by the conditional mean</p><formula xml:id="formula_9">E θ 1 [ϕ(ξ i )|X i , Z i ].</formula><p>Step 2 then estimates θ 2 in a linear SEM, where the measurement model is given by equation ( <ref type="formula" target="#formula_2">3</ref>) and the structural model is equation ( <ref type="formula">1</ref>) with the latent predictor replaced by</p><formula xml:id="formula_10">E θ 1 [ϕ(ξ i )|X i , Z i ].</formula><p>Thus, the key idea is to replace ϕ(ξ i ) by (an estimate of) the conditional mean of ϕ(ξ i ) given X and Z. Previous methods have used ϕ of the conditional mean <ref type="bibr" target="#b12">and Yang (2000)</ref>, <ref type="bibr" target="#b37">Schumacker (2002)</ref>).</p><formula xml:id="formula_11">E θ 1 [ξ i |X i , Z i ] (Jöreskog</formula><p>In the following we will use the notation</p><formula xml:id="formula_12">ϕ * (ξ i ) = E[ϕ(ξ i ) | X i , Z i ] and ϕ * n (ξ i ) = E θ 1 [ϕ(ξ i ) | X i , Z i ]</formula><p>to distinguish between the conditional expectation and the plugin estimator, where the expectation is taken with respect to the distribution indexed by the estimated parameter values from the stage one model. To summarize, we define the two-stage estimator in the following way Remark 1 (Two-Stage Structural Equation Model estimator (2SSEM)).</p><p>1. The linear SEM given by equations (2) and is (4) is fitted to (X i , Z i , i = 1, . . . , n) to achieve an estimate of the parameter θ 1 .</p><p>2. The parameter θ 2 is estimated via a linear SEM with measurement model given by equation (3) and structural model given by equation ( <ref type="formula">1</ref>), where the latent predictor, ϕ(ξ i ), is replaced by ϕ * n (ξ i ).</p><p>We can now formulate the consistency properties of the proposed estimator (the asymptotic distribution of 2SSEM is derived in Section 4).</p><p>Theorem 1. Under a correctly specified non-linear SEM ( <ref type="formula">1</ref>)-( <ref type="formula" target="#formula_4">4</ref>) including correctly specified distribution of the residual terms, 2SSEM will yield consistent estimates of all parameters (θ) except for the residual covariance, Ψ, of the latent variables in step 2.</p><p>Proof. Since the exposure part of the model is correctly specified, θ 1 is estimated using ML-estimation and therefore θ 1 is consistent under mild regularity conditions <ref type="bibr" target="#b0">(Anderson and Amemiya, 1988)</ref>. In step two, the model is misspecified as we fit a linear model to a non-linear association. We prove the theorem by showing that even though the model is misspecified it includes the true mean and covariance of the data. When fitting a linear SEM with correctly specified mean and variance, the estimator θ 2 will converge to the parameter value which induces the true mean and variance <ref type="bibr" target="#b2">(Arminger and Schoenberg, 1989)</ref>. Finally, we characterize this parameter value and see that it is identical to the truth (θ 2 ) except for elements describing the residual covariance of the latent variables in step 2 (Ψ).</p><p>We make these arguments assuming that the predicted values ϕ * were available.</p><p>The result then follows from the Continuous Mapping Theorem and by noting that</p><formula xml:id="formula_13">ϕ * n -→ ϕ * a.s. as n → ∞.</formula><p>The proof is illustrated in the situation where K = 0, as this simplifies matrix expressions without affecting theoretical insights (see the appendix for a more general formulation). The next step is to show that the model fitted in step-two induces the correct mean and variance structure for the data</p><formula xml:id="formula_14">V i = (Z t i , ϕ * (ξ i ) t , Y t i ) t .</formula><p>To save space, we illustrate this only for the variance (full proof is given in appendix). In step two, we fit a linear model with correct measurement part (</p><formula xml:id="formula_15">Y i = ν 2 + Λ 2 η i + i ) and structural part η i = α 2 + B 2 ϕ * (ξ i ) + Γ 2 Z i + ζ i .</formula><p>Here the subscript 2 is used to distinguish the parameters of step-two model from the true parameter value (no subscript). Using standard results from linear models <ref type="bibr" target="#b4">(Bollen, 1989)</ref>, and the notation Σ z,ϕ = Σ t ϕ,z , the modelled variance is</p><formula xml:id="formula_16">Σ V i =      Σ Z Σ z,ϕ [Σ z,ϕ B t 2 + Σ z Γ t 2 ]Λ t 2 . Σ ϕ [Σ ϕ B t 2 + Σ ϕ,z Γ t 2 ]Λ t 2 . . Λ 2 Σ η Λ t 2 + Ω 2     <label>(6)</label></formula><p>where</p><formula xml:id="formula_17">Σ η = B 2 Σ ϕ B t 2 + B 2 Σ ϕ,z Γ t 2 + Γ 2 Σ z,ϕ B t 2 + Γ 2 Σ Z Γ t 2 + Ψ 2</formula><p>is the modelled variance of η and Σ Z , Σ z,ϕ , Σ ϕ are completely unstructured parameters modelling the variance of the step-two covariates (Z i , ϕ * (ξ i )). To calculate the true variance, we write the structural model as</p><formula xml:id="formula_18">η i = α + Bϕ(ξ i ) + ΓZ i + ζ i = α + Bϕ * (ξ i ) + B[ϕ(ξ i ) -ϕ * (ξ i )] + ΓZ i + ζ i , (7)</formula><p>and from this we derive the variance of the latent variable η i</p><formula xml:id="formula_19">Var(η i ) = BVar[ϕ * (ξ i )]B t + BCov[ϕ * (ξ i ), Z i ]Γ t + ΓCov[Z i , ϕ * (ξ i )]B t +BVar[ϕ(ξ i ) -ϕ * (ξ i )]B t + ΓVar(Z)Γ t + Ψ,<label>(8)</label></formula><p>because Cov[ϕ * (ξ i ), ϕ(ξ i ) -ϕ * (ξ i )] = 0 and Cov[Z i , ϕ(ξ i ) -ϕ * (ξ i )] = 0, which follows from the law of iterated expectations. We can now determine the covariances</p><formula xml:id="formula_20">Cov[ϕ * (ξ i ), Y i ] = Cov[ϕ * (ξ i ), Λη i ] = Cov[ϕ * (ξ i ), Bϕ * (ξ i ) + ΓZ i ]Λ t as Cov[ϕ * (ξ i ), ϕ(ξ i ) -ϕ * (ξ i )] = 0 and Cov(Z i , Y i ) = Cov(Z i Λη i ) = Cov[Z i , Bϕ * (ξ i ) + ΓZ i ]Λ t as Cov[Z i , ϕ(ξ i ) -ϕ * (ξ i )] = 0.</formula><p>Finally, the variance is</p><formula xml:id="formula_21">Var(V i ) =      Var(Z i ) Cov[Z i , ϕ * (ξ i )] [Cov{Z i , ϕ * (ξ i )}B t + Var(Z i )Γ t ]Λ t . Var[ϕ * (ξ i )] [Var{ϕ * (ξ i )}B t + Cov{ϕ * (ξ i ), Z i }Γ t ]Λ t . . ΛVar(η i )Λ t + Ω      . (<label>9</label></formula><formula xml:id="formula_22">)</formula><p>It can now be seen that the modelled variance is equal to the true variance [(6) = (9)] and the modelled mean is equal to the true mean (equations not shown) if</p><formula xml:id="formula_23">B 2 = B, Λ 2 = Λ, Γ 2 = Γ, Ω 2 = Ω, α 2 = α, ν 2 = ν, µ ϕ = E[ϕ(ξ i )], µ Z = E(Z i ), Σ z,ϕ = Cov[Z i , ϕ * (ξ i )], Σ ϕ = Var[ϕ * (ξ i )], Σ Z = Var(Z i ) and Ψ 2 = Ψ + BVar[ϕ(ξ i ) - ϕ * (ξ i )]B t .</formula><p>Note, that although the expression for the modelled variance of the latent variable (Σ η ) is missing the term BVar[ϕ(ξ i ) -ϕ * (ξ i )]B t , the model can achieve the correct variance for Y i by adding the missing term to the residual variance Ψ 2 . Since the model includes the true mean and variance, θ 2 will converge to the specific parameter value inducing this mean and variance. Therefore, all parameters are consistently estimated except for the variance of the latent variable, which will be overestimated.</p><p>An important advantage of the proposed method is that closed form expressions for ϕ * (ξ i ) are available for large classes of functions including polynomials and splines basis functions (see Section 3) making the implementation of the estimator straightforward and computationally fast. Also, note that the formulation of Theorem 1 is overly restrictive, as it states that consistency relies not only on a correctly specified model structure, but also on correctly specified distributions of residuals. However, linear SEMs only require a correctly specified mean and variance (conditional on covariates) to yield consistent estimation <ref type="bibr" target="#b2">(Arminger and Schoenberg, 1989)</ref> and therefore 2SSEM will be robust to distributional misspecifications. Thus, non-normality of the residuals of the measurement models in step two will not affect consistency. However, for θ 2 to be consistent, we note that the following conditions must hold: (a)</p><formula xml:id="formula_24">E[ϕ(ξ i ) -ϕ * (ξ i )] = 0, (b) Cov[ϕ * (ξ i ), ϕ(ξ i ) -ϕ * (ξ i )] = 0, (c) Cov[Z i , ϕ(ξ i ) -ϕ * (ξ i )] = 0.</formula><p>These are obviously fulfilled when the conditional mean E[ϕ(ξ i ) | X i , Z i ] is correctly modelled. To address this both the stage 1 and stage 2 model fits should be assessed using standard model checking tools for linear SEMs <ref type="bibr" target="#b34">(Sánchez et al., 2009b)</ref>. Here the critical distribution is that for the residual ζ i of the latent exposure, whereas correct specification of error terms in the measurement model of the stage one model is less important as shown in simulations of Section 5. In Section 2.1, we describe an extended method which allow flexible models for the distribution of the latent exposure variable.</p><p>A few consequences of the calculations in the proof of Theorem 1 are important to note. Firstly, it is important that the step-two model uses an unstructured covariance matrix (Ψ 2 ) for the variance of the latent variable. If that is not the case, it may be impossible for the model to account for the misspecification of Σ η (Σ η = Var(η i )), therefore the modelled variance of</p><formula xml:id="formula_25">V i = (Z t i , ϕ * (ξ i ) t , Y t i )</formula><p>t may be wrong and estimation will likely become inconsistent. In particular, the model should not be made identifiable by fixing the variance of the latent variable to one. Secondly, covariates that are used in the step-two model, must also be present in the first step. If that is not the case, Cov[Z i , ϕ(ξ i )-ϕ * (ξ i )] may not be zero and the step-two model will have an incorrect variance leading to inconsistent estimation. Thirdly, in the step-two model, the covariance terms Cov[Z, ϕ * (ξ i )] and Var[ϕ * (ξ i )] are modelled using unstructured matrices so that any information these terms might have had about the parameters is disregarded in this approach. Finally, note that in Theorem 1 it is assumed that variables in the stage one model affects the variables in the stage two model only indirectly through the latent variable. In the presence of a direct effect from one of the indicators, X i , either on the latent variable or the indicators of the stage two model, the proposed method can easily be extended by simply including the relevant indicators as covariates in the stage two model. The consistency of this approach is proven in Appendix A. It is interesting to compare our method to the two-stage method-of-moments (2SMM) of <ref type="bibr" target="#b45">Wall and Amemiya (2000)</ref>. Here predictions ξ and η of the latent variables are calculated from a confirmatory factor analysis model and then the second step fits a non-linear regression model η = βϕ( ξ)+ζ allowing for uncertainty in ξ. For the latter task a method moments estimator is used, but it works only for polynomial models. Our method is different from 2SMM in two important ways. Rather than predicting ξ in step one, we predict the non-linear terms ϕ(ξ) and therefore we are left with a linear model in step two. Of course the predicted terms are different from the latent true terms, so, as in 2SMM, we have measurement error in covariates in the second step. Here the choice of prediction method in step one becomes important. We use the conditional mean ϕ * (ξ i ) = E[ϕ(ξ)|X, Z] which has Berkson errors, that is the prediction in uncorrelated with the prediction error</p><formula xml:id="formula_26">Cov[ϕ * (ξ i ), ϕ(ξ i ) -ϕ * (ξ i )] = 0.</formula><p>In linear regression models, it is well-known that Berkson errors will not bias regression coefficients <ref type="bibr" target="#b8">(Carroll et al., 2006)</ref>. In step two we estimate parameters using a linear model and therefore the Berkson errors do not lead to inconsistency as we show in Theorem 1. In contrast, Bartlett predictions (used in 2SMM) have classic error and therefore adjustments are needed in order to achieve unbiased estimation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Extension to mixtures of structural equation models</head><p>In this section we extend the structural part of the model to allow for non-normal latent predictor variables. This is done through a mixture model. Thus, let G i ∼ multinom(π) be the class indicator G i ∈ {1, . . . , K}, and ξ i the q-dimensional latent predictor</p><formula xml:id="formula_27">ξ i = K k=1 I(G i = k)ξ ki ,</formula><p>where each component ξ ki follows a linear structural equation</p><formula xml:id="formula_28">ξ ki = αk + Bξ ki + ΓZ i + ζki , (<label>10</label></formula><formula xml:id="formula_29">)</formula><p>with ζki ∼ N (0, Ψk ). We assume G i to be independent of ( ζ1i , ..., ζKi ) and ( i , ˜ i ).</p><p>Results can be extended also to the case where π depends on covariates. Note, that the extension concerns only the conditional distribution of the latent predictor given the covariates. Thus, the only parameters that depend on k is the intercept and the variance in the structural model for ξ, whereas the measurement models and the structural model for η i remain as shown in equations (1, 3, 4) independent of k.</p><p>In the extended model, the two-step procedure is modified by the fact that MLestimation in step 1 will be more complex (typically done via the EM algorithm) and the predicted latent variables now become</p><formula xml:id="formula_30">E[ϕ(ξ i )|X i , Z i ] = E{E[ϕ(ξ i )|X i , Z i , G i ]|X i , Z i } = K k=1 P (G i = k|X i , Z i ) E[ϕ(ξ ki )|X i , Z i , G i = k] = K k=1 P (G i = k|X i , Z i ) E[ϕ(ξ ki )|X i , Z i ],<label>(11)</label></formula><p>where the last step uses the fact that G i is independent of (ζ ki , ˜ i ). So the predictions of step 1 are the sum of the product of the posterior probabilities (class probabilities which are by-products of the EM algorithm) and predictions of the type described in Section 3. Of course, the second step in the estimation procedure is unchanged: a linear SEM is fitted with the predictions included as covariates.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Prediction of non-linear latent terms</head><p>In this section, we show that for important classes of non-linear functions (ϕ) closed form expressions can be derived for ϕ</p><formula xml:id="formula_31">* (ξ i ) = E[ϕ(ξ i )|X i , Z i ].</formula><p>Under the assumptions of the model, the conditional distribution of ξ i given X i and Z i is normal with mean and variance</p><formula xml:id="formula_32">m x,z = E(ξ i |X i , Z i ) = α + ΓZ i + Σ Xξ Σ -1 X (X i -µ X ) v = Var(ξ i |X i , Z i ) = Ψ -Σ Xξ Σ -1 X Σ t Xξ , (<label>12</label></formula><formula xml:id="formula_33">)</formula><p>where</p><formula xml:id="formula_34">µ X = ν + Λ(I -B) -1 α + Λ(I -B) -1 ΓZ i + KZ i , Σ X = Λ(I -B) -1 Ψ(I - B) -1t Λt + Ω and Σ Xξ = Λ(I -B) -1 Ψ(I -B) -1t</formula><p>. Note that the conditional variance does not depend on X and Z. Below we will consider a number a non-linear models and provide expressions for</p><formula xml:id="formula_35">E[ϕ(ξ i )|X i , Z i ].</formula><p>In addition, we will briefly compare our method to regression calibration <ref type="bibr" target="#b8">(Carroll et al., 2006)</ref>, where the second stage model simply would use ϕ(m x,z ) as a covariate in a linear SEM. We start by considering univariate functions, so we assume ξ i to be a scalar.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Example 1.</head><p>Polynomials</p><formula xml:id="formula_36">η i = α + k m=1 β m ξ m i + ζ i , (<label>13</label></formula><formula xml:id="formula_37">)</formula><p>Here ϕ(ξ i ) = ξ m i (m ∈ N) and conditional means are given by</p><formula xml:id="formula_38">E(ξ m i |X i , Z i ) = [m/2] k=0 m m-2k x,z v k m! 2 k k!(m-2k)! (14) In the quadratic model (η i = α + β 1 ξ i + β 2 ξ 2 i + ζ i ), E(ξ 2 i |X i , Z i ) = m 2 x,z + v and therefore E(η i |X i , Z i ) = α+β 1 m x,z +β 2 m 2</formula><p>x,z +β 2 v. So in this model, regression calibration uses a correct expression for then mean of η i except that the term depending on v will not be included and therefore the intercept will be estimated with bias. However, in a third-degree model,</p><formula xml:id="formula_39">E(ξ 3 i |X i , Z i ) = m 3 x,z + 3m</formula><p>x,y v and the regression calibration approach of just replacing ξ i with m x,z will lead to biased coefficients of the polynomial.</p><p>Example 2. For the exponential function ϕ(ξ i ) = exp(ξ i ) an expression can be obtained as exp(ξ i ) will follow a logarithmic normal distribution where the mean is</p><formula xml:id="formula_40">E[exp(ξ i )|X i , Z i ] = exp(0.5v + m x,y ) (15)</formula><p>Again, regression calibration is biased as the outcome is regressed on exp(m x,y ) and not exp(0.5v + m x,y ). If the conditional variance (v) is small then the bias is expected also to be small. The conditional mean of functions on the form ϕ(ξ i ) = exp(ξ i ) m is straightforward to calculate as this variable again follows a logarithmic normal distribution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Example 3. A piece-wise linear relation is described by</head><formula xml:id="formula_41">η i = α + β 1 (ξ i 1 {ξ i &lt;τ } + τ 1 {ξ i &gt;τ } ) + β 2 (ξ i -τ )1 {ξ i &gt;τ } + ζ i , (<label>16</label></formula><formula xml:id="formula_42">)</formula><p>where τ is a known break-point. As illustrated in Appendix ?? closed form expressions for the predictions can be calculated, i.e.,</p><formula xml:id="formula_43">E(ξ i 1 {ξ i &lt;τ } |X i , Z i ) = m x,z Φ( τ -mx,z s ) -sφ( τ -mx,z s ) E[(ξ i -τ )1 {ξ i &gt;τ } |X i , Z i ] = (m x,z -τ )[1 -Φ( τ -mx,z s )] + sφ( τ -mx,z s ), (<label>17</label></formula><formula xml:id="formula_44">)</formula><p>where φ and Φ are the density function and the cumulative distribution function of the standard normal distribution and s = √ v. Clearly, regression calibration will generally provide inconsistent estimates in this model.</p><p>Example 4. A natural cubic spline with k knots t 1 &lt; t 2 &lt; . . . &lt; t k is given by <ref type="bibr" target="#b9">(Durrleman and Simon, 1989)</ref>. Thus, predictions</p><formula xml:id="formula_45">η i = α + β 0 ξ i + k-2 j=1 β j f j (ξ i ) + ζ i , (<label>18</label></formula><formula xml:id="formula_46">)</formula><formula xml:id="formula_47">with f j (ξ i ) = g j (ξ i ) -t k -t j t k -t k-1 g k-1 (ξ i ) + t k-1 -t j t k -t k-1 g k (ξ i ), j = 1, . . . , k -2 and g j (ξ i ) = (ξ i -t j ) 3 1 ξ i &gt;t j , j = 1, . . . , k</formula><formula xml:id="formula_48">E[f j (ξ i )|X i , Z i ] are linear functions of E[g j (ξ i )|X i , Z i ].</formula><p>In the Appendix ?? we derive the following expressions for these means, i.e.,</p><formula xml:id="formula_49">E[g j (ξ i )|X i , Z i ] = s √ 2π [(2s 2 + (m x,z -t j ) 2 ) exp(-[ (mx,z-t j ) s √ 2 ] 2 )]+ (m x,z -t j )[(m x,z -t j ) 2 + 3s 2 ]p x,z,j , (<label>19</label></formula><formula xml:id="formula_50">)</formula><formula xml:id="formula_51">where s = √ v and p x,z,j = P (ξ i &gt; t j |X i , Z i ) = 1 -Φ( t j -mx,z s ).</formula><p>Also, in this model, regression calibration will generally provide inconsistent estimates.</p><p>The previous examples have focused on regression equations with only one latent predictor. Of course these calculations can easily be extended to models with multiple predictors with non-linear effects as long as the terms enter the model additively. Non-linear terms depending on multiple latent variables are more complex. The last example describes the most common non-linear function involving two variables where interactions are modelled using product terms.</p><p>Example 5. Product-interaction model</p><formula xml:id="formula_52">η i = α + β 1 ξ 1i + β 2 ξ 2i + β 12 ξ 1i ξ 2i + ζ i , (<label>20</label></formula><formula xml:id="formula_53">) Now E(ξ 1i ξ 2i |X i , Z i ) = Cov(ξ 1i , ξ 2i |X i , Z i ) + E(ξ 1i |X i , Z i )E(ξ 2i |X i , Z i ),</formula><p>where terms on the right-hand side are directly available from the bivariate normal distribution of ξ 1i , ξ 2i given X i , Z i . Regression calibration leads to the correct mean expect that the intercept will be biased as this method will not include the covariance term above.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Asymptotic properties of the two-stage estimator</head><p>From Theorem 1 we have consistency of all structural parameters in the stage 2 model. In this section, we show that the limiting distribution of the estimator is asymptotically normal, and we derive the asymptotic variance via the estimated influence functions of the stage 1 and stage 2 estimators.</p><p>In the following we assume that the observations (Y i , X i , Z i ), i = 1, . . . , n are i.i.d., and we also restrict attention only to the consistent estimates as mentioned in the previous section, i.e., θ 2 does not contain any of the parameters belonging to Ψ. We will assume that the stage 1 model estimator is obtained as the solution to the following score equation:</p><formula xml:id="formula_54">U 1 (θ 1 ; X, Z) = n i=1 U 1 (θ 1 ; X i , Z i ) = 0,<label>(21)</label></formula><p>which typically will be the score of the usual Maximum Likelihood Estimator.</p><p>Similarly, if we could observe the latent variables in the stage 1 model, a consistent estimator of the stage 2 model would be obtained by solving a score equation corresponding to another linear SEM</p><formula xml:id="formula_55">U 2 (θ 2 ; Y, X, Z, ξ) = n i=1 U 2 (θ 2 ; Y i , Z i , φ(ξ i )) = 0.</formula><p>As shown in Theorem 1, a consistent estimator for θ 2 can be obtained by instead considering the score equation</p><formula xml:id="formula_56">U 2 (θ 2 ; Y, X, Z) = n i=1 U 2 (θ 2 ; Y i , Z i , ϕ * (X i , Z i )) = 0,<label>(22)</label></formula><p>where</p><formula xml:id="formula_57">ϕ * (X i , Z i ) = E θ 01 (ϕ(ξ i ) | X i , Z i ). Denote the simultaneous score function U(θ 2 , θ 1 ; Y, X, Z) = n i=1 U 2 θ 2 ; Y i , Z i , ϕ * (X i , Z i ; θ 1 ) , (<label>23</label></formula><formula xml:id="formula_58">)</formula><p>where we have plugged in the predictions from the first model ϕ</p><formula xml:id="formula_59">* (X i , Z i ; θ 1 ) = E θ 1 (ϕ(ξ i ) | X i , Z i ) evaluated at the parameter θ 1 .</formula><p>Let in the following ∇ θ U(θ) denote the m × m matrix of partial derivatives of U, where m is the dimension of the joint parameter vector θ. We will impose the following regularity conditions in addition to the consistency assumptions in Theorem 1:</p><p>(a) The estimator of the stage 1 model is consistent, linear, regular, and asymptotic normal.</p><p>(b) U is twice continuous differentiable in a neighbourhood around the true (limiting) parameters (θ T 01 , θ T 02 ) T . Further,</p><formula xml:id="formula_60">n -1 n i=1 ∇U 2 (Y i , X i , Z i ; θ 1 , θ 2 ) converges uniformly to E[∇U 2 (Y i , X i , Z i ; θ 1 , θ 2 )] in a neighbourhood around (θ T 01 , θ T 02 ) T ,</formula><p>(c) and when evaluated here -E(∇U 2 ) is positive definite</p><p>We first note that assumption (a) means that</p><formula xml:id="formula_61">√ n( θ 1 -θ 01 ) = 1 √ n n i=1 IF 1 (X i , Z i ; θ 01 ) + o p (1),</formula><p>where IF 1 is the influence function of the estimator <ref type="bibr" target="#b42">(Stefanski and Boos, 2002)</ref>.</p><p>Similarly, (23) defines a regular consistent m-estimator, and for known θ 01 , it follows along the lines of <ref type="bibr">(Newey and McFadden, 1994, Theorem 3</ref>.4), <ref type="bibr" target="#b43">(Tsiatis, 2006</ref>, Chapter 3) from assumptions (b)-(c) that</p><formula xml:id="formula_62">√ n( θ 2 (θ 01 ) -θ 02 ) = 1 √ n n i=1 IF 2 (Y i , Z i , ϕ * (X i , Z i ); θ 02 ) + o p (1),</formula><p>where the influence function is given by</p><formula xml:id="formula_63">IF 2 (Y i , Z i , ϕ * (X i , Z i ); θ 02 ) = E ((-∇ θ 2 U 2 (Y, Z, ϕ * (X, Z), θ 02 )) U 2 (Y i , Z i , ϕ * (X i , Z i ), θ 02 ).<label>(24)</label></formula><p>A sufficient criterion for the uniform convergence is that the covariates are all bounded. Denote θ 2 (θ 1 ) as the estimator obtained from solving (23) with fixed stage 1 parameter at θ 1 . A Taylor expansion around θ 01 (see <ref type="bibr">(Newey and McFadden, 1994, Chapter 6</ref>)) yields</p><formula xml:id="formula_64">√ n( θ 2 ( θ 1 ) -θ 02 ) = √ n( θ 2 (θ 01 ) -θ 02 ) + √ n∇ θ 2 (θ 01 )( θ 1 -θ 01 ) + o p (1).</formula><p>This implies the following i.i.d. decomposition of the two-stage estimator</p><formula xml:id="formula_65">√ n( θ 2 ( θ 1 ) -θ 2 ) = n -1/2 n i=1 IF 2 (Y i , X i , Z i ; θ 2 ) + n -1/2 E[-∇ θ 2 U 2 (Y, Z, X; θ 2 , θ 1 )] -1 × E[∇ θ 1 U (Y, Z, X; θ 2 , θ 1 )] n i=1 IF 1 (X i , Z i ; θ 1 ) + o p (1) = n -1/2 n i=1 IF 3 (Y i , X i , Z i ; θ 2 , θ 1 ) + o p (1). (<label>25</label></formula><formula xml:id="formula_66">)</formula><p>By the central limit theorem we obtain that</p><formula xml:id="formula_67">√ n( θ 2 ( θ 1 ) -θ 2 ) D -→ N (0, Σ),</formula><p>where we can estimate the asymptotic variance by the plug-in estimate</p><formula xml:id="formula_68">Σ = 1 n n i=1 IF 3 (Y i , X i , Z i ; θ 2 , θ 1 ) ⊗2 .</formula><p>As noted in <ref type="bibr" target="#b29">(Parke, 1986)</ref>, the two influence functions IF 1 and IF 2 will generally be independent. However, we do not need to exploit this to obtain consistent estimates of the variance.</p><p>The case where the stage one model is based on a Gaussian mixture model requires additional considerations. Under the regularity conditions specified in <ref type="bibr" target="#b31">(Redner and Walker, 1984)</ref>, we obtain the usual rate of convergence such that √ n( θ 1 -θ 1 ) is asymptotically normal distributed with mean zero. This holds in particular for the important case, where the conditional distribution in each group is Gaussian and the conditional variance given covariates is fixed across the different groups in the mixture model, i.e., only the intercept of ξ ki , (α k ), varies between groups. It follows that in this case, the necessary regularity conditions for the stage 1 model are full-filled and the derivation of the asymptotic distribution of the proposed two-stage estimator follows along the same lines as in the normal case K = 1, with the influence function being estimated by the product of the inverse information matrix and score function of the MLE.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Simulation study</head><p>In this section we explore the finite sample properties of 2SSEM. We first considered scenarios where all distributional assumptions of the model were fulfilled. Next, we explored the robustness of the proposed methods in misspecified models and finally we explored 2SSEM in a non-parametric setting using a flexible spline model. The Monte Carlo simulations were based on the model illustrated in Figure <ref type="figure" target="#fig_0">1</ref> with the stage 1 model defined as ξ i = γ 1 Z i + ζ i , and X ij = ξ i + ij and the stage 2 model given by</p><formula xml:id="formula_69">η i = β T ϕ(ξ i ) + γ 2 Z i + ζ i , Y ij = η i + ij ,</formula><p>with mutually independent residual terms ζ i , ζ i , ij , ij , j = 1, 2, 3. The distribution of these terms was varied throughout the simulations. The parameters of primary interest were the structural parameters, β, defining the association between the two latent variables ξ i and η i .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Simulations I: Correctly specified model</head><p>Data was generated from a quadratic structural model</p><formula xml:id="formula_70">η i = β 0 + β 1 ξ i + β 2 ξ 2 i + γ 2 Z i + ζ i , with all residuals ζ i , ζ i , ij , ij , j = 1,</formula><p>2, 3 being standard normal and β 0 = 1, β 1 = 1, β 2 = 0.5. The simulation was run with sample sizes of n = 1, 000 and n = 500 (see Section D), without any covariate in the model (γ 1 = 0, γ 2 = 0) and with a covariate (γ 1 = 1, γ 2 = 1, see supplementary material). The simulation  <ref type="bibr" target="#b45">Wall and Amemiya (2000)</ref>), and approximate ML (Laplace, AGQ9) in a simulation study from a quadratic model E(η | ξ) = β 0 + β 1 ξ + β 2 ξ 2 (true parameters β 1 = 1 and β 2 = 0.5) where all assumptions hold. study was based on 1,000 replications. The 2SSEM methods were compared to Bollen's two-stage least squares (2SLS) estimator <ref type="bibr" target="#b4">(Bollen, 1995)</ref> (see Section B), 2SMM of <ref type="bibr" target="#b45">Wall and Amemiya (2000)</ref>, and approximate ML based on a Laplace approximation as well as Adaptive Gaussian Quadrature (AGQ) with 9 quadrature points. Simulations showed that the 2SSEM estimator had good properties in finite samples (Table <ref type="table" target="#tab_0">1</ref>). The method seemed approximately unbiased and confidence intervals had coverage probabilities close to the nominal level. It is interesting to see that in this case, where residual terms were normal, nothing seemed to have been lost by applying the robust mixture model extension. In addition to providing effectively unbiased inference this method yielded standard errors that were very close to those obtained assuming normality. As expected, ML analysis was more efficient, but the loss of the 2SSEM procedure was modest. The Laplace approximation showed some bias compared to the rest of the methods, but preformed well as measured by the RMSE and was almost as efficient as the more sophisticated AGQ-approximation. Bollen's 2SLS provided unbiased estimation, but it was clearly less efficient than both ML and 2SSEM. Also, the non-robust standard errors as suggested by <ref type="bibr" target="#b4">Bollen (1995)</ref> underestimated the uncertainty in the second order term. The methods of moments estimator 2SMM was less efficient than the 2SSEM estimator but performed clearly better than 2SLS. The conclusions were consistent across all scenarios we examined (see Section D). In contrast to 2SLS and 2SMM, our method is not restricted to polynomial structures, and we also examined the performance with an exponential effect, η i =</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head><formula xml:id="formula_71">β 1 ξ i + β 2 exp(ξ i ) + ζ i .</formula><p>The 2SSEM estimator also performed well in this setting being effectively unbiased with correct coverage of the confidence limits (see Section D for details).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Simulations II: Robustness</head><p>Here we explored the properties of the estimators in misspecified models. First we examined data generating mechanisms identical to the previous model except of the conditional distribution of the latent variable ξ i which was not Gaussian but followed a mixture distribution, i.e., ζ i ∼ 0.25N (0, 1) + 0.75N (3, 1). The results are summarized in Table <ref type="table">2</ref>, where we see some bias in the 2SSEM estimator using a Gaussian distribution for the stage 1 model. The mixture 2SSEM estimator is unbiased with correct coverage. As an observation, we noted that 2SSEM was generally much faster, more computational stable and less dependent on starting values than the Laplace and AGQ approximations. This was especially the case in the mixture setting where the ML-methods had convergence problems and need for fine-tuning across different implementations (results not shown). The above simulation setup corresponds exactly to the assumptions of our mixture model extension, so to test the robustness of the extension we also included a study where ζ i followed a uniform distribution with mean zero and variance one, and a simulation where the residuals of the indicators, ij followed a uniform distribution. In both cases, the 2SSEM mixture estimator was effectively unbiased with coverage close to the nominal level. Interestingly, the Gaussian 2SSEM was robust to the misspecification of the indicator distribution where it performed slightly better than the mixture model. Both 2SLS and 2SMM appeared to be robust to the considered misspecifications. In most cases both estimators were less efficient than 2SSEM (see Section D), however, as the sample size increased we observed that 2SMM seemed to catch up with 2SSEM. We note however, that a severe limitation of the 2SMM approach is the lack of generalizations (and implementations) allowing for example relaxation of conditional independence assumptions, inclusion of covariates, and most importantly specifications of functional forms beyond the polynomial structure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Simulations III: Non-parametric estimation</head><p>To study 2SSEM in a non-parametric setting, we also simulated data from the measurement models defined in the previous sections but with unknown functional relationship between the latent variables given by ϕ(ξ;</p><formula xml:id="formula_72">β) = β 1 ξ + β 2 ξ 2 + sin(β 3 ξ). A natural cubic spline with k knots t 1 &lt; t 2 &lt; . . . &lt; t k is given by E(η i | ξ i ) = γ 0 +γ 1 ξ i + k-2 j=1 γ j+1 f j (ξ i ) , with f j (ξ i ) = g j (ξ i )-t k -t j t k -t k-1 g k-1 (ξ i )+ t k-1 -t j t k -t k-1 g k (ξ i ), j = 1, . . . , k -2.</formula><p>Here g j (ξ i ) = (ξ i -t j ) 3 1 {ξ i &gt;t j } so to apply 2SSEM we calculated E[g j (ξ i )|X i , Z i ] (see Section 3). As a benchmark we compared 2SSEM with the estimator proposed by <ref type="bibr" target="#b14">Kelava et al. (2017)</ref> and the corresponding Matlab implementation 1 . Here the number of equidistant knots were chosen by dividing the simulated data into a single test and training data of equal size and choosing the spline basis (degrees of freedom varying from 1 to 11) as the one that minimized the RMSE evaluated in the test data. We noted that slightly better results were obtained for 2SSEM when the hyper-parameters (spline knots) were chosen using 5fold cross validation. To make the results more comparable we, however, adopted the same method for choosing the degrees of freedom for the spline using the exact same split of the testing and training data. In each simulation, r = 1, . . . , 100, we generated n = 200 observations, and for each estimator we calculated RMSE r = n i=1 [ϕ(ξ i ; β) -φ(ξ i ; γ r )] 2 1 2 , where β denotes the true parameter and γ r is the estimated parameters of the spline model, i.e., η = φ(ξ; γ r ) = B(ξ) γ r , where B(ξ) is the spline basis design matrix. With β 1 = 1, β 2 = 0, β 3 = 1 and with ζ, ζ ∼ N (0, 1) the average RMSE over all replications were 0.314 for Kelava's estimator and 0.112 for 2SSEM, and similarly when ζ, ζ ∼ U (-6, 6) the average RMSE were 0.933 and 0.608 in favour of 2SSEM. Similar conclusions were drawn when using a stronger non-linear functional form given by β 1 = 1, β 2 = 0, β 3 = 1. In the Gaussian case the average RMSE was 1.177 and 0.827, and in the uniform case 3.613 and 1.988, all in favour of 2SSEM. In addition, we note that another advantage of the 2SSEM estimator is the immediately available expressions of the asymptotic variance through the estimated influence functions. See Section D.4 for more details.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Application: Modelling in vivo brain serotonin measurements</head><p>Serotonin (5-HT, 5-hydrotryptamine) is known to play an important role in the regulation of appetite, sleep, mood, sex, and memory function. Variation in cerebral 5-HT levels is also recognized as being influential on addiction and development of psychiatric disorders such as schizophrenia and depression. With Positron Emission Tomography (PET) techniques it is possible to quantify post and pre-synaptic markers of the serotonergic system in the living human brain, such as the serotonin 2A receptor (5-HT 2A ) and the serotonin transporter (SERT). These markers have been intensively studied and associations to eating, sleeping, and mood disorders <ref type="bibr" target="#b22">(Meyer, 2007;</ref><ref type="bibr" target="#b23">Meyer et al., 1999</ref>) have been identified. Animal studies examining the consequence of manipulation of central 5-HT levels indicate an approximate (negative) linear relationship between normal synaptic 5-HT levels and 5-HT 2A receptor binding <ref type="bibr" target="#b20">(Licht et al., 2009)</ref>. It has been suggested that <ref type="bibr" target="#b22">(Meyer, 2007)</ref> 5-HT 2A receptor binding may act as an indicator of the cerebral 5-HT levels. Similarly, experimental studies have shown that manipulation of synaptic 5-HT levels causes change in the SERT binding <ref type="bibr" target="#b30">(Pineyro et al., 1994)</ref> with a suggested non-linear functional form (inverted u-shape where low and high serotonin levels both are associated with low levels of SERT). This association was studied in <ref type="bibr" target="#b10">(Erritzoe et al., 2010)</ref> hypothesizing that underlying low 5-HT levels could lead to a compensatory up-regulation of 5-HT 2A receptor binding and down-regulation of SERT. For the serotonin transporter we chose the regions: Putamen (put), Insula (ins), Midbrain (mid), Thalamus (th).</p><p>We will here present an analysis of the same sample as in the original paper, while taking into account the measurement error in both the 5-HT 2A and SERT measurements by using a non-linear SEM. The 5-HT 2A receptor binding potential (BP p ) and the SERT binding potential (BP N D ) was measured in 56 normal subjects. For each subject, the measurements were summarized in a number of regions of interest. We refer to the original paper for details on the method used in acquiring the data.</p><p>For the serotonergic markers the concept of a measurement model seems to be ideal in capturing the idea of an underlying common regulator of the two types of measurements. For the 5-HT 2A receptor outcome in a given region, we will assume a model</p><formula xml:id="formula_73">BP p,ROI = µ ROI + λ ROI • ξ + ROI , (<label>26</label></formula><formula xml:id="formula_74">)</formula><p>with a single latent variable ξ. The flexibility in letting each region have its own intercept, µ ROI , loading parameter, λ ROI , and residual term ROI ∼ N (0, σ 2 ROI ) allows us to model data, where different regions have different degrees of binding potential, variation and correlation with other regions. We will assume independence between residuals though this is not a necessary assumption. We propose a similar model for SERT binding with a measurement model described by a latent variable η. For both markers we chose 4 high binding regions of interest which previously have been demonstrated to be reliable measurements of 5-HT 2A and SERT binding, respectively (see Figure <ref type="figure" target="#fig_1">2</ref>). To describe the association between 5-HT 2A receptor binding and SERT binding we added a simple structural model η = µ sex + βξ + ζ, to see how well a linear approximation would describe the relationship. In this simple model, ξ takes the role of the common regulator, i.e. the central 5-HT level, as measured directly by the 5-HT 2A receptor binding, and the common regulator predicts the levels of the global SERT variable η. We estimated the parameters of the model using ML. The estimate of the primary parameter of interest, β, was 0.046 BP N D /BP p (with parietal cortex and thalamus as reference regions, allowing us to interpret the effect as change in SERT BP p in thalamus per unit change in parietal cortical BP N D ) and 95% CI <ref type="bibr">[-0.057; 0.149]</ref>. The lack of statistical significance may be explained by the lack of non-linear effects in our model specification. A χ 2 omnibus-test of goodness-of-fit (a likelihood ratio test against an unstructured 8-dimensional normal distribution) yielded a p-value of 0.23. Thus, based solely on this test there was no evidence against the model. Clearly, this goodness-of-fit test is, however, not adequate for detecting non-linearities <ref type="bibr" target="#b25">(Mooijaart and Satorra, 2009)</ref>. Next, we applied the 2SSEM procedure to the structural equation model of Figure <ref type="figure" target="#fig_1">2</ref> with the association between ξ and η described by a second order polynomial:  confirming our hypothesis of a non-linear association between 5-HT 2A receptor and SERT binding potential (Wald test for the hypothesis of no association: p = 0.0008, df = 2).</p><formula xml:id="formula_75">η = µ sex + β 1 ξ + β 2 ξ 2 + ζ.</formula><p>A more flexible natural cubic spline model was next applied. The predicted latent variable of the measurement error model for 5-HT 2A receptor binding potential was in the range 0.5-3.5 BP p , and we choose 4 knot points equidistantly in the interval 1 to 3. The association between the two markers (and comparison with the linear and quadratic model) is shown in Figure <ref type="figure" target="#fig_3">3</ref>. The natural cubic spline suggests a more flat association between 5-HT 2A BP p and SERT BP N D for high 5-HT 2A binding potential values, but otherwise there was a close agreement with the quadratic model. We conducted a more formal comparison of the two models using 5-fold cross validation with all indicator variables normalized. The RMSE was in slight favour of the quadratic model (0.94 vs 1.03). We also examined natural cubic splines with increased number of knots, but they all exhibited overfitting with higher RMSE. Finally, we used a two-component mixture in the stage one model and got results that were almost identical to those of the Gaussian model. Also, as in the original paper we observed that the estimated non-linear association was not sensitive to removing the observations with the highest values of 5-HT 2A binding potential from the data (results not shown). Thus, in agreement with animal and experimental studies, we were able to show a non-linear association between these two serotonergic markers. Our refined analysis also confirmed the findings of the original paper <ref type="bibr" target="#b10">(Erritzoe et al., 2010)</ref>, where the same data was analysed using standard regression techniques and hence results are likely to be susceptible to bias due to measurement error in both variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Discussion</head><p>ML-inference in non-linear SEMs is complex. Computational intensive methods based on numerical integration are needed and results are sensitive to distributional assumptions. This paper presented the two-stage estimator 2SSEM as a computationally simple alternative to ML. Here both steps are based on linear models: first we predict the non-linear terms and then these are related to latent outcomes in the second step. We identified the asymptotic distribution of 2SSEM, developed a robust extension based on mixture models and implemented the methods in a user-friendly R-package (see Appendix C). Simulations indicated a modest loss of efficiency compared to ML-estimation and our method was shown to be more powerful than two computationally simple and robust alternatives, i.e., 2SLS and 2SMM. In addition, 2SSEM can be applied to a larger class of non-linear functions than 2SLS and 2SMM. In particular the class of restricted cubic splines is an important example which have shown to be very useful in applications of regression models. The introduction of stable and fast estimation algorithms for spline functions in the structural equation framework is likely to lead to important improvements in applications which for too long have been restricted to linear relationships.</p><p>In linear models, 2SSEM is equivalent to regression calibration <ref type="bibr" target="#b8">(Carroll et al., 2006)</ref>.</p><p>This method has been investigated in linear SEMs e.g. by <ref type="bibr" target="#b38">Skrondal and Laake (2001)</ref> and <ref type="bibr">Sánchez et al. (2009a)</ref>. In non-linear SEMs, the idea of using mixture modelling to achieve more robust estimation has been exploited for ML-estimators e.g. by <ref type="bibr">Kelava et al. (2014)</ref>. The handling of splines in 2SSEM is related to the nonparametric estimators suggested by <ref type="bibr" target="#b7">Carroll et al. (1999)</ref> for linear regression models with measurement error in covariates. Bayesian methods have been developed for semi-parametric estimation in SEMs <ref type="bibr" target="#b40">(Song et al. (2013)</ref>, <ref type="bibr" target="#b11">Guo et al. (2012)</ref>, <ref type="bibr">Kelava and Brandt (2014)</ref>), but frequentist methods are rare. <ref type="bibr" target="#b3">Bauer (2005)</ref> and <ref type="bibr" target="#b14">Kelava et al. (2017)</ref> presented interesting methods but did not provide results on asymptotic standard errors. The latter procedure was included in our simulation study where it yielded larger prediction errors than 2SSEM.</p><p>The two-stage approach may be especially useful in data bases with many different research projects. Here the SEM for the exposure may be fitted only once and the predicted non-linear terms can be stored along with the influence function.</p><p>Then the predictions of exposure terms can be related to different outcomes by different research groups using linear structural models with corrected standard errors. Even in situations where ML-inference is the goal, 2SSEM will likely be very useful in providing good starting values. When using 2SSEM for assessing associations between latent variables an obvious strategy would be to start the analysis with a rich parametric model (e.g., spline model) which may then be reduced by backward selection using Wald tests. An obvious extension would be to develop lasso-type regularization for the 2SSEM estimator Similarly, different parametric forms may be compared using Wald tests in a nested model. An alternative is to base the model selection on the estimated out-of-sample predictive performance through cross-validation as demonstrated in the application. It may also be possible to develop fit criteria to detect general non-linear misfit. Recent theory in non-linear SEMs have focused on the development of such criteria and it may be possible to extend these so that they can be used together with 2SSEM. For example, Schermelleh-Engel et al. ( <ref type="formula">2014</ref>) developed a χ 2 -test comparing the observed and expected covariance matrix of the observed variables appended with selected products of indicators. Another interesting possibility would be to consider cumulative residuals as described by <ref type="bibr" target="#b34">Sánchez et al. (2009b)</ref> for linear SEMs.</p><p>We applied non-linear models to PET measurements of the serotonergic system.</p><p>Based on biological evidence we proposed a statistical model describing the underlying cerebral 5-HT level by inclusion of latent components in a SEM. The underlying 5-HT level were here assumed to be measured indirectly by PET measurements of 5-HT 2A receptor binding and serotonin transporter binding. In agreement with animal and experimental studies, we were able to show a non-linear association between these two serotonergic markers. Our model represents a first step towards linking several measurements of the serotonergic system into a simultaneous description of central 5-HT levels. An interesting longer-term perspective of this model is the possibility to explore the association between latent 5-HT levels and the development of neuropsychiatric diseases such as major depressive episodes. The extension of 2SSEM to allow for binary and time-to-event endpoints will be a topic for future research. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head><formula xml:id="formula_76">β 1 = 0.5 2SMM robust 0.512 0.074 0.074</formula><p>Table <ref type="table">2</ref>: Performance of the two-stage estimator assuming a Gaussian distribution (2SSEM) and with 2-component mixture (2SSEM mixture) in a simulation study from a quadratic model in three scenarios, where modelling assumptions were not all satisfied. First the latent predictor followed a two component mixture distribution, then the latent predictor followed a uniform distribution and finally the residuals in the measurement model of stage one followed a uniform distribution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A General proof of consistency and robustness to direct associations between stage one and stage two model</head><p>In this section, we prove that two-stage estimation is consistent also in the situation where some covariates may have direct effects on the outcomes of the stage 2 model (K = 0). We also show that the two-stage estimator can be modified to yield consistent estimation in situations where there are direct effects of outcomes in the stage 1 model on outcomes in the stage 2 model.</p><p>Theorem 2. Under the assumptions of the non-linear structural equation model with K = 0, the two-stage estimator will yield consistent estimation of all parameters (θ) except for the residual covariance, Ψ, of the latent variables in step 2.</p><p>Proof. Since the exposure part of the model is correctly specified θ 1 is estimated using ML-estimation in the marginal distribution of X given Z and therefore θ 1 is consistent under mild regularity conditions <ref type="bibr" target="#b0">(Anderson and Amemiya, 1988)</ref>.</p><p>In step 2, the model is misspecified as we fit a linear model to a non-linear association. In a linear SEM, the estimator will converge to the parameter value inducing the modelled mean and covariance which is closest to the true mean and covariance <ref type="bibr" target="#b46">White (1982)</ref>. We prove the theorem by showing that even though the model is misspecified it includes the true mean and covariance of the data. Therefore, θ 2 will converge to the parameter value which induces the true mean and variance. Finally, this value is characterized and it is seen to be identical to the truth (θ 2 ) except for elements describing the residual covariance of the latent variables in step 2 (Ψ).</p><p>In step 2, we fit a linear model to the data</p><formula xml:id="formula_77">V i = (Z t i , ϕ * (ξ i ) t , Y t i ) t . It is assumed that this model has the correct measurement part (Y i = ν 2 + Λ 2 η i + K 2 Z i + i ).</formula><p>Here the subscript 2 is used to distinguish the parameters of model 2 from the true parameter value (no subscript). The structural model is:</p><formula xml:id="formula_78">η i = α 2 + B 2 ϕ * (ξ i ) + Γ 2 Z i + ζ i .</formula><p>Using standard results from linear models <ref type="bibr" target="#b4">Bollen (1989)</ref>, we now derive expressions for the modelled mean and variance</p><formula xml:id="formula_79">µ V i = [µ Z , µ ϕ , ν 2 + Λ 2 α 2 + Λ 2 B 2 µ ϕ + (Λ 2 B 2 + K 2 )µ Z ]<label>(27)</label></formula><formula xml:id="formula_80">Σ V i =     Σ Z Σ z,ϕ [Σ ϕ,z B t 2 + Σ z Γ t 2 ]Λ t 2 + Σ Z K t 2 . Σ ϕ [Σ ϕ B t 2 + Σ ϕ,z Γ t 2 ]Λ t 2 + Σ ϕ,z K t 2 . . Λ 2 Σ η Λ t 2 + Λ 2 Γ 2 Σ z K t 2 + K 2 Σ z Γ t 2 Λ t 2 + Λ 2 B 2 Σ ϕ,z K t 2 + K 2 Σ z,ϕ B t 2 Λ t 2 + K 2 Σ z K t 2 + Ω 2    <label>(28)</label></formula><p>where</p><formula xml:id="formula_81">Σ η = B 2 Σ ϕ B t 2 +B 2 Σ ϕ,z Γ t 2 +Γ 2 Σ z,ϕ B t 2 +Γ 2 Σ Z Γ t 2 +Ψ 2</formula><p>is the modelled variance of η and µ ϕ , µ Z , Σ ϕ , Σ ϕ,z , Σ Z are completely unstructured parameters modelling the mean and variance of the step-two covariates (ϕ * (ξ i ), Z).</p><p>To calculate the true mean and variance of V i we re-write the structural model as</p><formula xml:id="formula_82">η i = α + Bϕ(ξ i ) + ΓZ i + ζ i = α + Bϕ * (ξ i ) + B[ϕ(ξ i ) -ϕ * (ξ i )] + ΓZ i + ζ i ,<label>(29)</label></formula><p>From the law of iterated expectations it follows that E[ϕ(ξ i ) -ϕ * (ξ i )] = 0 and therefore the marginal mean of the data is</p><formula xml:id="formula_83">E{V i } = [E(Z i ), E{ϕ(ξ i )}, ν + Λα + ΛBE{ϕ(ξ i )} + (ΛΓ + K)E(Z i )]<label>(30)</label></formula><p>For calculation of the variance, we first derive variance of the latent variable η i again using equation ( <ref type="formula" target="#formula_82">29</ref>)</p><formula xml:id="formula_84">Var(η i ) = BVar[ϕ * (ξ i )]B t + BCov[ϕ * (ξ i ), Z i ]Γ t + ΓCov[Z i , ϕ * (ξ i )]B t +BVar[ϕ(ξ i ) -ϕ * (ξ i )]B t + ΓVar(Z i )Γ t + Ψ. (<label>31</label></formula><formula xml:id="formula_85">)</formula><p>because Cov[ϕ * (ξ i ), ϕ(ξ i )-ϕ * (ξ i )] = 0 and Cov[Z i , ϕ(ξ i )-ϕ * (ξ i )] = 0, which again follows from the law of iterated expectations.</p><p>Now the variance of the step-two data is</p><formula xml:id="formula_86">Var[V i ] =      Var(Z i ) Cov[Z i , ϕ * (ξ i )] [Cov{ϕ * (ξ i ), Z i }B t + Var(Z i )Γ t ]Λ t + Var(Z i )K t . Var[ϕ * (ξ i )] [Var{ϕ * (ξ i )}B t + Cov{ϕ * (ξ i ), Z i }Γ t ]Λ t + Cov{ϕ * (ξ i ), Z i }K t . . Var(Y i )     <label>(32)</label></formula><p>where</p><formula xml:id="formula_87">Var(Y i ) = ΛVar(η i )Λ t +ΛΓVar(Z i )K t +KVar(Z i )Γ t Λ t +ΛBCov[ϕ * (ξ i ), Z i ]K t + KCov[Z i , ϕ * (ξ i )]B t Λ t +KVar(Z i )K t +Ω. Here we used Cov[ϕ * (ξ i ), Y i ] = Cov[ϕ * (ξ i ), Λη i ] = Cov[ϕ * (ξ i ), Bϕ * (ξ i ) + ΓZ i ]Λ t as Cov[ϕ * (ξ i ), ϕ(ξ i ) -ϕ * (ξ i )] = 0 and Cov(Z i , Y i ) = Cov(Z i Λη i ) = Cov[Z i , Bϕ * (ξ i ) + ΓZ i ]Λ t as Cov[Z i , ϕ(ξ i ) -ϕ * (ξ i )] = 0.</formula><p>Now it is straight forward to see that the modelled mean and covariance is equal to the corresponding true values [( <ref type="formula" target="#formula_79">27</ref>) = ( <ref type="formula" target="#formula_83">30</ref>) and ( <ref type="formula" target="#formula_80">28</ref></p><formula xml:id="formula_88">) = (32)] if B 2 = B, Λ 2 = Λ, Γ 2 = Γ, Ω 2 = Ω, α 2 = α, ν 2 = ν, µ ϕ = E[ϕ(ξ i )], µ Z = E(Z i ), Σ z,ϕ = Cov[Z i , ϕ * (ξ i )], Σ ϕ = Var[ϕ * (ξ i )], Σ Z = Var(Z i ) and Ψ 2 = Ψ + BVar[ϕ(ξ i ) -ϕ * (ξ i )]B t .</formula><p>Note that, although the expression for the modelled variance of the latent variable (Σ η ) is missing the term BVar[ϕ(ξ i ) -ϕ * (ξ i )]B t , the model can achieve the correct variance of Y i by adding the missing term to the residual variance Ψ 2 . Since the model includes the true mean and variance, θ 2 will converge to the specific parameter value inducing the true mean and variance. This means that all parameters are consistently estimated except for the variance of the latent variable, which will be overestimated.</p><p>The above arguments were made for predicted values ϕ * . The results now follows from the Continuous Mapping Theorem and by noting that ϕ * n -→ ϕ * a.s. as n → ∞.</p><p>Corollary 1. Consider a model where there may be direct effects of response variables in the stage 1 model on response variables in the stage 2 model (see Figure <ref type="figure" target="#fig_4">4</ref>), i.e., the measurement model of stage-two data is</p><formula xml:id="formula_89">Y i = ν + Λη i + KZ i + LX i + i .</formula><p>Consistent estimation can be obtained with the two-stage estimator if the measurement model for Y i is correctly specified, i.e., X i is included in the stage 2 analysis as additional covariates.</p><p>Proof. The stage-one model is correctly specified so this stage remains consistent. According to Theorem 2, the second stage analysis is also consistent when some covariates have direct effects on the response variables. The only requirement is that these covariates are also included in the first stage analysis, so that Cov[ϕ(ξ i )ϕ * (ξ i ), Z i ] = 0. Response variables in stage one are of course a part of the stage one analysis. A consequence of this is that Cov[ϕ(ξ i ) -ϕ * (ξ i ), X i ] = 0 and therefore the stage two analysis is consistent. </p><formula xml:id="formula_90">Y 1 Y 2 Y 3 η Z ξ X 1 X 2 X 3 Bϕ(ξ) Model 1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B Bollen's IV method</head><p>The idea is to replace latent variables with observed reference variables and then estimate parameters using regression techniques. For illustration, we use our simulation model with a linear structural equation η = α+βξ +ζ. If we use Y 1 and X 1 as reference indicators, we can replace the latent variables with observed reference indicators yielding Y 1 = α + βX 1 -β˜ 1 + 1 + ζ. This creates an observed-variableequation, where predictors are correlated with error terms and therefore least squares estimation would be biased, but a consistent analysis can be performed by using non-reference indicators as instrumental variables. In our example the indicators X 2 and X 3 could be used as instruments for X 1 . In linear models, Bollen have shown that this IV-estimator is more robust to model misspecification than ML-analysis <ref type="bibr" target="#b5">(Bollen et al., 2007)</ref>. He has also extended the method to non-linear models <ref type="bibr" target="#b4">(Bollen (1995)</ref>; <ref type="bibr" target="#b6">Bollen and Paxton (1998)</ref>). Here instrumental variables must be identified for the non-linear terms and this may be challenging. For a quadratic model (η = α + βϕ(ξ) + ζ with ϕ(ξ) = ξ 2 ), Bollen showed that consistent estimation can be achieved by replacing ξ by X 1 and by using transformed variables X 2 2 and X 2 3 as instruments for the non-linear effect term. It is not clear that this procedure would generally yield consistent estimation, but for product and quadratic terms, where ϕ(X 1 -˜ 1 ) = ϕ(X 1 ) + ϕ 1 (X 1 , ˜ 1 ), the observed-variable-equation takes the form Y 1 = α + βϕ(X 1 ) + error, and IV estimation will be consistent as long as it is possible to find instrumental variables that are uncorrelated with the error term. For standard errors, Bollen proposed the usual IV-solution, which in our example takes the form σ 2 e ( X t X) -1 , where X is n × 2-matrix with an intercept column of ones and a column of predicted values of X 1 obtained from a regression on X 2 , X 3 , while σ 2 e = n i=1 u 2 i /n with residuals u i = Y i1 -α-βX i1 . However, this expression assumes homoskedastic errors, which is generally not satisfied in non-linear SEMs. For example in the quadratic model, the observed-variable-equation becomes Y 1 = α + βX 2 1 -β˜ 1 X 1 + β˜ 2 1 + 1 + ζ and the error term (β˜ 1 X 1 + β˜ 2 1 + 1 + ζ) will have a variance that depends on X 1 . Instead, we suggest using the heteroskedasticity robust standard errors for the IV <ref type="bibr" target="#b47">(Wooldridge, 2010)</ref>, i.e. ( X t X) -1 X t S X( X t X) -1 , where S is a diagonal matrix of squared residuals (u 2 i ).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C Software implementation</head><p>The two-stage estimator is implemented in the lava package in the statistical software R citep:Rlang. The source code is hosted at GitHub and can be downloaded freely from <ref type="url" target="https://github.com/kkholst/lava">https://github.com/kkholst/lava</ref>. The version on which this paper is based on (doi: 10.5281/zenodo.1411865) can be installed with the following command (depending on the devtools package available from CRAN):</p><p>1 devtools::install_github("kkholst/lava", ref="twostage")</p><p>To demonstrate the syntax we simulate from the following measurement models </p><formula xml:id="formula_91">(see Figure ref:fig:lvm1) X 1 X 2 X 3 Y 1 Y 2 Y 3 η 1 η 2 Z f Model 1</formula><formula xml:id="formula_92">X j = η 1 + x j , j = 1, 2, 3 Y j = η 2 + y j , j = 1, 2, 3<label>(33)</label></formula><p>and with a structural model given by</p><formula xml:id="formula_93">η 2 = f (η 1 ) + Z + ζ 2 (34) η 1 = Z + ζ 1<label>(35)</label></formula><p>with iid measurement errors x j , y j , ζ 1 , ζ 2 ∼ N (0, 1), j = 1, 2, 3. and standard normal distributed covariate Z. To simulate from this model we use the following syntax:</p><p>1 library("lava") lava version 1.6.3</p><formula xml:id="formula_94">1 f &lt;-function(x) cos(1.25*x) + x -0.25*x^2 2 m &lt;-lvm(x1+x2+x3 ~eta1, y1+y2+y3 ~eta2, latent=~eta1+eta2) 3 regression(m) &lt;-eta1+eta2 ~z 4 functional(m, eta2~eta1) &lt;-f 5 6 d &lt;-sim(m, n=200, seed=42) # Default is all parameters are 1</formula><p>We refer to cite:holstjoergensen lava for details on the syntax for model specification. Given the data the first step is now to specify the measurement models in (ref:ex:measurements):</p><formula xml:id="formula_95">1 m1 &lt;-lvm(x1+x2+x3 ~eta1, eta1 ~z, latent=~eta1) 2 m2 &lt;-lvm(y1+y2+y3 ~eta2, eta2 ~z, latent=~eta2)</formula><p>Next, we specify a quadratic relationship between the two latent variables 1 nonlinear(m2, type="quadratic") &lt;-eta2 ~eta1 and the model can then be estimated using the two-stage estimator Next, we calculate predictions from the quadratic model using the estimated parameter coefficients <ref type="bibr">093569 -10.958869 -11.689950 -11.093569 [2,] -10.623561 -10.499736 -11.198861 -10.623561 [3,] -10.162565 -10.049406 -10.717187 -10.162565 eta1 Estimate</ref> Std.Err 2.5% 97.5% P-value p1 -4.0 -9.611119 1. <ref type="bibr">2650975 -12.09066 -7.131573 3.027543e-14 p2 -3.9 -9.324887 1.2054915 -11.68761 -6.962167 1.031268e-14 p3 -3.8 -9.038656 1.1467339 -11.28621 -6.791099 3.219580e-15 p4 -3.7 -8.752425 1.0889618 -10.88675 -6.618099 9.176275e-16 p5 -3.6 -8.466193 1.0323409 -10.48954 -6.442842 2.384613e-16 p6 -3.5 -8.179962 0.9770711 -10.09499 -6.264938 5.668675e-17</ref> The fitted function can be obtained with the following code (see applies 5-fold cross-validation to select the best splines with degrees of freedom varying from 1-6 (the linear model is automatically included) A formal test show no statistically significant effect of this interaction 1 summary(estimate(ee1,keep="(:g)", regex=TRUE))</p><formula xml:id="formula_96">E θ 2 (η 2 | η 1 , Z = 0), 1 newd &lt;-expand.grid(eta1=seq(-4, 4, by=0.1), z=0) 2 pred1 &lt;-predict(e1, newdata=newd, x=TRUE) 3 head(pred1) y1 y2 y3 eta2 [1,] -11.</formula><p>3 for (i in 1:5) {  <ref type="figure">------------------------------------------------</ref> ----------------------------------------------  <ref type="figure">------------------------------------------------</ref> Here we studied the situation when no covariates were included in neither the data generating model (γ 1 = γ 2 = 0) and the in the estimated models. Sample-size was set to n = 500 and all residual terms where normal distributed. See Table <ref type="table">3</ref>.  <ref type="table">3</ref>: Simulations from quadratic model without any covariates and Gaussian distribution of all residual terms. Sample-size was n = 500 and the number of replications of the simulation study was 1,000.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.1.3 Gaussian model with a covariate (n = 500)</head><p>Here we included a covariate Z in the model with γ 1 = γ 2 = 1. The samplesize was set to n = 500 and all residual terms where normal distributed. See Table <ref type="table">5</ref>. As the methods of moments estimator is not immediately available for estimating models with covariates <ref type="bibr" target="#b45">(Wall and Amemiya, 2000)</ref> we omitted it from this simulation.  <ref type="table">5</ref>: Simulations from quadratic with one covariate (γ 1 = 1, γ 2 = 1) and Gaussian distribution of all residual terms. Sample-size was n = 500 and the number of replications of the simulation study was 1,000.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head><p>The above simulation setup corresponds exactly to the assumptions of our mixture model extension, so to test the robustness of the extension we also included a study where ζ followed a uniform distribution with mean zero and variance one, and a simulation where the residuals of the indicators, i followed a uniform distribution. </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: Path diagram showing an example of the non-linear structural equation models considered. The two-stage estimator is constructed by separately estimating parameters of Model 1, and (non-linear) associations between the two models are then estimated in a subsequent step based on predictions from the Model 1 analysis.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Path diagram for a structural equation model describing the relationship between 5-HT 2A receptor binding (light grey) and SERT binding (dark grey). Each of the two types of markers are described by a single latent variable. For the 5-HT 2A receptor the following regions (light grey regions in the glass brain of the right figure) was chosen as measurements: Parietal cortex (pac), Superior frontal cortex (sfc), Posterior cingulate gyrus (pci), and Anterior cingulate gyrus (aci).For the serotonin transporter we chose the regions: Putamen (put), Insula (ins), Midbrain (mid), Thalamus (th).</figDesc><graphic coords="23,97.76,225.01,208.34,137.02" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>The estimates were β 1 = 0.676 (95% CI [0.321; 1.030], p = 0.00018) and β 2 = -0.153 (95% CI [-0.233; -0.074], p = 0.0002), thus</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 :</head><label>3</label><figDesc>Figure 3: Association between 5-HT 2A BP p binding potential and SERT BP N D binding potential as estimated using linear, quadratic and natural cubic spline model. . The points are the Empirical Bayes estimates from two separate linear SEMs.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: Path diagram showing an example of the non-linear structural equation model with a direct effect of an indicator variable of the stage one model onto a variable in the stage two model.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: diagram of the simulation model specified by (33)-(35). label:fig:lvm1</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 6 :Figure 7 :</head><label>67</label><figDesc>Figure6: Estimated association between η 1 and η 2 using natural cubic spline (4 knot points) with point-wise 95% confidence limits. label:fig:pred2b</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 9 :</head><label>9</label><figDesc>Figure 9: Comparison of the two-stage estimator and the estimation procedure of Kelava et al. (2017). The dashed red line is the true association between ξ and η and the dotted blue line is the average estimated association over the 100 replications. The transparent lines show the estimated spline for each of the replications.</figDesc><graphic coords="72,214.30,152.31,166.68,416.69" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 :</head><label>1</label><figDesc>Performance of the estimators: Gaussian 2SSEM, 2SEMM with 2component mixture (2SSEM mixture), 2SLS, 2SLS with heteroskedasticity standard errors (2SLS robust), methods of moments estimator (2SMM and 2SMM robust, with the former deriving moments from a Gaussian distribution. Standard error are omitted here but are derived in</figDesc><table><row><cell>SE SD</cell><cell>Cov. RMSE</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>We see a clear statistically significant of the second order term (eta2~eta1_2). For comparison, we can also estimate the full MLE of the linear model:</figDesc><table><row><cell>eta2~z</cell><cell></cell><cell>0.88513</cell><cell cols="2">0.20778 4.25997 2.045e-05</cell></row><row><cell cols="2">eta2~eta1_1</cell><cell>1.14072</cell><cell cols="2">0.17410 6.55194 5.679e-11</cell></row><row><cell cols="2">eta2~eta1_2</cell><cell>-0.45055</cell><cell cols="2">0.07161 -6.29199 3.134e-10</cell></row><row><cell>Intercepts:</cell><cell></cell><cell></cell><cell></cell></row><row><cell>y2</cell><cell></cell><cell>-0.12198</cell><cell cols="2">0.10915 -1.11749</cell><cell>0.2638</cell></row><row><cell>y3</cell><cell></cell><cell>-0.09879</cell><cell cols="2">0.10545 -0.93680</cell><cell>0.3489</cell></row><row><cell>eta2</cell><cell></cell><cell>0.67814</cell><cell cols="2">0.17363 3.90567 9.397e-05</cell></row><row><cell cols="2">Residual Variances:</cell><cell></cell><cell></cell></row><row><cell>y1</cell><cell></cell><cell>1.30730</cell><cell cols="2">0.17743 7.36790</cell></row><row><cell>y2</cell><cell></cell><cell>1.11056</cell><cell cols="2">0.14478 7.67064</cell></row><row><cell>y3</cell><cell></cell><cell>0.80961</cell><cell cols="2">0.13203 6.13219</cell></row><row><cell>eta2</cell><cell></cell><cell>2.08483</cell><cell cols="2">0.28985 7.19274</cell></row><row><cell cols="3">Estimate Std.Err</cell><cell>2.5% 97.5%</cell><cell>P-value</cell></row><row><cell>eta2~eta1</cell><cell cols="4">1.4140 0.2261 0.97083 1.857 4.014e-10</cell></row><row><cell>eta2~z</cell><cell cols="4">0.6374 0.2778 0.09291 1.182 2.177e-02</cell></row><row><cell cols="4">1 e1 &lt;-twostage(m1, m2, data=d)</cell></row><row><cell>2 e1</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell cols="3">Estimate Std. Error Z-value</cell><cell>P-value</cell></row><row><cell cols="2">Measurements:</cell><cell></cell><cell></cell></row><row><cell>y2~eta2</cell><cell></cell><cell>0.97686</cell><cell cols="2">0.03451 28.30865</cell><cell>&lt;1e-12</cell></row><row><cell>y3~eta2</cell><cell></cell><cell>1.04485</cell><cell cols="2">0.03485 29.98153</cell><cell>&lt;1e-12</cell></row><row><cell cols="2">Regressions:</cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>-function(mu,var,data,...) { 5 cbind("u1"=mu[,1],"u2"=mu[,1]^2+var[1],</head><label></label><figDesc>Next, we show how to specify a general functional relation of multiple different latent or exogenous variables. This is achieved via the predict.fun argument.To illustrate this we include interactions between the latent variable η 1 and a dichotomized version of the covariate z</figDesc><table><row><cell></cell><cell>y2</cell><cell>-0.12176 0.10921</cell><cell cols="2">-1.11495 0.2649</cell></row><row><cell></cell><cell>y3</cell><cell>-0.09872 0.10547</cell><cell cols="2">-0.93600 0.3493</cell></row><row><cell></cell><cell>eta2</cell><cell>3.93712 0.54020</cell><cell>7.28824</cell><cell>&lt;1e-12</cell></row><row><cell></cell><cell cols="2">Residual Variances:</cell><cell></cell></row><row><cell></cell><cell>y1</cell><cell>1.31625 0.17654</cell><cell>7.45594</cell></row><row><cell></cell><cell>y2</cell><cell>1.09975 0.14507</cell><cell>7.58079</cell></row><row><cell></cell><cell>y3</cell><cell>0.81270 0.13258</cell><cell>6.12986</cell></row><row><cell cols="2">1 selmod eta2</cell><cell>2.01822 0.28971</cell><cell>6.96633</cell></row><row><cell cols="5">______________________________________________________________________ Selected mixture model: 2 components C.2 Specification of general functional forms</cell></row><row><cell></cell><cell>AIC1</cell><cell></cell><cell></cell></row><row><cell></cell><cell>1 1961.839</cell><cell></cell><cell></cell></row><row><cell></cell><cell>2 1958.803</cell><cell></cell><cell></cell></row><row><cell></cell><cell>3 1962.046</cell><cell></cell><cell></cell></row><row><cell></cell><cell cols="4">______________________________________________________________________</cell></row><row><cell></cell><cell cols="3">Selected spline model degrees of freedom: 2</cell></row><row><cell></cell><cell cols="2">Knots: -3.958 0.02149 4.001</cell><cell></cell></row><row><cell></cell><cell cols="2">RMSE(nfolds=5, rep=1)</cell><cell></cell></row><row><cell></cell><cell>df:1</cell><cell>4.535541</cell><cell></cell></row><row><cell></cell><cell>df:2</cell><cell>3.611836</cell><cell></cell></row><row><cell>6</cell><cell cols="4">df:3 "u1:g"=mu[,1]*data[,"g"],"u2:g"=(mu[,1]^2+var[1])*data[,"g"]) 3.777584</cell></row><row><cell>7 }</cell><cell>df:4</cell><cell>3.657840</cell><cell></cell></row><row><cell cols="5">df:5 8 ee1 &lt;-twostage(mm1, model2=mm2, data=d, predict.fun=pred) 4.144918</cell></row><row><cell cols="2">df:6 9 estimate(</cell><cell>3.707977</cell><cell></cell></row><row><cell></cell><cell cols="4">______________________________________________________________________</cell></row><row><cell></cell><cell></cell><cell cols="3">Estimate Std. Error Z-value P-value</cell></row><row><cell></cell><cell>Measurements:</cell><cell></cell><cell></cell></row><row><cell></cell><cell>y1~eta2</cell><cell>1.00000</cell><cell></cell></row><row><cell></cell><cell>y2~eta2</cell><cell>0.97794 0.03463</cell><cell>28.24076</cell><cell>&lt;1e-12</cell></row><row><cell></cell><cell>y3~eta2</cell><cell>1.04520 0.03473</cell><cell>30.09595</cell><cell>&lt;1e-12</cell></row><row><cell></cell><cell>Regressions:</cell><cell></cell><cell></cell></row><row><cell></cell><cell>eta2~z</cell><cell>1.02819 0.22297</cell><cell cols="2">4.61136 4e-06</cell></row><row><cell></cell><cell>eta2~eta1_1</cell><cell>3.41773 0.36899</cell><cell>9.26228</cell><cell>&lt;1e-12</cell></row><row><cell></cell><cell>eta2~eta1_2</cell><cell>-0.05122 0.00706</cell><cell>-7.25313</cell><cell>&lt;1e-12</cell></row><row><cell></cell><cell>Intercepts:</cell><cell></cell><cell></cell></row><row><cell></cell><cell>y1</cell><cell>0.00000</cell><cell></cell></row></table><note><p>1 d$g &lt;-(d$z&lt;0)*1 ## Group variable 2 mm1 &lt;-regression(m1, ~g) # Add grouping variable as exogenous variable (effect specified via 'predict.fun') 3 mm2 &lt;-regression(m2, eta2~u1+u2+u1:g+u2:g+z) 4 pred &lt;</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>ee1,keep="eta2~u",regex=TRUE)</head><label></label><figDesc></figDesc><table><row><cell></cell><cell>Estimate Std.Err</cell><cell>2.5%</cell><cell>97.5% P-value</cell></row><row><cell>eta2~u1</cell><cell cols="3">0.9891 0.3020 0.3971 1.5810 0.001057</cell></row><row><cell>eta2~u2</cell><cell cols="3">-0.3962 0.1443 -0.6791 -0.1133 0.006047</cell></row><row><cell>eta2~u1:g</cell><cell cols="3">0.4487 0.4620 -0.4568 1.3543 0.331409</cell></row><row><cell>eta2~u2:g</cell><cell cols="3">0.0441 0.2166 -0.3804 0.4686 0.838667</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head></head><label></label><figDesc>Measured by AIC there is a slight improvement in the model fit using the mixture modelThe spline model may then be estimated as before with the two-stage method</figDesc><table><row><cell cols="5">D.1.1 Gaussian model without covariates (n = 500)</cell></row><row><cell></cell><cell></cell><cell></cell><cell>-</cell></row><row><cell cols="2">AIC= 1958.803</cell><cell></cell><cell></cell></row><row><cell cols="3">||score||^2= 2.124942e-06</cell><cell></cell></row><row><cell cols="3">1 e0 &lt;-estimate(m1,data=d)</cell><cell></cell></row><row><cell>2 AIC(e0,em0)</cell><cell></cell><cell></cell><cell></cell></row><row><cell>df</cell><cell>AIC</cell><cell></cell><cell></cell></row><row><cell cols="2">e0 10 1961.839</cell><cell></cell><cell></cell></row><row><cell cols="2">em0 12 1958.803</cell><cell></cell><cell></cell></row><row><cell cols="3">1 em2 &lt;-twostage(em0,m2,data=d)</cell><cell></cell></row><row><cell>2 em2</cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell cols="2">Estimate Std. Error Z-value</cell><cell>P-value</cell></row><row><cell cols="2">Measurements:</cell><cell></cell><cell></cell></row><row><cell>y2~eta2</cell><cell></cell><cell>0.97823</cell><cell>0.03469 28.19903</cell><cell>&lt;1e-12</cell></row><row><cell>y3~eta2</cell><cell></cell><cell>1.04530</cell><cell>0.03484 30.00720</cell><cell>&lt;1e-12</cell></row><row><cell cols="2">Regressions:</cell><cell></cell><cell></cell></row><row><cell>eta2~z</cell><cell></cell><cell>1.02886</cell><cell cols="2">0.22330 4.60763 4.073e-06</cell></row><row><cell cols="2">eta2~eta1_1</cell><cell>2.80407</cell><cell cols="2">0.65493 4.28149 1.856e-05</cell></row><row><cell cols="2">eta2~eta1_2</cell><cell>-0.02249</cell><cell>0.09996 -0.22495</cell><cell>0.822</cell></row><row><cell cols="2">eta2~eta1_3</cell><cell>-0.17333</cell><cell>0.28933 -0.59909</cell><cell>0.5491</cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0"><p>https://github.com/tifasch/nonparametric/tree/ead709097d6</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_1"><p>e0 &lt;-estimate(regression(m1%++%m2, eta2~eta1), d)</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_2"><p>estimate(e0,keep="^eta2~[a-z]",regex=TRUE) ## Extract coef. matching reg.ex.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_3"><p>em0 &lt;-NULL</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_4"><p>ll &lt;-c()</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_5"><p>https://github.com/tifasch/nonparametric/tree/ead709097d6</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgements</head><p>The project is part of the <rs type="institution">Dynamical Systems Interdisciplinary Network, University of Copenhagen</rs> and it has also recived support from <rs type="funder">Innovation Fund Denmark</rs>. The authors wish to thank the staff at the <rs type="institution">Neurobiology Research Unit, Rigshospitalet</rs>, for providing the data example and help with the interpretation of the data.</p></div>
			</div>
			<listOrg type="funding">
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>To obtain a potential better fit we next proceed with a natural cubic spline 1 kn &lt;-seq(-3,3,length.out=5) 2 nonlinear(m2, type="spline", knots=kn) &lt;-eta2 ~eta1 Confidence limits can be obtained via the Delta method using the estimate method:</p><p>1 p &lt;-cbind(eta1=newd$eta1, 2 estimate(e2,f=function(p) predict(e2,p=p,newdata=newd))$coefmat) 3 head(p)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.1 Cross-validation</head><p>A more formal comparison of the different models can be obtained by crossvalidation. Here we specify linear, quadratic and cubic spline models with 4 and 9 degrees of freedom.</p><p>1 m2a &lt;-nonlinear(m2, type="linear", eta2~eta1) 2 m2b &lt;-nonlinear(m2, type="quadratic", eta2~eta1) 3 kn1 &lt;-seq(-3,3,length.out=5) 4 kn2 &lt;-seq(-3,3,length.out=8) 5 m2c &lt;-nonlinear(m2, type="spline", knots=kn1, eta2~eta1) 6 m2d &lt;-nonlinear(m2, type="spline <ref type="bibr">", knots=kn2, eta2~eta1)</ref> To assess the model fit average RMSE is estimated with 5-fold cross-validation repeated two times 1 ## Scale models in stage 2 to allow for a fair RMSE comparison 2 d0 &lt;d 3 for (i in endogenous(m2))  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C.3 Mixture models</head><p>Lastly, we demonstrate how the distributional assumptions of stage 1 model can be relaxed by letting the conditional distribution of the latent variable given covariates follow a Gaussian mixture distribution. The following code explicitly defines the parameter constraints of the model by setting the intercept of the first indicator variable, x 1 , to zero and the factor loading parameter of the same variable to one.</p><p>1 m1 &lt;baptize(m1) ## Label all parameters 2 intercept(m1, ~x1+eta1) &lt;-list(0,NA) ## Set intercept of x 1 to zero.</p><p>Remove the label of η 1 3 regression(m1,x1~eta1) &lt;-1 ## Factor loading fixed to 1</p><p>The mixture model may then be estimated using the mixture method, where the Parameter names shared across the different mixture components given in the list will be constrained to be identical in the mixture model. Thus, only the intercept of η 1 is allowed to vary between the mixtures. border=NA, col=Col("darkred",0.2)) 13 legend("bottomright", c("Gaussian","Mixture"), 14 col=c("darkblue","darkred"), lwd=2, bty="n") </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D Simulation study</head><p>In the following we study the structural equation model defined by the stage 1 model:</p><p>and the stage 2 model given by</p><p>with mutually independent residual terms ζ, ζ, j , j , j = 1, 2, 3. The distribution of these terms was varied throughout the simulations. The parameters of primary interest are the structural parameters, β, defining the association between the two latent variables ξ and η.</p><p>The source code for all the simulations are available in the twostage branch of the lava git repository (commit hash: 53e2e18): <ref type="url" target="https://github.com/kkholst/lava/tree/twostage/inst/simulations">https://github.com/kkholst/ lava/tree/twostage/inst/simulations</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.1 Correctly specified model</head><p>We first conducted a simulation study to explore the properties of our estimator in correctly specified models. Data was generated from a quadratic structural model</p><p>, 3 being standard normal and with β 0 = 1, β 1 = 1, β 2 = 0.5. We compared the 2SSEM estimator (with and with-out mixture model extension) to 2SLS estimation, methods of moments estimation, and approximate ML based on a Laplace approximation as well as Gaussian Adaptive Quadrature with 9 quadrature points. For the mixture 2SSEM estimator we considered only two-component mixtures of the form</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.1.2 Gaussian model without covariates (n = 1, 000)</head><p>Same setup as in the previous section but with sample size increased to n = 1, 000. See Table <ref type="table">4</ref>. Gaussian distribution of all residual terms. Sample-size was n = 1, 000 and the number of replications of the simulation study was 1,000.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.1.5 Exponential model</head><p>We also assessed the performance of the model with an exponential effect η =</p><p>The consistency of the 2SLS estimator relies on the assumption that the function ϕ can be decomposed additively as ϕ(ξ) = ϕ(x 1 -1 ) = g 1 (x 1 ) + g 2 (x 1 , 1 ) and with access to instrumental variables (indicators X i ) that should be uncorrelated with the second term, g 2 . This is not possible with the exponential function, however in a neighbourhood around zero exp(x 1 -1 ) ≈ exp(x 1 ) + exp(x 1 )(x 1 -1 ), which suggests a first order approximate 2SLS estimator with g 1 (x 1 ) = exp(x 1 ).</p><p>The results of the simulation with an exponential transformation are summarized in Table <ref type="table">7</ref> (n = 500). As expected we see that the 2SSEM estimator is unbiased while this is no longer the case for the 2SLS estimator. Also, the coverage of the 2SSEM estimator remains close to the nominal level, however with more extreme choices of the parameters (simulations not shown) we did observe that the sample size needed to be increased to obtain correct coverage levels. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.2 Robustness</head><p>Here we explored the properties of the estimators in misspecified models. First we examined data generating mechanisms, where the conditional distribution of the latent variable ξ was not Gaussian but followed a mixture distribution, i.e.,</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.2.1 Mixture model without covariates (n = 500)</head><p>Same as Section D.1.1 with ζ following a Gaussian mixture distribution with π = 1 4 , σ 2 = 1, µ 1 = 0, µ 2 = 3. See Table <ref type="table">8</ref>. , σ 2 = 1, µ 1 = 0, µ 2 = 3. See Table <ref type="table">9</ref>. , σ 2 = 1, µ 1 = 0, µ 2 = 3. See Table <ref type="table">10</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.2.5 ζ ∼ U(-</head><p>2 ) (n = 500) Same as Section D.1.1 with ζ following a zero-mean uniform distribution with variance 1. See Table <ref type="table">12</ref>.  <ref type="table">12</ref>: Simulations from quadratic model without any covariates and the latent variable of the stage one model following a uniform distribution. Sample-size was n = 500 and the number of replications of the simulation study was 1,000.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.2.6 ζ ∼ U(-</head><p>2 ) (n = 1, 000) Same as Section D.1.2 with ζ following a zero-mean uniform distribution with variance 1. See Table <ref type="table">13</ref>.  <ref type="table">13</ref>: Simulations from quadratic model without any covariates and the latent variable of the stage one model following a uniform distribution. Sample-size was n = 1, 000 and the number of replications of the simulation study was 1,000.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.2.7 j ∼ U(-</head><p>2 ) (n = 500) Same as Section D.1.2 with j , j = 1, 2, 3 following a zero-mean uniform distribution with variance 1. See Table <ref type="table">14</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head><p>2 ) (n = 1, 000) Same as Section D.1.2 with j , j = 1, 2, 3 following a zero-mean uniform distribution with variance 1. See Table <ref type="table">15</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SE SD</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Cov</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.3 Larger measurement error</head><p>Same as Section D.1.3 with j , j = 1, 2, 3 following a zero-mean normal distribution with variance 2. See Table <ref type="table">16</ref>. We observe that also in this case with increased measurement error in the stage one model, the 2SSEM estimator performs well.</p><p>Here we also include results on the parameter estimates of the intercepts and covariate effect in the stage two model. Bias in the 2SLS intercept is observed. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Mean SD SE</head><p>and Gaussian distribution of all residual terms. Sample-size was n = 500 and the number of replications of the simulation study was 1,000. All residual terms have variance 1 except i j ∼ N (0, 2).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.4 Non-parametric estimation</head><p>To study the estimator in a non-parametric setting we also simulated data from the latent variable model with measurement models as defined in the previous sections but with the unknown functional relationship between the two measurement models given by φ(ξ; β) = β 1 ξ + β 2 ξ 2 + sin(β 3 ξ)</p><p>As a benchmark we compared results with the estimator proposed by <ref type="bibr" target="#b14">(Kelava et al., 2017)</ref> and the corresponding Matlab implementation 2 . Here the number of equidistant spline knots were chosen by dividing the simulated data into a single test and training dataset of equal size and choosing the spline basis (degrees of freedom varying from 1 to 11) as the one that minimized the RMSE evaluated in the test dataset. We noted that slightly better results were obtained for our twostage estimator when the hyper-parameters (spline knots) were chosen using 5-fold cross validation. To make the results more comparable we, however, adopted the same method for choosing the degrees of freedom for the spline using the exact same split of the testing and training data.</p><p>In each simulation, r = 1, . . . , 100, we simulated n = 200 observations, and for each estimator we calculated  </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">The asymptotic normal distribution of estimators in factor analysis under general conditions</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">W</forename><surname>Anderson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Amemiya</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of Statistics</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="759" to="771" />
			<date type="published" when="1988">1988</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A bayesian approach to nonlinear latent variable models using the gibbs sampler and the metropolis-hastings algorithm</title>
		<author>
			<persName><forename type="first">G</forename><surname>Arminger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">O</forename><surname>Muthén</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="271" to="300" />
			<date type="published" when="1998">1998</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Pseudo maximum likelihood estima-tion and a test for misspecification in mean and covariance structure models</title>
		<author>
			<persName><forename type="first">G</forename><surname>Arminger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Schoenberg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="409" to="425" />
			<date type="published" when="1989">1989</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">A semiparametric approach to modeling nonlinear relations among latent variables</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">J</forename><surname>Bauer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="513" to="535" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Structural equation models that are nonlinear in latent variables: A least-squares estimator</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Bollen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Structural Equations with Latent Variables</title>
		<editor>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Bollen</surname></persName>
		</editor>
		<imprint>
			<publisher>John Wiley &amp; Sons</publisher>
			<date type="published" when="1989">1989. 1995</date>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="223" to="252" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Latent variable models under misspecification: two-stage least squares (2sls) and maximum likelihood (ml) estimators</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Bollen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">B</forename><surname>Kirby</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">J</forename><surname>Curran</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">M</forename><surname>Paxton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Chen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sociological Methods &amp; Research</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="48" to="86" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Interactions of latent variables in structural equation models</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Bollen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Paxton</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling: A Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="267" to="293" />
			<date type="published" when="1998">1998</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Nonparametric regression in the presence of measurement error</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Carroll</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Maca</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Ruppert</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">86</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="541" to="554" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Measurement error in nonlinear models: a modern perspective</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Carroll</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Ruppert</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">A</forename><surname>Stefanski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">M</forename><surname>Crainiceanu</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2006">2006</date>
			<publisher>CRC press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Flexible regression models with cubic splines</title>
		<author>
			<persName><forename type="first">S</forename><surname>Durrleman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Simon</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statistics in medicine</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="551" to="561" />
			<date type="published" when="1989">1989</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">A nonlinear relationship between cerebral serotonin transporter and 5-HT2A receptor binding: An in vivo molecular imaging study in humans</title>
		<author>
			<persName><forename type="first">D</forename><surname>Erritzoe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">K</forename><surname>Holst</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">G</forename><surname>Frokjaer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">L</forename><surname>Licht</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Kalbitzer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">A</forename><surname>Nielsen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Svarer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Madsen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Knudsen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Neuroscience</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="3391" to="3397" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Bayesian lasso for semiparametric structural equation models</title>
		<author>
			<persName><forename type="first">R</forename><surname>Guo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">M</forename><surname>Chow</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">G</forename><surname>Ibrahim</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrics</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="567" to="577" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title level="m" type="main">Latent variable scores and their uses</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">G</forename><surname>Jöreskog</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Yang</surname></persName>
		</author>
		<ptr target="www.ssicentral.com/lisrel/techdocs/lvscores.pdf" />
		<imprint>
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
	<note>On-line paper</note>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">A general non-linear multilevel structural equation mixture model</title>
		<author>
			<persName><forename type="first">A</forename><surname>Kelava</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Brandt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Frontiers in psychology</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">748</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Nonparametric estimation of a latent variable model</title>
		<author>
			<persName><forename type="first">A</forename><surname>Kelava</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Kohler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Krzyżak</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Schaffland</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Multivariate Analysis</title>
		<imprint>
			<biblScope unit="volume">154</biblScope>
			<biblScope unit="page" from="112" to="134" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">A nonlinear structural equation mixture modeling approach for nonnormally distributed latent predictor variables</title>
		<author>
			<persName><forename type="first">A</forename><surname>Kelava</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Nagengast</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Brandt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling: A Multidisciplinary Journal</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="468" to="481" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Estimating the nonlinear and interactive effects of latent variables</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Kenny</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">M</forename><surname>Judd</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychological bulletin</title>
		<imprint>
			<biblScope unit="volume">96</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">201</biblScope>
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Maximum likelihood estimation of latent interaction effects with the LMS method</title>
		<author>
			<persName><forename type="first">A</forename><surname>Klein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Moosbrugger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">65</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="457" to="474" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Statistical analysis of nonlinear structural equation models with continuous and polytomous data</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">Y</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">T</forename><surname>Zhu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">British Journal of Mathematical and Statistical Psychology</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="209" to="232" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Maximum likelihood estimation of nonlinear structural equation models</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">Y</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H.-T</forename><surname>Zhu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="189" to="210" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">The brain 5-HT4 receptor binding is down-regulated in the Flinders Sensitive Line depression model and in response to paroxetine administration</title>
		<author>
			<persName><forename type="first">C</forename><surname>Licht</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Marcussen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Wegener</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Overstreet</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Aznar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Knudsen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Neurochem</title>
		<imprint>
			<biblScope unit="volume">109</biblScope>
			<biblScope unit="page" from="1363" to="1374" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Structural equation models of latent interactions: evaluation of alternative estimation strategies and indicator construction</title>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">W</forename><surname>Marsh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Wen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">T</forename><surname>Hau</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychological methods</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">275</biblScope>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Imaging the serotonin transporter during major depressive disorder and antidepressant treatment</title>
		<author>
			<persName><forename type="first">J</forename><surname>Meyer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Psychiatry Neurosci</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="86" to="102" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Prefrontal cortex 5-HT2 receptors in depression: an [18F]setoperone PET imaging study</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">H</forename><surname>Meyer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Kapur</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Houle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Dasilva</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Owczarek</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">M</forename><surname>Brown</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">A</forename><surname>Wilson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">H</forename><surname>Kennedy</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am J Psychiatry</title>
		<imprint>
			<biblScope unit="volume">156</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="1029" to="1034" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">An alternative approach for nonlinear latent variable models</title>
		<author>
			<persName><forename type="first">A</forename><surname>Mooijaart</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">M</forename><surname>Bentler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Structural Equation Modeling</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="357" to="373" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">On insensitivity of the chi-square model test to nonlinear misspecification in structural equation models</title>
		<author>
			<persName><forename type="first">A</forename><surname>Mooijaart</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Satorra</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">74</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="443" to="455" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">A general structural equation model with dichotomous, ordered categorical, and continuous latent variable indicators</title>
		<author>
			<persName><forename type="first">B</forename><surname>Muthén</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="115" to="132" />
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">K</forename><surname>Muthén</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">O</forename><surname>Muthén</surname></persName>
		</author>
		<title level="m">Mplus Version 7 user&apos;s guide</title>
		<meeting><address><addrLine>Los Angeles, CA</addrLine></address></meeting>
		<imprint>
			<publisher>Muthén &amp; Muthén</publisher>
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Large sample estimation and hypothesis testing</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">K</forename><surname>Newey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Mcfadden</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Handbook of Econometrics</title>
		<imprint>
			<publisher>Elsevier</publisher>
			<date type="published" when="1994">1994</date>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="2111" to="2245" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Pseudo maximum likelihood estimation: The asymptotic distribution</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">R</forename><surname>Parke</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of Statistics</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="355" to="357" />
			<date type="published" when="1986">1986</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Desensitization of the neuronal 5-HT carrier following its long-term blockade</title>
		<author>
			<persName><forename type="first">G</forename><surname>Pineyro</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Blier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Dennis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>De Montigny</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Neurosci</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page" from="3036" to="3047" />
			<date type="published" when="1994">1994</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Mixture densities, maximum likelihood and the em algorithm</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Redner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">F</forename><surname>Walker</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM review</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="195" to="239" />
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Generalized latent variable models with non-linear effects</title>
		<author>
			<persName><forename type="first">D</forename><surname>Rizopoulos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Moustaki</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">British Journal of Mathematical and Statistical Psychology</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="415" to="438" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">An estimating equations approach to fitting latent exposure models with longitudinal health outcomes</title>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">N</forename><surname>Sánchez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Budtz-Jørgensen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">M</forename><surname>Ryan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Annals of Applied Statistics</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="830" to="856" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Residual-based diagnostics for structural equation models</title>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">N</forename><surname>Sánchez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">A</forename><surname>Houseman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">M</forename><surname>Ryan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrics</title>
		<imprint>
			<biblScope unit="volume">65</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="104" to="115" />
			<date type="published" when="2009">2009b</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">Evaluation of model fit in nonlinear multilevel structural equation modeling</title>
		<author>
			<persName><forename type="first">K</forename><surname>Schermelleh-Engel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Kerwer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">G</forename><surname>Klein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Frontiers in Psychology</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">181</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Estimating nonlinear effects using a latent moderated structural equations approach</title>
		<author>
			<persName><forename type="first">K</forename><surname>Schermelleh-Engel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Klein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Moosbrugger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Interaction and nonlinear effects in structural equation modeling</title>
		<editor>
			<persName><forename type="first">R</forename><forename type="middle">E</forename><surname>Schumacker</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">G</forename><forename type="middle">A</forename><surname>Marcoulides</surname></persName>
		</editor>
		<imprint>
			<publisher>Lawrence Erlbaum Associates Publishers</publisher>
			<date type="published" when="1998">1998</date>
			<biblScope unit="page" from="203" to="238" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Latent variable interaction modeling</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">E</forename><surname>Schumacker</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Structural Equation Modeling</title>
		<imprint>
			<date type="published" when="2002">2002</date>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="40" to="54" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Regression among factor scores</title>
		<author>
			<persName><forename type="first">A</forename><surname>Skrondal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Laake</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">66</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="563" to="575" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<monogr>
		<title level="m" type="main">Generalized latent variable modeling: Multilevel, longitudinal, and structural equation models</title>
		<author>
			<persName><forename type="first">A</forename><surname>Skrondal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Rabe-Hesketh</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2004">2004</date>
			<publisher>Crc Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">A bayesian modeling approach for generalized semiparametric structural equation models</title>
		<author>
			<persName><forename type="first">X</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><forename type="middle">H</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">H</forename><surname>Cai</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">H S</forename><surname>Ip</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">78</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="624" to="647" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">A semiparametric bayesian approach for structural equation models</title>
		<author>
			<persName><forename type="first">X</forename><forename type="middle">Y</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">H</forename><surname>Pan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Kwok</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Vandenput</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Ohlsson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">C</forename><surname>Leung</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrical Journal</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="314" to="332" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">The calculus of m-estimation</title>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">A</forename><surname>Stefanski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">D</forename><surname>Boos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The American Statistician</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="29" to="38" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Semiparametric Theory and Missing Data</title>
		<author>
			<persName><forename type="first">A</forename><surname>Tsiatis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="s">Springer Series in Statistics</title>
		<imprint>
			<date type="published" when="2006">2006</date>
			<publisher>Springer</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title level="a" type="main">Maximum likelihood and bayesian estimation for nonlinear structural equation models</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">M</forename><surname>Wall</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">The SAGE handbook of quantitative methods in psychology</title>
		<editor>
			<persName><forename type="first">R</forename><forename type="middle">E</forename><surname>Millsap</surname></persName>
		</editor>
		<editor>
			<persName><forename type="first">A</forename><surname>Maydeu-Olivares</surname></persName>
		</editor>
		<imprint>
			<date type="published" when="2009">2009</date>
			<biblScope unit="page" from="540" to="567" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<analytic>
		<title level="a" type="main">Estimation for polynomial structural equation models</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">M</forename><surname>Wall</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Amemiya</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the American Statistical Association</title>
		<imprint>
			<biblScope unit="volume">95</biblScope>
			<biblScope unit="issue">451</biblScope>
			<biblScope unit="page" from="929" to="940" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title level="a" type="main">Maximum likelihood estimation of misspecified models. Econometrica</title>
		<author>
			<persName><forename type="first">H</forename><surname>White</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Econometric Society</title>
		<imprint>
			<biblScope unit="page" from="1" to="25" />
			<date type="published" when="1982">1982</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<monogr>
		<title level="m" type="main">Econometric analysis of cross section and panel data</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Wooldridge</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2010">2010</date>
			<publisher>MIT press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b48">
	<analytic>
		<title level="a" type="main">Bayesian semiparametric structural equation models with latent variables</title>
		<author>
			<persName><forename type="first">M</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">B</forename><surname>Dunson</surname></persName>
		</author>
		<idno>8.833641 -8.751230 -9.328656 -8.833641</idno>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">75</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="675" to="693" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
