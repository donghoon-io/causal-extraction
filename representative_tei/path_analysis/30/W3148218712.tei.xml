<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Structural equation modelling with lavaan: a tutorial and an intuitive introduction</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Arindam</forename><surname>Basu</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">University of Canterbury</orgName>
								<address>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Structural equation modelling with lavaan: a tutorial and an intuitive introduction</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.32388/DNI7ET</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-29T01:34+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The goal of this paper is to present a tutorial on structural equation modelling ("SEM"). SEM is a combination of multivariate linear regression and path analysis models. We will discuss path analysis, measurement models, measurement invariance and when or how to use them, twin studies, and longitudinal data analysis. In this tutorial, we shall use the free and open source package "lavaan" in R.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Structural equation modelling in health sciences and epidemiology</head><p>Structural equation modelling ("SEM") is a combination of multivariate linear regression and path analysis models. In this brief hands-on tutorial, we will discuss path analysis, measurement models, measurement invariance and when or how to use them, twin studies, and longitudinal data analysis using SEM. We shall use the free and open source package "lavaan" in R -the free and open source statistical programming language</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Steps of SEM</head><p>As structural equation modelling is graphical, we recommend that you follow the sequence:</p><p>1. Draw your model as a system of paths 2. Input data in the form of covariance or correlation matrix 3. Identify the model 4. Specify the model 5. Assess parameter estimates 6. Assess t measures (chi-square, df, residual matrix, GFI, RMSEA) 7. Check the modi cation indices 8. Rerun the model till you get the best t of the data to the model and theory Absolute rst step before you proceed: Load the packages Assuming that you use R for your analyses, you need to load the following packages in R after installing R: Qeios qeios.com</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Step 1: Notes on the system of paths and directed acyclic graphs (DAGs)</p><p>Everything graphical in SEM starts with path <ref type="bibr">analysis. Richard Sewall Wright (1921)</ref>, a hundred years ago, described a system of nding correlation between two variables, X and Y using a system of paths <ref type="bibr" target="#b12">(Denis 2021)</ref>. In this approach, he described that if a system of paths exist between two variables X and Y, the multiplication produce of the path coe cents of the sequences of the paths that traverse between the two variables should be added to the path coe cients of the direct paths that exist between X and Y to derive their correlations (Figure <ref type="figure" target="#fig_1">1</ref>). The above gure presents a system of paths that can be connected to derive covariances between pairs fo variables. These paths can be traced from one variable to another according to set rules. Sewall Wright described such a system of path tracing rules as follows:</p><p>1. A path can start from one variable to be connected to another variable and can start in either a forward or a reverse direction in the direction of the arrowhead 2. Once started in one direction, the path must continue in the same direction unless it meets with another path in a reverse direction and at that point can proceed no further 3. A path can only contain ONE curved double headed arrow. A curved double headed arrow signi es either a covariance between two variables or a variance of a single variable 4. A path cannot go through the same variable twice, that is a path can only go through one variable at a time Then, once all the valid paths are identi ed, their path coe cients are multiplied and added to the direct path coe cient if one exists between the two variables to derive the correlation between these two paths.</p><p>With these information, we can trace the following valid paths in Figure <ref type="figure" target="#fig_1">1:</ref> x-a-b-c-y</p><p>x-c-y</p><p>x-d-e-y These are the only three valid paths. No direct path exists between x and y, and all other paths are either invalid or they are blocked one way or another. In order to derive the correlation between x and y, we will need to add the multiple products of the individual path coe cients as follows:  The path model in Figure <ref type="figure">2</ref> is a simple measurement model or con rmatory factor analysis model with one latent variable ("lv1"), and three manifest variables (mv1 … mv3). You can see that a set of six paths connect the manifest variables. In con rmatory factor analysis, we estimate or constrain such path coe cients and the path coe cients are used to derive the variances and covariances of these variables.</p><p>The path coe cients also tell us the e ect of one variable over another. For example, the e ect of lv on mv1 in Figure <ref type="figure">2</ref> will be determined by the path coe cient of the path connecting lv with mv1.</p><p>Note another feature: all the arrows in these diagrams point in one direction, and the variables are all connected by arrows that move in one direction. Such kind of graphs are referred to as directed acyclic graphs (DAG) as no variable has arrows that eventually return to itself closing any loop. DAGs are visual tools to directly observe the causal relationships between exposures and outcomes, including mediators, confounders, and e ect modi ers; this is perhaps as accurate a de nition of the role of DAGs as you can get <ref type="bibr" target="#b15">Rohrer (2018)</ref>.</p><p>Path diagrams for structural equation models ("SEM") have symbols that help the readers to understand what these models are doing. However, as our aim is to eventually discuss structural causal models in the light of structural equation models, we will brie y mention them here and continue with the models as we present here for uniformity.  We will assume that all exogenous latent and manifest variables have variances so we do not show them separately and all endogenous latent and manifest variables have exogenous error terms. Hence we suggest the above scheme, besides, using dagitty and ggdag packages in R helps us to draw these graphs in a uniform way. Alternative, publication quality causal and structural equation graphs can be drawn using graphviz and DiagrammeR packages but they are also time consuming. We recommend that for rapid visualisation of the models, use dagitty.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Path analysis in a measurement model: partition of variances</head><p>Refer to Figure <ref type="figure">2</ref> where we see a measurement model with one latent variable and three manifest variables.</p><p>Here, we would like to use path tracing rules to derive the variance of manifest variable mv1. Here is the procedure:</p><p>We will trace ALL paths that BEGIN with mv1 and end on mv1.</p><p>We will multiply and add the path coe cients of all such paths What paths exist?</p><p>A path starts from mv1, goes to lv and returns to mv1 (we call this mv1-lv-mv1)</p><p>Another path is mv1-e1-mv1</p><p>No other path starts from mv1 and ends in mv1</p><p>Hence,variance of mv1 = (mv1-lv) * var(lv) * (lv-mv1) + (mv1-e1) * var(e1) * (e1-mv1)</p><p>Now, -mv1-lv and lv-mv1 are the same paths, so the path coe cient get squared -mv1-e1 and e1-mv1 are also the same paths, and we set the coe cients of these paths at 1. So, from here, we can say that the var(mv1) = square of the path coe cient from latent variable + variance of error term</p><p>The term "square of the path coe cient" is referred to as "communality," because this part of the total variance (or variability, so to say) of mv1 is EXPLAINED by the latent variable that is common to all other manifest variables in the model that receive arrows from the latent variable. The path coe cient is also referred to as factor loading.</p><p>Using the path analysis approach, you will see that as the error terms are uncorrelated, therefore the correlation (or covariance) between mv1 and mv2 is given by mv1-lv * var(lv) * lv-mv2</p><p>These concepts are fundamental to understanding what goes in SEMs. We have seen one model, that of a measurement model or con rmatory factor analysis model, where we have one or more latent variables load on manifest variables. Figure <ref type="figure" target="#fig_3">3</ref> shows the structural and measurement parts of an SEM As you can see in Figure <ref type="figure" target="#fig_3">3</ref>, on the left and right are two separate measurement models, where lv1 and lv2 are the respective latent variables, mv1 … mv3 are the manifest variables on the left hand side measurement model, and mv4 … mv6 are manifest variables on the right hand side measurement model.</p><p>We have now added a regression model to the mix where lv2 is regressed on lv1, so the path coe cient of lv1-lv2 can be viewed as a beta coe cient, with something like: </p><formula xml:id="formula_0">lv2 ~ beta * lv1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Path diagrams of models with meanstructures and group comparisons</head><p>So far, we have con ned our discussions to models that have only one group of people and models that only have explained covariances and variances. For example, a measurement model would be well suited to test the validity of the construct of a questionnaire you have set up to investigate some health construct.</p><p>Say you have developed a questionnaire that aims to tap an individual's concept of "health" and decide to distribute this questionnaire to 200 individuals, and obtain data from them. Each individual is asked ve questions, and you could have a measurement model out of these ve questions and a latent or unobserved construct of "health" from your research participants. Such a procedure would provide you with an estimate of whether you were able to tap the construct of "health" based on the items you asked your participants.</p><p>Now imagine that among your participants there are those with chronic diseases (such as diabetes, high blood pressure, chronic heart disease and so on) and those who are otherwise healthy adults with no evidence of any disease. You may claim that the questions were perceived in the same way among members of both the groups, and that the factor loadings of the latent variable (in this case "health") would be equal in both groups; So even if the unexplained and explained variances of the manifest variables may be similar in both groups, it might still mean that they would have di erent average values on those scores. In other words, you may want to nd out group di erences or invariances of your measurements across groups to make sure that your model is a robust model. This is where a mean structure is important <ref type="bibr" target="#b13">(Meredith 1993)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>qeios.com</head><p>doi.org/10.32388/DNI7ET</p><p>In SEM, the means of the manifest variables are referred to as "intercepts" and the means of the latent variables as "factor mean." The factor mean is derived from a constant term, represented by a triangle (we will present here in the form of a circle with 1.0 as value). In a standardised solution, the path coe cient from the constant to the latent variable is set at 0 (mean = 0 for a standardised variable). Also note that as this is a constant, it's variance is 0, and therefore it contributes only to the mean of the latent and manifest variables. When the mean of the latent variable is set to 0, the intercept of the model is same as the mean of the individual manifest variables. Such a structure is used to compare and evaluate that the measurements and the measurement properties (such as factor loadings, and variance of the latent variable) REMAIN THE SAME for each group. The groups themselves can be constituted on the basis of categorical variables such as sex, race, or case-control status, for example.</p><p>Figure <ref type="figure" target="#fig_4">4</ref> shows such a scenario Two arrows head from 1 (the constant) to the two latent variables.</p><p>Both latent variables are "lv," except for group 1 it is 1lv, and for group 2, it is 2lv (similarly for manifest variables mv1, …, mv3 and e1 … e3, they are prefaced with 1 for group 1 and 2 for group 2)</p><p>Three arrows on each side go from 1 to the manifest variables; these are the intercepts Then we have the measurement models of the two groups, group 1 and group 2 Now, a few things to consider here:</p><p>1. For each manifest variable in each group, we have their intercept, their variance, and their covariance on the basis of which the measurement model is formed 2. For each factor in each group, there are three manifest variables (in this case)</p><p>3. Each factor in each group (i.e., latent variable), we have measured their latent mean (the arrows that go from 1 to 1lv and 2lv), we have the factor loadings, and the variances</p><p>We believe that the groups will di er in some ways, but we must make sure that they were measured in EXACTLY the same way. So, while we study both (or more groups), we can restrict or constrain the group parameters in a number of ways:</p><p>At the least, we say that we only constrain that the con guration of the latent and manifest variables remain invariant in between the groups, but everything else can vary. If this is the case, this will be one of con gural measurement invariance</p><p>Then we can say that our factor loadings MUST be constrained in both the groups so as to ensure that both the groups had similar measurements. This is a weak measurement invariance because we still leave the possibiity that the variance of the latent variables themselves could di er between the groups Then we add the constraints of both factor loadings as well as latent variable variances to remain identical across the groups, but the latent means could still vary. This is strong invariance and is most practical assumption Finally, we can add the constraint that everything will be identical between the groups and see what factor structure will satisfy this condition and how would the model hold. This is referred to as strict measurement invariance.</p><p>Using strong invariance to examine the group di erences or groups is important to ascertain as to what di erences exist even as the measurement of the constructs were conducted identically </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Group comparison in the context of twin studies</head><p>Group comparison is particularly useful in the context of twin studies <ref type="bibr" target="#b14">(Neale and Cardon 2013)</ref>. The problem and the solution are as follows.</p><p>Figure <ref type="figure">6</ref>. Twin study design</p><p>Twin study design Say you want to test the hypothesis that BMI is determined by genes. BMI is a quantitative trait, so rather than one gene, we hypothesise that several genes add up to exert their e ects on BMI. Yet we may also argue that in addition to genes, there are environmental variables that also determine individual BMI scores. To study such e ects, you have collected data from 400 twins (200 monozygotic twins and 200 dizygotic twins), these twins were all raised in the same household and shared the same environment; however, even then, they also had unique environmental factors other than their shared households and rearing (such as di erent friends, di erent universities where they studied, di erent occupations, etc). So, if you take PAIRS of monzygotic and dizygotic twins and examine these TWO groups using a path analysis model, you will have the following:</p><p>For each of the 200 pairs of Monozygotic (and it is true for dizygotic twins), you will have data on their BMI Twin1 and Twin2 (T1 and T2) will have on BMI a variance-covariance matrix whose patterns can be explained by three variables:</p><p>their additive genetic e ects (As)</p><p>their common environmental e ects (Cs)</p><p>their dominant genetic e ects (Ds): this is the case where one gene is dominant over another their unique environmental e ects (Es), this is basically their error variance</p><p>For MONOZYGOTIC twins, as they have EXACTLY the same complement of genes, their As will perfectly vary, i.e., cor(A1, A2) = 1.0</p><p>For DIZYGOTIC twins, as they share 50% of their genes, their As will have cor(A1, A2) = 0.5</p><p>For DIZYGOTIC twins, as they share 25% of their dominant genes (heterozygosity), this will be cor(D1, D2) = 0.25</p><p>For BOTH monzygotic and dizygotic twins, their shared environments (Cs) will be perfectly correlated, so cor(C1, C2) = 1.0</p><p>for BOTH mono-and dizygotic twins, their unique environments are uncorrelated, so we will see cor(E1, E2) = 0 a$ ^2$ + e = 1.00 (assuming standardised coe cients)</p><p>a is also referred to as "narrow heritability"</p><p>Figure <ref type="figure" target="#fig_5">5</ref> shows the twin studies path diagram While analysing these paths, we have to be careful that while Cs are common to both MZ and DZ twins, the path coe cient that explains the part of the variation in the phenotype (say BMI in the example), will be very low if not negligible. This needs to be taken into account as you assess these models, so setting or constraining the path coe cients C1A1 and C2A2 to close to 0 (something like 0.001) is a useful strategy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Path analysis of longitudinal data or latent growth curve models</head><p>So far, we have discussed path models that are all assessed over a single period of time, and even when we discussed measurement invariance and discussed two groups in two periods of time, the scope was limited. We now turn to the problem of what happens when you have correlated measures over repeated measurements taken over three or more periods. These models are referred to as latent growth curve models.</p><p>There are two major di erences between the models we have studied so far and latent growth curve models. First, so far we have assumed that the data for all our models came from studies that were conducted over a speci ed period of time, rather than longitudinally. However, while this may be so for majority of the studies for which we would use SEM, for clinical and public health studies, large longitudinal studies for which data collection happens over repeated measurements over long periods of time are important. Longitudinal ageing studies are important study designs that allow studying change over time. Second, we have considered how latent variables would explain variability in the manifest variables, so we have considered path coe cients that we'd like to measure as in uences. When we analyse longitudinal studies, we x the parameters. Instead we study two issues with longitudinal studies:</p><p>1. We study change. -Now, change is unobserved and therefore change is inherently a latent construct. for the latent variable. We have met intercept before, but that was intercept for the manifest variable, which, in this case, are time-bound value of some trait repeated over time. We are not talking about that, instead, we mean what would be the latent value of baseline measure at ZERO TIME? Is that time constant, or is that time variable over the number of people or the context of the study? Is that level a sample from a distribution of in nite other values, i.e., a random e ect?</p><p>3. Change must also have some kind of rate of change. This could be linear, this could be quadratic.</p><p>Equally, as we factor in time, we factor in what intervals over which such change occur? Are the data collected linearly, as in every n number of years? Or are data collected every two years for the rst two waves and then every ve years for the next few waves and so on?</p><p>Figure <ref type="figure">6</ref> shows a simple latent growth curve model   # fit bli2_fit_m = fitMeasures(bli_2_fit, fit.measure = c("chisq", "pvalue", "cfi", "rmsea", "gfi", "aic")) bli_2_params = parameterEstimates(bli_2_fit, standardized = T) %&gt;% select <ref type="bibr">(lhs, rhs, est, ci.lower, ci.upper, std.lv, std.all)</ref> Now we will study a structural equation model. Here, we will regress personal well-being on social wellbeing and will test the hypothesis that social well-being in uence a person's personal sense of well being.</p><p># Using the above model, we will examine the association between social satisfaction Now that we have seen that evidence from 400 countries in Europe, Australia, and other parts of the world suggest that several aspects of personal well-being and better living are related to the social well-being, we can ask another related question: what are the relative genetic and environmental contributions to sense of psychological well-being. We will use data from <ref type="bibr">Archontaki et.al. (2012)</ref> on the twin study of psychological well-being; for the purpose of demonstration, we will only use a small set of twin correlations, but you can read the entire study here <ref type="bibr" target="#b11">(Archontaki, Lewis, and Bates 2013)</ref> We will replicate a small subscale from the data presented in the article, Table <ref type="table">3</ref>, Figure <ref type="figure">7</ref>. Table <ref type="table">data</ref> for the twin study we evaluate here</p><p>From the paper we know that there were 240 monozygotic twin pairs (MZ pairs), and 597 dizgyotic twin pairs (DZ pairs). We will analyse here the scale "personal growth" for this paper. We will set up the data for analysis as follows: ## T1 1.00 0.12 ## T2 0.12 1.00</p><p>Now that we have set up the data for this study, we will run the models and evaluate them as follows. Here</p><p>we will evaluate an ACE model, where we will test the path coe cients and heritability estimates for a model where we will test additive genetic e ecs (As), common environmental e ects (Cs), and unique environmental e ects (Es). Note that as correlation of Cs on both MZ and DZ twins is 1.0 (that is they share the SAME environment), the impact of a shared or common environment on their phenotype is likely to be very low, so we will set it at more than 0.001    </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>#modi cationIndices(happiness_ t)</head><p>As this analysis suggests:</p><p>About 72% people over the world population reported that they were happy or satis ed in 1993</p><p>Over time, more people tended to report they were happy over subsequent surveys</p><p>Countries that started with lower percentage of their people reporting in surveys they were happy, had a faster rate of growth over subsequent waves While our analysis borne this, you can also view the results reported graphically on the ourworldindata website as shown in the following gure:  [<ref type="url" target="https://www.causalows.com/structural-causal-models/">https://www.causal ows.com/structural-causal-models/</ref>]. We have also not touched the issues of model speci cation, interpretation of modi cation indices, and sample size estimation. In subsequent extensions to this in ammation, we will discuss these issues.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. Basic path diagram</figDesc><graphic coords="2,88.65,396.88,427.63,264.14" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>Figure 2. Another system of paths we use in measurement model or a con rmatory factor analysis model.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 .</head><label>3</label><figDesc>Figure 3. SEM with both measurement and structural parts</figDesc><graphic coords="7,88.65,352.29,427.63,305.35" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 4 .</head><label>4</label><figDesc>Figure 4. SEM with mean structure and group comparison</figDesc><graphic coords="9,88.65,319.87,427.63,305.35" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 5 .</head><label>5</label><figDesc>Figure 5. Path diagram for twin studies (same structure for BOTH MZ and DZ twins, the correlations will di er, that's all, the path coe cients are identical)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>2.</head><label></label><figDesc>Change has two parameters: it has to have an intercept, and it has to have a slope. It has to have an intercept for the latent or unobserved construct of change, as change has to happen from a baseline, such as change from value X to value Y over a period of time. X in our case, is a baseline intercept value</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure</head><label></label><figDesc>Figure 6. A simple latent growth curve model</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>##</head><label></label><figDesc>select the columns to work with bli_cfa = bli %&gt;% select(education, Income, Health, Environment, qeios.com doi.org/10.32388/DNI7ETHousing, civic, accessibility) bli_cov = cov(bli_cfa, use = "complete.obs") So now we will set up the model and examine it further. analyse fit measures and the parameter estimates separately. blifitm = fitMeasures(bli_1_fit, fit.measure = c("chisq", "pvalue", "cfi", "rmsea", "gfi", "aic"))# you can see that these measures indicate a poor fit of the model # when we have one latent variable bli_1_params = parameterEstimates(bli_1_fit, standardized = T) %&gt;% select(lhs, rhs, est, ci.lower, ci.upper, std.lv, std.all) now create two different latent variables # one will load on safety, health, environment, housing, community, we will call it safe_community # the other will load on education, jobs, income, we will call it secure_self</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head></head><label></label><figDesc>dz = lav_matrix_lower2full(c(1.00, 0.12, 1.00)) rownames(dz) = colnames(dz) = c("T1", "T2") qeios.com doi.org/10.32388/DNI7ET # we will now combine the sample size and correlation matrices cormat = list(mz = mz, dz = dz) sampsize = list(mz = 240, dz =</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head></head><label></label><figDesc>shows only 7 records in 1984 so we will select years 1993 -2014 # they were recorded every 5 years # we will remove 1984 from the data # then we will pivot the data wider happiness1 = happiness %&gt;% lter(year &gt; 1984) %&gt;% pivot_wider(names_from = year, values_from = pct_happy) %&gt;% rename(wave1 = `1993`, , wave1, wave2, wave3, wave4, wave5) # happiness1 %&gt;% head() shows us the data in desired format # Now we prepare the means and covariance matrix happy_mean = c(mean(happiness1$wave1, na.rm = T), mean(happiness1$wave2, na.rm = T), mean(happiness1$wave3, na.rm = T), mean(happiness1$wave4, na.rm = T), mean(happiness1$wave5, na.rm = T)) # happy_mean # covariance matrix of the ve time points happy_cov = happiness1 %&gt;% select(wave1, wave2, wave3, wave4, wave5) %&gt;% cov(use = "complete.obs") Now that we have the means and the covariance matrix, we are ready to code and nd out whether over time, the proportion of people who report they are happy in the happiness surveys are increasing. Besides, we would learn the baseline levels of proportions of people who were happy and the rate of change of that state. Here are the ndings and the code: # build the model (unconstrained, simple model) happiness_model = ' i =~ 1 * wave1 + 1 * wave2 + 1 * wave3 + 1 * wave4 + 1 * wave5 s =~ 0 * wave1 + 5 * wave2 + 10 * wave3 + 15 * wave4 + 20 * wave5 wave1 ~~ r * wave1 wave2 ~~ r * wave2</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Figure 8 .</head><label>8</label><figDesc>Figure 8. Trend in reporting of happiness</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic coords="4,88.65,57.75,427.63,427.63" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic coords="11,88.65,202.32,427.63,305.35" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic coords="14,88.65,57.75,427.63,305.35" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic coords="36,88.65,57.75,427.63,301.98" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>The following table shows the variables:</figDesc><table><row><cell>Variable Name</cell><cell>What it means</cell><cell>Description</cell></row><row><cell>lv</cell><cell>Latent variable</cell><cell>Unobserved variable</cell></row><row><cell>mv1 … mv3</cell><cell>manifest variables</cell><cell>Variables that are physically measured</cell></row><row><cell></cell><cell>Variables that are explained by</cell><cell></cell></row><row><cell>Endogenous variable</cell><cell></cell><cell>Arrows end in these variables</cell></row><row><cell></cell><cell>others</cell><cell></cell></row><row><cell></cell><cell>A variable that is used to explain</cell><cell></cell></row><row><cell>Exogenous variable</cell><cell></cell><cell>Arrows start from these variables</cell></row><row><cell></cell><cell>another</cell><cell></cell></row><row><cell></cell><cell cols="2">Unexplained variances, the path coe cients are</cell></row><row><cell>e1 … e3</cell><cell>Error terms</cell><cell></cell></row><row><cell></cell><cell></cell><cell>set at 1.0</cell></row><row><cell>constant term for mean</cell><cell></cell><cell></cell></row><row><cell></cell><cell>triangle</cell><cell>circle with 1.0 here</cell></row><row><cell>structure</cell><cell></cell><cell></cell></row><row><cell>qeios.com</cell><cell>doi.org/10.32388/DNI7ET</cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2 .</head><label>2</label><figDesc>Symbols used in SEM and what we will do here</figDesc><table><row><cell>Symbol</cell><cell>Description</cell><cell>In our scheme</cell></row><row><cell>Square or Rectangle</cell><cell>Manifest variable</cell><cell>Round circle or letter</cell></row><row><cell>Circle</cell><cell>Error Term</cell><cell>Round Circle or letter</cell></row><row><cell>Oval</cell><cell>Latent Variable</cell><cell>Round or letter</cell></row><row><cell>Straight arrow</cell><cell>Path</cell><cell>Straight arrow</cell></row><row><cell>long Curved double headed arrow</cell><cell>Covariance</cell><cell>Curved arrow</cell></row><row><cell>short curved double headed arrow</cell><cell>Variance</cell><cell>Not shown here</cell></row></table><note><p><p>qeios.com</p>doi.org/10.32388/DNI7ET</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_10"><head></head><label></label><figDesc>Our nal analysis will be based on data where Gallup World Poll measured the proportion of people in various countries where they said they were happy over time, see for more information here. We obtained the data and you can download a copy of the data from here. The data were collected between 1984 through 2014. We will study the longitudinal pattern using SEM (growth model) and study the baseline percentage from where it began and slope of the growth. The data were gathered every ve years.</figDesc><table><row><cell cols="2"># a_squared = 33.4% of heritability is explained by genes</cell></row><row><cell>e_squared = 0.664 * 0.664</cell><cell></cell></row><row><cell cols="2"># e_squared = 44% of heritability explained by unique environmental factors</cell></row><row><cell>model_est</cell><cell></cell></row><row><cell>Are people getting happier over time?</cell><cell></cell></row><row><cell># get the data</cell><cell></cell></row><row><cell>happiness_data</cell><cell>=</cell></row><row><cell cols="2">read_csv("https://raw.githubusercontent.com/arinbasu/2021_04_sem_datasets/main/share_happy.csv")</cell></row><row><cell># Preprocess the data to rename variables, etc</cell><cell></cell></row><row><cell>happiness_data %&gt;%</cell><cell></cell></row><row><cell>head(5)</cell><cell></cell></row><row><cell>## # A tibble: 5 x 4</cell><cell></cell></row><row><cell cols="2">## Entity Code Year `Share of people who are happy (World Value Survey 2014)#</cell></row><row><cell># &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;</cell><cell>&lt;dbl&gt;</cell></row><row><cell># parameter estimates ## 1 Albania ALB 1998</cell><cell>33.4</cell></row><row><cell>## 2 Albania ALB 2004</cell><cell>58.8</cell></row><row><cell>model_est = parameterEstimates(ace_ t) ## 3 Algeria DZA 2004</cell><cell>80.7</cell></row><row><cell>## 4 Algeria DZA 2014</cell><cell>79.9</cell></row><row><cell># t measures ## 5 Andorra AND 2009</cell><cell>92.9</cell></row><row><cell cols="2">ace_measures = tMeasures(ace_ t, number_of_records = length(happiness_data$Code)</cell></row><row><cell cols="2">t.measures = c("chisq", "g ", "rmsea")) number_of_records # 237 countries/regions</cell></row><row><cell>## [1] 237</cell><cell></cell></row><row><cell>a_squared = 0.578 * 0.578</cell><cell></cell></row><row><cell>qeios.com</cell><cell>doi.org/10.32388/DNI7ET</cell></row></table><note><p><p>qeios.com</p>doi.org/10.32388/DNI7ET</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_11"><head></head><label></label><figDesc>## .wave1 (r)  19.522 0.920  21.213 0.000 ## .wave2 (r) 19.522 0.920 21.213 0.000 ## .wave3 (r) 19.522 0.920 21.213 0.000 ## .wave4 (r) 19.522 0.920 21.213 0.000</figDesc><table><row><cell cols="2">## .wave5 (r) 19.522 0.920 21.213 0.000</cell></row><row><cell>## i</cell><cell>20.549 2.691 7.635 0.000</cell></row><row><cell>## s</cell><cell>0.091 0.014 6.380 0.000</cell></row><row><cell cols="2">param_happy = parameterEstimates(happiness_ t)</cell></row><row><cell cols="2">t_happy = tMeasures(happiness_ t)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_12"><head></head><label></label><figDesc>Trend in reporting of happiness qeios.com doi.org/10.32388/DNI7ET intercepts and slopes, as we constrain the parameters that explain variance of the time bound values of variables. While SEMs are powerful strategies, one needs to be careful to deal with missing values, extreme outliers, non-normal distribution of the variables, and categorical variables. Lately, SEM strategies are</figDesc><table><row><cell>being</cell><cell>used</cell><cell>to</cell><cell>model</cell><cell>non-parametric</cell><cell>equations</cell><cell>as</cell><cell>in</cell><cell>(Structural</cell><cell>Causal</cell><cell>Models)</cell></row></table></figure>
		</body>
		<back>

			<div type="availability">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Code of all the graphs and diagrams we have presented so far: 1. Basic path diagram mypaths &lt;-dagitty('dag{ x [pos = "1,1"] a [pos = "2,1"] qeios.com doi.org/10.32388/DNI7ET Code for structural equation modelling semdag &lt;-dagitty('dag{ e1 [pos = "1,1"] mv1 [pos = "2,1"] e2 [pos = "1,2"] mv2 [pos = "2,2"] e3 [pos = "1,3"] mv3 [pos = "2,3"] lv1 [pos = "3,2"] lv2 [pos = "4,2"] mv4 [pos = "5,1"] qeios.com doi.org/10.32388/DNI7ET</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>As you can see in this gure, countries such as Russia and Zimbabwe, that started at the lower end of the graphs had steeper upward slopes reporting happiness over time, while countries that started with higher proportion of people as happy tended to have slower trajectory of growth reporting happy people in subsequent waves. Overall, people do seem to get happier over time, at least till 2014 starting from 1993.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Summary</head><p>In this tutorial, we provided a brief roundup of using structural equation modelling as an analytical strategy. Structural equation modelling is a mix of regression and factor analysis, and as you may have seen, this can be used for validation of surveys and questionnaires, reducing data, linear regression modelling, analysis of group di erences, twin data analyses, and growth curve modelling. </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">## ## Latent</forename><surname>Variables</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Err z-value P(&gt;|z|)</title>
		<author>
			<persName><forename type="first">## Estimate</forename><surname>Std</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">#</forename></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">## ##</forename><surname>Covariances</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">Err z-value P(&gt;|z|)</title>
		<author>
			<persName><forename type="first">## Estimate</forename><surname>Std</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">## ##</forename><surname>Intercepts</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">Err z-value P(&gt;|z|)</title>
		<author>
			<persName><forename type="first">## Estimate</forename><surname>Std</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">#</forename><forename type="middle">#</forename></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">#</forename><forename type="middle">#</forename></persName>
		</author>
		<imprint/>
	</monogr>
	<note>wave5</note>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">## ##</forename><surname>Variances</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Err z-value P(&gt;|z|) qeios</title>
		<author>
			<persName><forename type="first">## Estimate</forename><surname>Std</surname></persName>
		</author>
		<idno type="DOI">10.32388/DNI7ET</idno>
		<ptr target=".comdoi.org/10.32388/DNI7ET" />
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Genetic In uences on p Sychological w Ellb Eing: A Nationally Representative Twin Study</title>
		<author>
			<persName><forename type="first">Despina</forename><surname>Archontaki</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gary</forename><forename type="middle">J</forename><surname>Lewis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Timothy</forename><forename type="middle">C</forename><surname>Bates</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Personality</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="221" to="230" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title level="m" type="main">ORIGINS OF PATH ANALYSIS: Causal Modeling and the Origins of Path Analysis</title>
		<author>
			<persName><forename type="first">D</forename><surname>Denis</surname></persName>
		</author>
		<ptr target="https://theoryandscience.icaap.org/content/vol7.1/denis.html" />
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Measurement Invariance, Factor Analysis and Factorial Invariance</title>
		<author>
			<persName><forename type="first">William</forename><surname>Meredith</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Psychometrika</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="525" to="543" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">Mccl</forename><surname>Neale</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Lon</forename><forename type="middle">R</forename><surname>Cardon</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Methodology for Genetic Studies of Twins and Families</title>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<date type="published" when="2013">2013</date>
			<publisher>Springer Science &amp; Business Media</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Thinking Clearly about Correlations and Causation: Graphical Causal Models for Observational Data</title>
		<author>
			<persName><forename type="first">Julia</forename><forename type="middle">M</forename><surname>Rohrer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in Methods and Practices in Psychological Science</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="27" to="42" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Directed Acyclic Graphs: A Tool for Causal Studies in Paediatrics</title>
		<author>
			<persName><forename type="first">Thomas</forename><forename type="middle">C</forename><surname>Williams</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Cathrine</forename><forename type="middle">C</forename><surname>Bach</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Niels</forename><forename type="middle">B</forename><surname>Matthiesen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Tine</forename><forename type="middle">B</forename><surname>Henriksen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Luigi</forename><surname>Gagliardi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pediatric Research</title>
		<imprint>
			<biblScope unit="volume">84</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="487" to="493" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
