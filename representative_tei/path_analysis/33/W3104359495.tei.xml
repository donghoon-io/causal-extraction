<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Girsanov reweighting for path ensembles and Markov state models</title>
				<funder ref="#_k3qZceh">
					<orgName type="full">unknown</orgName>
				</funder>
				<funder ref="#_aDUb3pZ">
					<orgName type="full">Deutsche Forschungsgemeinschaft (DFG)</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability  status="unknown">
					<licence/>
				</availability>
				<date type="published" when="2017-03-16">16 Mar 2017</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">L</forename><surname>Donati</surname></persName>
						</author>
						<author>
							<persName><forename type="first">C</forename><surname>Hartmann</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Institute of Mathematics</orgName>
								<orgName type="institution">Brandenburgische Technische Universität Cottbus-Senftenberg</orgName>
								<address>
									<addrLine>Konrad-Wachsmann-Allee 1</addrLine>
									<postCode>D-03046</postCode>
									<settlement>Cottbus</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">B</forename><forename type="middle">G</forename><surname>Keller</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Department of Biology, Chemistry, Pharmacy</orgName>
								<orgName type="institution">Freie Universität Berlin</orgName>
								<address>
									<addrLine>Takustraße 3</addrLine>
									<postCode>D-14195</postCode>
									<settlement>Berlin</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Girsanov reweighting for path ensembles and Markov state models</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2017-03-16">16 Mar 2017</date>
						</imprint>
					</monogr>
					<idno type="arXiv">arXiv:1703.05498v1[cond-mat.stat-mech]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.1" ident="GROBID" when="2025-10-29T01:07+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Markov State Models</term>
					<term>Dynamical Reweighting</term>
					<term>Path Ensembles</term>
					<term>Molecular Dynamics</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The sensitivity of molecular dynamics on changes in the potential energy function plays an important role in understanding the dynamics and function of complex molecules. We present a method to obtain path ensemble averages of a perturbed dynamics from a set of paths generated by a reference dynamics. It is based on the concept of path probability measure and the Girsanov theorem, a result from stochastic analysis to estimate a change of measure of a path ensemble. Since Markov state models (MSM) of the molecular dynamics can be formulated as a combined phasespace and path ensemble average, the method can be extended to reweight MSMs by combining it with a reweighting of the Boltzmann distribution. We demonstrate how to efficiently implement the Girsanov reweighting in a molecular dynamics simulation program by calculating parts of the reweighting factor "on the fly" during the simulation, and we benchmark the method on test systems ranging from a two-dimensional diffusion process to an artificial many-body system and alanine dipeptide and valine dipeptide in implicit and explicit water. The method can be used to study the sensitivity of molecular dynamics on external perturbations as well as to reweight trajectories generated by enhanced sampling schemes to the original dynamics. PACS numbers: 05.10.-a Computational methods in statistical physics and nonlinear dynamics (see also 02.70.-c in mathematical methods in physics</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I. INTRODUCTION</head><p>Molecular dynamics (MD) simulations with explicit solvent molecules are routinely used as efficient importance sampling algorithms for the Boltzmann distribution of molecular systems. From the conformational snapshots created by MD simulations, one can estimate phase-space ensemble averages and thus interpret experimental data or thermodynamic functions in terms of molecular conformations.</p><p>In recent years, the scope of MD simulations has considerably widened, and the method has been increasingly used to construct models of the conformational dynamics <ref type="bibr" target="#b0">[1]</ref><ref type="bibr" target="#b1">[2]</ref><ref type="bibr" target="#b2">[3]</ref><ref type="bibr" target="#b3">[4]</ref><ref type="bibr" target="#b4">[5]</ref> . Most notably Markov state models <ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b8">[9]</ref><ref type="bibr" target="#b9">[10]</ref><ref type="bibr" target="#b10">[11]</ref><ref type="bibr" target="#b11">[12]</ref><ref type="bibr" target="#b12">[13]</ref><ref type="bibr" target="#b13">[14]</ref> , in which the conformational space is discretized into disjoint states and the dynamics is modeled as a Markov jump process between these states, have become a valuable tool for the analysis of complex molecular dynamics <ref type="bibr" target="#b14">[15]</ref><ref type="bibr" target="#b15">[16]</ref><ref type="bibr" target="#b16">[17]</ref><ref type="bibr" target="#b17">[18]</ref><ref type="bibr" target="#b18">[19]</ref> .</p><p>For the construction of dynamic models, one has to estimate path ensemble averages. For example in MSMs, the transition probabilities between a pair of states B i and B j is estimated by considering a set of paths S τ = {ω 1 , ω 2 , ...ω n }, each of which has length τ , counting the number of paths which start in B i and end in B j , and comparing this number to the total number of paths in the set (vertical line of blue boxes in Fig. <ref type="figure">1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Reweighting MSM( ) MSM( ) MSM( ) MSM( )</head><p>FIG. <ref type="figure">1</ref>. Workflow of a reweighting scheme. V (r) is the reference potential energy function, V (r) + U (r, κ) is the perturbed potential energy function, where κ is a tunable parameter, ω is the trajectory generated by an MD simulation at the potential V (r) or V (r) + U (r, κ) and at a fixed thermodynamic state point. A MSM is an expectation value with respect to a path probability measure P and a stationary distribution π, which can be estimated from the trajectory ω. A dynamical reweighting scheme, reweights the path probability measures P and π of the reference dynamics, to the path probability measures of a perturbed potential energy functions P and π. Thus, we can use the trajectory generated at V (r) to estimate dynamical expectation value (e.g. MSMs) at the perturbed potential energy functions.</p><p>Suppose, one would like to compare the dynamics in a reference potential energy function V (r) to the dynamics in a series of perturbed potential energy functions V (r)+U (r, κ), where U (r, κ) represents the perturbation and κ is a tunable parameter, e.g. a force constant. While for phase-space ensemble averages, numerous methods exist to reweight the samples of the reference conformational ensemble to yield ensemble averages for the perturbed systems <ref type="bibr" target="#b19">[20]</ref><ref type="bibr" target="#b20">[21]</ref><ref type="bibr" target="#b21">[22]</ref><ref type="bibr" target="#b22">[23]</ref> , similar reweighting schemes have not yet been developed for path ensemble averages of explicit-solvent simulations. This means that currently one would have to re-simulate the dynamics at each parameter value (vertical lines of green boxes in Fig. <ref type="figure">1</ref>) and then construct a MSM for each simulation separately. This is computationally extremely costly.</p><p>An alternative would be to reweight the path ensemble average at the reference potential energy function to obtain path ensemble averages for the perturbed systems (reweighting box in Fig. <ref type="figure">1</ref>). From measure theory it is well known that a reweighting factor is given as the ratio between the probability measure associated to the reference potential energy function and the probability measure associated to the perturbed potential energy function. This applies to reweighting phase space ensemble averages as well as to reweighting path ensemble averages. Fig. <ref type="figure">2</ref> illustrates the idea of a path ensemble reweighting method. The figure shows two sets of paths, one generated by a Brownian dynamics simulation without drift, S τ (Fig. <ref type="figure">2</ref>.A), and one generated by a Brownian dynamics simulation with drift, S τ (Fig. <ref type="figure">2</ref>.B). Both simulations sample the same path space Ω τ,x but the probability with which a given path is realized differs in the two simulations. In Fig. <ref type="figure">2</ref>.A and 2.B, the sets of paths, S τ and S τ , are colored according to their respective path probability density µ P (ω) and µ P (ω). Fig. <ref type="figure">2</ref>.C and 2.D shows again S τ , this time however we colored the paths according to the probability density µ P (ω) with which they would have been generated by a Brownian dynamics with drift. For Brownian dynamics this probability can be calculated directly (Fig. <ref type="figure">2</ref>.C), for other types of dynamics a reweighting method has to be used (Fig. <ref type="figure">2</ref></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>.D).</head><p>To estimate a path ensemble average for the Brownian dynamics with drift from S τ , the contribution of each path ω to the estimate is multiplied by the ratio M τ,x (ω) = µ P (ω)/µ P (ω) (Fig. <ref type="figure">1</ref>).</p><p>Path ensemble reweighting schemes have initially been developed in the field of importance sampling for stochastic differential equations <ref type="bibr" target="#b23">[24]</ref><ref type="bibr" target="#b24">[25]</ref><ref type="bibr" target="#b25">[26]</ref> . For Langevin dynamics, the Girsanov theorem <ref type="bibr" target="#b26">27,</ref><ref type="bibr" target="#b27">28</ref> provides us with an expression for the probability ratio, and thus reweighting path ensemble averages becomes possible for this type of dynamics (section II D). It has recently been demonstrated that the theorem can be applied to reweight Markov state models of Brownian dynamics in one-and two-dimensional potential energy functions <ref type="bibr" target="#b28">29</ref> .</p><p>Here we demonstrate how the Girsanov reweighting scheme can be applied to explicitsolvent all-atom MD simulations. For this, we need to address to critical pillars on which the Girsanov reweighting scheme rests:</p><p>• The equation of motion need to contain a stochastic term which generates random forces drawn from a normal distribution (white noise).</p><p>• To calculate the reweighting factor, the random forces need to be accessible for each MD simulation step.</p><p>In all-atom MD simulations, the system is propagated by the Newton equations of motion which do not contain a stochastic term. We will discuss, how the Girsanov theorem can nonetheless be applied to this type of simulations (section IV B). The second point, in principle, requires that the forces are written out at every MD simulation step, i.e. at a frequency of femtoseconds rather than the usual output rate of several picoseconds. This quickly fills up any hard disc and slows the simulation by orders of magnitudes. We will present a computational efficient implementation of the reweighting scheme (section IV A).</p><p>When applying the Girsanov theorem to reweight an MSM, an additional difficulty arises • The degrees of freedom which are affected by the perturbation might not be part of the relevant subspace of the MSM.</p><p>We found that the reweighting becomes problematic in this case and propose to project the perturbed degrees of freedom onto the relevant subspace during the estimation of the ratio of probability measures (section II E).</p><p>The Girsanov reweighting method is demonstrated and benchmarked on several systems, ranging from two-dimensional diffusion processes (section IV C), over molecular model systems which follow a Langevin dynamics (section IV D) to all-atom MD simulations of alanine and valine dipeptides in explicit and implicit solvent (section IV E).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>II. THEORY</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Molecular dynamics</head><p>Consider a molecular system with N particles, which evolves in time t according to the Langevin equation</p><formula xml:id="formula_0">M dv(t) dt = -∇V (r(t)) -γv(t) + ση(t) v(t) = dr(t) dt ,<label>(1)</label></formula><p>where M is the mass matrix, r(t) and v(t) ∈ R 3N are the position vector and the velocity vector. V (r) is the potential energy function. The interaction with the thermal bath is modelled by the friction coefficient γ, and an uncorrelated Gaussian white noise η(t) ∈ R 3N which is scaled by the volatility σ</p><formula xml:id="formula_1">σ = 2k B T γM<label>(2)</label></formula><p>where k B is the Boltzmann constant and T is the temperature of the system. The phase-space vector x(t) = {r(t), v(t)} ∈ Γ fully represents the state of the system at time t, where Γ = R 6N denotes the phase space of the system. The dynamics in eq. 1 is associated to an equilibrium probability density</p><formula xml:id="formula_2">µ π (x) = exp [-βH(x)] Z<label>(3)</label></formula><p>where</p><formula xml:id="formula_3">β = 1 k B T , H(x) = 1 2 v M v + V (r)</formula><p>is the classical Hamiltonian of the system, and Z = Γ exp [-βH(x)] dx is the partition function. The function µ π (x) is associated to the probability measure</p><formula xml:id="formula_4">π(A) = P(x ∈ A) = A µ π (x)dx , ∀A ⊂ Γ (<label>4</label></formula><formula xml:id="formula_5">)</formula><p>where π(A) represents the equilibrium probability of finding the system in a subset A of the phase space Γ. The expectation value of a function a(x) : Γ → R with respect to the probability density µ π (x) is given as</p><formula xml:id="formula_6">E π [a] = Γ a(x)µ π (x) dx = lim n→∞ 1 n x k ∈Sn a(x k ) ,<label>(5)</label></formula><p>where S n = {x 1 , ...x n } is a set of states distributed according to eq. 3. When the phase space vectors x i are generated by numerically integrating eq. 1, the second equality only holds if the sampling is ergodic. Eq. 5 defines a phase-space ensemble average. The subscript π indicates the measure for which the expectation value is calculated.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Path ensembles and MSMs</head><p>A path ω = {x(t = 0) = x 0 , x 1 , x 2 , ..., x(τ ) = x n } is a time-discretized realization of the dynamics x(t) on the time interval [0, τ = n • ∆t] starting at particular point x 0 ∈ Γ, where ∆t is the time step and n ∈ N is the number of time steps. The associated path space is denoted Ω τ,x = R 6N •n . A subset of the path space A is constructed as a product of subsets A i ⊂ Γ of the state space A = A 1 × A 2 ... × A n , where the subset A i represents the phase space volume in which x i may be found. The probability that by integrating eq. 1 one obtains a path ω which belongs to the subset A ⊂ Ω τ,x is given as</p><formula xml:id="formula_7">P (A) = P(ω ∈ A) = P(x 1 ∈ A 1 , x 2 ∈ A 2 , ..., x τ ∈ A n ) = A 1 A 2 ... An p(x 0 , x 1 ; ∆t) p(x 1 , x 2 ; ∆t) ... p(x n-1 , x n ; ∆t) dx 1 dx 2 ... dx n . (6)</formula><p>The function p(x i , x i+1 ; ∆t) is the transition probability density , i.e. the conditional probability to be in x i+1 after a time ∆t given the initial state x i . The function P is a path probability measure and is the analogon to π in phase space ensemble averages (eq. 4). The path probability measure is associated to the path probability density function: µ P (ω) = µ P (x 1 , x 2 , ..., x τ ) = p(x 0 , x 1 ; ∆t) p(x 1 , x 2 ; ∆t) ... p(x n-1 , x n ; ∆t) (7)   and hence the formal analogon to eq. 4 in the path space is</p><formula xml:id="formula_8">P (A) = P(ω ∈ A) = A µ P (ω)dω , ∀A ⊂ Ω τ,x<label>(8)</label></formula><p>where the integration over dω is defined by eq. 6.</p><p>Let f : Ω τ,x → R be an integrable function, which assigns a real number to each path. The expectation value of this function is</p><formula xml:id="formula_9">E P [f (ω)] = Ωτ,x f (ω) µ P (ω) dω = Γ Γ • • • Γ f (x 1 , x 2 , ..., x n )µ P (x 1 , x 2 , ..., x n )dx 1 dx 2 ... dx n = lim m→∞ 1 m ω k ∈Sτ,x,m f (ω k ) . (<label>9</label></formula><formula xml:id="formula_10">)</formula><p>where we again assumed that the paths have a common initial state x(t = 0) = x 0 , and S τ,x,m = {ω 1 , ω 2 , ...ω m } corresponds to a set of paths of length τ generated by numerically integrating eq. 1. When the paths are extracted from a single long trajectory, the last equality only holds if the sampling is ergodic. Eq. 9 defines a path ensemble average. The subscript P indicates that the expectation value is calculated with respect to a path probability measure.</p><p>For Markov processes, one can define a transition probability density p(x, y; τ ), i.e. the conditional probability to be in x n = y after a time τ given that the path started in x 0 = x, by integrating the path probability density over all intervening states and applying recursively the Chapman-Kolmogorov equation</p><formula xml:id="formula_11">p(x, y, τ ) = Γ Γ • • • Γ µ P (x 1 , x 2 , ..., y) dx 1 dx 2 ... dx n-1 .<label>(10)</label></formula><p>Markov processes can be approximated by Markov state models <ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b8">[9]</ref><ref type="bibr" target="#b9">[10]</ref><ref type="bibr" target="#b10">[11]</ref><ref type="bibr" target="#b11">[12]</ref><ref type="bibr" target="#b13">14</ref> . In these models, the phase space is discretized into disjoint sets (or microstates) B 1 , B 2 , ...B s with ∪ m i=1 B i = Γ, where the indicator function of the ith state is given by</p><formula xml:id="formula_12">1 B i (x) := 1 if x ∈ B i , 0 otherwise . (<label>11</label></formula><formula xml:id="formula_13">)</formula><p>The associated cross-correlation function is</p><formula xml:id="formula_14">C ij (τ ) = Γ µ π (x)1 B i (x) Γ p(x, y; τ ) 1 B j (y) dy dx ,<label>(12)</label></formula><p>and the transition probability between set B i and set B j is</p><formula xml:id="formula_15">T ij (τ ) = C ij (τ ) s j=1 C ij (τ ) . (<label>13</label></formula><formula xml:id="formula_16">)</formula><p>T ij (τ ) are the elements of the transition matrix whose dominant eigenvectors and eigenvalues represent the slow dynamic processes of the system <ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b8">[9]</ref><ref type="bibr" target="#b9">[10]</ref><ref type="bibr" target="#b10">[11]</ref><ref type="bibr" target="#b11">[12]</ref><ref type="bibr" target="#b13">14</ref> . Because of eq. 10, one can regard the inner integral of the cross-correlation function C ij (τ ) (eq. 12) as a path ensemble average (eq. 9) which depends on the initial state x 0 = x of the path ensemble</p><formula xml:id="formula_17">Γ p(x, y; τ ) 1 B j (y) dy = Γ Γ • • • Γ µ P (x 1 , x 2 , ..., x n ) 1 B j (x n ) dx 1 dx 2 . . . dx n = E x 0 P [1 B j (x n )] .<label>(14)</label></formula><p>This expected value is a linear operator and it is called backward transfer operator (more details are given in appendix). The outer integral in eq. 12 is a phase space ensemble average, thus we have</p><formula xml:id="formula_18">C ij (τ ) = Γ µ π (x 0 ) 1 B i (x 0 ) E x 0 P [1 B j (x n )]dx 0 = E π [1 B i (x 0 ) E x 0 P [1 B j (x n )]] = E P,π [1 B i (x 0 )1 B j (x n )] (<label>15</label></formula><formula xml:id="formula_19">)</formula><p>where the combined phase space and ensemble average is defined as</p><formula xml:id="formula_20">E P,π [f (ω)] = Γ µ π (x 0 ) Ωτ,x f (ω) µ P (ω) dω dx 0 .<label>(16)</label></formula><p>Eq. 16 extends eqs. 9 to path ensembles with arbitrary initial states. The elements C ij (τ ) can be estimated from a set of paths of length τ , S τ,m = {ν 1 , ν 2 ...ν m }, in which the initial states are no longer fixed but are distributed according to µ π (x),</p><formula xml:id="formula_21">C ij (τ ) = lim m→∞ 1 m ν k ∈Sτ 1 B i ([ν k ] t=0 ) • 1 B j ([ν k ] t=n ) = lim m→∞ 1 m m k=1 1 B i ([x 0 ] k ) • 1 B j ([x n ] k )<label>(17)</label></formula><p>where [ν k ] t=i = [x i ] k denotes the ith time step of the kth path.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Dynamical reweighting</head><p>We alter the reference dynamics (eq. 1) by adding a perturbation U (r) : Γ → R to the potential energy function V (r). Thus, V (r) = V (r) + U (r) is the perturbed potential energy function and the Langevin equations of motion are</p><formula xml:id="formula_22">M dv(t) dt = -∇ V (r(t)) -γv(t) + ση(t) v(t) = dr(t) dt ,<label>(18)</label></formula><p>The perturbed dynamics is associated to a peturbed stationary probability density</p><formula xml:id="formula_23">µ π (x) = exp -β H(x) Z ,<label>(19)</label></formula><p>where</p><formula xml:id="formula_24">H(x) = 1 2 v M v + V (r)</formula><p>is the Hamiltonian of the perturbed system, and Z is its partition function. The perturbation of the potential energy function also changes the transition probability density p(x i , x i+1 ; ∆t), which gives rise to a perturbed path probability density µ P (ω) (eq. 7) and a perturbed path measure P (eq. 6) .</p><p>Reweighting methods compare the probability measure of the perturbed systems to the probability measure of a reference system. We first review the derivation of a reweighting scheme for phase space probability measures before discussing path space probability measures. The perturbed phase-space probability measure π is said to be absolutely continuous with respect to the reference phase space probability measure π if</p><formula xml:id="formula_25">π(A) = A µ π (x) dx = 0 ⇒ π(A) = A µ π (x) dx = 0 . (<label>20</label></formula><formula xml:id="formula_26">)</formula><p>This condition is sufficient and necessary to define the likelihood ratio between probability measures</p><formula xml:id="formula_27">g(x) = d π dπ = µ π (x) µ π (x) = Z Z exp (-βU (x)) .<label>(21)</label></formula><p>The function g(x) is also called Radon-Nikodym derivative (Radon-Nikodym theorem <ref type="bibr" target="#b27">28</ref> ) and can be used to construct the phase-space probability measure of the perturbed system, from the phase-space probability of the reference system:</p><formula xml:id="formula_28">π(A) = A µ π (x)dx = A g(x)µ π (x)dx .<label>(22)</label></formula><p>As consequence, if g(x) can be calculated, one can estimate a phase space ensemble average (eq. 5) for the perturbed dynamics (eq. 18) from a set of states S n = {x 1 , ...x n } which has been generated by the reference dynamics (eq. 1)</p><formula xml:id="formula_29">E π [a] = Γ a(x)µ π (x) dx = Γ a(x)g(x)µ π (x) dx = lim n→∞ 1 n n k=1 a(x k )g(x k ) .<label>(23)</label></formula><p>The notion of absolute continuity is valid also for path probability densities:</p><formula xml:id="formula_30">P (A) = A µ P (ω)dω = 0 ⇒ P (A) = A µ P (ω)dω = 0 ∀A ⊂ Ω τ,x .<label>(24)</label></formula><p>Thus we can reweight a path ensemble average, by using the likelihood ratio between the path probability density µ P (ω) and µ P (ω). For diffusion processes like (1) and ( <ref type="formula" target="#formula_22">18</ref>), the likelihood ratio is given as</p><formula xml:id="formula_31">M τ,x (ω) = µ P (ω) µ P (ω) = exp - 3N i=1 n k=0 ∇ i U (r k ) σ η i k √ ∆t - 1 2 n k=0 ∇ i U (r k ) σ 2 ∆t (<label>25</label></formula><formula xml:id="formula_32">)</formula><p>where η i k are the random numbers, along dimension i at time step k, generated to integrate equation 1 of the reference dynamics and ∇ i U (r k ) is the gradient of the perturbation along dimension i measured a the position r k . Note that to evaluate eq. 25 one needs the positions and the random numbers for every time step of the time-discretized trajectory. Eq. 25 is </p><formula xml:id="formula_33">Γ ⊂ R 6N Ω τ,x = Γ n ⊂ R 6N •n Subsets A i ⊂ Γ A = ( n i=1 A i ) ⊂ Ω τ,x</formula><p>Probability density</p><formula xml:id="formula_34">µ π (x) | t→∞ µ P (ω) Probability of a state/path π(A) = A µ π (x)dx P (A) = A µ P (ω)dω Expectation value E π [f (x)] = A f (x)µ π (x)dx E P [f (ω)] = A f (ω)µ P (ω)dω Absolute continuity π(A) = 0 ⇒ π(A) = 0 P (A) = 0 ⇒ P (A) = 0 Radon-Nikodyn derivative d π</formula><p>dπ , see eq. 21</p><formula xml:id="formula_35">d P dP , see eq. 25</formula><p>derived in appendix C. We remark that the quantity M τ,x (ω) exists also for continuous paths (∆t → 0). In this case the existence of the Radon-Nikodym derivative is guaranteed by the Girsanov theorem 27,28 that states the conditions under which a perturbed path probability density P can be defined with respect to a reference path probability density P . The differences between time-continuous and time-discrete paths are discussed in the appendix A.</p><p>Analogous to the reweighting of phase-space ensemble averages (eq. 23), we can use M τ,x (ω) to reweight path ensemble averages</p><formula xml:id="formula_36">E P [f (ω)] = Ωτ,x f (ω) M τ,x (ω) µ P (ω) dω = lim n→∞ 1 n n i=1 M τ,x (ω i ) f (ω i ) . (<label>26</label></formula><formula xml:id="formula_37">)</formula><p>The second equality shows how to estimate the path ensemble average E P [f (ω)] at the perturbed dynamics (eq. 18) from a set of paths S τ,x,m = {ω 1 , ω 2 , ...ω m } which has been generated by the reference dynamics (eq. 1).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D. Reweighting MSMs</head><p>When reweighting a MSM, we estimate the cross-correlation function C ij (τ ) for the perturbed dynamics (eq. 18), from a set of paths of length τ , S τ,m = {ν 1 , ν 2 ...ν m }, which has been generated by the reference dynamics (eq. 1). The cross-correlation function C ij (τ ) is a combined phase space and path ensemble average (eq. 16). Thus, both averages have to be reweighted with the appropriated probability ratio</p><formula xml:id="formula_38">E P , π [a(x 0 )f (ω)] = Γ a(x 0 )µ π (x 0 ) Ωτ,x f (ω) µ P (ω) dω dx 0 = Γ a(x 0 )g(x 0 )µ π (x 0 ) Ωτ,x f (ω) M τ,x (ω) µ P (ω) dω dx 0 . (<label>27</label></formula><formula xml:id="formula_39">) With a(x 0 ) = 1 B i (x 0 ) and f (ω) = 1 B j (x n ), we obtain C ij (τ ) = E P , π [1 B i (x 0 )1 B j (x n )] = Γ 1 B i (x 0 )g(x 0 )µ π (x 0 ) Ωτ,x 1 B j (x n ) M τ,x (ω) µ P (ω) dω dx 0 . (<label>28</label></formula><formula xml:id="formula_40">)</formula><p>which can be estimated from a set of paths S τ,m = {ν 1 , ν 2 ...ν m } as</p><formula xml:id="formula_41">C ij (τ ) = lim m→∞ 1 m ν k ∈Sτ,m g([x 0 ] k )1 B i ([x 0 ] k ) • M x,τ (ν k )1 B j ([x n ] k ) . (<label>29</label></formula><formula xml:id="formula_42">)</formula><p>where [x i ] k is the ith time step of the kth path. As in eq. 12, the initial states of the paths are not fixed but are distrubuted according to the equilibrium distribution µ π (x) of the unperturbed dynamics. Finally, the transition probability between set B i and set B j for the perturbed dynamics is obtained as</p><formula xml:id="formula_43">T ij (τ ) = C ij (τ ) j C ij (τ ) . (<label>30</label></formula><formula xml:id="formula_44">)</formula><p>The Radon-Nikodym derivative for path ensembles g(x) contains the ratio of the partition functions Z / Z as a multiplicative factor. Since this factor appears both in the numerator and the denominator of eq. 30, it cancels, and the partition functions do not have to be calculated.</p><p>T ij (τ ) (and analogously T ij (τ )) is an element of the s × s MSM transition matrix T(τ ), where s is the number of disjoint sets (microstates). We characterize the MSM by plotting and analyzing the dominant left and right eigenvectors of the transitiom matrix</p><formula xml:id="formula_45">T(τ )r i = λ i (τ )r i l i T(τ ) = λ i (τ )l i (<label>31</label></formula><formula xml:id="formula_46">)</formula><p>where l i denotes the transpose of vector l i . We assess the approximation quality of the MSM by checking wether the implied timescales</p><formula xml:id="formula_47">t i = - τ ln(λ i (τ )) = const ∀ τ &gt; 0 (<label>32</label></formula><formula xml:id="formula_48">)</formula><p>are constant <ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b11">12</ref> .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E. Projection</head><p>We now consider a perturbation U (•) that does not directly affect the relevant coordinates used to construct the MSM. In such a situation the perturbation acts mainly on the coordinates directly perturbed and has a minor effect on the other degrees of freedom, in particular on the relevant coordinates that do not capture the full effect of the perturbation. Thus the reweighting may become problematic because the reweighting formula ( <ref type="formula" target="#formula_31">25</ref>) is dominated by large, fluctuating gradients, therefore a rescaling of the force needs to be introduced. To address this issue, we propose to project the gradient of the perturbation onto the coordinates used to construct the MSM. Let's assume that the MSM has been built on a combination of d coordinates χ 1 , ...χ d , then the equation 25 is rewritten as:</p><formula xml:id="formula_49">M τ,x (ω) = µ P (ω) µ P (ω) = exp - 3N i=1 n k=0 c i,k σ i η i k √ ∆t - 1 2 n k=0 c i,k σ i 2 ∆t (<label>33</label></formula><formula xml:id="formula_50">)</formula><p>with</p><formula xml:id="formula_51">c i,k = d j=1 ∇ i U (r k ), χ j,k χ j,k , χ j,k χ j,k<label>(34)</label></formula><p>III. METHODS</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Two dimensional system</head><p>The Brownian dynamics on a two-dimensional potential energy function V (x, y)</p><formula xml:id="formula_52">dx t = -∇ x V (x t , y t ) + σdB x t dy t = -∇ y V (x t , y t ) + σdB y t (<label>35</label></formula><formula xml:id="formula_53">)</formula><p>have been solved using the Euler-Maruyama scheme <ref type="bibr" target="#b29">30</ref> with an integration time step of ∆t = 0.001. The term B i t denotes a standard Brownian motion in direction i = x, y, σ = 1 is the volatility, and the random variables η i were drawn from a standard Gaussian distribution. The reference potential energy function was</p><formula xml:id="formula_54">V (x, y) = (x 2 -1) 2 + (y 2 -1) 2 + |x -y| ,<label>(36)</label></formula><p>and the perturbed potential energy function was V (x, y, ) = V (x, y) + U (y) with</p><formula xml:id="formula_55">U (y) = -y<label>(37)</label></formula><p>For both potential energy functions, trajectories of 8 × 10 7 time-steps were produced. In both simulations, the path probability ratio M τ,x was calculated using eq. 25. The MSM have been constructed by discretizing each dimension x and y into 40 bins, yielding 1600 microstates. The chosen lagtime was τ = 400 time-steps.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Many-body system in three-dimensional space</head><p>We designed a six-particle system, in which five particles form a chain while the sixth particle branches the chain at the central atom (Fig. <ref type="figure" target="#fig_2">5</ref>.A). The position of the ith particle is r i ∈ R 3 . The potential energy between two directly bonded atoms (blue lines in Fig. <ref type="figure" target="#fig_2">5</ref></p><formula xml:id="formula_56">.A) was V (r ij ) = r 2 ij -1 2 + 0.6r ij<label>(38)</label></formula><p>with r ij = r j -r i . The bond potential energy function is a tilted double well potential. This ensures that the potential energy function of the complete system has multiple minima with varying depths. No non-bonded interactions were applied. Thus, the reference potential energy function of the complete system was</p><formula xml:id="formula_57">V (r) =</formula><p>ij=12,13,14,24,36</p><formula xml:id="formula_58">V (r ij )<label>(39)</label></formula><p>The Langevin dynamics (eq. 1) of this system have been solved using the BBK integrator <ref type="bibr" target="#b30">31</ref> with an integration time step of ∆t = 0.001. The masses M of the particles, temperature T , the friction coefficient γ, and the Boltzmann constant k B were all set to one. The perturbed potential energy function was V (r) = V (r) + U (r) with</p><formula xml:id="formula_59">U (r) = 1 2 r 2 24 + 1 2 r 2 34 (<label>40</label></formula><formula xml:id="formula_60">)</formula><p>The perturbation is a harmonic potential energy along the through-space distance between atoms (2, 4) and (3, 4), respectively (green dashed line in Fig. <ref type="figure" target="#fig_2">5</ref>.A). For both potential energy functions, trajectories of 3.2×10 8 time-steps were produced. The MSMs were constructed on the two-dimensional space spanned by the bond-vectors r 12 and r 13 , i.e. on two coordinates which were not directly perturbed. Each dimension x and y has been discretized into 40 bins, yielding 1600 microstates. The chosen lagtime was τ = 400 time-steps. In both simulations, the path probability ratio M τ,x was calculated by projecting the gradient vectors ∇U (r 24 ) and ∇U (r 34 ) on the vectors r 12 and r 13 and subsequently evaluating eq. 33.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Alanine and Valine dipeptide</head><p>We performed all-atom MD simulations of acetyl-alanine-methylamide (Ac-A-NHMe, alanine dipeptide) in implicit and explicit water and of acetyl-valine-methylamide (Ac-V-NHMe, valine dipeptide) in implicit water. All simulations were carried out with the OPENMM 7.01 simulation package <ref type="bibr" target="#b31">32</ref> , in an NVT ensemble at 300 K. Each system was simulated with the force field AMBER ff-14sb <ref type="bibr" target="#b32">33</ref> . The water model was chosen according to the simulation, i.e. the GBSA model <ref type="bibr" target="#b33">34</ref> for implicit solvent simulation and the TIP3P model <ref type="bibr" target="#b34">35</ref> for explicit solvent simulation. For each of these setups, the aggregated simulation time was 1 µs and we printed out the positions every nstxout=100 time steps, corresponding to 0.2 ps. A Langevin thermostat has been applied to control the temperature and a Langevin leapfrog integrator <ref type="bibr" target="#b35">36</ref> has been used to integrate eq. 1. For implicit solvent simulations, interactions beyond 1 nm are truncated. For explicit solvent simulations, periodic boundary conditions are used with the Particle-Mesh Ewald (PME) algorithm to estimate Coulomb interactions.</p><p>In the alanine dipeptide simulations, we have perturbed the potential energy function of the backbone dihedral angles φ and ψ. The reference potential energy functions were V (φ) = 0.27 cos(2φ) + 0.42 cos(3φ) (41)</p><formula xml:id="formula_61">V (ψ) = 0.45 cos(ψ -π) + 1.58 cos(2ψ -π) + 0.44 cos(3ψ -π)<label>(42)</label></formula><p>where the parameters have been extracted from force field files and π denotes the mathematical constant. The perturbed potential energy function was a harmonic potential along each dihedral angle degree of freedom</p><formula xml:id="formula_62">U (φ, ψ) = 1 2 κ φ φ 2 + 1 2 κ ψ ψ 2<label>(43)</label></formula><p>where κ φ and κ ψ are the force constants, which could be adjusted after the simulation (Fig. <ref type="figure" target="#fig_3">6</ref>.A and 6.B). The gradient ∇ r i U (•) in eq. 25 is defined with respect to the Cartesian coordinates. Thus, applying the chain rule, the path probability ratio for the perturbation of the backbone dihedral angles is given as</p><formula xml:id="formula_63">M τ = exp{- N i [κ φ τ 0 φ(s) σ i ∂φ(s) ∂r i dB i s + κ ψ τ 0 ψ(s) σ i ∂ψ(s) ∂r i dB i s - 1 2 κ 2 φ τ 0 φ(s) σ i ∂φ(s) ∂r i 2 ds - 1 2 κ 2 ψ τ 0 ψ(s) σ i ∂ψ(s) ∂r i</formula><p>2 ds</p><formula xml:id="formula_64">κ φ κ ψ τ 0 φ(s)ψ(s) σ 2 i ∂φ(s) ∂r i</formula><p>∂ψ(s) ∂r i</p><p>ds]} .</p><p>In the valine dipeptide simulation, we have perturbed the χ 1 side-chain dihedral angle. The reference potential energy function was V (χ) = 0.337 cos(χ) + 0.216 cos(2χ -π) + 0.001 cos(4χ -π) + 0.148 cos(3χ) .</p><p>(</p><formula xml:id="formula_66">)<label>45</label></formula><p>where the parameters have been extracted from force field files and π denotes the mathematical constant. The perturbed potential energy function was a harmonic potential</p><formula xml:id="formula_67">U (χ) = 1 2 κ χ χ 2<label>(46)</label></formula><p>where κ χ is the force constant, which could be adjusted after the simulation (Fig. <ref type="figure" target="#fig_5">8</ref>.A). Thus, the path probability ratio is given as</p><formula xml:id="formula_68">M τ = exp{- N i [κ χ τ 0 χ(s) σ i ∂χ(s) ∂r i dB i s - 1 2 κ 2 χ τ 0 χ(s) σ i ∂χ(s) ∂r i 2 ds]} . (<label>47</label></formula><formula xml:id="formula_69">)</formula><p>The MSM, for both alanine dipeptide and valine dipeptide simulations, have been constructed by discretizing the dihedral angles φ and ψ into 36 bins each, yielding 1296 microstates. The chosen lagtime was 20 ps for both the implicit and explicit solvent simulation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>IV. RESULTS AND DISCUSSION</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Efficient implementation</head><p>To estimate a MSM at a perturbed potential energy function V (x) + U (x, κ) with the dynamical reweighting method, one simulates a long trajectory x(t) at a reference potential energy function V (x) using an integration time step ∆t. From this trajectory m short paths of length τ = n∆t are extracted, yielding a set of paths S τ,m = {ν 1 , ν 2 , ...ν m }, which can subsequently be used to evaluate eq. 29, where g([x 0 ] k ) is given by eq. 21 and M x,τ (ν k ) is given by eq. 25 or eq. 33. As discussed in section II D, the factor Z / Z cancels for the estimate of T ij (τ ) (eq. 30) and the partition functions do not need to be calculated.</p><p>Let us assume that the simulation integrates the Langevin equation of motion for the reference potential energy function V (x) (eq. 1). To estimate a MSM with transition probabilities T ij (τ ) for the dynamics in the perturbed potential energy function from a set of paths S τ,m = {ν 1 , ν 2 , ...ν m }, we need to know the value of the perturbation U ([x t ] k , κ) at every time step t and for each path ν k , the gradient of the perturbation ∇U ([x t ] k , κ) at every time step t and for each path ν k , the random numbers η k generated at every time step of the simulation of each path ν k , and the volatility σ. The volatility is determined by the temperature and the friction coefficient (eq. 2), both of which are input parameters for the simulation algorithm. To calculate the other three properties one needs to know the positions and the random numbers at every integration time step of the simulation.</p><p>In a naive implementation of the reweighting method one would hence write out the positions and random number at every time step and calculate g([x 0 ] k ) and M x,τ (ν k ) in a post-analysis step. The advantage of this approach is that the set of paths can be reweighted to the path probability measure of any perturbation U (x, κ), as long as the absolute continuity is respected (eq. 20). On the other hand, this approach is hardly practical because writing out a trajectory at every integration time step quickly fills up any hard disc and slows down the simulation considerably.</p><p>We therefore decided to compute the probability ratios g([x 0 ] k ) and M x,τ (ν k ) "on the fly" during the simulation. In practice, the lag time τ of a MSM can only assume values integer multiples of the frequency nstxout at which the positions are written to file, i.e. of τ = n∆t = A • nstxout • ∆t with A ∈ N. The discretized Itô integral and the discretized Riemann integral in eq. 25 are sums from time step k = 0 to k = n, which can be broken down into A sums of size nstxout</p><formula xml:id="formula_70">n k=0 . . . = nstxout-1 k=0 • • • + 2• nstxout-1 k=nstxout • • • + A•nstxout-1 k=(A-1)•nstxout (48)</formula><p>Thus, we calculate the terms</p><formula xml:id="formula_71">I(a) = - 3N i=1 a•nstxout-1 k=(a-1)•nstxout ∇ i U (r k ) σ η i k √ ∆t<label>(49)</label></formula><p>and</p><formula xml:id="formula_72">R(a) = - 3N i=1 1 2 a•nstxout-1 k=(a-1)•nstxout ∇ i U (r k ) σ 2 ∆t<label>(50)</label></formula><p>"on the fly" and write out the results at the same frequency nstxout as the positions. The path probability ratio is reconstructed after the simulation as</p><formula xml:id="formula_73">M τ,x (ω) = exp A a=1 I(a) + R(a) .<label>(51)</label></formula><p>The potential energy of the perturbation U (x t ) is written out at the frequency nstxout and the complete weight g([x 0 ] k ) • M x,τ (ν k ) is calculated during the construction of the MSM.</p><p>The lag-time τ can be chosen and varied after the simulation. The modification of the MD integrator can be readily implemented within the MD software package OpenMM <ref type="bibr" target="#b31">32</ref> . An example script is provided in the supplementary material.</p><p>The approach requires that the perturbation potential energy function U (r, κ) is chosen prior to the simulation. Note however that, if the perturbation potential energy function depends linearly on the parameter κ, i.e. if κ is a force constant U (r, κ) = κ • U (r), then so do the two integrals I(a, U (r, κ)) = κ • I(a, U (r)) and R(a, U (r, κ)) = κ • R(a, U (r)). Thus, it is sufficient to calculate I(a, U (r)) and R(a, U (r)) "on the fly" and to scale the integrals after the simulation to any desired value of κ. A single simulation is sufficient to allow for reweighting to a whole series of perturbation potential energy functions. Also, the integrator can be modified such that the Itô integrals I 1 (a), I 2 (2)... and the Riemann integral R 1 (a), R 2 (2)... of several functionally different perturbation energy functions U 1 (x), U 2 (x)... are calculated. Thus, using a single reference simulation one can reweight to several functionally different perturbations and scale these perturbations by an arbitrary force constant. The computional cost of adding the calculation of I i (a) and R i (a) for a perturbation energy function U i (x) is modest. The blue line in Fig. <ref type="figure" target="#fig_0">3</ref> shows the computational costs for simulating alanine dipeptide in implicit water with n = 0, 1, 2, 3, 4, 5 different perturbations as the number of days required to obtain a trajectory of 1 µs for each perturbation on a small workstation. The red line in Fig. <ref type="figure" target="#fig_0">3</ref> shows the computational cost of implementing the same n perturbations into a single reference simulation. For a single perturbation 30% of the computational cost is saved by dynamical reweighting, whereas for 5 perturbations more than half of the computational cost is saved. The gain is even greater, if the dependence on a force constant is to be studied. Moreover, in simulation boxes of larger systems with explicit solvent, the cost of evaluating of the perturbation potential energy is small compared to the normal force evaluations, such that for these systems the computional cost of calculating the I i (a) and R i (a) "on the fly" becomes negligible. We remark that if I i (a) and R i (a) are too large, the Girsanov reweighting method might become numerically intractable.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Stochastic forces</head><p>The dynamical reweighting method has been derived by using the Langevin equation of motion as starting point. The concept of the path probability is inextricably linked to the presence of Gaussian random forces in the equation of motion (see appendix A). However from a physical perspective, the Langevin dynamics only approximates the Hamiltonian dynamics of the complete system, by splitting the system in a subsystem S and a heat bath B and replacing the interaction of the subsystem with the heat bath by a friction term and a stochastic process. In most MD simulations, thermostatted versions of the Hamiltonian dynamics are propagated in which no stochastic forces are generated. In principle, one could split such a simulation box into two subsystem S and B and use the forces which subsystem B exerts on subsystem S as substitute for the random forces. Unfortunately, even if the heat bath B consists of Lennard-Jones particles, the forces on S deviate too much from a Gaussian random process to be used in the dynamical reweighting method (data not shown). We therefore decided to use the Langevin leapfrog integrator <ref type="bibr" target="#b35">36</ref> to integrate the Langevin equation of motion for both the implicit and explicit solvent simulations and used the random forces generated by the integrator to reweight the path ensemble.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Two dimensional system</head><p>As a first application, we consider the Brownian dynamics of a particle moving on a two-dimensional potential energy function (eq. 35). The reference potential energy function V (x, y) (eq. 36, Fig. <ref type="figure" target="#fig_1">4</ref>.A) has two minima at (-1, -1) and (1, 1) which are connected by a transition state at (0, 0). We added at a perturbation (eq. 37) which tilts the energy function V (x, y) along the direction y, such that the mininum at (1, 1) becomes much deeper than the minimum at (-1, -1). Fig. <ref type="figure" target="#fig_1">4</ref>.B and 4.E show the dominant left MSM eigenvectors of the two systems (direct MSMs). The first eigenvector corresponds to the equilibrium distribution. In both cases, the second eigenvector represents the transition between the two wells, while the third eigenvector corresponds to an exchange of probability density between the transition state region and the two wells. Fig. <ref type="figure" target="#fig_1">4</ref>.C shows the MSM eigenvectors obtained by reweighting the simulation in V (x, y) to the perturbed potential energy function V (x, y)+U (y) (reweighted MSM). Both eigenvectors (eq. 31) and implied timescales (eq. 32) are in perfect agreement with Fig. <ref type="figure" target="#fig_1">4</ref>.E. This confirms that reweighting MSMs using the Girsanov formula works well for low-dimensional Brownian dynamics <ref type="bibr" target="#b28">29</ref> . Note that the simulation in the reference potential energy function V (x, y) exhibits frequent transitions between the two minima, and thus eq. 24 is certainly fulfilled. By contrast in the perturbed system V (x, y), the simulation sampled considerably fewer transitions between the minima and only a small fraction of the simulation time was spent in the minimum in the lower left corner. Fig. <ref type="figure" target="#fig_1">4</ref>.F shows the dominant eigenvectors of a MSM of the reference dynamics constructed by reweighting the perturbed path ensemble. The fact that Fig. <ref type="figure" target="#fig_1">4</ref>.C is in excellent agreement with Fig. <ref type="figure" target="#fig_1">4</ref>.B demonstrates that the reweighting method yields accurate results even for path ensembes with low numbers of transitions across the largest barriers of the system and thus suggests that it can be applied to high-dimensional dynamics on rugged potential energy surfaces. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>MSM MSM</head><note type="other">Reweighting</note></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D. Many-body system in three-dimensional space</head><p>As a second example, we studied a six-particle system, in which five particles form a chain while the sixth particle branches the chain at the central atom Fig. <ref type="figure" target="#fig_2">5</ref>.A . We constructed the MSM on the central bonds r 12 and r 13 , but applied the perturbation potential energy function along the through-space distances r 24 and r 34 . Thus, the perturbation was projected onto the reaction coordinates r 12 and r 13 during the reweighting. The reference potential energy function for each bond is a tilted double well potential, such that the reference system exhibits four metastable states (first row of Fig. <ref type="figure" target="#fig_2">5</ref>.B). The six-particle system and the reference potential energy function is symmetric. Thus the MSM of the reference system has two degenerate dominant eigenfunction with implied timescales of 1.1 • 10 4 ∆t. with a relative error due to sampling of 1.6 %.</p><p>The perturbation contracts the bonds, thereby stabilizing the metastable state at the lower left corner in the 1st eigenvector (second row of Fig. <ref type="figure" target="#fig_2">5</ref>.B). Its effect is to break the symmetry and to accelerate the dynamics, yielding implied timescales of 6.7 • 10 4 ∆t and 5.9 • 10 4 ∆t. The third row of Fig. <ref type="figure" target="#fig_2">5</ref>.B shows the eigenvectors and the implied time scales obtained by reweighting the simulation at the reference potential energy function to the perturbed potential energy function. The relative error of the implied timescale of the second and third eigenvector is 5.2% and 0.7%, respectively. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E. Alanine dipeptide and valine dipeptide</head><p>Figure <ref type="figure" target="#fig_3">6</ref> shows the results for alanine dipeptide (Ac-A-NHMe) in implicit water. The MSM has been constructed on the φ and ψ backbone dihedral angles and the slow eigenvectors of the unperturbed system are shown in Fig. <ref type="figure" target="#fig_3">6</ref>.C. The first eigenvector shows the typical equilibrium distribution in the Ramachandran plane <ref type="bibr" target="#b36">37</ref> . The second eigenvector represents a torsion around the φ angle and corresponds to a kinetic exchange between the L α -minimum (φ &gt; 0) and the α-helix and β-sheet minima (φ &lt; 0). The associated timescale is 2.8 ns. The green arrows in Fig. <ref type="figure" target="#fig_3">6</ref>.C represent the frequency of the transitions, with the transition L α ↔ β-sheet conformation occuring more frequently than the transition L α ↔ αhelical conformation. The third eigenvector represents a transition β-sheet ←→ α-helical conformation, i.e. a torsion around ψ, and is associated to a timescale of 27 ps.</p><p>We perturbed the dynamics by adding a harmonic potential to the dihedral angle potentials of the φ-and ψ-angle (Fig. <ref type="figure" target="#fig_3">6</ref>.A and 6.B, eq. 43 with κ φ = 0.5 and κ ψ = 0.5). The α-helical region is somewhat stabilized by the perturbation but otherwise the dominant eigenvectors are very similar to the unperturbed system (second row in Fig. <ref type="figure" target="#fig_3">6</ref>.C). However, the perturbation changes the relative frequency of the two possible transitions (green arrows) in the second eigenvector, resulting in an increased implied timescale of 4.5 ns. The third row of Fig. <ref type="figure" target="#fig_3">6</ref>.C shows the dominant eigenvector of the perturbed system obtained by reweighting the reference simulations. The results are in excellent agreement with the direct simulation of the perturbed systems. The relative error of the implied timescale associated to the second eigenvector is 4.1%. Fig. <ref type="figure" target="#fig_4">7</ref>.A shows the implied timescale test (eq. 32) for alanine dipeptide in implicit water. All three systems (reference, perturbed and reweighted) show constant implied timescales, indicating that the MSM are well converged. Moreover, the graph shows that the reweighting method can recover the implied timescales of the perturbed system over a large range of lag times τ . We have repeated the alanine dipeptide simulations in explicit water. The eigenvectors are very similar to those of alanine dipeptide in implicit water (data not shown), but the associated implied timescales differ from the implicit solvent simulations (Fig. <ref type="figure" target="#fig_4">7</ref>.B). In the unperturbed system, the implied timescale of the second eigenvector was 3.1 ns and the implied timescale of the third eigenvector was 75 ps. Perturbing the dihedral angle potentials, slightly increased the implied timescale of the second eigenvector to 3.5 ns and left the implied timescale of the third eigenvector unaffected. The implied timescales of the reference simulation and the direct simulation of the perturbed system were constant, whereas we noticed a slight drift in the implied timescale of the second eigenvector for the reweighted MSM. At τ = 45 ps, the measured implied timescale is 3.4 ns which corresponds to a relative error of 2.8 %. We also tested the dynamical reweighting method on valine dipeptide (Fig. <ref type="figure" target="#fig_5">8</ref>). Here, however, we perturbed the potential energy function of the χ-side chain dihedral angle (Fig. <ref type="figure" target="#fig_5">8</ref>.A) by adding a harmonic potential, while constructing the MSM on the φ and ψ backbone dihedral angles. Thus, the perturbation did not directly act on the variables of the MSM. The perturbation of the χ angle had no affect on the eigenvectors of the MSM (Fig. <ref type="figure" target="#fig_5">8</ref>.B), but it did change the implied time scales. It caused a decrease of the implied time scale of the second eigenvector from 1.3 ns in the reference simulation to 1.0 ns in the perturbed simulation and a slight increase of the implied time scale of the third eigenvector from 159 ps in the reference simulation to 170 ps in the perturbed simulation. Reweighting the reference simulation to the perturbed potential energy function recovered the results of the direct simulation of the perturbed system. The implied timescales obtained by the reweighting calculation were 1.0 ns (relative error: 4.9% before rounding to ns) for the second eigenvector and 179 ps (relativ error: 5.3%) for the third eigenvector. This shows that the dynamical reweighting method also works, when the perturbation acts on degrees of freedom which are part of the relevant coordinates on which the MSM is constructed. Fig. <ref type="figure">9</ref> illustrates how to use the dynamical reweighting method to study the influence of a force constant on the molecular dynamics. It shows the implied timescale of the second and third MSM eigenvectors of alanine dipeptide in explicit water as a function of the force constant κ φ , where the perturbation potential energy is given by eqs. 41 and 43. The scan has been repeated with different values of the force constant κ ψ for the potential energy function of the ψ-backbone dihedral angle (eqs. 42 and 43). The dynamics is more sensitive to a change in the value of κ φ than to a change of κ ψ , but the overall effect of the perturbation is moderate. It is important to point out that MSMs which are summarized in Fig. <ref type="figure">9</ref> have been constructed from a single simulation at the reference potential energy function. During this simulation, the Itô integral I(a) and the Riemann integral R(a) have been calculated for κ φ = 1 and κ ψ = 1, and the force constants have been scaled after the simulation during the construction of the MSM, as described in section IV A. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Ac-A-NHMe</head><note type="other">Reweighting</note></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Ac-V-NHMe</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>V. CONCLUSION</head><p>We have presented the Girsanov reweighting scheme, which is a method to study the dynamics of a molecular system subject to an (external) perturbation U (κ, x) of the (reference) potential energy function V (x). It allows for the estimation of a dynamical model, e.g. a MSM, of the perturbed system from a simulation at the reference potential energy function. The underlying assumption is that the equation of motion generates a path ensemble and that we can define a probability measure on this ensemble. A perturbation of the potential energy function causes a modification of the probability measure. The Girsanov theorem guarantees that the probability ratio between these two measures exists (under certain conditions) and leads to an analytical expression for this ratio (eq. 25). By reformulating the MSM transition probabilities as path ensemble averages, we can apply the Girsanov reweighting scheme to obtain the transition probabilities of the perturbed system from a set of paths generated at the reference potential energy function. The method can be extended to the variational approaches <ref type="bibr" target="#b37">38,</ref><ref type="bibr" target="#b38">39</ref> , milestoning approaches <ref type="bibr" target="#b39">40,</ref><ref type="bibr" target="#b40">41</ref> or tensor approaches <ref type="bibr" target="#b41">42</ref> to molecular dynamics, since in each of these methods the molecular transfer operator is discretized and the resulting matrix elements are estimated as path ensemble averages.</p><p>Calculating the path probability ratio requires the knowledge of the random forces at each integration time step. For the explicit solvent simulations, we have introduced stochastic forces by using a Langevin thermostat. In an efficient implementation of the method, two terms which are needed to calculate the probability ratio should be calculated "on the fly" during the simulation. We have demonstrated this using the MD simulation toolkit OPENMM <ref type="bibr" target="#b31">32</ref> .</p><p>Two other dynamical reweighting schemes for MSMs have been published in recent years. In the reweighting scheme for parallel tempering simulations <ref type="bibr" target="#b42">43,</ref><ref type="bibr" target="#b43">44</ref> , the path probability density is defined for time discretized paths at a reference temperature and then reweighted to different temperatures using statistically optimal estimators <ref type="bibr" target="#b44">45,</ref><ref type="bibr" target="#b45">46</ref> . Like the Girsanov reweighting scheme, this method relies on the random forces at each integration time step and reweights the contribution of each path to the estimate of the transition probability individually. We remark that the reweighting to different thermodynamic states cannot be extended to the limiting case of continuous paths because for different volatilities the path probability ratio relative to the Wiener process cannot be defined (see appendix A). This however seems to be of little practical importance. In the TRAM method <ref type="bibr" target="#b46">[47]</ref><ref type="bibr" target="#b47">[48]</ref><ref type="bibr" target="#b48">[49]</ref> , rather than reweighting the probabilities of each individual path, the MSM transition probabilities T ij (τ ) are directly reweighted to a different potential energy function or a different thermodynamic state using a maximum likelihood estimator for the transition counts. This becomes possible, if one additionally assumes that the dynamics is in local equilibrium within each microstate of the MSM, which possibly renders the method more sensitive to the MSM discretization than path based reweighting methods.</p><p>We have tested the Girsanov reweighting method on several systems, ranging from diffusion in a two-dimensional potential energy surface to alanine dipeptide and valine dipetide in implicit and explict water. Importantly, the direct simulations of the perturbed potential energy function (Figs. 5, 6, 8) are only included as a validation for the method. In an actual application one would only simulate the system at the reference potential energy function and then reweight to the perturbed potential energy function, thus saving the computational time of the direct simulation of the perturbed system.</p><p>Girsanov reweighting could be useful in several areas of research. First, one can very efficiently test the influence of a change in the potential energy function on the dynamics of the molecule. The influence of a change in the force constant on the dynamics is particularly easy to study. The Girsanov reweighting method can therefore be applied to improve the dynamical properties of force fields 37 , by for example tuning the force constants to match an experimentally measured correlation time. Similarly, one can use Girsanov reweighting to understand the influence of restraining potentials <ref type="bibr" target="#b49">50,</ref><ref type="bibr" target="#b50">51</ref> on the dynamics of the system. Second, the method can be used to understand which degrees of freedom have the largest influence on the slow modes of the molecule <ref type="bibr" target="#b51">52,</ref><ref type="bibr" target="#b52">53</ref> . For example, for alanine dipeptide, we showed that the slow dynamic modes are more sensitive to a force field variation in the φ-backbone dihedral angle than they are to a variation in the ψ-backbone dihedral angle. Last but not least, Girsanov reweighting can be used to account for the effect of any external potential which has been added to the simulation in order to enhance the sampling. Thus, one can for example estimate MSMs from metadynamics simulations <ref type="bibr" target="#b53">54,</ref><ref type="bibr" target="#b54">55</ref> , Hamilton replica exchange simulations <ref type="bibr" target="#b55">56</ref> or umbrella sampling simulations <ref type="bibr" target="#b56">57</ref> .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>VI. SUPPLEMENTARY MATERIAL</head><p>Example script for the implementation of the dynamical reweigthing method with OpenMM 32 .</p><p>1. The normalization constant tends to infinity:</p><formula xml:id="formula_74">lim ∆t→0 1 √ 2π∆tσ 2 = +∞ (A4)</formula><p>2. The quantity in the exponential function becomes a derivative of the process x t :</p><formula xml:id="formula_75">(x k -x k-1 -a k ∆t) 2 2∆tσ 2 = x k -x k-1 ∆t -a k 2 ∆t 2σ 2 (A5)</formula><p>Then, formally lim ∆t→0</p><formula xml:id="formula_76">x k -x k-1 ∆t -a k 2 ∆t 2σ 2 = dx t dt -a(x t ) 2 dt 2σ 2 (A6)</formula><p>But the derivative dxt dt is not defined, because even though Brownian motion is everywhere continuous, it is nowhere differentiable.</p><p>3. The continuous path is made by an infinite number of points. If n → +∞, then the infinitesimal volume space dω = dx 1 dx 2 ...dx ∞ becomes infinite-dimensional. However, the Lebesgue measure of an infinite-dimensional space does not exist.</p><p>In conclusion, we cannot define a path probability density for a continuous path respect to the Lebesgue measure.</p><p>On the other hand we can define the probability density of a path ω respect to a Wiener measure W . By computing explicitly the ratio between the probability density associated to a (discrete) brownian motion with drift and a probability density associated to a Brownian motion without drift, but with the same volatility, we get the following expression: We observe that if we take the limit ∆t → 0, the three problems described above are solved:</p><p>1. The normalization constant cancels.</p><p>2. The term x k -x k-1 is not divided by the time-step ∆t, so there is not derivative respect to time.</p><p>3. The ratio between the two probability densities cancels also the infinitesimal volume dω. The new probability density is defined respect to the Wiener measure, not respect the Lebesgue measure.</p><p>Thus in the continuous case the likelihood (A7) is written as: </p><formula xml:id="formula_77">(x k -x k-1 -a k ∆t) 2 2∆tσ 2 = exp -n k=0 x 2 k +x 2 k-1 +b 2 k ∆t 2 -2x k x k-1 -2x k b k ∆t+2x k-1 b k ∆t 2∆tσ 2 exp -n k=0 x 2 k +x 2 k-1 +a 2 k ∆t 2 -2x k x k-1 -2x k a k ∆t+2x k-1 a k ∆t 2∆tσ 2 = exp -n k=0 (x k -x k-1 ) 2 2∆tσ 2 exp -n k=0 b 2 k ∆t 2 -2x k b k ∆t+2x k-1 b k ∆t 2∆tσ 2 exp -n k=0 (x k -x k-1 ) 2 2∆tσ 2 exp -n k=0 a 2 k ∆t 2 -2x k a k ∆t+2x k-1 a k ∆t 2∆tσ 2 = exp - n k=0 (b 2 k -a 2 k ) ∆t 2 -2x k (b k -a k ) ∆t + 2x k-1 (b k -a k ) ∆t 2∆tσ 2 = exp - n k=0 -2x k (b k -a k ) ∆t + 2x k-1 (b k -a k ) ∆t 2∆tσ 2 exp - n k=0 (b 2 k -a 2 k ) ∆t 2 2∆tσ 2 = exp n k=0 (x k -x k-1 ) (b k -a k ) σ 2 exp - n k=0 (b 2 k -a 2 k ) ∆t 2σ 2</formula><p>(C7)</p><p>If we take the limit ∆t → 0, the two sums in the exponential function converge respectively to the Ito integral and the Riemann integral. The jump x k -x k-1 is Wiener jump with drift a k ∆t: </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>FIG. 3 .</head><label>3</label><figDesc>FIG.3. Number of days needed to product a trajectory of Alanine dipeptide in implicit solvent of 1 µs. The system has been perturbed by adding an harmonic potential to different dihedral angles. The blue line denotes the time needed to perform respectively 1,...,5 simulations with different potential energy functions (i.e. different perturbations). The red line is the time necessary to perform one single simulation and to compute the Girsanov formula on fly for 1,...,5 different perturbations at the same time. The benchmark test has been realized on a CPU Intel(R) Core(TM) i5-4590 CPU @ 3.30GHz with 15 GB of RAM.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>FIG. 4 .</head><label>4</label><figDesc>FIG. 4. (A) Reference potential. (B) Dominant left eigenvectors of the reference potential. (C) Dominant left eigenvectors reweighted from the reference dynamics. (D) Perturbed potential. (E) Dominant left eigenvectors of the perturbed potential. (F) Dominant left eigenvectors reweighted from the perturbed dynamics.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>FIG. 5 .</head><label>5</label><figDesc>FIG. 5. Many body system. (A)The system is perturbed adding the bonds r 24 and r 34 , while the MSM is constructed on the distances r 12 and r 13 . The numbers written in italic identify the atoms of the molecule. (B) Dominant eigenvectors of the manybody system. (first row) Unperturbed system; (second row) perturbed system (third row) reweighting method. The number above the eigenvectors denote respectively the implied time scales of the second and third process as number of timesteps.</figDesc><graphic coords="18,194.53,173.60,226.80,213.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>FIG. 6 .</head><label>6</label><figDesc>FIG. 6. Alanine dipeptide. (A) Reference potential energy function of the backbone dihedral angle φ, V (φ) (blue line), and perturbed potential energy function, V (φ) + U (κ φ = 0.5, κ ψ = 0, φ, ψ) (green line). (B) Reference potential energy function of the backbone dihedral angle ψ, V (ψ) (blue line), and perturbed potential energy function, V (ψ) + U (κ φ = 0, κ ψ = 0.5, φ, ψ) (green line). (C) First three MSM eigenvectors of alanine dipeptide, where the MSM is constructed in the space spanned by the φ-and ψ-backbone dihedral angle.</figDesc><graphic coords="19,187.53,345.51,210.70,220.50" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>FIG. 7 .</head><label>7</label><figDesc>FIG. 7. Alanine dipeptide. (A) Implied time scales in implicit solvent. (B) Implied time scales in explicit solvent. Reference potential (blue line), perturbed potential (green line) and reweighting method (red dashed line).</figDesc><graphic coords="20,188.83,367.09,226.80,113.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>FIG. 8 .</head><label>8</label><figDesc>FIG. 8. Valine dipeptide. (A) Reference potential energy function of the side-chain dihedral angle χ, V (χ) (blue line), and perturbed potential energy function, V (χ) + U (κ χ = 0.5, χ) (green line). (B) First three MSM eigenvectors of the valine dipeptide, where the MSM is constructed in the space spanned by the φ-and ψ-backbone dihedral angle. (C) Associated implied time scales as a function of the lag time τ . Reference potential (blue line), perturbed potential (green line) and reweighting method (red dashed line)</figDesc><graphic coords="21,178.63,429.08,234.70,117.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><label></label><figDesc>quantity denotes the probability density, in the continuos case, of a path x t solution of a diffusion process, respect to the Wiener measure. The complete computation of the formulas (A7) and (A8) is reported in the appendix C. The Girsanov theorem states the condition under which the likelihood (A8) exists.L = µ P b (x 0 , ..., x n ) µ Pa (x 0 , ..., x n ) = exp -n k=0 (x k -x k-1 -b k ∆t) 2 2∆tσ 2 exp -n k=0</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>2 T 0 b 2 T 0 b 2 T 0 ( 2 T 0 b</head><label>20202020</label><figDesc>-a k )(x k -x k-1 ) → T 0 (b(x s ) -a(x s ))dx s = T 0 (b(x s ) -a(x s ))d Bs = T 0 (b(x s ) -a(x s ))(a(x s )ds + σdB s ) = T 0 a(x s )b(x s )ds + b(x s )σdB s -a(x s ) 2 ds -a(x s )σdB s s )b(x s )ds + b(x s )σdB s -a(x s ) 2 ds -a(x s )σdB s σ 2 exp -1 (x s ) 2 -a(x s ) s )σdB s -a(x s )σdB s σ 2 exp T 0 a(x s )b(x s ) -a(x s ) s ) 2 -a(x s ) s ) -a(x s ) σ dB s exp -1 (x s ) 2 + a(x s ) 2 -2a(x s )b(x s ) s ) -a(x s ) σ dB s exp -1 b(x s ) -a(x s )) 2 σ 2 ds(C9) Thus we get the more general Girsanov formula valid also for two diffusion processes with different drifts.L = expT 0 b(x s ) -a(x s ) σ dB s -1 (x s ) -a(x s ) σ 2 ds</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>TABLE I .</head><label>I</label><figDesc>Overview of the notation</figDesc><table><row><cell>State: x</cell><cell>Path: ω</cell></row><row><cell>Space</cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>FIG. 9. First and second implied time scales of alanine dipeptide in explicit solvent as function of the parameters k φ , k ψ , estimated with the Girsanov reweighting method.</figDesc><table><row><cell>1st its (ps)</cell><cell>3150 3200 3250 3300 3350 3400 3600 3550 3500 3450</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>78</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>77</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell>2nd its (ps)</cell><cell>74 75 76</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>73</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row><row><cell></cell><cell>72</cell><cell>0</cell><cell>0.1</cell><cell>0.2</cell><cell>k φ</cell><cell>0.3</cell><cell>0.4</cell><cell>0.5</cell></row><row><cell cols="2">k ψ = 0.0 0.04 0.08</cell><cell></cell><cell>0.12 0.16 0.2</cell><cell></cell><cell cols="2">0.24 0.28 0.32</cell><cell>0.36 0.4</cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>ACKNOWLEDGMENTS</head><p>This research has been funded by <rs type="funder">Deutsche Forschungsgemeinschaft (DFG)</rs> through grant <rs type="grantNumber">CRC 1114</rs> "<rs type="projectName">Scaling Cascades in Complex Systems</rs>", Project <rs type="grantNumber">B05</rs> "<rs type="projectName">Origin of the scaling cascades in protein dynamics</rs>".</p></div>
			</div>
			<listOrg type="funding">
				<org type="funded-project" xml:id="_aDUb3pZ">
					<idno type="grant-number">CRC 1114</idno>
					<orgName type="project" subtype="full">Scaling Cascades in Complex Systems</orgName>
				</org>
				<org type="funded-project" xml:id="_k3qZceh">
					<idno type="grant-number">B05</idno>
					<orgName type="project" subtype="full">Origin of the scaling cascades in protein dynamics</orgName>
				</org>
			</listOrg>
			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Appendix A: Discussion over path probability measure of time-discrete and continuos paths</p><p>In the theory section, we assumed to work with time-discrete trajectories and we have defined the corresponding concepts of path ensemble and path probability measures. In this section, we show why we cannot extend these concepts to continuous paths.</p><p>Let's consider a diffusion process</p><p>where a(•) is a drift, B t is a Brownian motion, σ is a volatility and τ is the total time. The equation can be discretized in time according to several schemes. We consider the Euler-Maruyana method:</p><p>where a k = a(x t ), ∆t is a time-step and η is a random number drawn from a standard Gaussian distribution. We now recall the same definitions given in the theory section. A time-discrete path is the set of the points x k generated by the equation A2 ω = {x(t = 0) = x 0 , x 1 , x 2 , ..., x n } where n ∈ N is the total number of time steps and τ = n∆t.</p><p>If we consider an ensemble of paths starting from the same point x 0 and length τ , we can define a path space Ω τ,x = Γ n , a path probability measure P and the associated path probability density µ P (ω) as defined respectively in eq. ( <ref type="formula">6</ref>) and eq. ( <ref type="formula">7</ref>)</p><p>The path probability density function is defined as in the theory section, but here we remark that, in a rigorous formalism, a density function is a derivative respect to the Lebesgue measure dω = dx 1 dx 2 ...dx n , i.e. µ P (ω) = dP dω . For Brownian motion with drift, the transition probability density p(x k-1 , x k ; ∆t) that appear in eq. ( <ref type="formula">6</ref>) and eq. ( <ref type="formula">7</ref>) is well defined for time-discrete paths:</p><p>Let's see now what happen if we take ∆t → 0, i.e. if we consider continuous paths:</p><p>Appendix B: The Girsanov theorem</p><p>The Girsanov theorem <ref type="bibr" target="#b26">27,</ref><ref type="bibr" target="#b27">28</ref> is an important result of stochastic analysis that states the conditions under which a change of measure is possible for diffusion processes.</p><p>Let's consider two diffusion processes x t ∈ R and y t ∈ R defined on the probability space (Ω, F, {F t } t≥0 ), respectively with probability measures P and Q on the filtration {F t } t≥0 ), be solutions of the stochastic differential equations:</p><p>where the functions a : R n → R n and b : R n → R n are measurable, σ is the volatility, B t is an n-dimensional Brownian motion, τ ≤ ∞ and x 0 = y 0 ∈ R n . Suppose that there exists a process ξ t such that</p><p>and define</p><p>is satisfied, then the process M τ is a martingale [ </p><p>Remark The measures P and Q on the filtration F t represent the probability measures on a path space. In other words, given a set of trajectories, P and Q return the probability of a certain path. The concept of absolute continuity means that if a path is not allowed under P , then it is not allowed under Q:</p><p>for every measurable set F 1 , ..., F n ⊆ F τ with τ &gt; 0 fixed. Because M τ is strictly positive, the probability measure P is also absolutely continuous w.r.t Q:</p><p>then the two measures P and Q are equivalent (or mutually absolutely continuous w.r.t each other) and we can write:</p><p>Appendix C: Derivation of the Girsanov formula</p><p>Let's now consider two diffusion processes with different drift terms, solutions of the stochastic differential equations:</p><p>with initial conditions x 0 = x ∈ R. We discretize the equations C1, C2 with the Euler-Maruyama method:</p><p>where a k = a(x k ) and b k = b(x k ) are two different drift terms. The transition probability densities are defined respectively as</p><p>for the first equation C1 and</p><p>for the second equation C2.</p><p>The path probability density µ Pa (ω) associated to the equation C1 and µ P b (ω) associated to the equation C2 are defined as in eq. 7. Thus, the ratio is given as</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">G</forename><surname>Bolhuis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Chandler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Dellago</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">L</forename><surname>Geissler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annu. Rev. Phys. Chem</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page">291</biblScope>
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">K</forename><surname>Faradjian</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Elber</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">120</biblScope>
			<biblScope unit="page">10880</biblScope>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">B</forename><surname>Best</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Hummer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Natl. Acad. Sci. U.S.A</title>
		<imprint>
			<biblScope unit="volume">102</biblScope>
			<biblScope unit="page">6732</biblScope>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">R</forename><surname>Hegger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Stock</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">130</biblScope>
			<biblScope unit="page">34106</biblScope>
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">P</forename><surname>Faccioli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Lonardi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Orland</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">133</biblScope>
			<biblScope unit="page">45104</biblScope>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">C</forename><surname>Schütte</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Fischer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Huisinga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Deuflhard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">151</biblScope>
			<biblScope unit="page">146</biblScope>
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">C</forename><surname>Schütte</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Huisinga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Deuflhard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Z.I.B. Report</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
	<note>SC</note>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">P</forename><surname>Deuflhard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Huisinga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Fischer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Schütte</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Linear Algebra Appl</title>
		<imprint>
			<biblScope unit="volume">315</biblScope>
			<biblScope unit="page">39</biblScope>
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">C</forename><surname>Swope</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">W</forename><surname>Pitera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Suits</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Pitman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Eleftheriou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">G</forename><surname>Fitch</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">S</forename><surname>Germain</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rayshubski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">J C</forename><surname>Ward</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhestkov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Zhou</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Phys. Chem. B</title>
		<imprint>
			<biblScope unit="volume">108</biblScope>
			<biblScope unit="page">6582</biblScope>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Chodera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Singhal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">S</forename><surname>Pande</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Dill</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">C</forename><surname>Swope</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">126</biblScope>
			<biblScope unit="page">155101</biblScope>
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">N.-V</forename><surname>Buchete</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Hummer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Phys. Chem. B</title>
		<imprint>
			<biblScope unit="volume">112</biblScope>
			<biblScope unit="page">6057</biblScope>
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">J.-H</forename><surname>Prinz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Sarich</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Keller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Senne</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Held</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Chodera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Schütte</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">134</biblScope>
			<biblScope unit="page">174105</biblScope>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">B</forename><surname>Keller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Daura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">F</forename><surname>Van Gunsteren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">132</biblScope>
			<biblScope unit="page">74110</biblScope>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">B</forename><surname>Keller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Hünenberger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">F</forename><surname>Van Gunsteren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Theory Comput</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">1032</biblScope>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">A</forename><surname>Voelz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">R</forename><surname>Bowman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Beauchamp</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">S</forename><surname>Pande</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Am. Chem. Soc</title>
		<imprint>
			<biblScope unit="volume">132</biblScope>
			<biblScope unit="page">1526</biblScope>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">D</forename><surname>Fabritiis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Stanley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Esteban-Mart</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Commun</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">5272</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">R</forename><surname>Bowman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">R</forename><surname>Bolin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">M</forename><surname>Hart</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">C</forename><surname>Maguire</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Marqusee</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Natl. Acad. Sci. U.S.A</title>
		<imprint>
			<biblScope unit="volume">112</biblScope>
			<biblScope unit="page">2734</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">N</forename><surname>Plattner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noe</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Commun</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">7653</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">L</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><forename type="middle">C</forename><surname>Unarta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">P</forename><surname>-H. Cheung</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Huang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Accounts Chem. Res</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="page">698</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">R</forename><surname>Zwanzig</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page">1420</biblScope>
			<date type="published" when="1954">1954</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">H</forename><surname>Bennett</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page">245</biblScope>
			<date type="published" when="1976">1976</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">S</forename><surname>Kumar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Bouzida</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">H</forename><surname>Swendsen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">A</forename><surname>Kollman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Rosenberger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Chem</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">1011</biblScope>
			<date type="published" when="1992">1992</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">J</forename><surname>Kästner</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Thiel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">123</biblScope>
			<biblScope unit="page">144104</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">Méthodes de Monte Carlo pour les équations de transport et de diffusion</title>
		<author>
			<persName><forename type="first">B</forename><surname>Lapeyre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Pardoux</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Sentis</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1998">1998</date>
			<publisher>Springer</publisher>
			<pubPlace>Berlin</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">O</forename><surname>Papaspiliopoulos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Roberts</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
			<biblScope unit="page">28</biblScope>
		</imprint>
		<respStmt>
			<orgName>University of Warwick, Centre for Research in Statistical Methodology</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">C</forename><surname>Hartmann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Schütte</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Mech. Theor. Exp</title>
		<imprint>
			<date type="published" when="2012">2012. 2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">I</forename><forename type="middle">V</forename><surname>Girsanov</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Theory Probab. Appl</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">285</biblScope>
			<date type="published" when="1960">1960</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">Stochastic Differential Equations: An Introduction with Applications</title>
		<author>
			<persName><forename type="first">B</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2003">2003</date>
			<publisher>Springer Verlag</publisher>
			<pubPlace>Berlin</pubPlace>
		</imprint>
	</monogr>
	<note>6th edition</note>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">C</forename><surname>Schütte</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Nielsen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Weber</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Phys</title>
		<imprint>
			<biblScope unit="volume">113</biblScope>
			<biblScope unit="page">69</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title level="m" type="main">Numerical Solution of Stochastic Differential Equations with Jumps in Finance</title>
		<author>
			<persName><forename type="first">E</forename><surname>Platen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Bruti-Liberati</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013">2013</date>
			<publisher>Springer Verlag</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><surname>Brünger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">L B</forename><surname>Iii</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Karplus</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Chem. Phys. Letters</title>
		<imprint>
			<biblScope unit="volume">105</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page">495</biblScope>
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">P</forename><surname>Eastman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S</forename><surname>Friedrichs</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Chodera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Radmer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">M</forename><surname>Bruns</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Ku</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">A</forename><surname>Beauchamp</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">J</forename><surname>Lane</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L.-P</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Shukla</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Tye</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Houston</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Stich</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Klein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">R</forename><surname>Shirts</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">S</forename><surname>Pande</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Theory Comput</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">461</biblScope>
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Maier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Martinez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Kasavajhala</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Wickstrom</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">E</forename><surname>Hauser</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Simmerling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Theory Comput</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page">3696</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><surname>Onufriev</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Bashford</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Case</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proteins</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="issue">22</biblScope>
			<biblScope unit="page">383</biblScope>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">L</forename><surname>Jorgensen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Chandrasekhar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Madura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">W</forename><surname>Impey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Klein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">79</biblScope>
			<biblScope unit="page">926</biblScope>
			<date type="published" when="1983">1983</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Izaguirre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">R</forename><surname>Sweet</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">S</forename><surname>Pande</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pac. Symp. Biocomput</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page">240</biblScope>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">F</forename><surname>Vitalini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">S J S</forename><surname>Mey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">G</forename><surname>Keller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Vitalini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">S J S</forename><surname>Mey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">G</forename><surname>Keller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">142</biblScope>
			<biblScope unit="page">84101</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">F</forename><surname>Nüske</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Keller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Perez-Hernandez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">S J S</forename><surname>Mey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noe</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Theory Comput</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">1739</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">F</forename><surname>Vitalini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">G</forename><surname>Keller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Theory Comput</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">3992</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">C</forename><surname>Schütte</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Sarich</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Vanden-Eijnden</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">134</biblScope>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">O</forename><surname>Lemke</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">G</forename><surname>Keller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">164104</biblScope>
			<biblScope unit="page">1</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">F</forename><surname>Nüske</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Schneider</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Vitalini</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noe</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">144</biblScope>
			<biblScope unit="page">54105</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">J.-H</forename><surname>Prinz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Chodera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">S</forename><surname>Pande</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">C</forename><surname>Swope</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Smith</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">134</biblScope>
			<biblScope unit="page">244108</biblScope>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Chodera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">C</forename><surname>Swope</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-H</forename><surname>Prinz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">R</forename><surname>Shirts</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">S</forename><surname>Pande</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">134</biblScope>
			<biblScope unit="page">244107</biblScope>
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">R</forename><surname>Shirts</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Chodera</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">129</biblScope>
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">D L</forename><surname>Minh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Chodera</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">131</biblScope>
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">S J S</forename><surname>Mey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Phys. Rev. X</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page">41018</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">H</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">S J S</forename><surname>Mey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Rosta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">141</biblScope>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b48">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">H</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Paul</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Wehmeyer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Noé</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Natl. Acad. Sci. U.S.A</title>
		<imprint>
			<biblScope unit="volume">113</biblScope>
			<biblScope unit="page">3221</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b49">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><surname>Cesari</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Gil-Ley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Bussi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Theory Comput</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">6192</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b50">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">B</forename><surname>Keller</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Christen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Oostenbrink</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">F</forename><surname>Van Gunsteren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Biomol. NMR</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page">1</biblScope>
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b51">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><surname>Tsourtis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Pantazis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Katsoulakis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Harmandaris</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">143</biblScope>
			<biblScope unit="page">14116</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b52">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">G</forename><surname>Arampatzisa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Katsoulakis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Rey-Bellet</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">144</biblScope>
			<biblScope unit="page">104107</biblScope>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b53">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">T</forename><surname>Huber</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">E</forename><surname>Torda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">F</forename><surname>Van Gunsteren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Aided Mol. Des</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">695</biblScope>
			<date type="published" when="1994">1994</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b54">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">A</forename><surname>Laio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Parrinello</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Natl. Acad. Sci. U.S.A</title>
		<imprint>
			<biblScope unit="volume">99</biblScope>
			<biblScope unit="page">12562</biblScope>
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b55">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">Y</forename><surname>Sugita</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Okamoto</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Chem. Phys. Lett</title>
		<imprint>
			<biblScope unit="volume">329</biblScope>
			<biblScope unit="page">261</biblScope>
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b56">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">G</forename><surname>Torrie</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Valleau</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page">187</biblScope>
			<date type="published" when="1977">1977</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
